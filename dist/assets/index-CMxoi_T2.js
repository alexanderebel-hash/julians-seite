var Ws=Object.defineProperty;var os=e=>{throw TypeError(e)};var zs=(e,i,a)=>i in e?Ws(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a;var $r=(e,i,a)=>zs(e,typeof i!="symbol"?i+"":i,a),Mn=(e,i,a)=>i.has(e)||os("Cannot "+a);var mt=(e,i,a)=>(Mn(e,i,"read from private field"),a?a.call(e):i.get(e)),nr=(e,i,a)=>i.has(e)?os("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,a),ir=(e,i,a,s)=>(Mn(e,i,"write to private field"),s?s.call(e,a):i.set(e,a),a),Qt=(e,i,a)=>(Mn(e,i,"access private method"),a);var un=(e,i,a,s)=>({set _(o){ir(e,i,o,a)},get _(){return mt(e,i,s)}});(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function a(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=a(o);fetch(o.href,c)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var a=function s(){return this instanceof s?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};a.prototype=i.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,i,a){var s,o={},c=null,h=null;if(i!=null)for(s in i.ref!==void 0&&(h=i.ref),i.key!==void 0&&(c=""+i.key),i)J.call(i,s)&&!L$1.hasOwnProperty(s)&&(o[s]=i[s]);var d=arguments.length-2;if(d===1)o.children=a;else if(1<d){for(var g=Array(d),_=0;_<d;_++)g[_]=arguments[_+2];o.children=g}if(e&&e.defaultProps)for(s in d=e.defaultProps,d)o[s]===void 0&&(o[s]=d[s]);return{$$typeof:l$1,type:e,key:c,ref:h,props:o,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape$1(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return i[a]})}var P$1=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape$1(""+e.key):i.toString(36)}function R$1(e,i,a,s,o){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(c){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:h=!0}}if(h)return h=e,o=o(h),e=s===""?"."+Q$1(h,0):s,I$1(o)?(a="",e!=null&&(a=e.replace(P$1,"$&/")+"/"),R$1(o,i,a,"",function(_){return _})):o!=null&&(O$1(o)&&(o=N$1(o,a+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(P$1,"$&/")+"/")+e)),i.push(o)),1;if(h=0,s=s===""?".":s+":",I$1(e))for(var d=0;d<e.length;d++){c=e[d];var g=s+Q$1(c,d);h+=R$1(c,i,a,g,o)}else if(g=A$1(e),typeof g=="function")for(e=g.call(e),d=0;!(c=e.next()).done;)c=c.value,g=s+Q$1(c,d++),h+=R$1(c,i,a,g,o);else if(c==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return h}function S$1(e,i,a){if(e==null)return e;var s=[],o=0;return R$1(e,s,"","",function(c){return i.call(a,c,o++)}),s}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,i,a){S$1(e,function(){i.apply(this,arguments)},a)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(e,i,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=C$1({},e.props),o=e.key,c=e.ref,h=e._owner;if(i!=null){if(i.ref!==void 0&&(c=i.ref,h=K$1.current),i.key!==void 0&&(o=""+i.key),e.type&&e.type.defaultProps)var d=e.type.defaultProps;for(g in i)J.call(i,g)&&!L$1.hasOwnProperty(g)&&(s[g]=i[g]===void 0&&d!==void 0?d[g]:i[g])}var g=arguments.length-2;if(g===1)s.children=a;else if(1<g){d=Array(g);for(var _=0;_<g;_++)d[_]=arguments[_+2];s.children=d}return{$$typeof:l$1,type:e.type,key:o,ref:c,props:s,_owner:h}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var i=M$1.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(e,i){return U$1.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$1.current.useEffect(e,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,i,a){return U$1.current.useImperativeHandle(e,i,a)};react_production_min.useInsertionEffect=function(e,i){return U$1.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$1.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$1.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,a){return U$1.current.useReducer(e,i,a)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,a){return U$1.current.useSyncExternalStore(e,i,a)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,a){var s,o={},c=null,h=null;a!==void 0&&(c=""+a),i.key!==void 0&&(c=""+i.key),i.ref!==void 0&&(h=i.ref);for(s in i)m$1.call(i,s)&&!p$1.hasOwnProperty(s)&&(o[s]=i[s]);if(e&&e.defaultProps)for(s in i=e.defaultProps,i)o[s]===void 0&&(o[s]=i[s]);return{$$typeof:k,type:e,key:c,ref:h,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(Wt,yt){var Dt=Wt.length;Wt.push(yt);e:for(;0<Dt;){var $t=Dt-1>>>1,_t=Wt[$t];if(0<o(_t,yt))Wt[$t]=yt,Wt[Dt]=_t,Dt=$t;else break e}}function a(Wt){return Wt.length===0?null:Wt[0]}function s(Wt){if(Wt.length===0)return null;var yt=Wt[0],Dt=Wt.pop();if(Dt!==yt){Wt[0]=Dt;e:for(var $t=0,_t=Wt.length,ht=_t>>>1;$t<ht;){var ct=2*($t+1)-1,xt=Wt[ct],Et=ct+1,bt=Wt[Et];if(0>o(xt,Dt))Et<_t&&0>o(bt,xt)?(Wt[$t]=bt,Wt[Et]=Dt,$t=Et):(Wt[$t]=xt,Wt[ct]=Dt,$t=ct);else if(Et<_t&&0>o(bt,Dt))Wt[$t]=bt,Wt[Et]=Dt,$t=Et;else break e}}return yt}function o(Wt,yt){var Dt=Wt.sortIndex-yt.sortIndex;return Dt!==0?Dt:Wt.id-yt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var h=Date,d=h.now();e.unstable_now=function(){return h.now()-d}}var g=[],_=[],b=1,j=null,_e=3,et=!1,rt=!1,tt=!1,it=typeof setTimeout=="function"?setTimeout:null,nt=typeof clearTimeout=="function"?clearTimeout:null,at=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function st(Wt){for(var yt=a(_);yt!==null;){if(yt.callback===null)s(_);else if(yt.startTime<=Wt)s(_),yt.sortIndex=yt.expirationTime,i(g,yt);else break;yt=a(_)}}function dt(Wt){if(tt=!1,st(Wt),!rt)if(a(g)!==null)rt=!0,Ht(lt);else{var yt=a(_);yt!==null&&It(dt,yt.startTime-Wt)}}function lt(Wt,yt){rt=!1,tt&&(tt=!1,nt(ft),ft=-1),et=!0;var Dt=_e;try{for(st(yt),j=a(g);j!==null&&(!(j.expirationTime>yt)||Wt&&!gt());){var $t=j.callback;if(typeof $t=="function"){j.callback=null,_e=j.priorityLevel;var _t=$t(j.expirationTime<=yt);yt=e.unstable_now(),typeof _t=="function"?j.callback=_t:j===a(g)&&s(g),st(yt)}else s(g);j=a(g)}if(j!==null)var ht=!0;else{var ct=a(_);ct!==null&&It(dt,ct.startTime-yt),ht=!1}return ht}finally{j=null,_e=Dt,et=!1}}var ut=!1,ot=null,ft=-1,pt=5,St=-1;function gt(){return!(e.unstable_now()-St<pt)}function vt(){if(ot!==null){var Wt=e.unstable_now();St=Wt;var yt=!0;try{yt=ot(!0,Wt)}finally{yt?At():(ut=!1,ot=null)}}else ut=!1}var At;if(typeof at=="function")At=function(){at(vt)};else if(typeof MessageChannel<"u"){var Gt=new MessageChannel,Nt=Gt.port2;Gt.port1.onmessage=vt,At=function(){Nt.postMessage(null)}}else At=function(){it(vt,0)};function Ht(Wt){ot=Wt,ut||(ut=!0,At())}function It(Wt,yt){ft=it(function(){Wt(e.unstable_now())},yt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Wt){Wt.callback=null},e.unstable_continueExecution=function(){rt||et||(rt=!0,Ht(lt))},e.unstable_forceFrameRate=function(Wt){0>Wt||125<Wt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):pt=0<Wt?Math.floor(1e3/Wt):5},e.unstable_getCurrentPriorityLevel=function(){return _e},e.unstable_getFirstCallbackNode=function(){return a(g)},e.unstable_next=function(Wt){switch(_e){case 1:case 2:case 3:var yt=3;break;default:yt=_e}var Dt=_e;_e=yt;try{return Wt()}finally{_e=Dt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Wt,yt){switch(Wt){case 1:case 2:case 3:case 4:case 5:break;default:Wt=3}var Dt=_e;_e=Wt;try{return yt()}finally{_e=Dt}},e.unstable_scheduleCallback=function(Wt,yt,Dt){var $t=e.unstable_now();switch(typeof Dt=="object"&&Dt!==null?(Dt=Dt.delay,Dt=typeof Dt=="number"&&0<Dt?$t+Dt:$t):Dt=$t,Wt){case 1:var _t=-1;break;case 2:_t=250;break;case 5:_t=1073741823;break;case 4:_t=1e4;break;default:_t=5e3}return _t=Dt+_t,Wt={id:b++,callback:yt,priorityLevel:Wt,startTime:Dt,expirationTime:_t,sortIndex:-1},Dt>$t?(Wt.sortIndex=Dt,i(_,Wt),a(g)===null&&Wt===a(_)&&(tt?(nt(ft),ft=-1):tt=!0,It(dt,Dt-$t))):(Wt.sortIndex=_t,i(g,Wt),rt||et||(rt=!0,Ht(lt))),Wt},e.unstable_shouldYield=gt,e.unstable_wrapCallback=function(Wt){var yt=_e;return function(){var Dt=_e;_e=yt;try{return Wt.apply(this,arguments)}finally{_e=Dt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,a,s){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return s?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,a,s){if(i===null||typeof i>"u"||pa(e,i,a,s))return!0;if(s)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(e,i,a,s,o,c,h){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=a,this.propertyName=e,this.type=i,this.sanitizeURL=c,this.removeEmptyString=h}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,a,s){var o=z.hasOwnProperty(i)?z[i]:null;(o!==null?o.type!==0:s||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,a,o,s)&&(a=null),s||o===null?oa(i)&&(a===null?e.removeAttribute(i):e.setAttribute(i,""+a)):o.mustUseProperty?e[o.propertyName]=a===null?o.type===3?!1:"":a:(i=o.attributeName,s=o.attributeNamespace,a===null?e.removeAttribute(i):(o=o.type,a=o===3||o===4&&a===!0?"":""+a,s?e.setAttributeNS(s,i,a):e.setAttribute(i,a))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(_){var s=_}Reflect.construct(e,[],i)}else{try{i.call()}catch(_){s=_}e.call(i.prototype)}else{try{throw Error()}catch(_){s=_}e()}}catch(_){if(_&&s&&typeof _.stack=="string"){for(var o=_.stack.split(`
`),c=s.stack.split(`
`),h=o.length-1,d=c.length-1;1<=h&&0<=d&&o[h]!==c[d];)d--;for(;1<=h&&0<=d;h--,d--)if(o[h]!==c[d]){if(h!==1||d!==1)do if(h--,d--,0>d||o[h]!==c[d]){var g=`
`+o[h].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=h&&0<=d);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),s=""+e[i];if(!e.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var o=a.get,c=a.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return o.call(this)},set:function(h){s=""+h,c.call(this,h)}}),Object.defineProperty(e,i,{enumerable:a.enumerable}),{getValue:function(){return s},setValue:function(h){s=""+h},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var a=i.getValue(),s="";return e&&(s=Ta(e)?e.checked?"true":"false":e.value),e=s,e!==a?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var a=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Za(e,i){var a=i.defaultValue==null?"":i.defaultValue,s=i.checked!=null?i.checked:i.defaultChecked;a=Sa(i.value!=null?i.value:a),e._wrapperState={initialChecked:s,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var a=Sa(i.value),s=i.type;if(a!=null)s==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,a):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var s=i.type;if(!(s!=="submit"&&s!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,a||i===e.value||(e.value=i),e.defaultValue=i}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function cb(e,i,a){(i!=="number"||Xa(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var eb=Array.isArray;function fb(e,i,a,s){if(e=e.options,i){i={};for(var o=0;o<a.length;o++)i["$"+a[o]]=!0;for(a=0;a<e.length;a++)o=i.hasOwnProperty("$"+e[a].value),e[a].selected!==o&&(e[a].selected=o),o&&s&&(e[a].defaultSelected=!0)}else{for(a=""+Sa(a),i=null,o=0;o<e.length;o++){if(e[o].value===a){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}i!==null||e[o].disabled||(i=e[o])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(p(92));if(eb(a)){if(1<a.length)throw Error(p(93));a=a[0]}i=a}i==null&&(i=""),a=i}e._wrapperState={initialValue:Sa(a)}}function ib(e,i){var a=Sa(i.value),s=Sa(i.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),i.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),s!=null&&(e.defaultValue=""+s)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,s,o){MSApp.execUnsafeLocalFunction(function(){return e(i,a,s,o)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var a in i)if(i.hasOwnProperty(a)){var s=a.indexOf("--")===0,o=rb(a,i[a],s);a==="float"&&(a="cssFloat"),s?e.setProperty(a,o):e[a]=o}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,a){if(Ib)return e(i,a);Ib=!0;try{return Gb(e,i,a)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var a=e.stateNode;if(a===null)return null;var s=Db(a);if(s===null)return null;a=s[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(p(231,i,typeof a));return a}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,a,s,o,c,h,d,g){var _=Array.prototype.slice.call(arguments,3);try{i.apply(a,_)}catch(b){this.onError(b)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,a,s,o,c,h,d,g){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,a,s,o,c,h,d,g){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_)}}function Vb(e){var i=e,a=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(a=i.return),e=i.return;while(e)}return i.tag===3?a:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p(188));return i!==e?null:e}for(var a=e,s=i;;){var o=a.return;if(o===null)break;var c=o.alternate;if(c===null){if(s=o.return,s!==null){a=s;continue}break}if(o.child===c.child){for(c=o.child;c;){if(c===a)return Xb(o),e;if(c===s)return Xb(o),i;c=c.sibling}throw Error(p(188))}if(a.return!==s.return)a=o,s=c;else{for(var h=!1,d=o.child;d;){if(d===a){h=!0,a=o,s=c;break}if(d===s){h=!0,s=o,a=c;break}d=d.sibling}if(!h){for(d=c.child;d;){if(d===a){h=!0,a=c,s=o;break}if(d===s){h=!0,s=c,a=o;break}d=d.sibling}if(!h)throw Error(p(189))}}if(a.alternate!==s)throw Error(p(190))}if(a.tag!==3)throw Error(p(188));return a.stateNode.current===a?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var a=e.pendingLanes;if(a===0)return 0;var s=0,o=e.suspendedLanes,c=e.pingedLanes,h=a&268435455;if(h!==0){var d=h&~o;d!==0?s=tc(d):(c&=h,c!==0&&(s=tc(c)))}else h=a&~o,h!==0?s=tc(h):c!==0&&(s=tc(c));if(s===0)return 0;if(i!==0&&i!==s&&!(i&o)&&(o=s&-s,c=i&-i,o>=c||o===16&&(c&4194240)!==0))return i;if(s&4&&(s|=a&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=s;0<i;)a=31-oc(i),o=1<<a,s|=e[a],i&=~o;return s}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var a=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,c=e.pendingLanes;0<c;){var h=31-oc(c),d=1<<h,g=o[h];g===-1?(!(d&a)||d&s)&&(o[h]=vc(d,i)):g<=i&&(e.expiredLanes|=d),c&=~d}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],a=0;31>a;a++)i.push(e);return i}function Ac(e,i,a){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=a}function Bc(e,i){var a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<a;){var o=31-oc(a),c=1<<o;i[o]=0,s[o]=-1,e[o]=-1,a&=~c}}function Cc(e,i){var a=e.entangledLanes|=i;for(e=e.entanglements;a;){var s=31-oc(a),o=1<<s;o&i|e[s]&i&&(e[s]|=i),a&=~o}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,a,s,o,c){return e===null||e.nativeEvent!==c?(e={blockedOn:i,domEventName:a,eventSystemFlags:s,nativeEvent:c,targetContainers:[o]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=s,i=e.targetContainers,o!==null&&i.indexOf(o)===-1&&i.push(o),e)}function Uc(e,i,a,s,o){switch(i){case"focusin":return Lc=Tc(Lc,e,i,a,s,o),!0;case"dragenter":return Mc=Tc(Mc,e,i,a,s,o),!0;case"mouseover":return Nc=Tc(Nc,e,i,a,s,o),!0;case"pointerover":var c=o.pointerId;return Oc.set(c,Tc(Oc.get(c)||null,e,i,a,s,o)),!0;case"gotpointercapture":return c=o.pointerId,Pc.set(c,Tc(Pc.get(c)||null,e,i,a,s,o)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var a=Vb(i);if(a!==null){if(i=a.tag,i===13){if(i=Wb(a),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var a=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var s=new a.constructor(a.type,a);wb=s,a.target.dispatchEvent(s),wb=null}else return i=Cb(a),i!==null&&Fc(i),e.blockedOn=a,!1;i.shift()}return!0}function Zc(e,i,a){Xc(e)&&a.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(o){return ad(o,e)}if(0<Kc.length){ad(Kc[0],e);for(var a=1;a<Kc.length;a++){var s=Kc[a];s.blockedOn===e&&(s.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),a=0;a<Qc.length;a++)s=Qc[a],s.blockedOn===e&&(s.blockedOn=null);for(;0<Qc.length&&(a=Qc[0],a.blockedOn===null);)Vc(a),a.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,a,s){var o=C,c=cd.transition;cd.transition=null;try{C=1,fd(e,i,a,s)}finally{C=o,cd.transition=c}}function gd(e,i,a,s){var o=C,c=cd.transition;cd.transition=null;try{C=4,fd(e,i,a,s)}finally{C=o,cd.transition=c}}function fd(e,i,a,s){if(dd){var o=Yc(e,i,a,s);if(o===null)hd(e,i,s,id$2,a),Sc(e,s);else if(Uc(o,e,i,a,s))s.stopPropagation();else if(Sc(e,s),i&4&&-1<Rc.indexOf(e)){for(;o!==null;){var c=Cb(o);if(c!==null&&Ec(c),c=Yc(e,i,a,s),c===null&&hd(e,i,s,id$2,a),c===o)break;o=c}o!==null&&s.stopPropagation()}else hd(e,i,s,null,a)}}var id$2=null;function Yc(e,i,a,s){if(id$2=null,e=xb(s),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(a=i.tag,a===13){if(e=Wb(i),e!==null)return e;e=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id$2=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,a=i.length,s,o="value"in kd?kd.value:kd.textContent,c=o.length;for(e=0;e<a&&i[e]===o[e];e++);var h=a-e;for(s=1;s<=h&&i[a-s]===o[c-s];s++);return md=o.slice(e,1<s?1-s:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(a,s,o,c,h){this._reactName=a,this._targetInst=o,this.type=s,this.nativeEvent=c,this.target=h,this.currentTarget=null;for(var d in e)e.hasOwnProperty(d)&&(a=e[d],this[d]=a?a(c):c[d]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de$1=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return e=i.data,e===ee&&fe?null:e;default:return null}}function ke(e,i){if(ie)return e==="compositionend"||!ae&&ge(e,i)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de$1&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le[e.type]:i==="textarea"}function ne(e,i,a,s){Eb(s),i=oe(i,"onChange"),0<i.length&&(a=new td("onChange","change",null,a,s),e.push({event:a,listeners:i}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var i=ue(e);if(Wa(i))return e}function ve(e,i){if(e==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,a){e==="focusin"?(Ae(),pe=i,qe=a,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,i){if(e==="click")return te(i)}function Fe(e,i){if(e==="input"||e==="change")return te(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var a=Object.keys(e),s=Object.keys(i);if(a.length!==s.length)return!1;for(s=0;s<a.length;s++){var o=a[s];if(!ja.call(i,o)||!He(e[o],i[o]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var a=Je(e);e=0;for(var s;a;){if(a.nodeType===3){if(s=e+a.textContent.length,e<=i&&s>=i)return{node:a,offset:i-e};e=s}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Je(a)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),a=e.focusedElem,s=e.selectionRange;if(i!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(s!==null&&Ne(a)){if(i=s.start,e=s.end,e===void 0&&(e=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(e,a.value.length);else if(e=(i=a.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var o=a.textContent.length,c=Math.min(s.start,o);s=s.end===void 0?c:Math.min(s.end,o),!e.extend&&c>s&&(o=s,s=c,c=o),o=Ke(a,c);var h=Ke(a,s);o&&h&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(i=i.createRange(),i.setStart(o.node,o.offset),e.removeAllRanges(),c>s?(e.addRange(i),e.extend(h.node,h.offset)):(i.setEnd(h.node,h.offset),e.addRange(i)))}}for(i=[],e=a;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)e=i[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,i,a){var s=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe==null||Qe!==Xa(s)||(s=Qe,"selectionStart"in s&&Ne(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Se&&Ie(Se,s)||(Se=s,s=oe(Re,"onSelect"),0<s.length&&(i=new td("onSelect","select",null,i,a),e.push({event:i,listeners:s}),i.target=Qe)))}function Ve(e,i){var a={};return a[e.toLowerCase()]=i.toLowerCase(),a["Webkit"+e]="webkit"+i,a["Moz"+e]="moz"+i,a}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],a;for(a in i)if(i.hasOwnProperty(a)&&a in Ye)return Xe[e]=i[a];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,a){var s=e.type||"unknown-event";e.currentTarget=a,Ub(s,i,void 0,e),e.currentTarget=null}function se(e,i){i=(i&4)!==0;for(var a=0;a<e.length;a++){var s=e[a],o=s.event;s=s.listeners;e:{var c=void 0;if(i)for(var h=s.length-1;0<=h;h--){var d=s[h],g=d.instance,_=d.currentTarget;if(d=d.listener,g!==c&&o.isPropagationStopped())break e;nf(o,d,_),c=g}else for(h=0;h<s.length;h++){if(d=s[h],g=d.instance,_=d.currentTarget,d=d.listener,g!==c&&o.isPropagationStopped())break e;nf(o,d,_),c=g}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,i){var a=i[of];a===void 0&&(a=i[of]=new Set);var s=e+"__bubble";a.has(s)||(pf(i,e,2,!1),a.add(s))}function qf(e,i,a){var s=0;i&&(s|=4),pf(a,e,s,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(a){a!=="selectionchange"&&(mf.has(a)||qf(a,!1,e),qf(a,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,a,s){switch(jd(i)){case 1:var o=ed;break;case 4:o=gd;break;default:o=fd}a=o.bind(null,i,a,e),o=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(i,a,{capture:!0,passive:o}):e.addEventListener(i,a,!0):o!==void 0?e.addEventListener(i,a,{passive:o}):e.addEventListener(i,a,!1)}function hd(e,i,a,s,o){var c=s;if(!(i&1)&&!(i&2)&&s!==null)e:for(;;){if(s===null)return;var h=s.tag;if(h===3||h===4){var d=s.stateNode.containerInfo;if(d===o||d.nodeType===8&&d.parentNode===o)break;if(h===4)for(h=s.return;h!==null;){var g=h.tag;if((g===3||g===4)&&(g=h.stateNode.containerInfo,g===o||g.nodeType===8&&g.parentNode===o))return;h=h.return}for(;d!==null;){if(h=Wc(d),h===null)return;if(g=h.tag,g===5||g===6){s=c=h;continue e}d=d.parentNode}}s=s.return}Jb(function(){var _=c,b=xb(a),j=[];e:{var _e=df.get(e);if(_e!==void 0){var et=td,rt=e;switch(e){case"keypress":if(od(a)===0)break e;case"keydown":case"keyup":et=Rd;break;case"focusin":rt="focus",et=Fd;break;case"focusout":rt="blur",et=Fd;break;case"beforeblur":case"afterblur":et=Fd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Vd;break;case $e:case af:case bf:et=Hd;break;case cf:et=Xd;break;case"scroll":et=vd;break;case"wheel":et=Zd;break;case"copy":case"cut":case"paste":et=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=Td}var tt=(i&4)!==0,it=!tt&&e==="scroll",nt=tt?_e!==null?_e+"Capture":null:_e;tt=[];for(var at=_,st;at!==null;){st=at;var dt=st.stateNode;if(st.tag===5&&dt!==null&&(st=dt,nt!==null&&(dt=Kb(at,nt),dt!=null&&tt.push(tf(at,dt,st)))),it)break;at=at.return}0<tt.length&&(_e=new et(_e,rt,null,a,b),j.push({event:_e,listeners:tt}))}}if(!(i&7)){e:{if(_e=e==="mouseover"||e==="pointerover",et=e==="mouseout"||e==="pointerout",_e&&a!==wb&&(rt=a.relatedTarget||a.fromElement)&&(Wc(rt)||rt[uf]))break e;if((et||_e)&&(_e=b.window===b?b:(_e=b.ownerDocument)?_e.defaultView||_e.parentWindow:window,et?(rt=a.relatedTarget||a.toElement,et=_,rt=rt?Wc(rt):null,rt!==null&&(it=Vb(rt),rt!==it||rt.tag!==5&&rt.tag!==6)&&(rt=null)):(et=null,rt=_),et!==rt)){if(tt=Bd,dt="onMouseLeave",nt="onMouseEnter",at="mouse",(e==="pointerout"||e==="pointerover")&&(tt=Td,dt="onPointerLeave",nt="onPointerEnter",at="pointer"),it=et==null?_e:ue(et),st=rt==null?_e:ue(rt),_e=new tt(dt,at+"leave",et,a,b),_e.target=it,_e.relatedTarget=st,dt=null,Wc(b)===_&&(tt=new tt(nt,at+"enter",rt,a,b),tt.target=st,tt.relatedTarget=it,dt=tt),it=dt,et&&rt)t:{for(tt=et,nt=rt,at=0,st=tt;st;st=vf(st))at++;for(st=0,dt=nt;dt;dt=vf(dt))st++;for(;0<at-st;)tt=vf(tt),at--;for(;0<st-at;)nt=vf(nt),st--;for(;at--;){if(tt===nt||nt!==null&&tt===nt.alternate)break t;tt=vf(tt),nt=vf(nt)}tt=null}else tt=null;et!==null&&wf(j,_e,et,tt,!1),rt!==null&&it!==null&&wf(j,it,rt,tt,!0)}}e:{if(_e=_?ue(_):window,et=_e.nodeName&&_e.nodeName.toLowerCase(),et==="select"||et==="input"&&_e.type==="file")var lt=ve;else if(me(_e))if(we)lt=Fe;else{lt=De;var ut=Ce}else(et=_e.nodeName)&&et.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&(lt=Ee);if(lt&&(lt=lt(e,_))){ne(j,lt,a,b);break e}ut&&ut(e,_e,_),e==="focusout"&&(ut=_e._wrapperState)&&ut.controlled&&_e.type==="number"&&cb(_e,"number",_e.value)}switch(ut=_?ue(_):window,e){case"focusin":(me(ut)||ut.contentEditable==="true")&&(Qe=ut,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(j,a,b);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(j,a,b)}var ot;if(ae)e:{switch(e){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else ie?ge(e,a)&&(ft="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(ft="onCompositionStart");ft&&(de$1&&a.locale!=="ko"&&(ie||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&ie&&(ot=nd()):(kd=b,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ut=oe(_,ft),0<ut.length&&(ft=new Ld(ft,e,null,a,b),j.push({event:ft,listeners:ut}),ot?ft.data=ot:(ot=he(a),ot!==null&&(ft.data=ot)))),(ot=ce?je(e,a):ke(e,a))&&(_=oe(_,"onBeforeInput"),0<_.length&&(b=new Ld("onBeforeInput","beforeinput",null,a,b),j.push({event:b,listeners:_}),b.data=ot))}se(j,i)})}function tf(e,i,a){return{instance:e,listener:i,currentTarget:a}}function oe(e,i){for(var a=i+"Capture",s=[];e!==null;){var o=e,c=o.stateNode;o.tag===5&&c!==null&&(o=c,c=Kb(e,a),c!=null&&s.unshift(tf(e,c,o)),c=Kb(e,i),c!=null&&s.push(tf(e,c,o))),e=e.return}return s}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,a,s,o){for(var c=i._reactName,h=[];a!==null&&a!==s;){var d=a,g=d.alternate,_=d.stateNode;if(g!==null&&g===s)break;d.tag===5&&_!==null&&(d=_,o?(g=Kb(a,c),g!=null&&h.unshift(tf(a,g,d))):o||(g=Kb(a,c),g!=null&&h.push(tf(a,g,d)))),a=a.return}h.length!==0&&e.push({event:i,listeners:h})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,a){if(i=zf(i),zf(e)!==i&&a)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var a=i,s=0;do{var o=a.nextSibling;if(e.removeChild(a),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(s===0){e.removeChild(o),bd(i);return}s--}else a!=="$"&&a!=="$?"&&a!=="$!"||s++;a=o}while(a);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return e;i--}else a==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var a=e.parentNode;a;){if(i=a[uf]||a[Of]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(e=Mf(e);e!==null;){if(a=e[Of])return a;e=Mf(e)}return i}e=a,a=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var a=e.type.contextTypes;if(!a)return Vf;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===i)return s.__reactInternalMemoizedMaskedChildContext;var o={},c;for(c in a)o[c]=i[c];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,i,a){if(H.current!==Vf)throw Error(p(168));G(H,i),G(Wf,a)}function bg(e,i,a){var s=e.stateNode;if(i=i.childContextTypes,typeof s.getChildContext!="function")return a;s=s.getChildContext();for(var o in s)if(!(o in i))throw Error(p(108,Ra(e)||"Unknown",o));return A({},a,s)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,a){var s=e.stateNode;if(!s)throw Error(p(169));a?(e=bg(e,i,Xf),s.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,a)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var a=eg;for(C=1;e<a.length;e++){var s=a[e];do s=s(!0);while(s!==null)}eg=null,fg=!1}catch(o){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),o}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,a){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var s=rg;e=sg;var o=32-oc(s)-1;s&=~(1<<o),a+=1;var c=32-oc(i)+o;if(30<c){var h=o-o%5;c=(s&(1<<h)-1).toString(32),s>>=h,o-=h,rg=1<<32-oc(i)+o|a<<o|s,sg=c+e}else rg=1<<c|a<<o|s,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=e,i=e.deletions,i===null?(e.deletions=[a],e.flags|=16):i.push(a)}function Cg(e,i){switch(e.tag){case 5:var a=e.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=i,a.return=e,e.child=a,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var a=i;if(!Cg(e,i)){if(Dg(e))throw Error(p(418));i=Lf(a.nextSibling);var s=xg;i&&Cg(e,i)?Ag(s,a):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(i===0){yg=Lf(e.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p(309));var s=a.stateNode}if(!s)throw Error(p(147,e));var o=s,c=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===c?i.ref:(i=function(h){var d=o.refs;h===null?delete d[c]:d[c]=h},i._stringRef=c,i)}if(typeof e!="string")throw Error(p(284));if(!a._owner)throw Error(p(290,e))}return e}function Mg(e,i){throw e=Object.prototype.toString.call(i),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function Ng(e){var i=e._init;return i(e._payload)}function Og(e){function i(nt,at){if(e){var st=nt.deletions;st===null?(nt.deletions=[at],nt.flags|=16):st.push(at)}}function a(nt,at){if(!e)return null;for(;at!==null;)i(nt,at),at=at.sibling;return null}function s(nt,at){for(nt=new Map;at!==null;)at.key!==null?nt.set(at.key,at):nt.set(at.index,at),at=at.sibling;return nt}function o(nt,at){return nt=Pg(nt,at),nt.index=0,nt.sibling=null,nt}function c(nt,at,st){return nt.index=st,e?(st=nt.alternate,st!==null?(st=st.index,st<at?(nt.flags|=2,at):st):(nt.flags|=2,at)):(nt.flags|=1048576,at)}function h(nt){return e&&nt.alternate===null&&(nt.flags|=2),nt}function d(nt,at,st,dt){return at===null||at.tag!==6?(at=Qg(st,nt.mode,dt),at.return=nt,at):(at=o(at,st),at.return=nt,at)}function g(nt,at,st,dt){var lt=st.type;return lt===ya?b(nt,at,st.props.children,dt,st.key):at!==null&&(at.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Ha&&Ng(lt)===at.type)?(dt=o(at,st.props),dt.ref=Lg(nt,at,st),dt.return=nt,dt):(dt=Rg(st.type,st.key,st.props,null,nt.mode,dt),dt.ref=Lg(nt,at,st),dt.return=nt,dt)}function _(nt,at,st,dt){return at===null||at.tag!==4||at.stateNode.containerInfo!==st.containerInfo||at.stateNode.implementation!==st.implementation?(at=Sg(st,nt.mode,dt),at.return=nt,at):(at=o(at,st.children||[]),at.return=nt,at)}function b(nt,at,st,dt,lt){return at===null||at.tag!==7?(at=Tg(st,nt.mode,dt,lt),at.return=nt,at):(at=o(at,st),at.return=nt,at)}function j(nt,at,st){if(typeof at=="string"&&at!==""||typeof at=="number")return at=Qg(""+at,nt.mode,st),at.return=nt,at;if(typeof at=="object"&&at!==null){switch(at.$$typeof){case va:return st=Rg(at.type,at.key,at.props,null,nt.mode,st),st.ref=Lg(nt,null,at),st.return=nt,st;case wa:return at=Sg(at,nt.mode,st),at.return=nt,at;case Ha:var dt=at._init;return j(nt,dt(at._payload),st)}if(eb(at)||Ka(at))return at=Tg(at,nt.mode,st,null),at.return=nt,at;Mg(nt,at)}return null}function _e(nt,at,st,dt){var lt=at!==null?at.key:null;if(typeof st=="string"&&st!==""||typeof st=="number")return lt!==null?null:d(nt,at,""+st,dt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case va:return st.key===lt?g(nt,at,st,dt):null;case wa:return st.key===lt?_(nt,at,st,dt):null;case Ha:return lt=st._init,_e(nt,at,lt(st._payload),dt)}if(eb(st)||Ka(st))return lt!==null?null:b(nt,at,st,dt,null);Mg(nt,st)}return null}function et(nt,at,st,dt,lt){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return nt=nt.get(st)||null,d(at,nt,""+dt,lt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:return nt=nt.get(dt.key===null?st:dt.key)||null,g(at,nt,dt,lt);case wa:return nt=nt.get(dt.key===null?st:dt.key)||null,_(at,nt,dt,lt);case Ha:var ut=dt._init;return et(nt,at,st,ut(dt._payload),lt)}if(eb(dt)||Ka(dt))return nt=nt.get(st)||null,b(at,nt,dt,lt,null);Mg(at,dt)}return null}function rt(nt,at,st,dt){for(var lt=null,ut=null,ot=at,ft=at=0,pt=null;ot!==null&&ft<st.length;ft++){ot.index>ft?(pt=ot,ot=null):pt=ot.sibling;var St=_e(nt,ot,st[ft],dt);if(St===null){ot===null&&(ot=pt);break}e&&ot&&St.alternate===null&&i(nt,ot),at=c(St,at,ft),ut===null?lt=St:ut.sibling=St,ut=St,ot=pt}if(ft===st.length)return a(nt,ot),I&&tg(nt,ft),lt;if(ot===null){for(;ft<st.length;ft++)ot=j(nt,st[ft],dt),ot!==null&&(at=c(ot,at,ft),ut===null?lt=ot:ut.sibling=ot,ut=ot);return I&&tg(nt,ft),lt}for(ot=s(nt,ot);ft<st.length;ft++)pt=et(ot,nt,ft,st[ft],dt),pt!==null&&(e&&pt.alternate!==null&&ot.delete(pt.key===null?ft:pt.key),at=c(pt,at,ft),ut===null?lt=pt:ut.sibling=pt,ut=pt);return e&&ot.forEach(function(gt){return i(nt,gt)}),I&&tg(nt,ft),lt}function tt(nt,at,st,dt){var lt=Ka(st);if(typeof lt!="function")throw Error(p(150));if(st=lt.call(st),st==null)throw Error(p(151));for(var ut=lt=null,ot=at,ft=at=0,pt=null,St=st.next();ot!==null&&!St.done;ft++,St=st.next()){ot.index>ft?(pt=ot,ot=null):pt=ot.sibling;var gt=_e(nt,ot,St.value,dt);if(gt===null){ot===null&&(ot=pt);break}e&&ot&&gt.alternate===null&&i(nt,ot),at=c(gt,at,ft),ut===null?lt=gt:ut.sibling=gt,ut=gt,ot=pt}if(St.done)return a(nt,ot),I&&tg(nt,ft),lt;if(ot===null){for(;!St.done;ft++,St=st.next())St=j(nt,St.value,dt),St!==null&&(at=c(St,at,ft),ut===null?lt=St:ut.sibling=St,ut=St);return I&&tg(nt,ft),lt}for(ot=s(nt,ot);!St.done;ft++,St=st.next())St=et(ot,nt,ft,St.value,dt),St!==null&&(e&&St.alternate!==null&&ot.delete(St.key===null?ft:St.key),at=c(St,at,ft),ut===null?lt=St:ut.sibling=St,ut=St);return e&&ot.forEach(function(vt){return i(nt,vt)}),I&&tg(nt,ft),lt}function it(nt,at,st,dt){if(typeof st=="object"&&st!==null&&st.type===ya&&st.key===null&&(st=st.props.children),typeof st=="object"&&st!==null){switch(st.$$typeof){case va:e:{for(var lt=st.key,ut=at;ut!==null;){if(ut.key===lt){if(lt=st.type,lt===ya){if(ut.tag===7){a(nt,ut.sibling),at=o(ut,st.props.children),at.return=nt,nt=at;break e}}else if(ut.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Ha&&Ng(lt)===ut.type){a(nt,ut.sibling),at=o(ut,st.props),at.ref=Lg(nt,ut,st),at.return=nt,nt=at;break e}a(nt,ut);break}else i(nt,ut);ut=ut.sibling}st.type===ya?(at=Tg(st.props.children,nt.mode,dt,st.key),at.return=nt,nt=at):(dt=Rg(st.type,st.key,st.props,null,nt.mode,dt),dt.ref=Lg(nt,at,st),dt.return=nt,nt=dt)}return h(nt);case wa:e:{for(ut=st.key;at!==null;){if(at.key===ut)if(at.tag===4&&at.stateNode.containerInfo===st.containerInfo&&at.stateNode.implementation===st.implementation){a(nt,at.sibling),at=o(at,st.children||[]),at.return=nt,nt=at;break e}else{a(nt,at);break}else i(nt,at);at=at.sibling}at=Sg(st,nt.mode,dt),at.return=nt,nt=at}return h(nt);case Ha:return ut=st._init,it(nt,at,ut(st._payload),dt)}if(eb(st))return rt(nt,at,st,dt);if(Ka(st))return tt(nt,at,st,dt);Mg(nt,st)}return typeof st=="string"&&st!==""||typeof st=="number"?(st=""+st,at!==null&&at.tag===6?(a(nt,at.sibling),at=o(at,st),at.return=nt,nt=at):(a(nt,at),at=Qg(st,nt.mode,dt),at.return=nt,nt=at),h(nt)):a(nt,at)}return it}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var i=Wg.current;E(Wg),e._currentValue=i}function bh(e,i,a){for(;e!==null;){var s=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,s!==null&&(s.childLanes|=i)):s!==null&&(s.childLanes&i)!==i&&(s.childLanes|=i),e===a)break;e=e.return}}function ch(e,i){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(dh=!0),e.firstContext=null)}function eh(e){var i=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return i}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,i,a,s){var o=i.interleaved;return o===null?(a.next=a,gh(i)):(a.next=o.next,o.next=a),i.interleaved=a,ih(e,s)}function ih(e,i){e.lanes|=i;var a=e.alternate;for(a!==null&&(a.lanes|=i),a=e,e=e.return;e!==null;)e.childLanes|=i,a=e.alternate,a!==null&&(a.childLanes|=i),a=e,e=e.return;return a.tag===3?a.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(e,i,a){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,K&2){var o=s.pending;return o===null?i.next=i:(i.next=o.next,o.next=i),s.pending=i,ih(e,a)}return o=s.interleaved,o===null?(i.next=i,gh(s)):(i.next=o.next,o.next=i),s.interleaved=i,ih(e,a)}function oh(e,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var s=i.lanes;s&=e.pendingLanes,a|=s,i.lanes=a,Cc(e,a)}}function ph(e,i){var a=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,a===s)){var o=null,c=null;if(a=a.firstBaseUpdate,a!==null){do{var h={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};c===null?o=c=h:c=c.next=h,a=a.next}while(a!==null);c===null?o=c=i:c=c.next=i}else o=c=i;a={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:c,shared:s.shared,effects:s.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=i:e.next=i,a.lastBaseUpdate=i}function qh(e,i,a,s){var o=e.updateQueue;jh=!1;var c=o.firstBaseUpdate,h=o.lastBaseUpdate,d=o.shared.pending;if(d!==null){o.shared.pending=null;var g=d,_=g.next;g.next=null,h===null?c=_:h.next=_,h=g;var b=e.alternate;b!==null&&(b=b.updateQueue,d=b.lastBaseUpdate,d!==h&&(d===null?b.firstBaseUpdate=_:d.next=_,b.lastBaseUpdate=g))}if(c!==null){var j=o.baseState;h=0,b=_=g=null,d=c;do{var _e=d.lane,et=d.eventTime;if((s&_e)===_e){b!==null&&(b=b.next={eventTime:et,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var rt=e,tt=d;switch(_e=i,et=a,tt.tag){case 1:if(rt=tt.payload,typeof rt=="function"){j=rt.call(et,j,_e);break e}j=rt;break e;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=tt.payload,_e=typeof rt=="function"?rt.call(et,j,_e):rt,_e==null)break e;j=A({},j,_e);break e;case 2:jh=!0}}d.callback!==null&&d.lane!==0&&(e.flags|=64,_e=o.effects,_e===null?o.effects=[d]:_e.push(d))}else et={eventTime:et,lane:_e,tag:d.tag,payload:d.payload,callback:d.callback,next:null},b===null?(_=b=et,g=j):b=b.next=et,h|=_e;if(d=d.next,d===null){if(d=o.shared.pending,d===null)break;_e=d,d=_e.next,_e.next=null,o.lastBaseUpdate=_e,o.shared.pending=null}}while(!0);if(b===null&&(g=j),o.baseState=g,o.firstBaseUpdate=_,o.lastBaseUpdate=b,i=o.shared.interleaved,i!==null){o=i;do h|=o.lane,o=o.next;while(o!==i)}else c===null&&(o.shared.lanes=0);rh|=h,e.lanes=h,e.memoizedState=j}}function sh(e,i,a){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var s=e[i],o=s.callback;if(o!==null){if(s.callback=null,s=a,typeof o!="function")throw Error(p(191,o));o.call(s)}}}var th={},uh=Uf(th),vh$1=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,i){switch(G(wh,i),G(vh$1,e),G(uh,th),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E(uh),G(uh,i)}function zh(){E(uh),E(vh$1),E(wh)}function Ah(e){xh(wh.current);var i=xh(uh.current),a=lb(i,e.type);i!==a&&(G(vh$1,e),G(uh,a))}function Bh(e){vh$1.current===e&&(E(uh),E(vh$1))}var L=Uf(0);function Ch(e){for(var i=e;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(e,i){if(i===null)return!1;for(var a=0;a<i.length&&a<e.length;a++)if(!He(e[a],i[a]))return!1;return!0}function Nh(e,i,a,s,o,c){if(Hh=c,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=a(s,o),Jh){c=0;do{if(Jh=!1,Kh=0,25<=c)throw Error(p(301));c+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,e=a(s,o)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=e;else{if(e===null)throw Error(p(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,i){return typeof i=="function"?i(e):i}function Wh(e){var i=Uh(),a=i.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=e;var s=N,o=s.baseQueue,c=a.pending;if(c!==null){if(o!==null){var h=o.next;o.next=c.next,c.next=h}s.baseQueue=o=c,a.pending=null}if(o!==null){c=o.next,s=s.baseState;var d=h=null,g=null,_=c;do{var b=_.lane;if((Hh&b)===b)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),s=_.hasEagerState?_.eagerState:e(s,_.action);else{var j={lane:b,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(d=g=j,h=s):g=g.next=j,M.lanes|=b,rh|=b}_=_.next}while(_!==null&&_!==c);g===null?h=s:g.next=d,He(s,i.memoizedState)||(dh=!0),i.memoizedState=s,i.baseState=h,i.baseQueue=g,a.lastRenderedState=s}if(e=a.interleaved,e!==null){o=e;do c=o.lane,M.lanes|=c,rh|=c,o=o.next;while(o!==e)}else o===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Xh(e){var i=Uh(),a=i.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=e;var s=a.dispatch,o=a.pending,c=i.memoizedState;if(o!==null){a.pending=null;var h=o=o.next;do c=e(c,h.action),h=h.next;while(h!==o);He(c,i.memoizedState)||(dh=!0),i.memoizedState=c,i.baseQueue===null&&(i.baseState=c),a.lastRenderedState=c}return[c,s]}function Yh(){}function Zh(e,i){var a=M,s=Uh(),o=i(),c=!He(s.memoizedState,o);if(c&&(s.memoizedState=o,dh=!0),s=s.queue,$h(ai.bind(null,a,s,e),[e]),s.getSnapshot!==i||c||O!==null&&O.memoizedState.tag&1){if(a.flags|=2048,bi(9,ci.bind(null,a,s,o,i),void 0,null),Q===null)throw Error(p(349));Hh&30||di(a,i,o)}return o}function di(e,i,a){e.flags|=16384,e={getSnapshot:i,value:a},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[e]):(a=i.stores,a===null?i.stores=[e]:a.push(e))}function ci(e,i,a,s){i.value=a,i.getSnapshot=s,ei(i)&&fi(e)}function ai(e,i,a){return a(function(){ei(i)&&fi(e)})}function ei(e){var i=e.getSnapshot;e=e.value;try{var a=i();return!He(e,a)}catch{return!0}}function fi(e){var i=ih(e,1);i!==null&&gi(i,e,1,-1)}function hi(e){var i=Th();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},i.queue=e,e=e.dispatch=ii.bind(null,M,e),[i.memoizedState,e]}function bi(e,i,a,s){return e={tag:e,create:i,destroy:a,deps:s,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=e.next=e):(a=i.lastEffect,a===null?i.lastEffect=e.next=e:(s=a.next,a.next=e,e.next=s,i.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,i,a,s){var o=Th();M.flags|=e,o.memoizedState=bi(1|i,a,void 0,s===void 0?null:s)}function li(e,i,a,s){var o=Uh();s=s===void 0?null:s;var c=void 0;if(N!==null){var h=N.memoizedState;if(c=h.destroy,s!==null&&Mh(s,h.deps)){o.memoizedState=bi(i,a,c,s);return}}M.flags|=e,o.memoizedState=bi(1|i,a,c,s)}function mi(e,i){return ki(8390656,8,e,i)}function $h(e,i){return li(2048,8,e,i)}function ni(e,i){return li(4,2,e,i)}function oi(e,i){return li(4,4,e,i)}function pi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function qi(e,i,a){return a=a!=null?a.concat([e]):null,li(4,4,pi.bind(null,i,e),a)}function ri(){}function si(e,i){var a=Uh();i=i===void 0?null:i;var s=a.memoizedState;return s!==null&&i!==null&&Mh(i,s[1])?s[0]:(a.memoizedState=[e,i],e)}function ti(e,i){var a=Uh();i=i===void 0?null:i;var s=a.memoizedState;return s!==null&&i!==null&&Mh(i,s[1])?s[0]:(e=e(),a.memoizedState=[e,i],e)}function ui(e,i,a){return Hh&21?(He(a,i)||(a=yc(),M.lanes|=a,rh|=a,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=a)}function vi(e,i){var a=C;C=a!==0&&4>a?a:4,e(!0);var s=Gh.transition;Gh.transition={};try{e(!1),i()}finally{C=a,Gh.transition=s}}function wi(){return Uh().memoizedState}function xi(e,i,a){var s=yi(e);if(a={lane:s,action:a,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(i,a);else if(a=hh(e,i,a,s),a!==null){var o=R();gi(a,e,s,o),Bi(a,i,s)}}function ii(e,i,a){var s=yi(e),o={lane:s,action:a,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(i,o);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=i.lastRenderedReducer,c!==null))try{var h=i.lastRenderedState,d=c(h,a);if(o.hasEagerState=!0,o.eagerState=d,He(d,h)){var g=i.interleaved;g===null?(o.next=o,gh(i)):(o.next=g.next,g.next=o),i.interleaved=o;return}}catch{}finally{}a=hh(e,i,o,s),a!==null&&(o=R(),gi(a,e,s,o),Bi(a,i,s))}}function zi(e){var i=e.alternate;return e===M||i!==null&&i===M}function Ai(e,i){Jh=Ih=!0;var a=e.pending;a===null?i.next=i:(i.next=a.next,a.next=i),e.pending=i}function Bi(e,i,a){if(a&4194240){var s=i.lanes;s&=e.pendingLanes,a|=s,i.lanes=a,Cc(e,a)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,i){return Th().memoizedState=[e,i===void 0?null:i],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,i,a){return a=a!=null?a.concat([e]):null,ki(4194308,4,pi.bind(null,i,e),a)},useLayoutEffect:function(e,i){return ki(4194308,4,e,i)},useInsertionEffect:function(e,i){return ki(4,2,e,i)},useMemo:function(e,i){var a=Th();return i=i===void 0?null:i,e=e(),a.memoizedState=[e,i],e},useReducer:function(e,i,a){var s=Th();return i=a!==void 0?a(i):i,s.memoizedState=s.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},s.queue=e,e=e.dispatch=xi.bind(null,M,e),[s.memoizedState,e]},useRef:function(e){var i=Th();return e={current:e},i.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),i=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,a){var s=M,o=Th();if(I){if(a===void 0)throw Error(p(407));a=a()}else{if(a=i(),Q===null)throw Error(p(349));Hh&30||di(s,i,a)}o.memoizedState=a;var c={value:a,getSnapshot:i};return o.queue=c,mi(ai.bind(null,s,c,e),[e]),s.flags|=2048,bi(9,ci.bind(null,s,c,a,i),void 0,null),a},useId:function(){var e=Th(),i=Q.identifierPrefix;if(I){var a=sg,s=rg;a=(s&~(1<<32-oc(s)-1)).toString(32)+a,i=":"+i+"R"+a,a=Kh++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=Lh++,i=":"+i+"r"+a.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return ui(i,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return N===null?i.memoizedState=e:ui(i,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var a in e)i[a]===void 0&&(i[a]=e[a]);return i}return i}function Di(e,i,a,s){i=e.memoizedState,a=a(s,i),a=a==null?i:A({},i,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,a){e=e._reactInternals;var s=R(),o=yi(e),c=mh(s,o);c.payload=i,a!=null&&(c.callback=a),i=nh(e,c,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))},enqueueReplaceState:function(e,i,a){e=e._reactInternals;var s=R(),o=yi(e),c=mh(s,o);c.tag=1,c.payload=i,a!=null&&(c.callback=a),i=nh(e,c,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var a=R(),s=yi(e),o=mh(a,s);o.tag=2,i!=null&&(o.callback=i),i=nh(e,o,s),i!==null&&(gi(i,e,s,a),oh(i,e,s))}};function Fi(e,i,a,s,o,c,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,h):i.prototype&&i.prototype.isPureReactComponent?!Ie(a,s)||!Ie(o,c):!0}function Gi(e,i,a){var s=!1,o=Vf,c=i.contextType;return typeof c=="object"&&c!==null?c=eh(c):(o=Zf(i)?Xf:H.current,s=i.contextTypes,c=(s=s!=null)?Yf(e,o):Vf),i=new i(a,c),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,e.stateNode=i,i._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=c),i}function Hi(e,i,a,s){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,s),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,s),i.state!==e&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(e,i,a,s){var o=e.stateNode;o.props=a,o.state=e.memoizedState,o.refs={},kh(e);var c=i.contextType;typeof c=="object"&&c!==null?o.context=eh(c):(c=Zf(i)?Xf:H.current,o.context=Yf(e,c)),o.state=e.memoizedState,c=i.getDerivedStateFromProps,typeof c=="function"&&(Di(e,i,c,a),o.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(i=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),i!==o.state&&Ei.enqueueReplaceState(o,o.state,null),qh(e,a,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,i){try{var a="",s=i;do a+=Pa(s),s=s.return;while(s);var o=a}catch(c){o=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:i,stack:o,digest:null}}function Ki(e,i,a){return{value:e,source:null,stack:a??null,digest:i??null}}function Li(e,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,i,a){a=mh(-1,a),a.tag=3,a.payload={element:null};var s=i.value;return a.callback=function(){Oi||(Oi=!0,Pi=s),Li(e,i)},a}function Qi(e,i,a){a=mh(-1,a),a.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=i.value;a.payload=function(){return s(o)},a.callback=function(){Li(e,i)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(a.callback=function(){Li(e,i),typeof s!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var h=i.stack;this.componentDidCatch(i.value,{componentStack:h!==null?h:""})}),a}function Si(e,i,a){var s=e.pingCache;if(s===null){s=e.pingCache=new Mi;var o=new Set;s.set(i,o)}else o=s.get(i),o===void 0&&(o=new Set,s.set(i,o));o.has(a)||(o.add(a),e=Ti.bind(null,e,i,a),i.then(e,e))}function Ui(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Vi(e,i,a,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===i?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=mh(-1,1),i.tag=2,nh(a,i,1))),a.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,i,a,s){i.child=e===null?Vg(i,null,a,s):Ug(i,e.child,a,s)}function Yi(e,i,a,s,o){a=a.render;var c=i.ref;return ch(i,o),s=Nh(e,i,a,s,c,o),a=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&a&&vg(i),i.flags|=1,Xi(e,i,s,o),i.child)}function $i(e,i,a,s,o){if(e===null){var c=a.type;return typeof c=="function"&&!aj(c)&&c.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=c,bj(e,i,c,s,o)):(e=Rg(a.type,null,s,i,i.mode,o),e.ref=i.ref,e.return=i,i.child=e)}if(c=e.child,!(e.lanes&o)){var h=c.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a(h,s)&&e.ref===i.ref)return Zi(e,i,o)}return i.flags|=1,e=Pg(c,s),e.ref=i.ref,e.return=i,i.child=e}function bj(e,i,a,s,o){if(e!==null){var c=e.memoizedProps;if(Ie(c,s)&&e.ref===i.ref)if(dh=!1,i.pendingProps=s=c,(e.lanes&o)!==0)e.flags&131072&&(dh=!0);else return i.lanes=e.lanes,Zi(e,i,o)}return cj(e,i,a,s,o)}function dj(e,i,a){var s=i.pendingProps,o=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=a;else{if(!(a&1073741824))return e=c!==null?c.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=c!==null?c.baseLanes:a,G(ej,fj),fj|=s}else c!==null?(s=c.baseLanes|a,i.memoizedState=null):s=a,G(ej,fj),fj|=s;return Xi(e,i,o,a),i.child}function gj(e,i){var a=i.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function cj(e,i,a,s,o){var c=Zf(a)?Xf:H.current;return c=Yf(i,c),ch(i,o),a=Nh(e,i,a,s,c,o),s=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&s&&vg(i),i.flags|=1,Xi(e,i,a,o),i.child)}function hj(e,i,a,s,o){if(Zf(a)){var c=!0;cg(i)}else c=!1;if(ch(i,o),i.stateNode===null)ij(e,i),Gi(i,a,s),Ii(i,a,s,o),s=!0;else if(e===null){var h=i.stateNode,d=i.memoizedProps;h.props=d;var g=h.context,_=a.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(a)?Xf:H.current,_=Yf(i,_));var b=a.getDerivedStateFromProps,j=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";j||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(d!==s||g!==_)&&Hi(i,h,s,_),jh=!1;var _e=i.memoizedState;h.state=_e,qh(i,s,h,o),g=i.memoizedState,d!==s||_e!==g||Wf.current||jh?(typeof b=="function"&&(Di(i,a,b,s),g=i.memoizedState),(d=jh||Fi(i,a,d,s,_e,g,_))?(j||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(i.flags|=4194308)):(typeof h.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=s,i.memoizedState=g),h.props=s,h.state=g,h.context=_,s=d):(typeof h.componentDidMount=="function"&&(i.flags|=4194308),s=!1)}else{h=i.stateNode,lh(e,i),d=i.memoizedProps,_=i.type===i.elementType?d:Ci(i.type,d),h.props=_,j=i.pendingProps,_e=h.context,g=a.contextType,typeof g=="object"&&g!==null?g=eh(g):(g=Zf(a)?Xf:H.current,g=Yf(i,g));var et=a.getDerivedStateFromProps;(b=typeof et=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(d!==j||_e!==g)&&Hi(i,h,s,g),jh=!1,_e=i.memoizedState,h.state=_e,qh(i,s,h,o);var rt=i.memoizedState;d!==j||_e!==rt||Wf.current||jh?(typeof et=="function"&&(Di(i,a,et,s),rt=i.memoizedState),(_=jh||Fi(i,a,_,s,_e,rt,g)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(s,rt,g),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(s,rt,g)),typeof h.componentDidUpdate=="function"&&(i.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof h.componentDidUpdate!="function"||d===e.memoizedProps&&_e===e.memoizedState||(i.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&_e===e.memoizedState||(i.flags|=1024),i.memoizedProps=s,i.memoizedState=rt),h.props=s,h.state=rt,h.context=g,s=_):(typeof h.componentDidUpdate!="function"||d===e.memoizedProps&&_e===e.memoizedState||(i.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&_e===e.memoizedState||(i.flags|=1024),s=!1)}return jj(e,i,a,s,c,o)}function jj(e,i,a,s,o,c){gj(e,i);var h=(i.flags&128)!==0;if(!s&&!h)return o&&dg(i,a,!1),Zi(e,i,c);s=i.stateNode,Wi.current=i;var d=h&&typeof a.getDerivedStateFromError!="function"?null:s.render();return i.flags|=1,e!==null&&h?(i.child=Ug(i,e.child,null,c),i.child=Ug(i,null,d,c)):Xi(e,i,d,c),i.memoizedState=s.state,o&&dg(i,a,!0),i.child}function kj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),yh(e,i.containerInfo)}function lj(e,i,a,s,o){return Ig(),Jg(o),i.flags|=256,Xi(e,i,a,s),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,i,a){var s=i.pendingProps,o=L.current,c=!1,h=(i.flags&128)!==0,d;if((d=h)||(d=e!==null&&e.memoizedState===null?!1:(o&2)!==0),d?(c=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),G(L,o&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(h=s.children,e=s.fallback,c?(s=i.mode,c=i.child,h={mode:"hidden",children:h},!(s&1)&&c!==null?(c.childLanes=0,c.pendingProps=h):c=pj(h,s,0,null),e=Tg(e,s,a,null),c.return=i,e.return=i,c.sibling=e,i.child=c,i.child.memoizedState=nj(a),i.memoizedState=mj,e):qj(i,h));if(o=e.memoizedState,o!==null&&(d=o.dehydrated,d!==null))return rj(e,i,h,s,d,o,a);if(c){c=s.fallback,h=i.mode,o=e.child,d=o.sibling;var g={mode:"hidden",children:s.children};return!(h&1)&&i.child!==o?(s=i.child,s.childLanes=0,s.pendingProps=g,i.deletions=null):(s=Pg(o,g),s.subtreeFlags=o.subtreeFlags&14680064),d!==null?c=Pg(d,c):(c=Tg(c,h,a,null),c.flags|=2),c.return=i,s.return=i,s.sibling=c,i.child=s,s=c,c=i.child,h=e.child.memoizedState,h=h===null?nj(a):{baseLanes:h.baseLanes|a,cachePool:null,transitions:h.transitions},c.memoizedState=h,c.childLanes=e.childLanes&~a,i.memoizedState=mj,s}return c=e.child,e=c.sibling,s=Pg(c,{mode:"visible",children:s.children}),!(i.mode&1)&&(s.lanes=a),s.return=i,s.sibling=null,e!==null&&(a=i.deletions,a===null?(i.deletions=[e],i.flags|=16):a.push(e)),i.child=s,i.memoizedState=null,s}function qj(e,i){return i=pj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function sj(e,i,a,s){return s!==null&&Jg(s),Ug(i,e.child,null,a),e=qj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function rj(e,i,a,s,o,c,h){if(a)return i.flags&256?(i.flags&=-257,s=Ki(Error(p(422))),sj(e,i,h,s)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(c=s.fallback,o=i.mode,s=pj({mode:"visible",children:s.children},o,0,null),c=Tg(c,o,h,null),c.flags|=2,s.return=i,c.return=i,s.sibling=c,i.child=s,i.mode&1&&Ug(i,e.child,null,h),i.child.memoizedState=nj(h),i.memoizedState=mj,c);if(!(i.mode&1))return sj(e,i,h,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var d=s.dgst;return s=d,c=Error(p(419)),s=Ki(c,s,void 0),sj(e,i,h,s)}if(d=(h&e.childLanes)!==0,dh||d){if(s=Q,s!==null){switch(h&-h){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|h)?0:o,o!==0&&o!==c.retryLane&&(c.retryLane=o,ih(e,o),gi(s,e,o,-1))}return tj(),s=Ki(Error(p(421))),sj(e,i,h,s)}return o.data==="$?"?(i.flags|=128,i.child=e.child,i=uj.bind(null,e),o._reactRetry=i,null):(e=c.treeContext,yg=Lf(o.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=qj(i,s.children),i.flags|=4096,i)}function vj(e,i,a){e.lanes|=i;var s=e.alternate;s!==null&&(s.lanes|=i),bh(e.return,i,a)}function wj(e,i,a,s,o){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:s,tail:a,tailMode:o}:(c.isBackwards=i,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=a,c.tailMode=o)}function xj(e,i,a){var s=i.pendingProps,o=s.revealOrder,c=s.tail;if(Xi(e,i,s.children,a),s=L.current,s&2)s=s&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,a,i);else if(e.tag===19)vj(e,a,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(G(L,s),!(i.mode&1))i.memoizedState=null;else switch(o){case"forwards":for(a=i.child,o=null;a!==null;)e=a.alternate,e!==null&&Ch(e)===null&&(o=a),a=a.sibling;a=o,a===null?(o=i.child,i.child=null):(o=a.sibling,a.sibling=null),wj(i,!1,o,a,c);break;case"backwards":for(a=null,o=i.child,i.child=null;o!==null;){if(e=o.alternate,e!==null&&Ch(e)===null){i.child=o;break}e=o.sibling,o.sibling=a,a=o,o=e}wj(i,!0,a,null,c);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function Zi(e,i,a){if(e!==null&&(i.dependencies=e.dependencies),rh|=i.lanes,!(a&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p(153));if(i.child!==null){for(e=i.child,a=Pg(e,e.pendingProps),i.child=a,a.return=i;e.sibling!==null;)e=e.sibling,a=a.sibling=Pg(e,e.pendingProps),a.return=i;a.sibling=null}return i.child}function yj(e,i,a){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var s=i.type._context,o=i.memoizedProps.value;G(Wg,s._currentValue),s._currentValue=o;break;case 13:if(s=i.memoizedState,s!==null)return s.dehydrated!==null?(G(L,L.current&1),i.flags|=128,null):a&i.child.childLanes?oj(e,i,a):(G(L,L.current&1),e=Zi(e,i,a),e!==null?e.sibling:null);G(L,L.current&1);break;case 19:if(s=(a&i.childLanes)!==0,e.flags&128){if(s)return xj(e,i,a);i.flags|=128}if(o=i.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),G(L,L.current),s)break;return null;case 22:case 23:return i.lanes=0,dj(e,i,a)}return Zi(e,i,a)}var zj,Aj,Bj,Cj;zj=function(e,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Aj=function(){};Bj=function(e,i,a,s){var o=e.memoizedProps;if(o!==s){e=i.stateNode,xh(uh.current);var c=null;switch(a){case"input":o=Ya(e,o),s=Ya(e,s),c=[];break;case"select":o=A({},o,{value:void 0}),s=A({},s,{value:void 0}),c=[];break;case"textarea":o=gb(e,o),s=gb(e,s),c=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Bf)}ub(a,s);var h;a=null;for(_ in o)if(!s.hasOwnProperty(_)&&o.hasOwnProperty(_)&&o[_]!=null)if(_==="style"){var d=o[_];for(h in d)d.hasOwnProperty(h)&&(a||(a={}),a[h]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in s){var g=s[_];if(d=o!=null?o[_]:void 0,s.hasOwnProperty(_)&&g!==d&&(g!=null||d!=null))if(_==="style")if(d){for(h in d)!d.hasOwnProperty(h)||g&&g.hasOwnProperty(h)||(a||(a={}),a[h]="");for(h in g)g.hasOwnProperty(h)&&d[h]!==g[h]&&(a||(a={}),a[h]=g[h])}else a||(c||(c=[]),c.push(_,a)),a=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,d=d?d.__html:void 0,g!=null&&d!==g&&(c=c||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(c=c||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&D("scroll",e),c||d===g||(c=[])):(c=c||[]).push(_,g))}a&&(c=c||[]).push("style",a);var _=c;(i.updateQueue=_)&&(i.flags|=4)}};Cj=function(e,i,a,s){a!==s&&(i.flags|=4)};function Dj(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,a=0,s=0;if(i)for(var o=e.child;o!==null;)a|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)a|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=a,i}function Ej(e,i,a){var s=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return s=i.stateNode,zh(),E(Wf),E(H),Eh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,i),S(i),null;case 5:Bh(i);var o=xh(wh.current);if(a=i.type,e!==null&&i.stateNode!=null)Bj(e,i,a,s,o),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!s){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(e=xh(uh.current),Gg(i)){s=i.stateNode,a=i.type;var c=i.memoizedProps;switch(s[Of]=i,s[Pf]=c,e=(i.mode&1)!==0,a){case"dialog":D("cancel",s),D("close",s);break;case"iframe":case"object":case"embed":D("load",s);break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],s);break;case"source":D("error",s);break;case"img":case"image":case"link":D("error",s),D("load",s);break;case"details":D("toggle",s);break;case"input":Za(s,c),D("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!c.multiple},D("invalid",s);break;case"textarea":hb(s,c),D("invalid",s)}ub(a,c),o=null;for(var h in c)if(c.hasOwnProperty(h)){var d=c[h];h==="children"?typeof d=="string"?s.textContent!==d&&(c.suppressHydrationWarning!==!0&&Af(s.textContent,d,e),o=["children",d]):typeof d=="number"&&s.textContent!==""+d&&(c.suppressHydrationWarning!==!0&&Af(s.textContent,d,e),o=["children",""+d]):ea.hasOwnProperty(h)&&d!=null&&h==="onScroll"&&D("scroll",s)}switch(a){case"input":Va(s),db(s,c,!0);break;case"textarea":Va(s),jb(s);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(s.onclick=Bf)}s=o,i.updateQueue=s,s!==null&&(i.flags|=4)}else{h=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=h.createElement(a,{is:s.is}):(e=h.createElement(a),a==="select"&&(h=e,s.multiple?h.multiple=!0:s.size&&(h.size=s.size))):e=h.createElementNS(e,a),e[Of]=i,e[Pf]=s,zj(e,i,!1,!1),i.stateNode=e;e:{switch(h=vb(a,s),a){case"dialog":D("cancel",e),D("close",e),o=s;break;case"iframe":case"object":case"embed":D("load",e),o=s;break;case"video":case"audio":for(o=0;o<lf.length;o++)D(lf[o],e);o=s;break;case"source":D("error",e),o=s;break;case"img":case"image":case"link":D("error",e),D("load",e),o=s;break;case"details":D("toggle",e),o=s;break;case"input":Za(e,s),o=Ya(e,s),D("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=A({},s,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,s),o=gb(e,s),D("invalid",e);break;default:o=s}ub(a,o),d=o;for(c in d)if(d.hasOwnProperty(c)){var g=d[c];c==="style"?sb(e,g):c==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&nb(e,g)):c==="children"?typeof g=="string"?(a!=="textarea"||g!=="")&&ob(e,g):typeof g=="number"&&ob(e,""+g):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?g!=null&&c==="onScroll"&&D("scroll",e):g!=null&&ta(e,c,g,h))}switch(a){case"input":Va(e),db(e,s,!1);break;case"textarea":Va(e),jb(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Sa(s.value));break;case"select":e.multiple=!!s.multiple,c=s.value,c!=null?fb(e,!!s.multiple,c,!1):s.defaultValue!=null&&fb(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Bf)}switch(a){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Cj(e,i,e.memoizedProps,s);else{if(typeof s!="string"&&i.stateNode===null)throw Error(p(166));if(a=xh(wh.current),xh(uh.current),Gg(i)){if(s=i.stateNode,a=i.memoizedProps,s[Of]=i,(c=s.nodeValue!==a)&&(e=xg,e!==null))switch(e.tag){case 3:Af(s.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(s.nodeValue,a,(e.mode&1)!==0)}c&&(i.flags|=4)}else s=(a.nodeType===9?a:a.ownerDocument).createTextNode(s),s[Of]=i,i.stateNode=s}return S(i),null;case 13:if(E(L),s=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,c=!1;else if(c=Gg(i),s!==null&&s.dehydrated!==null){if(e===null){if(!c)throw Error(p(318));if(c=i.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p(317));c[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),c=!1}else zg!==null&&(Fj(zg),zg=null),c=!0;if(!c)return i.flags&65536?i:null}return i.flags&128?(i.lanes=a,i):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(i.child.flags|=8192,i.mode&1&&(e===null||L.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(L),c=i.memoizedState,c===null)return S(i),null;if(s=(i.flags&128)!==0,h=c.rendering,h===null)if(s)Dj(c,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(h=Ch(e),h!==null){for(i.flags|=128,Dj(c,!1),s=h.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),i.subtreeFlags=0,s=a,a=i.child;a!==null;)c=a,e=s,c.flags&=14680066,h=c.alternate,h===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=h.childLanes,c.lanes=h.lanes,c.child=h.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=h.memoizedProps,c.memoizedState=h.memoizedState,c.updateQueue=h.updateQueue,c.type=h.type,e=h.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return G(L,L.current&1|2),i.child}e=e.sibling}c.tail!==null&&B()>Gj&&(i.flags|=128,s=!0,Dj(c,!1),i.lanes=4194304)}else{if(!s)if(e=Ch(h),e!==null){if(i.flags|=128,s=!0,a=e.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),Dj(c,!0),c.tail===null&&c.tailMode==="hidden"&&!h.alternate&&!I)return S(i),null}else 2*B()-c.renderingStartTime>Gj&&a!==1073741824&&(i.flags|=128,s=!0,Dj(c,!1),i.lanes=4194304);c.isBackwards?(h.sibling=i.child,i.child=h):(a=c.last,a!==null?a.sibling=h:i.child=h,c.last=h)}return c.tail!==null?(i=c.tail,c.rendering=i,c.tail=i.sibling,c.renderingStartTime=B(),i.sibling=null,a=L.current,G(L,s?a&1|2:a&1),i):(S(i),null);case 22:case 23:return Hj(),s=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(i.flags|=8192),s&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Ij(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return zh(),E(Wf),E(H),Eh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E(L),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,i){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(s){W(e,i,s)}else a.current=null}function Mj(e,i,a){try{a()}catch(s){W(e,i,s)}}var Nj=!1;function Oj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var s=a.getSelection&&a.getSelection();if(s&&s.rangeCount!==0){a=s.anchorNode;var o=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{a.nodeType,c.nodeType}catch{a=null;break e}var h=0,d=-1,g=-1,_=0,b=0,j=e,_e=null;t:for(;;){for(var et;j!==a||o!==0&&j.nodeType!==3||(d=h+o),j!==c||s!==0&&j.nodeType!==3||(g=h+s),j.nodeType===3&&(h+=j.nodeValue.length),(et=j.firstChild)!==null;)_e=j,j=et;for(;;){if(j===e)break t;if(_e===a&&++_===o&&(d=h),_e===c&&++b===s&&(g=h),(et=j.nextSibling)!==null)break;j=_e,_e=j.parentNode}j=et}a=d===-1||g===-1?null:{start:d,end:g}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df={focusedElem:e,selectionRange:a},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var rt=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(rt!==null){var tt=rt.memoizedProps,it=rt.memoizedState,nt=i.stateNode,at=nt.getSnapshotBeforeUpdate(i.elementType===i.type?tt:Ci(i.type,tt),it);nt.__reactInternalSnapshotBeforeUpdate=at}break;case 3:var st=i.stateNode.containerInfo;st.nodeType===1?st.textContent="":st.nodeType===9&&st.documentElement&&st.removeChild(st.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(dt){W(i,i.return,dt)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return rt=Nj,Nj=!1,rt}function Pj(e,i,a){var s=i.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var c=o.destroy;o.destroy=void 0,c!==void 0&&Mj(i,a,c)}o=o.next}while(o!==s)}}function Qj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var s=a.create;a.destroy=s()}a=a.next}while(a!==i)}}function Rj(e){var i=e.ref;if(i!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof i=="function"?i(e):i.current=e}}function Sj(e){var i=e.alternate;i!==null&&(e.alternate=null,Sj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,i,a){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(e,i):a.insertBefore(e,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(e,a)):(i=a,i.appendChild(e)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Bf));else if(s!==4&&(e=e.child,e!==null))for(Vj(e,i,a),e=e.sibling;e!==null;)Vj(e,i,a),e=e.sibling}function Wj(e,i,a){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?a.insertBefore(e,i):a.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Wj(e,i,a),e=e.sibling;e!==null;)Wj(e,i,a),e=e.sibling}var X=null,Xj=!1;function Yj(e,i,a){for(a=a.child;a!==null;)Zj(e,i,a),a=a.sibling}function Zj(e,i,a){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,a)}catch{}switch(a.tag){case 5:U||Lj(a,i);case 6:var s=X,o=Xj;X=null,Yj(e,i,a),X=s,Xj=o,X!==null&&(Xj?(e=X,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):X.removeChild(a.stateNode));break;case 18:X!==null&&(Xj?(e=X,a=a.stateNode,e.nodeType===8?Kf(e.parentNode,a):e.nodeType===1&&Kf(e,a),bd(e)):Kf(X,a.stateNode));break;case 4:s=X,o=Xj,X=a.stateNode.containerInfo,Xj=!0,Yj(e,i,a),X=s,Xj=o;break;case 0:case 11:case 14:case 15:if(!U&&(s=a.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var c=o,h=c.destroy;c=c.tag,h!==void 0&&(c&2||c&4)&&Mj(a,i,h),o=o.next}while(o!==s)}Yj(e,i,a);break;case 1:if(!U&&(Lj(a,i),s=a.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=a.memoizedProps,s.state=a.memoizedState,s.componentWillUnmount()}catch(d){W(a,i,d)}Yj(e,i,a);break;case 21:Yj(e,i,a);break;case 22:a.mode&1?(U=(s=U)||a.memoizedState!==null,Yj(e,i,a),U=s):Yj(e,i,a);break;default:Yj(e,i,a)}}function ak(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new Kj),i.forEach(function(s){var o=bk.bind(null,e,s);a.has(s)||(a.add(s),s.then(o,o))})}}function ck(e,i){var a=i.deletions;if(a!==null)for(var s=0;s<a.length;s++){var o=a[s];try{var c=e,h=i,d=h;e:for(;d!==null;){switch(d.tag){case 5:X=d.stateNode,Xj=!1;break e;case 3:X=d.stateNode.containerInfo,Xj=!0;break e;case 4:X=d.stateNode.containerInfo,Xj=!0;break e}d=d.return}if(X===null)throw Error(p(160));Zj(c,h,o),X=null,Xj=!1;var g=o.alternate;g!==null&&(g.return=null),o.return=null}catch(_){W(o,i,_)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,e),i=i.sibling}function dk(e,i){var a=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(i,e),ek(e),s&4){try{Pj(3,e,e.return),Qj(3,e)}catch(tt){W(e,e.return,tt)}try{Pj(5,e,e.return)}catch(tt){W(e,e.return,tt)}}break;case 1:ck(i,e),ek(e),s&512&&a!==null&&Lj(a,a.return);break;case 5:if(ck(i,e),ek(e),s&512&&a!==null&&Lj(a,a.return),e.flags&32){var o=e.stateNode;try{ob(o,"")}catch(tt){W(e,e.return,tt)}}if(s&4&&(o=e.stateNode,o!=null)){var c=e.memoizedProps,h=a!==null?a.memoizedProps:c,d=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{d==="input"&&c.type==="radio"&&c.name!=null&&ab(o,c),vb(d,h);var _=vb(d,c);for(h=0;h<g.length;h+=2){var b=g[h],j=g[h+1];b==="style"?sb(o,j):b==="dangerouslySetInnerHTML"?nb(o,j):b==="children"?ob(o,j):ta(o,b,j,_)}switch(d){case"input":bb(o,c);break;case"textarea":ib(o,c);break;case"select":var _e=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!c.multiple;var et=c.value;et!=null?fb(o,!!c.multiple,et,!1):_e!==!!c.multiple&&(c.defaultValue!=null?fb(o,!!c.multiple,c.defaultValue,!0):fb(o,!!c.multiple,c.multiple?[]:"",!1))}o[Pf]=c}catch(tt){W(e,e.return,tt)}}break;case 6:if(ck(i,e),ek(e),s&4){if(e.stateNode===null)throw Error(p(162));o=e.stateNode,c=e.memoizedProps;try{o.nodeValue=c}catch(tt){W(e,e.return,tt)}}break;case 3:if(ck(i,e),ek(e),s&4&&a!==null&&a.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(tt){W(e,e.return,tt)}break;case 4:ck(i,e),ek(e);break;case 13:ck(i,e),ek(e),o=e.child,o.flags&8192&&(c=o.memoizedState!==null,o.stateNode.isHidden=c,!c||o.alternate!==null&&o.alternate.memoizedState!==null||(fk=B())),s&4&&ak(e);break;case 22:if(b=a!==null&&a.memoizedState!==null,e.mode&1?(U=(_=U)||b,ck(i,e),U=_):ck(i,e),ek(e),s&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!b&&e.mode&1)for(V=e,b=e.child;b!==null;){for(j=V=b;V!==null;){switch(_e=V,et=_e.child,_e.tag){case 0:case 11:case 14:case 15:Pj(4,_e,_e.return);break;case 1:Lj(_e,_e.return);var rt=_e.stateNode;if(typeof rt.componentWillUnmount=="function"){s=_e,a=_e.return;try{i=s,rt.props=i.memoizedProps,rt.state=i.memoizedState,rt.componentWillUnmount()}catch(tt){W(s,a,tt)}}break;case 5:Lj(_e,_e.return);break;case 22:if(_e.memoizedState!==null){gk(j);continue}}et!==null?(et.return=_e,V=et):gk(j)}b=b.sibling}e:for(b=null,j=e;;){if(j.tag===5){if(b===null){b=j;try{o=j.stateNode,_?(c=o.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(d=j.stateNode,g=j.memoizedProps.style,h=g!=null&&g.hasOwnProperty("display")?g.display:null,d.style.display=rb("display",h))}catch(tt){W(e,e.return,tt)}}}else if(j.tag===6){if(b===null)try{j.stateNode.nodeValue=_?"":j.memoizedProps}catch(tt){W(e,e.return,tt)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===e)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===e)break e;for(;j.sibling===null;){if(j.return===null||j.return===e)break e;b===j&&(b=null),j=j.return}b===j&&(b=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:ck(i,e),ek(e),s&4&&ak(e);break;case 21:break;default:ck(i,e),ek(e)}}function ek(e){var i=e.flags;if(i&2){try{e:{for(var a=e.return;a!==null;){if(Tj(a)){var s=a;break e}a=a.return}throw Error(p(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(ob(o,""),s.flags&=-33);var c=Uj(e);Wj(e,c,o);break;case 3:case 4:var h=s.stateNode.containerInfo,d=Uj(e);Vj(e,d,h);break;default:throw Error(p(161))}}catch(g){W(e,e.return,g)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function hk(e,i,a){V=e,ik(e)}function ik(e,i,a){for(var s=(e.mode&1)!==0;V!==null;){var o=V,c=o.child;if(o.tag===22&&s){var h=o.memoizedState!==null||Jj;if(!h){var d=o.alternate,g=d!==null&&d.memoizedState!==null||U;d=Jj;var _=U;if(Jj=h,(U=g)&&!_)for(V=o;V!==null;)h=V,g=h.child,h.tag===22&&h.memoizedState!==null?jk(o):g!==null?(g.return=h,V=g):jk(o);for(;c!==null;)V=c,ik(c),c=c.sibling;V=o,Jj=d,U=_}kk(e)}else o.subtreeFlags&8772&&c!==null?(c.return=o,V=c):kk(e)}}function kk(e){for(;V!==null;){var i=V;if(i.flags&8772){var a=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var s=i.stateNode;if(i.flags&4&&!U)if(a===null)s.componentDidMount();else{var o=i.elementType===i.type?a.memoizedProps:Ci(i.type,a.memoizedProps);s.componentDidUpdate(o,a.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var c=i.updateQueue;c!==null&&sh(i,c,s);break;case 3:var h=i.updateQueue;if(h!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}sh(i,h,a)}break;case 5:var d=i.stateNode;if(a===null&&i.flags&4){a=d;var g=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&a.focus();break;case"img":g.src&&(a.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var _=i.alternate;if(_!==null){var b=_.memoizedState;if(b!==null){var j=b.dehydrated;j!==null&&bd(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||i.flags&512&&Rj(i)}catch(_e){W(i,i.return,_e)}}if(i===e){V=null;break}if(a=i.sibling,a!==null){a.return=i.return,V=a;break}V=i.return}}function gk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var a=i.sibling;if(a!==null){a.return=i.return,V=a;break}V=i.return}}function jk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Qj(4,i)}catch(g){W(i,a,g)}break;case 1:var s=i.stateNode;if(typeof s.componentDidMount=="function"){var o=i.return;try{s.componentDidMount()}catch(g){W(i,o,g)}}var c=i.return;try{Rj(i)}catch(g){W(i,c,g)}break;case 5:var h=i.return;try{Rj(i)}catch(g){W(i,h,g)}}}catch(g){W(i,i.return,g)}if(i===e){V=null;break}var d=i.sibling;if(d!==null){d.return=i.return,V=d;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,i,a,s){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,a,s),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=a),T===4&&Ck(e,Z)),Dk(e,s),a===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,i){var a=e.callbackNode;wc(e,i);var s=uc(e,e===Q?Z:0);if(s===0)a!==null&&bc(a),e.callbackNode=null,e.callbackPriority=0;else if(i=s&-s,e.callbackPriority!==i){if(a!=null&&bc(a),i===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),a=null;else{switch(Dc(s)){case 1:a=fc;break;case 4:a=gc;break;case 16:a=hc;break;case 536870912:a=jc;break;default:a=hc}a=Fk(a,Gk.bind(null,e))}e.callbackPriority=i,e.callbackNode=a}}function Gk(e,i){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var a=e.callbackNode;if(Hk()&&e.callbackNode!==a)return null;var s=uc(e,e===Q?Z:0);if(s===0)return null;if(s&30||s&e.expiredLanes||i)i=Ik(e,s);else{i=s;var o=K;K|=2;var c=Jk();(Q!==e||Z!==i)&&(uk=null,Gj=B()+500,Kk(e,i));do try{Lk();break}catch(d){Mk(e,d)}while(!0);$g(),mk.current=c,K=o,Y!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(o=xc(e),o!==0&&(s=o,i=Nk(e,o))),i===1)throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;if(i===6)Ck(e,s);else{if(o=e.current.alternate,!(s&30)&&!Ok(o)&&(i=Ik(e,s),i===2&&(c=xc(e),c!==0&&(s=c,i=Nk(e,c))),i===1))throw a=pk,Kk(e,0),Ck(e,s),Dk(e,B()),a;switch(e.finishedWork=o,e.finishedLanes=s,i){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,s),(s&130023424)===s&&(i=fk+500-B(),10<i)){if(uc(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){R(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 4:if(Ck(e,s),(s&4194240)===s)break;for(i=e.eventTimes,o=-1;0<s;){var h=31-oc(s);c=1<<h,h=i[h],h>o&&(o=h),s&=~c}if(s=o,s=B()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*lk(s/1960))-s,10<s){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),s);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===a?Gk.bind(null,e):null}function Nk(e,i){var a=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,i).flags|=256),e=Ik(e,i),e!==2&&(i=tk,tk=a,i!==null&&Fj(i)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var i=e;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var s=0;s<a.length;s++){var o=a[s],c=o.getSnapshot;o=o.value;try{if(!He(c(),o))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(e,i){for(i&=~rk,i&=~qk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var a=31-oc(i),s=1<<a;e[a]=-1,i&=~s}}function Ek(e){if(K&6)throw Error(p(327));Hk();var i=uc(e,0);if(!(i&1))return Dk(e,B()),null;var a=Ik(e,i);if(e.tag!==0&&a===2){var s=xc(e);s!==0&&(i=s,a=Nk(e,s))}if(a===1)throw a=pk,Kk(e,0),Ck(e,i),Dk(e,B()),a;if(a===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,i){var a=K;K|=1;try{return e(i)}finally{K=a,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var a=ok.transition,s=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=s,ok.transition=a,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,i){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Gf(a)),Y!==null)for(a=Y.return;a!==null;){var s=a;switch(wg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(s);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(s.type._context);break;case 22:case 23:Hj()}a=a.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(a=fh[i],s=a.interleaved,s!==null){a.interleaved=null;var o=s.next,c=a.pending;if(c!==null){var h=c.next;c.next=o,s.next=h}a.pending=s}fh=null}return e}function Mk(e,i){do{var a=Y;try{if($g(),Fh.current=Rh,Ih){for(var s=M.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,a===null||a.return===null){T=1,pk=i,Y=null;break}e:{var c=e,h=a.return,d=a,g=i;if(i=Z,d.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,b=d,j=b.tag;if(!(b.mode&1)&&(j===0||j===11||j===15)){var _e=b.alternate;_e?(b.updateQueue=_e.updateQueue,b.memoizedState=_e.memoizedState,b.lanes=_e.lanes):(b.updateQueue=null,b.memoizedState=null)}var et=Ui(h);if(et!==null){et.flags&=-257,Vi(et,h,d,c,i),et.mode&1&&Si(c,_,i),i=et,g=_;var rt=i.updateQueue;if(rt===null){var tt=new Set;tt.add(g),i.updateQueue=tt}else rt.add(g);break e}else{if(!(i&1)){Si(c,_,i),tj();break e}g=Error(p(426))}}else if(I&&d.mode&1){var it=Ui(h);if(it!==null){!(it.flags&65536)&&(it.flags|=256),Vi(it,h,d,c,i),Jg(Ji(g,d));break e}}c=g=Ji(g,d),T!==4&&(T=2),sk===null?sk=[c]:sk.push(c),c=h;do{switch(c.tag){case 3:c.flags|=65536,i&=-i,c.lanes|=i;var nt=Ni(c,g,i);ph(c,nt);break e;case 1:d=g;var at=c.type,st=c.stateNode;if(!(c.flags&128)&&(typeof at.getDerivedStateFromError=="function"||st!==null&&typeof st.componentDidCatch=="function"&&(Ri===null||!Ri.has(st)))){c.flags|=65536,i&=-i,c.lanes|=i;var dt=Qi(c,d,i);ph(c,dt);break e}}c=c.return}while(c!==null)}Sk(a)}catch(lt){i=lt,Y===a&&a!==null&&(Y=a=a.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,i){var a=K;K|=2;var s=Jk();(Q!==e||Z!==i)&&(uk=null,Kk(e,i));do try{Tk();break}catch(o){Mk(e,o)}while(!0);if($g(),K=a,mk.current=s,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(e){var i=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,i===null?Sk(e):Y=i,nk.current=null}function Sk(e){var i=e;do{var a=i.alternate;if(e=i.return,i.flags&32768){if(a=Ij(a,i),a!==null){a.flags&=32767,Y=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(a=Ej(a,i,fj),a!==null){Y=a;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=e}while(i!==null);T===0&&(T=5)}function Pk(e,i,a){var s=C,o=ok.transition;try{ok.transition=null,C=1,Wk(e,i,a,s)}finally{ok.transition=o,C=s}return null}function Wk(e,i,a,s){do Hk();while(wk!==null);if(K&6)throw Error(p(327));a=e.finishedWork;var o=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var c=a.lanes|a.childLanes;if(Bc(e,c),e===Q&&(Y=Q=null,Z=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),c=(a.flags&15990)!==0,a.subtreeFlags&15990||c){c=ok.transition,ok.transition=null;var h=C;C=1;var d=K;K|=4,nk.current=null,Oj(e,a),dk(a,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=a,hk(a),dc(),K=d,C=h,ok.transition=c}else e.current=a;if(vk&&(vk=!1,wk=e,xk=o),c=e.pendingLanes,c===0&&(Ri=null),mc(a.stateNode),Dk(e,B()),i!==null)for(s=e.onRecoverableError,a=0;a<i.length;a++)o=i[a],s(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),c=e.pendingLanes,c&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),i=ok.transition,a=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var s=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var o=K;for(K|=4,V=e.current;V!==null;){var c=V,h=c.child;if(V.flags&16){var d=c.deletions;if(d!==null){for(var g=0;g<d.length;g++){var _=d[g];for(V=_;V!==null;){var b=V;switch(b.tag){case 0:case 11:case 15:Pj(8,b,c)}var j=b.child;if(j!==null)j.return=b,V=j;else for(;V!==null;){b=V;var _e=b.sibling,et=b.return;if(Sj(b),b===_){V=null;break}if(_e!==null){_e.return=et,V=_e;break}V=et}}}var rt=c.alternate;if(rt!==null){var tt=rt.child;if(tt!==null){rt.child=null;do{var it=tt.sibling;tt.sibling=null,tt=it}while(tt!==null)}}V=c}}if(c.subtreeFlags&2064&&h!==null)h.return=c,V=h;else e:for(;V!==null;){if(c=V,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Pj(9,c,c.return)}var nt=c.sibling;if(nt!==null){nt.return=c.return,V=nt;break e}V=c.return}}var at=e.current;for(V=at;V!==null;){h=V;var st=h.child;if(h.subtreeFlags&2064&&st!==null)st.return=h,V=st;else e:for(h=at;V!==null;){if(d=V,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:Qj(9,d)}}catch(lt){W(d,d.return,lt)}if(d===h){V=null;break e}var dt=d.sibling;if(dt!==null){dt.return=d.return,V=dt;break e}V=d.return}}if(K=o,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}s=!0}return s}finally{C=a,ok.transition=i}}return!1}function Xk(e,i,a){i=Ji(a,i),i=Ni(e,i,1),e=nh(e,i,1),i=R(),e!==null&&(Ac(e,1,i),Dk(e,i))}function W(e,i,a){if(e.tag===3)Xk(e,e,a);else for(;i!==null;){if(i.tag===3){Xk(i,e,a);break}else if(i.tag===1){var s=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ri===null||!Ri.has(s))){e=Ji(a,e),e=Qi(i,e,1),i=nh(i,e,1),e=R(),i!==null&&(Ac(i,1,e),Dk(i,e));break}}i=i.return}}function Ti(e,i,a){var s=e.pingCache;s!==null&&s.delete(i),i=R(),e.pingedLanes|=e.suspendedLanes&a,Q===e&&(Z&a)===a&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=a),Dk(e,i)}function Yk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var a=R();e=ih(e,i),e!==null&&(Ac(e,i,a),Dk(e,a))}function uj(e){var i=e.memoizedState,a=0;i!==null&&(a=i.retryLane),Yk(e,a)}function bk(e,i){var a=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(a=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(p(314))}s!==null&&s.delete(i),Yk(e,a)}var Vk;Vk=function(e,i,a){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&a)&&!(i.flags&128))return dh=!1,yj(e,i,a);dh=!!(e.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var s=i.type;ij(e,i),e=i.pendingProps;var o=Yf(i,H.current);ch(i,a),o=Nh(null,i,s,e,o,a);var c=Sh();return i.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(s)?(c=!0,cg(i)):c=!1,i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,kh(i),o.updater=Ei,i.stateNode=o,o._reactInternals=i,Ii(i,s,e,a),i=jj(null,i,s,!0,c,a)):(i.tag=0,I&&c&&vg(i),Xi(null,i,o,a),i=i.child),i;case 16:s=i.elementType;e:{switch(ij(e,i),e=i.pendingProps,o=s._init,s=o(s._payload),i.type=s,o=i.tag=Zk(s),e=Ci(s,e),o){case 0:i=cj(null,i,s,e,a);break e;case 1:i=hj(null,i,s,e,a);break e;case 11:i=Yi(null,i,s,e,a);break e;case 14:i=$i(null,i,s,Ci(s.type,e),a);break e}throw Error(p(306,s,""))}return i;case 0:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),cj(e,i,s,o,a);case 1:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),hj(e,i,s,o,a);case 3:e:{if(kj(i),e===null)throw Error(p(387));s=i.pendingProps,c=i.memoizedState,o=c.element,lh(e,i),qh(i,s,null,a);var h=i.memoizedState;if(s=h.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},i.updateQueue.baseState=c,i.memoizedState=c,i.flags&256){o=Ji(Error(p(423)),i),i=lj(e,i,s,a,o);break e}else if(s!==o){o=Ji(Error(p(424)),i),i=lj(e,i,s,a,o);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,a=Vg(i,null,s,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),s===o){i=Zi(e,i,a);break e}Xi(e,i,s,a)}i=i.child}return i;case 5:return Ah(i),e===null&&Eg(i),s=i.type,o=i.pendingProps,c=e!==null?e.memoizedProps:null,h=o.children,Ef(s,o)?h=null:c!==null&&Ef(s,c)&&(i.flags|=32),gj(e,i),Xi(e,i,h,a),i.child;case 6:return e===null&&Eg(i),null;case 13:return oj(e,i,a);case 4:return yh(i,i.stateNode.containerInfo),s=i.pendingProps,e===null?i.child=Ug(i,null,s,a):Xi(e,i,s,a),i.child;case 11:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),Yi(e,i,s,o,a);case 7:return Xi(e,i,i.pendingProps,a),i.child;case 8:return Xi(e,i,i.pendingProps.children,a),i.child;case 12:return Xi(e,i,i.pendingProps.children,a),i.child;case 10:e:{if(s=i.type._context,o=i.pendingProps,c=i.memoizedProps,h=o.value,G(Wg,s._currentValue),s._currentValue=h,c!==null)if(He(c.value,h)){if(c.children===o.children&&!Wf.current){i=Zi(e,i,a);break e}}else for(c=i.child,c!==null&&(c.return=i);c!==null;){var d=c.dependencies;if(d!==null){h=c.child;for(var g=d.firstContext;g!==null;){if(g.context===s){if(c.tag===1){g=mh(-1,a&-a),g.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var b=_.pending;b===null?g.next=g:(g.next=b.next,b.next=g),_.pending=g}}c.lanes|=a,g=c.alternate,g!==null&&(g.lanes|=a),bh(c.return,a,i),d.lanes|=a;break}g=g.next}}else if(c.tag===10)h=c.type===i.type?null:c.child;else if(c.tag===18){if(h=c.return,h===null)throw Error(p(341));h.lanes|=a,d=h.alternate,d!==null&&(d.lanes|=a),bh(h,a,i),h=c.sibling}else h=c.child;if(h!==null)h.return=c;else for(h=c;h!==null;){if(h===i){h=null;break}if(c=h.sibling,c!==null){c.return=h.return,h=c;break}h=h.return}c=h}Xi(e,i,o.children,a),i=i.child}return i;case 9:return o=i.type,s=i.pendingProps.children,ch(i,a),o=eh(o),s=s(o),i.flags|=1,Xi(e,i,s,a),i.child;case 14:return s=i.type,o=Ci(s,i.pendingProps),o=Ci(s.type,o),$i(e,i,s,o,a);case 15:return bj(e,i,i.type,i.pendingProps,a);case 17:return s=i.type,o=i.pendingProps,o=i.elementType===s?o:Ci(s,o),ij(e,i),i.tag=1,Zf(s)?(e=!0,cg(i)):e=!1,ch(i,a),Gi(i,s,o),Ii(i,s,o,a),jj(null,i,s,!0,e,a);case 19:return xj(e,i,a);case 22:return dj(e,i,a)}throw Error(p(156,i.tag))};function Fk(e,i){return ac(e,i)}function $k(e,i,a,s){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,a,s){return new $k(e,i,a,s)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,i){var a=e.alternate;return a===null?(a=Bg(e.tag,i,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=i,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,i=e.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Rg(e,i,a,s,o,c){var h=2;if(s=e,typeof e=="function")aj(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case ya:return Tg(a.children,o,c,i);case za:h=8,o|=8;break;case Aa:return e=Bg(12,a,i,o|2),e.elementType=Aa,e.lanes=c,e;case Ea:return e=Bg(13,a,i,o),e.elementType=Ea,e.lanes=c,e;case Fa:return e=Bg(19,a,i,o),e.elementType=Fa,e.lanes=c,e;case Ia:return pj(a,o,c,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:h=10;break e;case Ca:h=9;break e;case Da:h=11;break e;case Ga:h=14;break e;case Ha:h=16,s=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return i=Bg(h,a,i,o),i.elementType=e,i.type=s,i.lanes=c,i}function Tg(e,i,a,s){return e=Bg(7,e,s,i),e.lanes=a,e}function pj(e,i,a,s){return e=Bg(22,e,s,i),e.elementType=Ia,e.lanes=a,e.stateNode={isHidden:!1},e}function Qg(e,i,a){return e=Bg(6,e,null,i),e.lanes=a,e}function Sg(e,i,a){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=a,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function al(e,i,a,s,o){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function bl(e,i,a,s,o,c,h,d,g){return e=new al(e,i,a,d,g),i===1?(i=1,c===!0&&(i|=8)):i=0,c=Bg(3,null,null,i),e.current=c,c.stateNode=e,c.memoizedState={element:s,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(c),e}function cl(e,i,a){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:s==null?null:""+s,children:e,containerInfo:i,implementation:a}}function dl(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(e.tag===1){var a=e.type;if(Zf(a))return bg(e,a,i)}return i}function el(e,i,a,s,o,c,h,d,g){return e=bl(a,s,!0,e,o,c,h,d,g),e.context=dl(null),a=e.current,s=R(),o=yi(a),c=mh(s,o),c.callback=i??null,nh(a,c,o),e.current.lanes=o,Ac(e,o,s),Dk(e,s),e}function fl(e,i,a,s){var o=i.current,c=R(),h=yi(o);return a=dl(a),i.context===null?i.context=a:i.pendingContext=a,i=mh(c,h),i.payload={element:e},s=s===void 0?null:s,s!==null&&(i.callback=s),e=nh(o,i,h),e!==null&&(gi(e,o,h,c),oh(e,o,h)),h}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<i?a:i}}function il(e,i){hl(e,i),(e=e.alternate)&&hl(e,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p(409));fl(e,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Rk(function(){fl(null,e,null,null)}),i[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var a=0;a<Qc.length&&i!==0&&i<Qc[a].priority;a++);Qc.splice(a,0,e),a===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,i,a,s,o){if(o){if(typeof s=="function"){var c=s;s=function(){var _=gl(h);c.call(_)}}var h=el(i,s,e,0,null,!1,!1,"",pl);return e._reactRootContainer=h,e[uf]=h.current,sf(e.nodeType===8?e.parentNode:e),Rk(),h}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var d=s;s=function(){var _=gl(g);d.call(_)}}var g=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=g,e[uf]=g.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(i,g,a,s)}),g}function rl(e,i,a,s,o){var c=a._reactRootContainer;if(c){var h=c;if(typeof o=="function"){var d=o;o=function(){var g=gl(h);d.call(g)}}fl(i,h,e,o)}else h=ql(a,i,e,o,s);return gl(h)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var a=tc(i.pendingLanes);a!==0&&(Cc(i,a|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var s=ih(e,1);if(s!==null){var o=R();gi(s,e,1,o)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var i=ih(e,134217728);if(i!==null){var a=R();gi(i,e,134217728,a)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var i=yi(e),a=ih(e,i);if(a!==null){var s=R();gi(a,e,i,s)}il(e,i)}};Hc=function(){return C};Ic=function(e,i){var a=C;try{return C=e,i()}finally{C=a}};yb=function(e,i,a){switch(i){case"input":if(bb(e,a),i=a.name,a.type==="radio"&&i!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var s=a[i];if(s!==e&&s.form===e.form){var o=Db(s);if(!o)throw Error(p(90));Wa(s),bb(s,o)}}}break;case"textarea":ib(e,a);break;case"select":i=a.value,i!=null&&fb(e,!!a.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p(200));return cl(e,i,null,a)};reactDom_production_min.createRoot=function(e,i){if(!nl(e))throw Error(p(299));var a=!1,s="",o=kl;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),i=bl(e,1,!1,null,null,a,!1,s,o),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ll(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,i,a){if(!ol(i))throw Error(p(200));return rl(null,e,i,!0,a)};reactDom_production_min.hydrateRoot=function(e,i,a){if(!nl(e))throw Error(p(405));var s=a!=null&&a.hydratedSources||null,o=!1,c="",h=kl;if(a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onRecoverableError!==void 0&&(h=a.onRecoverableError)),i=el(i,null,e,1,a??null,o,!1,c,h),e[uf]=i.current,sf(e),s)for(e=0;e<s.length;e++)a=s[e],o=a._getVersion,o=o(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,o]:i.mutableSourceEagerHydrationData.push(a,o);return new ml(i)};reactDom_production_min.render=function(e,i,a){if(!ol(i))throw Error(p(200));return rl(null,e,i,!1,a)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,a,s){if(!ol(a))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl(e,i,a,!1,s)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,i)=>{const a=reactExports.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:h,className:d="",children:g,..._},b)=>reactExports.createElement("svg",{ref:b,...defaultAttributes,width:o,height:o,stroke:s,strokeWidth:h?Number(c)*24/Number(o):c,className:["lucide",`lucide-${toKebabCase(e)}`,d].join(" "),..._},[...i.map(([j,_e])=>reactExports.createElement(j,_e)),...Array.isArray(g)?g:[g]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Calendar=createLucideIcon("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileSpreadsheet=createLucideIcon("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Loader2=createLucideIcon("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function Card({children:e,className:i=""}){return jsxRuntimeExports.jsx("div",{className:`bg-card text-card-foreground rounded-lg border border-border shadow-sm ${i}`,children:e})}function CardHeader({children:e,className:i=""}){return jsxRuntimeExports.jsx("div",{className:`flex flex-col space-y-1.5 p-6 ${i}`,children:e})}function CardTitle({children:e,className:i=""}){return jsxRuntimeExports.jsx("h3",{className:`text-2xl font-semibold leading-none tracking-tight ${i}`,children:e})}function CardContent({children:e,className:i=""}){return jsxRuntimeExports.jsx("div",{className:`p-6 pt-0 ${i}`,children:e})}function CardFooter({children:e,className:i=""}){return jsxRuntimeExports.jsx("div",{className:`flex items-center p-6 pt-0 ${i}`,children:e})}function Button({variant:e="default",size:i="default",className:a="",children:s,disabled:o,...c}){const h="inline-flex items-center justify-center rounded-md font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none active:scale-95 hover:scale-105",d={default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",outline:"border border-input hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},g={default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md text-sm",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"};return jsxRuntimeExports.jsx("button",{className:`${h} ${d[e]} ${g[i]} ${a}`,disabled:o,...c,children:s})}const LayoutGroupContext=reactExports.createContext({});function useConstant(e){const i=reactExports.useRef(null);return i.current===null&&(i.current=e()),i.current}const PresenceContext=reactExports.createContext(null),MotionConfigContext=reactExports.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(i){const a=this.props.childRef.current;if(a&&i.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=a.offsetHeight||0,s.width=a.offsetWidth||0,s.top=a.offsetTop,s.left=a.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:e,isPresent:i}){const a=reactExports.useId(),s=reactExports.useRef(null),o=reactExports.useRef({width:0,height:0,top:0,left:0}),{nonce:c}=reactExports.useContext(MotionConfigContext);return reactExports.useInsertionEffect(()=>{const{width:h,height:d,top:g,left:_}=o.current;if(i||!s.current||!h||!d)return;s.current.dataset.motionPopId=a;const b=document.createElement("style");return c&&(b.nonce=c),document.head.appendChild(b),b.sheet&&b.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${d}px !important;
            top: ${g}px !important;
            left: ${_}px !important;
          }
        `),()=>{document.head.removeChild(b)}},[i]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:i,childRef:s,sizeRef:o,children:reactExports.cloneElement(e,{ref:s})})}const PresenceChild=({children:e,initial:i,isPresent:a,onExitComplete:s,custom:o,presenceAffectsLayout:c,mode:h})=>{const d=useConstant(newChildrenMap),g=reactExports.useId(),_=reactExports.useCallback(j=>{d.set(j,!0);for(const _e of d.values())if(!_e)return;s&&s()},[d,s]),b=reactExports.useMemo(()=>({id:g,initial:i,isPresent:a,custom:o,onExitComplete:_,register:j=>(d.set(j,!1),()=>d.delete(j))}),c?[Math.random(),_]:[a,_]);return reactExports.useMemo(()=>{d.forEach((j,_e)=>d.set(_e,!1))},[a]),reactExports.useEffect(()=>{!a&&!d.size&&s&&s()},[a]),h==="popLayout"&&(e=jsxRuntimeExports.jsx(PopChild,{isPresent:a,children:e})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:b,children:e})};function newChildrenMap(){return new Map}function usePresence(e=!0){const i=reactExports.useContext(PresenceContext);if(i===null)return[!0,null];const{isPresent:a,onExitComplete:s,register:o}=i,c=reactExports.useId();reactExports.useEffect(()=>{e&&o(c)},[e]);const h=reactExports.useCallback(()=>e&&s&&s(c),[c,s,e]);return!a&&s?[!1,h]:[!0]}const getChildKey=e=>e.key||"";function onlyElements(e){const i=[];return reactExports.Children.forEach(e,a=>{reactExports.isValidElement(a)&&i.push(a)}),i}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,AnimatePresence=({children:e,custom:i,initial:a=!0,onExitComplete:s,presenceAffectsLayout:o=!0,mode:c="sync",propagate:h=!1})=>{const[d,g]=usePresence(h),_=reactExports.useMemo(()=>onlyElements(e),[e]),b=h&&!d?[]:_.map(getChildKey),j=reactExports.useRef(!0),_e=reactExports.useRef(_),et=useConstant(()=>new Map),[rt,tt]=reactExports.useState(_),[it,nt]=reactExports.useState(_);useIsomorphicLayoutEffect(()=>{j.current=!1,_e.current=_;for(let dt=0;dt<it.length;dt++){const lt=getChildKey(it[dt]);b.includes(lt)?et.delete(lt):et.get(lt)!==!0&&et.set(lt,!1)}},[it,b.length,b.join("-")]);const at=[];if(_!==rt){let dt=[..._];for(let lt=0;lt<it.length;lt++){const ut=it[lt],ot=getChildKey(ut);b.includes(ot)||(dt.splice(lt,0,ut),at.push(ut))}c==="wait"&&at.length&&(dt=at),nt(onlyElements(dt)),tt(_);return}const{forceRender:st}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:it.map(dt=>{const lt=getChildKey(dt),ut=h&&!d?!1:_===it||b.includes(lt),ot=()=>{if(et.has(lt))et.set(lt,!0);else return;let ft=!0;et.forEach(pt=>{pt||(ft=!1)}),ft&&(st==null||st(),nt(_e.current),h&&(g==null||g()),s&&s())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:ut,initial:!j.current||a?void 0:!1,custom:ut?void 0:i,presenceAffectsLayout:o,mode:c,onExitComplete:ut?void 0:ot,children:dt},lt)})})},noop=e=>e;let invariant=noop;function memo(e){let i;return()=>(i===void 0&&(i=e()),i)}const progress=(e,i,a)=>{const s=i-e;return s===0?1:(a-e)/s},secondsToMilliseconds=e=>e*1e3,millisecondsToSeconds=e=>e/1e3,MotionGlobalConfig={useManualTiming:!1};function createRenderStep(e){let i=new Set,a=new Set,s=!1,o=!1;const c=new WeakSet;let h={delta:0,timestamp:0,isProcessing:!1};function d(_){c.has(_)&&(g.schedule(_),e()),_(h)}const g={schedule:(_,b=!1,j=!1)=>{const et=j&&s?i:a;return b&&c.add(_),et.has(_)||et.add(_),_},cancel:_=>{a.delete(_),c.delete(_)},process:_=>{if(h=_,s){o=!0;return}s=!0,[i,a]=[a,i],i.forEach(d),i.clear(),s=!1,o&&(o=!1,g.process(_))}};return g}const stepsOrder=["read","resolveKeyframes","update","preRender","render","postRender"],maxElapsed=40;function createRenderBatcher(e,i){let a=!1,s=!0;const o={delta:0,timestamp:0,isProcessing:!1},c=()=>a=!0,h=stepsOrder.reduce((nt,at)=>(nt[at]=createRenderStep(c),nt),{}),{read:d,resolveKeyframes:g,update:_,preRender:b,render:j,postRender:_e}=h,et=()=>{const nt=performance.now();a=!1,o.delta=s?1e3/60:Math.max(Math.min(nt-o.timestamp,maxElapsed),1),o.timestamp=nt,o.isProcessing=!0,d.process(o),g.process(o),_.process(o),b.process(o),j.process(o),_e.process(o),o.isProcessing=!1,a&&i&&(s=!1,e(et))},rt=()=>{a=!0,s=!0,o.isProcessing||e(et)};return{schedule:stepsOrder.reduce((nt,at)=>{const st=h[at];return nt[at]=(dt,lt=!1,ut=!1)=>(a||rt(),st.schedule(dt,lt,ut)),nt},{}),cancel:nt=>{for(let at=0;at<stepsOrder.length;at++)h[stepsOrder[at]].cancel(nt)},state:o,steps:h}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0),LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const e in featureProps)featureDefinitions[e]={isEnabled:i=>featureProps[e].some(a=>!!i[a])};function loadFeatures(e){for(const i in e)featureDefinitions[i]={...featureDefinitions[i],...e[i]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||validMotionProps.has(e)}let shouldForward=e=>!isValidMotionProp(e);function loadExternalIsValidProp(e){e&&(shouldForward=i=>i.startsWith("on")?!isValidMotionProp(i):e(i))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(e,i,a){const s={};for(const o in e)o==="values"&&typeof e.values=="object"||(shouldForward(o)||a===!0&&isValidMotionProp(o)||!i&&!isValidMotionProp(o)||e.draggable&&o.startsWith("onDrag"))&&(s[o]=e[o]);return s}function createDOMMotionComponentProxy(e){if(typeof Proxy>"u")return e;const i=new Map,a=(...s)=>e(...s);return new Proxy(a,{get:(s,o)=>o==="create"?e:(i.has(o)||i.set(o,e(o)),i.get(o))})}const MotionContext=reactExports.createContext({});function isVariantLabel(e){return typeof e=="string"||Array.isArray(e)}function isAnimationControls(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(e){return isAnimationControls(e.animate)||variantProps.some(i=>isVariantLabel(e[i]))}function isVariantNode(e){return!!(isControllingVariants(e)||e.variants)}function getCurrentTreeVariants(e,i){if(isControllingVariants(e)){const{initial:a,animate:s}=e;return{initial:a===!1||isVariantLabel(a)?a:void 0,animate:isVariantLabel(s)?s:void 0}}return e.inherit!==!1?i:{}}function useCreateMotionContext(e){const{initial:i,animate:a}=getCurrentTreeVariants(e,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:i,animate:a}),[variantLabelsAsDependency(i),variantLabelsAsDependency(a)])}function variantLabelsAsDependency(e){return Array.isArray(e)?e.join(" "):e}const motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function useMotionRef(e,i,a){return reactExports.useCallback(s=>{s&&e.onMount&&e.onMount(s),i&&(s?i.mount(s):i.unmount()),a&&(typeof a=="function"?a(s):isRefObject(a)&&(a.current=s))},[i])}const camelToDash=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(e,i,a,s,o){var c,h;const{visualElement:d}=reactExports.useContext(MotionContext),g=reactExports.useContext(LazyContext),_=reactExports.useContext(PresenceContext),b=reactExports.useContext(MotionConfigContext).reducedMotion,j=reactExports.useRef(null);s=s||g.renderer,!j.current&&s&&(j.current=s(e,{visualState:i,parent:d,props:a,presenceContext:_,blockInitialAnimation:_?_.initial===!1:!1,reducedMotionConfig:b}));const _e=j.current,et=reactExports.useContext(SwitchLayoutGroupContext);_e&&!_e.projection&&o&&(_e.type==="html"||_e.type==="svg")&&createProjectionNode$1(j.current,a,o,et);const rt=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{_e&&rt.current&&_e.update(a,_)});const tt=a[optimizedAppearDataAttribute],it=reactExports.useRef(!!tt&&!(!((c=window.MotionHandoffIsComplete)===null||c===void 0)&&c.call(window,tt))&&((h=window.MotionHasOptimisedAnimation)===null||h===void 0?void 0:h.call(window,tt)));return useIsomorphicLayoutEffect(()=>{_e&&(rt.current=!0,window.MotionIsMounted=!0,_e.updateFeatures(),microtask.render(_e.render),it.current&&_e.animationState&&_e.animationState.animateChanges())}),reactExports.useEffect(()=>{_e&&(!it.current&&_e.animationState&&_e.animationState.animateChanges(),it.current&&(queueMicrotask(()=>{var nt;(nt=window.MotionHandoffMarkAsComplete)===null||nt===void 0||nt.call(window,tt)}),it.current=!1))}),_e}function createProjectionNode$1(e,i,a,s){const{layoutId:o,layout:c,drag:h,dragConstraints:d,layoutScroll:g,layoutRoot:_}=i;e.projection=new a(e.latestValues,i["data-framer-portal-id"]?void 0:getClosestProjectingNode(e.parent)),e.projection.setOptions({layoutId:o,layout:c,alwaysMeasureLayout:!!h||d&&isRefObject(d),visualElement:e,animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:g,layoutRoot:_})}function getClosestProjectingNode(e){if(e)return e.options.allowProjection!==!1?e.projection:getClosestProjectingNode(e.parent)}function createRendererMotionComponent({preloadedFeatures:e,createVisualElement:i,useRender:a,useVisualState:s,Component:o}){var c,h;e&&loadFeatures(e);function d(_,b){let j;const _e={...reactExports.useContext(MotionConfigContext),..._,layoutId:useLayoutId(_)},{isStatic:et}=_e,rt=useCreateMotionContext(_),tt=s(_,et);if(!et&&isBrowser){useStrictMode();const it=getProjectionFunctionality(_e);j=it.MeasureLayout,rt.visualElement=useVisualElement(o,tt,_e,i,it.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:rt,children:[j&&rt.visualElement?jsxRuntimeExports.jsx(j,{visualElement:rt.visualElement,..._e}):null,a(o,_,useMotionRef(tt,rt.visualElement,b),tt,et,rt.visualElement)]})}d.displayName=`motion.${typeof o=="string"?o:`create(${(h=(c=o.displayName)!==null&&c!==void 0?c:o.name)!==null&&h!==void 0?h:""})`}`;const g=reactExports.forwardRef(d);return g[motionComponentSymbol]=o,g}function useLayoutId({layoutId:e}){const i=reactExports.useContext(LayoutGroupContext).id;return i&&e!==void 0?i+"-"+e:e}function useStrictMode(e,i){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(e){const{drag:i,layout:a}=featureDefinitions;if(!i&&!a)return{};const s={...i,...a};return{MeasureLayout:i!=null&&i.isEnabled(e)||a!=null&&a.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(e){return typeof e!="string"||e.includes("-")?!1:!!(lowercaseSVGElements.indexOf(e)>-1||/[A-Z]/u.test(e))}function getValueState(e){const i=[{},{}];return e==null||e.values.forEach((a,s)=>{i[0][s]=a.get(),i[1][s]=a.getVelocity()}),i}function resolveVariantFromProps(e,i,a,s){if(typeof i=="function"){const[o,c]=getValueState(s);i=i(a!==void 0?a:e.custom,o,c)}if(typeof i=="string"&&(i=e.variants&&e.variants[i]),typeof i=="function"){const[o,c]=getValueState(s);i=i(a!==void 0?a:e.custom,o,c)}return i}const isKeyframesTarget=e=>Array.isArray(e),isCustomValue=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),resolveFinalValueInKeyframes=e=>isKeyframesTarget(e)?e[e.length-1]||0:e,isMotionValue=e=>!!(e&&e.getVelocity);function resolveMotionValue(e){const i=isMotionValue(e)?e.get():e;return isCustomValue(i)?i.toValue():i}function makeState({scrapeMotionValuesFromProps:e,createRenderState:i,onUpdate:a},s,o,c){const h={latestValues:makeLatestValues(s,o,c,e),renderState:i()};return a&&(h.onMount=d=>a({props:s,current:d,...h}),h.onUpdate=d=>a(d)),h}const makeUseVisualState=e=>(i,a)=>{const s=reactExports.useContext(MotionContext),o=reactExports.useContext(PresenceContext),c=()=>makeState(e,i,s,o);return a?c():useConstant(c)};function makeLatestValues(e,i,a,s){const o={},c=s(e,{});for(const _e in c)o[_e]=resolveMotionValue(c[_e]);let{initial:h,animate:d}=e;const g=isControllingVariants(e),_=isVariantNode(e);i&&_&&!g&&e.inherit!==!1&&(h===void 0&&(h=i.initial),d===void 0&&(d=i.animate));let b=a?a.initial===!1:!1;b=b||h===!1;const j=b?d:h;if(j&&typeof j!="boolean"&&!isAnimationControls(j)){const _e=Array.isArray(j)?j:[j];for(let et=0;et<_e.length;et++){const rt=resolveVariantFromProps(e,_e[et]);if(rt){const{transitionEnd:tt,transition:it,...nt}=rt;for(const at in nt){let st=nt[at];if(Array.isArray(st)){const dt=b?st.length-1:0;st=st[dt]}st!==null&&(o[at]=st)}for(const at in tt)o[at]=tt[at]}}}return o}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),checkStringStartsWith=e=>i=>typeof i=="string"&&i.startsWith(e),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=e=>startsAsVariableToken(e)?singleCssVariableRegex.test(e.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,getValueAsType=(e,i)=>i&&typeof e=="number"?i.transform(e):e,clamp=(e,i,a)=>a>i?i:a<e?e:a,number={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},alpha={...number,transform:e=>clamp(0,1,e)},scale={...number,default:1},createUnitType=e=>({test:i=>typeof i=="string"&&i.endsWith(e)&&i.split(" ").length===1,parse:parseFloat,transform:i=>`${i}${e}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:e=>percent.parse(e)/100,transform:e=>percent.transform(e*100)},browserNumberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},int={...number,transform:Math.round},numberValueTypes={...browserNumberValueTypes,...transformValueTypes,zIndex:int,size:px,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(e,i,a){let s="",o=!0;for(let c=0;c<numTransforms;c++){const h=transformPropOrder[c],d=e[h];if(d===void 0)continue;let g=!0;if(typeof d=="number"?g=d===(h.startsWith("scale")?1:0):g=parseFloat(d)===0,!g||a){const _=getValueAsType(d,numberValueTypes[h]);if(!g){o=!1;const b=translateAlias[h]||h;s+=`${b}(${_}) `}a&&(i[h]=_)}}return s=s.trim(),a?s=a(i,o?"":s):o&&(s="none"),s}function buildHTMLStyles(e,i,a){const{style:s,vars:o,transformOrigin:c}=e;let h=!1,d=!1;for(const g in i){const _=i[g];if(transformProps.has(g)){h=!0;continue}else if(isCSSVariableName(g)){o[g]=_;continue}else{const b=getValueAsType(_,numberValueTypes[g]);g.startsWith("origin")?(d=!0,c[g]=b):s[g]=b}}if(i.transform||(h||a?s.transform=buildTransform(i,e.transform,a):s.transform&&(s.transform="none")),d){const{originX:g="50%",originY:_="50%",originZ:b=0}=c;s.transformOrigin=`${g} ${_} ${b}`}}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(e,i,a=1,s=0,o=!0){e.pathLength=1;const c=o?dashKeys:camelKeys;e[c.offset]=px.transform(-s);const h=px.transform(i),d=px.transform(a);e[c.array]=`${h} ${d}`}function calcOrigin$1(e,i,a){return typeof e=="string"?e:px.transform(i+a*e)}function calcSVGTransformOrigin(e,i,a){const s=calcOrigin$1(i,e.x,e.width),o=calcOrigin$1(a,e.y,e.height);return`${s} ${o}`}function buildSVGAttrs(e,{attrX:i,attrY:a,attrScale:s,originX:o,originY:c,pathLength:h,pathSpacing:d=1,pathOffset:g=0,..._},b,j){if(buildHTMLStyles(e,_,j),b){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:_e,style:et,dimensions:rt}=e;_e.transform&&(rt&&(et.transform=_e.transform),delete _e.transform),rt&&(o!==void 0||c!==void 0||et.transform)&&(et.transformOrigin=calcSVGTransformOrigin(rt,o!==void 0?o:.5,c!==void 0?c:.5)),i!==void 0&&(_e.x=i),a!==void 0&&(_e.y=a),s!==void 0&&(_e.scale=s),h!==void 0&&buildSVGPath(_e,h,d,g,!1)}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=e=>typeof e=="string"&&e.toLowerCase()==="svg";function renderHTML(e,{style:i,vars:a},s,o){Object.assign(e.style,i,o&&o.getProjectionStyles(s));for(const c in a)e.style.setProperty(c,a[c])}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(e,i,a,s){renderHTML(e,i,void 0,s);for(const o in i.attrs)e.setAttribute(camelCaseAttributes.has(o)?o:camelToDash(o),i.attrs[o])}const scaleCorrectors={};function addScaleCorrector(e){Object.assign(scaleCorrectors,e)}function isForcedMotionValue(e,{layout:i,layoutId:a}){return transformProps.has(e)||e.startsWith("origin")||(i||a!==void 0)&&(!!scaleCorrectors[e]||e==="opacity")}function scrapeMotionValuesFromProps$1(e,i,a){var s;const{style:o}=e,c={};for(const h in o)(isMotionValue(o[h])||i.style&&isMotionValue(i.style[h])||isForcedMotionValue(h,e)||((s=a==null?void 0:a.getValue(h))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(c[h]=o[h]);return c}function scrapeMotionValuesFromProps(e,i,a){const s=scrapeMotionValuesFromProps$1(e,i,a);for(const o in e)if(isMotionValue(e[o])||isMotionValue(i[o])){const c=transformPropOrder.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;s[c]=e[o]}return s}function updateSVGDimensions(e,i){try{i.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{i.dimensions={x:0,y:0,width:0,height:0}}}const layoutProps=["x","y","width","height","cx","cy","r"],svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onUpdate:({props:e,prevProps:i,current:a,renderState:s,latestValues:o})=>{if(!a)return;let c=!!e.drag;if(!c){for(const d in o)if(transformProps.has(d)){c=!0;break}}if(!c)return;let h=!i;if(i)for(let d=0;d<layoutProps.length;d++){const g=layoutProps[d];e[g]!==i[g]&&(h=!0)}h&&frame.read(()=>{updateSVGDimensions(a,s),frame.render(()=>{buildSVGAttrs(s,o,isSVGTag(a.tagName),e.transformTemplate),renderSVG(a,s)})})}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function copyRawValuesOnly(e,i,a){for(const s in i)!isMotionValue(i[s])&&!isForcedMotionValue(s,a)&&(e[s]=i[s])}function useInitialMotionValues({transformTemplate:e},i){return reactExports.useMemo(()=>{const a=createHtmlRenderState();return buildHTMLStyles(a,i,e),Object.assign({},a.vars,a.style)},[i])}function useStyle(e,i){const a=e.style||{},s={};return copyRawValuesOnly(s,a,e),Object.assign(s,useInitialMotionValues(e,i)),s}function useHTMLProps(e,i){const a={},s=useStyle(e,i);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=s,a}function useSVGProps(e,i,a,s){const o=reactExports.useMemo(()=>{const c=createSvgRenderState();return buildSVGAttrs(c,i,isSVGTag(s),e.transformTemplate),{...c.attrs,style:{...c.style}}},[i]);if(e.style){const c={};copyRawValuesOnly(c,e.style,e),o.style={...c,...o.style}}return o}function createUseRender(e=!1){return(a,s,o,{latestValues:c},h)=>{const g=(isSVGComponent(a)?useSVGProps:useHTMLProps)(s,c,h,a),_=filterProps(s,typeof a=="string",e),b=a!==reactExports.Fragment?{..._,...g,ref:o}:{},{children:j}=s,_e=reactExports.useMemo(()=>isMotionValue(j)?j.get():j,[j]);return reactExports.createElement(a,{...b,children:_e})}}function createMotionComponentFactory(e,i){return function(s,{forwardMotionProps:o}={forwardMotionProps:!1}){const h={...isSVGComponent(s)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:e,useRender:createUseRender(o),createVisualElement:i,Component:s};return createRendererMotionComponent(h)}}function shallowCompare(e,i){if(!Array.isArray(i))return!1;const a=i.length;if(a!==e.length)return!1;for(let s=0;s<a;s++)if(i[s]!==e[s])return!1;return!0}function resolveVariant(e,i,a){const s=e.getProps();return resolveVariantFromProps(s,i,a!==void 0?a:s.custom,e)}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0);class BaseGroupPlaybackControls{constructor(i){this.stop=()=>this.runAll("stop"),this.animations=i.filter(Boolean)}get finished(){return Promise.all(this.animations.map(i=>"finished"in i?i.finished:i))}getAll(i){return this.animations[0][i]}setAll(i,a){for(let s=0;s<this.animations.length;s++)this.animations[s][i]=a}attachTimeline(i,a){const s=this.animations.map(o=>{if(supportsScrollTimeline()&&o.attachTimeline)return o.attachTimeline(i);if(typeof a=="function")return a(o)});return()=>{s.forEach((o,c)=>{o&&o(),this.animations[c].stop()})}}get time(){return this.getAll("time")}set time(i){this.setAll("time",i)}get speed(){return this.getAll("speed")}set speed(i){this.setAll("speed",i)}get startTime(){return this.getAll("startTime")}get duration(){let i=0;for(let a=0;a<this.animations.length;a++)i=Math.max(i,this.animations[a].duration);return i}runAll(i){this.animations.forEach(a=>a[i]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class GroupPlaybackControls extends BaseGroupPlaybackControls{then(i,a){return Promise.all(this.animations).then(i).catch(a)}}function getValueTransition(e,i){return e?e[i]||e.default||e:void 0}const maxGeneratorDuration=2e4;function calcGeneratorDuration(e){let i=0;const a=50;let s=e.next(i);for(;!s.done&&i<maxGeneratorDuration;)i+=a,s=e.next(i);return i>=maxGeneratorDuration?1/0:i}function isGenerator(e){return typeof e=="function"}function attachTimeline(e,i){e.timeline=i,e.onfinish=null}const isBezierDefinition=e=>Array.isArray(e)&&typeof e[0]=="number",supportsFlags={linearEasing:void 0};function memoSupports(e,i){const a=memo(e);return()=>{var s;return(s=supportsFlags[i])!==null&&s!==void 0?s:a()}}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),generateLinearEasing=(e,i,a=10)=>{let s="";const o=Math.max(Math.round(i/a),2);for(let c=0;c<o;c++)s+=e(progress(0,o-1,c))+", ";return`linear(${s.substring(0,s.length-2)})`};function isWaapiSupportedEasing(e){return!!(typeof e=="function"&&supportsLinearEasing()||!e||typeof e=="string"&&(e in supportedWaapiEasing||supportsLinearEasing())||isBezierDefinition(e)||Array.isArray(e)&&e.every(isWaapiSupportedEasing))}const cubicBezierAsString=([e,i,a,s])=>`cubic-bezier(${e}, ${i}, ${a}, ${s})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(e,i){if(e)return typeof e=="function"&&supportsLinearEasing()?generateLinearEasing(e,i):isBezierDefinition(e)?cubicBezierAsString(e):Array.isArray(e)?e.map(a=>mapEasingToNativeEasing(a,i)||supportedWaapiEasing.easeOut):supportedWaapiEasing[e]}const isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function resolveElements(e,i,a){var s;if(e instanceof Element)return[e];if(typeof e=="string"){let o=document;const c=(s=void 0)!==null&&s!==void 0?s:o.querySelectorAll(e);return c?Array.from(c):[]}return Array.from(e)}function setupGesture(e,i){const a=resolveElements(e),s=new AbortController,o={passive:!0,...i,signal:s.signal};return[a,o,()=>s.abort()]}function filterEvents$1(e){return i=>{i.pointerType==="touch"||isDragActive()||e(i)}}function hover(e,i,a={}){const[s,o,c]=setupGesture(e,a),h=filterEvents$1(d=>{const{target:g}=d,_=i(d);if(typeof _!="function"||!g)return;const b=filterEvents$1(j=>{_(j),g.removeEventListener("pointerleave",b)});g.addEventListener("pointerleave",b,o)});return s.forEach(d=>{d.addEventListener("pointerenter",h,o)}),c}const isNodeOrChild=(e,i)=>i?e===i?!0:isNodeOrChild(e,i.parentElement):!1,isPrimaryPointer=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(e){return focusableElements.has(e.tagName)||e.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(e){return i=>{i.key==="Enter"&&e(i)}}function firePointerEvent(e,i){e.dispatchEvent(new PointerEvent("pointer"+i,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(e,i)=>{const a=e.currentTarget;if(!a)return;const s=filterEvents(()=>{if(isPressing.has(a))return;firePointerEvent(a,"down");const o=filterEvents(()=>{firePointerEvent(a,"up")}),c=()=>firePointerEvent(a,"cancel");a.addEventListener("keyup",o,i),a.addEventListener("blur",c,i)});a.addEventListener("keydown",s,i),a.addEventListener("blur",()=>a.removeEventListener("keydown",s),i)};function isValidPressEvent(e){return isPrimaryPointer(e)&&!isDragActive()}function press(e,i,a={}){const[s,o,c]=setupGesture(e,a),h=d=>{const g=d.currentTarget;if(!isValidPressEvent(d)||isPressing.has(g))return;isPressing.add(g);const _=i(d),b=(et,rt)=>{window.removeEventListener("pointerup",j),window.removeEventListener("pointercancel",_e),!(!isValidPressEvent(et)||!isPressing.has(g))&&(isPressing.delete(g),typeof _=="function"&&_(et,{success:rt}))},j=et=>{b(et,a.useGlobalTarget||isNodeOrChild(g,et.target))},_e=et=>{b(et,!1)};window.addEventListener("pointerup",j,o),window.addEventListener("pointercancel",_e,o)};return s.forEach(d=>{!isElementKeyboardAccessible(d)&&d.getAttribute("tabindex")===null&&(d.tabIndex=0),(a.useGlobalTarget?window:d).addEventListener("pointerdown",h,o),d.addEventListener("focus",_=>enableKeyboardPress(_,o),o)}),c}function setDragLock(e){return e==="x"||e==="y"?isDragging[e]?null:(isDragging[e]=!0,()=>{isDragging[e]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:e=>{now=e,queueMicrotask(clearTime)}};function addUniqueItem(e,i){e.indexOf(i)===-1&&e.push(i)}function removeItem(e,i){const a=e.indexOf(i);a>-1&&e.splice(a,1)}class SubscriptionManager{constructor(){this.subscriptions=[]}add(i){return addUniqueItem(this.subscriptions,i),()=>removeItem(this.subscriptions,i)}notify(i,a,s){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](i,a,s);else for(let c=0;c<o;c++){const h=this.subscriptions[c];h&&h(i,a,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function velocityPerSecond(e,i){return i?e*(1e3/i):0}const MAX_VELOCITY_DELTA=30,isFloat=e=>!isNaN(parseFloat(e));class MotionValue{constructor(i,a={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,o=!0)=>{const c=time.now();this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(i),this.owner=a.owner}setCurrent(i){this.current=i,this.updatedAt=time.now(),this.canTrackVelocity===null&&i!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(i=this.current){this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt}onChange(i){return this.on("change",i)}on(i,a){this.events[i]||(this.events[i]=new SubscriptionManager);const s=this.events[i].add(a);return i==="change"?()=>{s(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const i in this.events)this.events[i].clear()}attach(i,a){this.passiveEffect=i,this.stopPassiveEffect=a}set(i,a=!0){!a||!this.passiveEffect?this.updateAndNotify(i,a):this.passiveEffect(i,this.updateAndNotify)}setWithVelocity(i,a,s){this.set(a),this.prev=void 0,this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt-s}jump(i,a=!0){this.updateAndNotify(i),this.prev=i,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const i=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||i-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(i){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=i(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(e,i){return new MotionValue(e,i)}function setMotionValue(e,i,a){e.hasValue(i)?e.getValue(i).set(a):e.addValue(i,motionValue(a))}function setTarget(e,i){const a=resolveVariant(e,i);let{transitionEnd:s={},transition:o={},...c}=a||{};c={...c,...s};for(const h in c){const d=resolveFinalValueInKeyframes(c[h]);setMotionValue(e,h,d)}}function isWillChangeMotionValue(e){return!!(isMotionValue(e)&&e.add)}function addValueToWillChange(e,i){const a=e.getValue("willChange");if(isWillChangeMotionValue(a))return a.add(i)}function getOptimisedAppearId(e){return e.props[optimizedAppearDataAttribute]}const calcBezier=(e,i,a)=>(((1-3*a+3*i)*e+(3*a-6*i))*e+3*i)*e,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(e,i,a,s,o){let c,h,d=0;do h=i+(a-i)/2,c=calcBezier(h,s,o)-e,c>0?a=h:i=h;while(Math.abs(c)>subdivisionPrecision&&++d<subdivisionMaxIterations);return h}function cubicBezier(e,i,a,s){if(e===i&&a===s)return noop;const o=c=>binarySubdivide(c,0,1,e,a);return c=>c===0||c===1?c:calcBezier(o(c),i,s)}const mirrorEasing=e=>i=>i<=.5?e(2*i)/2:(2-e(2*(1-i)))/2,reverseEasing=e=>i=>1-e(1-i),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=e=>(e*=2)<1?.5*backIn(e):.5*(2-Math.pow(2,-10*(e-1))),circIn=e=>1-Math.sin(Math.acos(e)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),isZeroValueString=e=>/^0[^.\s]+$/u.test(e);function isNone(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||isZeroValueString(e):!0}const sanitize=e=>Math.round(e*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(e){return e==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(e,i)=>a=>!!(typeof a=="string"&&singleColorRegex.test(a)&&a.startsWith(e)||i&&!isNullish(a)&&Object.prototype.hasOwnProperty.call(a,i)),splitColor=(e,i,a)=>s=>{if(typeof s!="string")return s;const[o,c,h,d]=s.match(floatRegex);return{[e]:parseFloat(o),[i]:parseFloat(c),[a]:parseFloat(h),alpha:d!==void 0?parseFloat(d):1}},clampRgbUnit=e=>clamp(0,255,e),rgbUnit={...number,transform:e=>Math.round(clampRgbUnit(e))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:e,green:i,blue:a,alpha:s=1})=>"rgba("+rgbUnit.transform(e)+", "+rgbUnit.transform(i)+", "+rgbUnit.transform(a)+", "+sanitize(alpha.transform(s))+")"};function parseHex(e){let i="",a="",s="",o="";return e.length>5?(i=e.substring(1,3),a=e.substring(3,5),s=e.substring(5,7),o=e.substring(7,9)):(i=e.substring(1,2),a=e.substring(2,3),s=e.substring(3,4),o=e.substring(4,5),i+=i,a+=a,s+=s,o+=o),{red:parseInt(i,16),green:parseInt(a,16),blue:parseInt(s,16),alpha:o?parseInt(o,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:e,saturation:i,lightness:a,alpha:s=1})=>"hsla("+Math.round(e)+", "+percent.transform(sanitize(i))+", "+percent.transform(sanitize(a))+", "+sanitize(alpha.transform(s))+")"},color={test:e=>rgba.test(e)||hex.test(e)||hsla.test(e),parse:e=>rgba.test(e)?rgba.parse(e):hsla.test(e)?hsla.parse(e):hex.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?rgba.transform(e):hsla.transform(e)},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(e){var i,a;return isNaN(e)&&typeof e=="string"&&(((i=e.match(floatRegex))===null||i===void 0?void 0:i.length)||0)+(((a=e.match(colorRegex))===null||a===void 0?void 0:a.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(e){const i=e.toString(),a=[],s={color:[],number:[],var:[]},o=[];let c=0;const d=i.replace(complexRegex,g=>(color.test(g)?(s.color.push(c),o.push(COLOR_TOKEN),a.push(color.parse(g))):g.startsWith(VAR_FUNCTION_TOKEN)?(s.var.push(c),o.push(VAR_TOKEN),a.push(g)):(s.number.push(c),o.push(NUMBER_TOKEN),a.push(parseFloat(g))),++c,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:a,split:d,indexes:s,types:o}}function parseComplexValue(e){return analyseComplexValue(e).values}function createTransformer(e){const{split:i,types:a}=analyseComplexValue(e),s=i.length;return o=>{let c="";for(let h=0;h<s;h++)if(c+=i[h],o[h]!==void 0){const d=a[h];d===NUMBER_TOKEN?c+=sanitize(o[h]):d===COLOR_TOKEN?c+=color.transform(o[h]):c+=o[h]}return c}}const convertNumbersToZero=e=>typeof e=="number"?0:e;function getAnimatableNone$1(e){const i=parseComplexValue(e);return createTransformer(e)(i.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1},maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(e){const[i,a]=e.slice(0,-1).split("(");if(i==="drop-shadow")return e;const[s]=a.match(floatRegex)||[];if(!s)return e;const o=a.replace(s,"");let c=maxDefaults.has(i)?1:0;return s!==a&&(c*=100),i+"("+c+o+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:e=>{const i=e.match(functionRegex);return i?i.map(applyDefaultFilter).join(" "):e}},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=e=>defaultValueTypes[e];function getAnimatableNone(e,i){let a=getDefaultValueType(e);return a!==filter&&(a=complex),a.getAnimatableNone?a.getAnimatableNone(i):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(e,i,a){let s=0,o;for(;s<e.length&&!o;){const c=e[s];typeof c=="string"&&!invalidTemplates.has(c)&&analyseComplexValue(c).values.length&&(o=e[s]),s++}if(o&&a)for(const c of i)e[c]=getAnimatableNone(a,o)}const isNumOrPxType=e=>e===number||e===px,getPosFromMatrix=(e,i)=>parseFloat(e.split(", ")[i]),getTranslateFromMatrix=(e,i)=>(a,{transform:s})=>{if(s==="none"||!s)return 0;const o=s.match(/^matrix3d\((.+)\)$/u);if(o)return getPosFromMatrix(o[1],i);{const c=s.match(/^matrix\((.+)\)$/u);return c?getPosFromMatrix(c[1],e):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(e=>!transformKeys.has(e));function removeNonTranslationalTransform(e){const i=[];return nonTranslationalTransformKeys.forEach(a=>{const s=e.getValue(a);s!==void 0&&(i.push([a,s.get()]),s.set(a.startsWith("scale")?1:0))}),i}const positionalValues={width:({x:e},{paddingLeft:i="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(i)-parseFloat(a),height:({y:e},{paddingTop:i="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(i)-parseFloat(a),top:(e,{top:i})=>parseFloat(i),left:(e,{left:i})=>parseFloat(i),bottom:({y:e},{top:i})=>parseFloat(i)+(e.max-e.min),right:({x:e},{left:i})=>parseFloat(i)+(e.max-e.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const e=Array.from(toResolve).filter(s=>s.needsMeasurement),i=new Set(e.map(s=>s.element)),a=new Map;i.forEach(s=>{const o=removeNonTranslationalTransform(s);o.length&&(a.set(s,o),s.render())}),e.forEach(s=>s.measureInitialState()),i.forEach(s=>{s.render();const o=a.get(s);o&&o.forEach(([c,h])=>{var d;(d=s.getValue(c))===null||d===void 0||d.set(h)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(e=>e.complete()),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){readAllKeyframes(),measureAllKeyframes()}class KeyframeResolver{constructor(i,a,s,o,c,h=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...i],this.onComplete=a,this.name=s,this.motionValue=o,this.element=c,this.isAsync=h}scheduleResolve(){this.isScheduled=!0,this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:i,name:a,element:s,motionValue:o}=this;for(let c=0;c<i.length;c++)if(i[c]===null)if(c===0){const h=o==null?void 0:o.get(),d=i[i.length-1];if(h!==void 0)i[0]=h;else if(s&&a){const g=s.readValue(a,d);g!=null&&(i[0]=g)}i[0]===void 0&&(i[0]=d),o&&h===void 0&&o.set(i[0])}else i[c]=i[c-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),toResolve.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,toResolve.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const isNumericalString=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(e){const i=splitCSSVariableRegex.exec(e);if(!i)return[,];const[,a,s,o]=i;return[`--${a??s}`,o]}function getVariableValue(e,i,a=1){const[s,o]=parseCSSVariable(e);if(!s)return;const c=window.getComputedStyle(i).getPropertyValue(s);if(c){const h=c.trim();return isNumericalString(h)?parseFloat(h):h}return isCSSVariableToken(o)?getVariableValue(o,i,a+1):o}const testValueType=e=>i=>i.test(e),auto={test:e=>e==="auto",parse:e=>e},dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=e=>dimensionValueTypes.find(testValueType(e));class DOMKeyframesResolver extends KeyframeResolver{constructor(i,a,s,o,c){super(i,a,s,o,c,!0)}readKeyframes(){const{unresolvedKeyframes:i,element:a,name:s}=this;if(!a||!a.current)return;super.readKeyframes();for(let g=0;g<i.length;g++){let _=i[g];if(typeof _=="string"&&(_=_.trim(),isCSSVariableToken(_))){const b=getVariableValue(_,a.current);b!==void 0&&(i[g]=b),g===i.length-1&&(this.finalKeyframe=_)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(s)||i.length!==2)return;const[o,c]=i,h=findDimensionValueType(o),d=findDimensionValueType(c);if(h!==d)if(isNumOrPxType(h)&&isNumOrPxType(d))for(let g=0;g<i.length;g++){const _=i[g];typeof _=="string"&&(i[g]=parseFloat(_))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:i,name:a}=this,s=[];for(let o=0;o<i.length;o++)isNone(i[o])&&s.push(o);s.length&&makeNoneKeyframesAnimatable(i,s,a)}measureInitialState(){const{element:i,unresolvedKeyframes:a,name:s}=this;if(!i||!i.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[s](i.measureViewportBox(),window.getComputedStyle(i.current)),a[0]=this.measuredOrigin;const o=a[a.length-1];o!==void 0&&i.getValue(s,o).jump(o,!1)}measureEndState(){var i;const{element:a,name:s,unresolvedKeyframes:o}=this;if(!a||!a.current)return;const c=a.getValue(s);c&&c.jump(this.measuredOrigin,!1);const h=o.length-1,d=o[h];o[h]=positionalValues[s](a.measureViewportBox(),window.getComputedStyle(a.current)),d!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=d),!((i=this.removedTransforms)===null||i===void 0)&&i.length&&this.removedTransforms.forEach(([g,_])=>{a.getValue(g).set(_)}),this.resolveNoneKeyframes()}}const isAnimatable=(e,i)=>i==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(complex.test(e)||e==="0")&&!e.startsWith("url("));function hasKeyframesChanged(e){const i=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==i)return!0}function canAnimate(e,i,a,s){const o=e[0];if(o===null)return!1;if(i==="display"||i==="visibility")return!0;const c=e[e.length-1],h=isAnimatable(o,i),d=isAnimatable(c,i);return!h||!d?!1:hasKeyframesChanged(e)||(a==="spring"||isGenerator(a))&&s}const isNotNull=e=>e!==null;function getFinalKeyframe(e,{repeat:i,repeatType:a="loop"},s){const o=e.filter(isNotNull),c=i&&a!=="loop"&&i%2===1?0:o.length-1;return!c||s===void 0?o[c]:s}const MAX_RESOLVE_DELAY=40;class BaseAnimation{constructor({autoplay:i=!0,delay:a=0,type:s="keyframes",repeat:o=0,repeatDelay:c=0,repeatType:h="loop",...d}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=time.now(),this.options={autoplay:i,delay:a,type:s,repeat:o,repeatDelay:c,repeatType:h,...d},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&flushKeyframeResolvers(),this._resolved}onKeyframesResolved(i,a){this.resolvedAt=time.now(),this.hasAttemptedResolve=!0;const{name:s,type:o,velocity:c,delay:h,onComplete:d,onUpdate:g,isGenerator:_}=this.options;if(!_&&!canAnimate(i,s,o,c))if(h)this.options.duration=0;else{g&&g(getFinalKeyframe(i,this.options,a)),d&&d(),this.resolveFinishedPromise();return}const b=this.initPlayback(i,a);b!==!1&&(this._resolved={keyframes:i,finalKeyframe:a,...b},this.onPostResolved())}onPostResolved(){}then(i,a){return this.currentFinishedPromise.then(i,a)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(i=>{this.resolveFinishedPromise=i})}}const mixNumber$1=(e,i,a)=>e+(i-e)*a;function hueToRgb(e,i,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(i-e)*6*a:a<1/2?i:a<2/3?e+(i-e)*(2/3-a)*6:e}function hslaToRgba({hue:e,saturation:i,lightness:a,alpha:s}){e/=360,i/=100,a/=100;let o=0,c=0,h=0;if(!i)o=c=h=a;else{const d=a<.5?a*(1+i):a+i-a*i,g=2*a-d;o=hueToRgb(g,d,e+1/3),c=hueToRgb(g,d,e),h=hueToRgb(g,d,e-1/3)}return{red:Math.round(o*255),green:Math.round(c*255),blue:Math.round(h*255),alpha:s}}function mixImmediate(e,i){return a=>a>0?i:e}const mixLinearColor=(e,i,a)=>{const s=e*e,o=a*(i*i-s)+s;return o<0?0:Math.sqrt(o)},colorTypes=[hex,rgba,hsla],getColorType=e=>colorTypes.find(i=>i.test(e));function asRGBA(e){const i=getColorType(e);if(!i)return!1;let a=i.parse(e);return i===hsla&&(a=hslaToRgba(a)),a}const mixColor=(e,i)=>{const a=asRGBA(e),s=asRGBA(i);if(!a||!s)return mixImmediate(e,i);const o={...a};return c=>(o.red=mixLinearColor(a.red,s.red,c),o.green=mixLinearColor(a.green,s.green,c),o.blue=mixLinearColor(a.blue,s.blue,c),o.alpha=mixNumber$1(a.alpha,s.alpha,c),rgba.transform(o))},combineFunctions=(e,i)=>a=>i(e(a)),pipe=(...e)=>e.reduce(combineFunctions),invisibleValues=new Set(["none","hidden"]);function mixVisibility(e,i){return invisibleValues.has(e)?a=>a<=0?e:i:a=>a>=1?i:e}function mixNumber(e,i){return a=>mixNumber$1(e,i,a)}function getMixer(e){return typeof e=="number"?mixNumber:typeof e=="string"?isCSSVariableToken(e)?mixImmediate:color.test(e)?mixColor:mixComplex:Array.isArray(e)?mixArray:typeof e=="object"?color.test(e)?mixColor:mixObject:mixImmediate}function mixArray(e,i){const a=[...e],s=a.length,o=e.map((c,h)=>getMixer(c)(c,i[h]));return c=>{for(let h=0;h<s;h++)a[h]=o[h](c);return a}}function mixObject(e,i){const a={...e,...i},s={};for(const o in a)e[o]!==void 0&&i[o]!==void 0&&(s[o]=getMixer(e[o])(e[o],i[o]));return o=>{for(const c in s)a[c]=s[c](o);return a}}function matchOrder(e,i){var a;const s=[],o={color:0,var:0,number:0};for(let c=0;c<i.values.length;c++){const h=i.types[c],d=e.indexes[h][o[h]],g=(a=e.values[d])!==null&&a!==void 0?a:0;s[c]=g,o[h]++}return s}const mixComplex=(e,i)=>{const a=complex.createTransformer(i),s=analyseComplexValue(e),o=analyseComplexValue(i);return s.indexes.var.length===o.indexes.var.length&&s.indexes.color.length===o.indexes.color.length&&s.indexes.number.length>=o.indexes.number.length?invisibleValues.has(e)&&!o.values.length||invisibleValues.has(i)&&!s.values.length?mixVisibility(e,i):pipe(mixArray(matchOrder(s,o),o.values),a):mixImmediate(e,i)};function mix(e,i,a){return typeof e=="number"&&typeof i=="number"&&typeof a=="number"?mixNumber$1(e,i,a):getMixer(e)(e,i)}const velocitySampleDuration=5;function calcGeneratorVelocity(e,i,a){const s=Math.max(i-velocitySampleDuration,0);return velocityPerSecond(a-e(s),i-s)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:e=springDefaults.duration,bounce:i=springDefaults.bounce,velocity:a=springDefaults.velocity,mass:s=springDefaults.mass}){let o,c,h=1-i;h=clamp(springDefaults.minDamping,springDefaults.maxDamping,h),e=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(e)),h<1?(o=_=>{const b=_*h,j=b*e,_e=b-a,et=calcAngularFreq(_,h),rt=Math.exp(-j);return safeMin-_e/et*rt},c=_=>{const j=_*h*e,_e=j*a+a,et=Math.pow(h,2)*Math.pow(_,2)*e,rt=Math.exp(-j),tt=calcAngularFreq(Math.pow(_,2),h);return(-o(_)+safeMin>0?-1:1)*((_e-et)*rt)/tt}):(o=_=>{const b=Math.exp(-_*e),j=(_-a)*e+1;return-safeMin+b*j},c=_=>{const b=Math.exp(-_*e),j=(a-_)*(e*e);return b*j});const d=5/e,g=approximateRoot(o,c,d);if(e=secondsToMilliseconds(e),isNaN(g))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:e};{const _=Math.pow(g,2)*s;return{stiffness:_,damping:h*2*Math.sqrt(s*_),duration:e}}}const rootIterations=12;function approximateRoot(e,i,a){let s=a;for(let o=1;o<rootIterations;o++)s=s-e(s)/i(s);return s}function calcAngularFreq(e,i){return e*Math.sqrt(1-i*i)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(e,i){return i.some(a=>e[a]!==void 0)}function getSpringOptions(e){let i={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...e};if(!isSpringType(e,physicsKeys)&&isSpringType(e,durationKeys))if(e.visualDuration){const a=e.visualDuration,s=2*Math.PI/(a*1.2),o=s*s,c=2*clamp(.05,1,1-(e.bounce||0))*Math.sqrt(o);i={...i,mass:springDefaults.mass,stiffness:o,damping:c}}else{const a=findSpring(e);i={...i,...a,mass:springDefaults.mass},i.isResolvedFromDuration=!0}return i}function spring(e=springDefaults.visualDuration,i=springDefaults.bounce){const a=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:i}:e;let{restSpeed:s,restDelta:o}=a;const c=a.keyframes[0],h=a.keyframes[a.keyframes.length-1],d={done:!1,value:c},{stiffness:g,damping:_,mass:b,duration:j,velocity:_e,isResolvedFromDuration:et}=getSpringOptions({...a,velocity:-millisecondsToSeconds(a.velocity||0)}),rt=_e||0,tt=_/(2*Math.sqrt(g*b)),it=h-c,nt=millisecondsToSeconds(Math.sqrt(g/b)),at=Math.abs(it)<5;s||(s=at?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),o||(o=at?springDefaults.restDelta.granular:springDefaults.restDelta.default);let st;if(tt<1){const lt=calcAngularFreq(nt,tt);st=ut=>{const ot=Math.exp(-tt*nt*ut);return h-ot*((rt+tt*nt*it)/lt*Math.sin(lt*ut)+it*Math.cos(lt*ut))}}else if(tt===1)st=lt=>h-Math.exp(-nt*lt)*(it+(rt+nt*it)*lt);else{const lt=nt*Math.sqrt(tt*tt-1);st=ut=>{const ot=Math.exp(-tt*nt*ut),ft=Math.min(lt*ut,300);return h-ot*((rt+tt*nt*it)*Math.sinh(ft)+lt*it*Math.cosh(ft))/lt}}const dt={calculatedDuration:et&&j||null,next:lt=>{const ut=st(lt);if(et)d.done=lt>=j;else{let ot=0;tt<1&&(ot=lt===0?secondsToMilliseconds(rt):calcGeneratorVelocity(st,lt,ut));const ft=Math.abs(ot)<=s,pt=Math.abs(h-ut)<=o;d.done=ft&&pt}return d.value=d.done?h:ut,d},toString:()=>{const lt=Math.min(calcGeneratorDuration(dt),maxGeneratorDuration),ut=generateLinearEasing(ot=>dt.next(lt*ot).value,lt,30);return lt+"ms "+ut}};return dt}function inertia({keyframes:e,velocity:i=0,power:a=.8,timeConstant:s=325,bounceDamping:o=10,bounceStiffness:c=500,modifyTarget:h,min:d,max:g,restDelta:_=.5,restSpeed:b}){const j=e[0],_e={done:!1,value:j},et=ft=>d!==void 0&&ft<d||g!==void 0&&ft>g,rt=ft=>d===void 0?g:g===void 0||Math.abs(d-ft)<Math.abs(g-ft)?d:g;let tt=a*i;const it=j+tt,nt=h===void 0?it:h(it);nt!==it&&(tt=nt-j);const at=ft=>-tt*Math.exp(-ft/s),st=ft=>nt+at(ft),dt=ft=>{const pt=at(ft),St=st(ft);_e.done=Math.abs(pt)<=_,_e.value=_e.done?nt:St};let lt,ut;const ot=ft=>{et(_e.value)&&(lt=ft,ut=spring({keyframes:[_e.value,rt(_e.value)],velocity:calcGeneratorVelocity(st,ft,_e.value),damping:o,stiffness:c,restDelta:_,restSpeed:b}))};return ot(0),{calculatedDuration:null,next:ft=>{let pt=!1;return!ut&&lt===void 0&&(pt=!0,dt(ft),ot(ft)),lt!==void 0&&ft>=lt?ut.next(ft-lt):(!pt&&dt(ft),_e)}}}const easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=e=>Array.isArray(e)&&typeof e[0]!="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},easingDefinitionToFunction=e=>{if(isBezierDefinition(e)){invariant(e.length===4);const[i,a,s,o]=e;return cubicBezier(i,a,s,o)}else if(typeof e=="string")return easingLookup[e];return e};function createMixers(e,i,a){const s=[],o=a||mix,c=e.length-1;for(let h=0;h<c;h++){let d=o(e[h],e[h+1]);if(i){const g=Array.isArray(i)?i[h]||noop:i;d=pipe(g,d)}s.push(d)}return s}function interpolate(e,i,{clamp:a=!0,ease:s,mixer:o}={}){const c=e.length;if(invariant(c===i.length),c===1)return()=>i[0];if(c===2&&i[0]===i[1])return()=>i[1];const h=e[0]===e[1];e[0]>e[c-1]&&(e=[...e].reverse(),i=[...i].reverse());const d=createMixers(i,s,o),g=d.length,_=b=>{if(h&&b<e[0])return i[0];let j=0;if(g>1)for(;j<e.length-2&&!(b<e[j+1]);j++);const _e=progress(e[j],e[j+1],b);return d[j](_e)};return a?b=>_(clamp(e[0],e[c-1],b)):_}function fillOffset(e,i){const a=e[e.length-1];for(let s=1;s<=i;s++){const o=progress(0,i,s);e.push(mixNumber$1(a,1,o))}}function defaultOffset(e){const i=[0];return fillOffset(i,e.length-1),i}function convertOffsetToTimes(e,i){return e.map(a=>a*i)}function defaultEasing(e,i){return e.map(()=>i||easeInOut).splice(0,e.length-1)}function keyframes({duration:e=300,keyframes:i,times:a,ease:s="easeInOut"}){const o=isEasingArray(s)?s.map(easingDefinitionToFunction):easingDefinitionToFunction(s),c={done:!1,value:i[0]},h=convertOffsetToTimes(a&&a.length===i.length?a:defaultOffset(i),e),d=interpolate(h,i,{ease:Array.isArray(o)?o:defaultEasing(i,o)});return{calculatedDuration:e,next:g=>(c.value=d(g),c.done=g>=e,c)}}const frameloopDriver=e=>{const i=({timestamp:a})=>e(a);return{start:()=>frame.update(i,!0),stop:()=>cancelFrame(i),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generators={decay:inertia,inertia,tween:keyframes,keyframes,spring},percentToProgress=e=>e/100;class MainThreadAnimation extends BaseAnimation{constructor(i){super(i),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:g}=this.options;g&&g()};const{name:a,motionValue:s,element:o,keyframes:c}=this.options,h=(o==null?void 0:o.KeyframeResolver)||KeyframeResolver,d=(g,_)=>this.onKeyframesResolved(g,_);this.resolver=new h(c,d,a,s,o),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(i){const{type:a="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:c,velocity:h=0}=this.options,d=isGenerator(a)?a:generators[a]||keyframes;let g,_;d!==keyframes&&typeof i[0]!="number"&&(g=pipe(percentToProgress,mix(i[0],i[1])),i=[0,100]);const b=d({...this.options,keyframes:i});c==="mirror"&&(_=d({...this.options,keyframes:[...i].reverse(),velocity:-h})),b.calculatedDuration===null&&(b.calculatedDuration=calcGeneratorDuration(b));const{calculatedDuration:j}=b,_e=j+o,et=_e*(s+1)-o;return{generator:b,mirroredGenerator:_,mapPercentToKeyframes:g,calculatedDuration:j,resolvedDuration:_e,totalDuration:et}}onPostResolved(){const{autoplay:i=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!i?this.pause():this.state=this.pendingPlayState}tick(i,a=!1){const{resolved:s}=this;if(!s){const{keyframes:ft}=this.options;return{done:!0,value:ft[ft.length-1]}}const{finalKeyframe:o,generator:c,mirroredGenerator:h,mapPercentToKeyframes:d,keyframes:g,calculatedDuration:_,totalDuration:b,resolvedDuration:j}=s;if(this.startTime===null)return c.next(0);const{delay:_e,repeat:et,repeatType:rt,repeatDelay:tt,onUpdate:it}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,i):this.speed<0&&(this.startTime=Math.min(i-b/this.speed,this.startTime)),a?this.currentTime=i:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(i-this.startTime)*this.speed;const nt=this.currentTime-_e*(this.speed>=0?1:-1),at=this.speed>=0?nt<0:nt>b;this.currentTime=Math.max(nt,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=b);let st=this.currentTime,dt=c;if(et){const ft=Math.min(this.currentTime,b)/j;let pt=Math.floor(ft),St=ft%1;!St&&ft>=1&&(St=1),St===1&&pt--,pt=Math.min(pt,et+1),!!(pt%2)&&(rt==="reverse"?(St=1-St,tt&&(St-=tt/j)):rt==="mirror"&&(dt=h)),st=clamp(0,1,St)*j}const lt=at?{done:!1,value:g[0]}:dt.next(st);d&&(lt.value=d(lt.value));let{done:ut}=lt;!at&&_!==null&&(ut=this.speed>=0?this.currentTime>=b:this.currentTime<=0);const ot=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ut);return ot&&o!==void 0&&(lt.value=getFinalKeyframe(g,this.options,o)),it&&it(lt.value),ot&&this.finish(),lt}get duration(){const{resolved:i}=this;return i?millisecondsToSeconds(i.calculatedDuration):0}get time(){return millisecondsToSeconds(this.currentTime)}set time(i){i=secondsToMilliseconds(i),this.currentTime=i,this.holdTime!==null||this.speed===0?this.holdTime=i:this.driver&&(this.startTime=this.driver.now()-i/this.speed)}get speed(){return this.playbackSpeed}set speed(i){const a=this.playbackSpeed!==i;this.playbackSpeed=i,a&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:i=frameloopDriver,onPlay:a,startTime:s}=this.options;this.driver||(this.driver=i(c=>this.tick(c))),a&&a();const o=this.driver.now();this.holdTime!==null?this.startTime=o-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=o):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var i;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(i=this.currentTime)!==null&&i!==void 0?i:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:i}=this.options;i&&i()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(i){return this.startTime=0,this.tick(i,!0)}}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]);function startWaapiAnimation(e,i,a,{delay:s=0,duration:o=300,repeat:c=0,repeatType:h="loop",ease:d="easeInOut",times:g}={}){const _={[i]:a};g&&(_.offset=g);const b=mapEasingToNativeEasing(d,o);return Array.isArray(b)&&(_.easing=b),e.animate(_,{delay:s,duration:o,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:c+1,direction:h==="reverse"?"alternate":"normal"})}const supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),sampleDelta=10,maxDuration=2e4;function requiresPregeneratedKeyframes(e){return isGenerator(e.type)||e.type==="spring"||!isWaapiSupportedEasing(e.ease)}function pregenerateKeyframes(e,i){const a=new MainThreadAnimation({...i,keyframes:e,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:e[0]};const o=[];let c=0;for(;!s.done&&c<maxDuration;)s=a.sample(c),o.push(s.value),c+=sampleDelta;return{times:void 0,keyframes:o,duration:c-sampleDelta,ease:"linear"}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(e){return e in unsupportedEasingFunctions}class AcceleratedAnimation extends BaseAnimation{constructor(i){super(i);const{name:a,motionValue:s,element:o,keyframes:c}=this.options;this.resolver=new DOMKeyframesResolver(c,(h,d)=>this.onKeyframesResolved(h,d),a,s,o),this.resolver.scheduleResolve()}initPlayback(i,a){let{duration:s=300,times:o,ease:c,type:h,motionValue:d,name:g,startTime:_}=this.options;if(!d.owner||!d.owner.current)return!1;if(typeof c=="string"&&supportsLinearEasing()&&isUnsupportedEase(c)&&(c=unsupportedEasingFunctions[c]),requiresPregeneratedKeyframes(this.options)){const{onComplete:j,onUpdate:_e,motionValue:et,element:rt,...tt}=this.options,it=pregenerateKeyframes(i,tt);i=it.keyframes,i.length===1&&(i[1]=i[0]),s=it.duration,o=it.times,c=it.ease,h="keyframes"}const b=startWaapiAnimation(d.owner.current,g,i,{...this.options,duration:s,times:o,ease:c});return b.startTime=_??this.calcStartTime(),this.pendingTimeline?(attachTimeline(b,this.pendingTimeline),this.pendingTimeline=void 0):b.onfinish=()=>{const{onComplete:j}=this.options;d.set(getFinalKeyframe(i,this.options,a)),j&&j(),this.cancel(),this.resolveFinishedPromise()},{animation:b,duration:s,times:o,type:h,ease:c,keyframes:i}}get duration(){const{resolved:i}=this;if(!i)return 0;const{duration:a}=i;return millisecondsToSeconds(a)}get time(){const{resolved:i}=this;if(!i)return 0;const{animation:a}=i;return millisecondsToSeconds(a.currentTime||0)}set time(i){const{resolved:a}=this;if(!a)return;const{animation:s}=a;s.currentTime=secondsToMilliseconds(i)}get speed(){const{resolved:i}=this;if(!i)return 1;const{animation:a}=i;return a.playbackRate}set speed(i){const{resolved:a}=this;if(!a)return;const{animation:s}=a;s.playbackRate=i}get state(){const{resolved:i}=this;if(!i)return"idle";const{animation:a}=i;return a.playState}get startTime(){const{resolved:i}=this;if(!i)return null;const{animation:a}=i;return a.startTime}attachTimeline(i){if(!this._resolved)this.pendingTimeline=i;else{const{resolved:a}=this;if(!a)return noop;const{animation:s}=a;attachTimeline(s,i)}return noop}play(){if(this.isStopped)return;const{resolved:i}=this;if(!i)return;const{animation:a}=i;a.playState==="finished"&&this.updateFinishedPromise(),a.play()}pause(){const{resolved:i}=this;if(!i)return;const{animation:a}=i;a.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:i}=this;if(!i)return;const{animation:a,keyframes:s,duration:o,type:c,ease:h,times:d}=i;if(a.playState==="idle"||a.playState==="finished")return;if(this.time){const{motionValue:_,onUpdate:b,onComplete:j,element:_e,...et}=this.options,rt=new MainThreadAnimation({...et,keyframes:s,duration:o,type:c,ease:h,times:d,isGenerator:!0}),tt=secondsToMilliseconds(this.time);_.setWithVelocity(rt.sample(tt-sampleDelta).value,rt.sample(tt).value,sampleDelta)}const{onStop:g}=this.options;g&&g(),this.cancel()}complete(){const{resolved:i}=this;i&&i.animation.finish()}cancel(){const{resolved:i}=this;i&&i.animation.cancel()}static supports(i){const{motionValue:a,name:s,repeatDelay:o,repeatType:c,damping:h,type:d}=i;if(!a||!a.owner||!(a.owner.current instanceof HTMLElement))return!1;const{onUpdate:g,transformTemplate:_}=a.owner.getProps();return supportsWaapi()&&s&&acceleratedValues.has(s)&&!g&&!_&&!o&&c!=="mirror"&&h!==0&&d!=="inertia"}}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(e,{keyframes:i})=>i.length>2?keyframesTransition:transformProps.has(e)?e.startsWith("scale")?criticallyDampedSpring(i[1]):underDampedSpring:ease;function isTransitionDefined({when:e,delay:i,delayChildren:a,staggerChildren:s,staggerDirection:o,repeat:c,repeatType:h,repeatDelay:d,from:g,elapsed:_,...b}){return!!Object.keys(b).length}const animateMotionValue=(e,i,a,s={},o,c)=>h=>{const d=getValueTransition(s,e)||{},g=d.delay||s.delay||0;let{elapsed:_=0}=s;_=_-secondsToMilliseconds(g);let b={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:i.getVelocity(),...d,delay:-_,onUpdate:_e=>{i.set(_e),d.onUpdate&&d.onUpdate(_e)},onComplete:()=>{h(),d.onComplete&&d.onComplete()},name:e,motionValue:i,element:c?void 0:o};isTransitionDefined(d)||(b={...b,...getDefaultTransition(e,b)}),b.duration&&(b.duration=secondsToMilliseconds(b.duration)),b.repeatDelay&&(b.repeatDelay=secondsToMilliseconds(b.repeatDelay)),b.from!==void 0&&(b.keyframes[0]=b.from);let j=!1;if((b.type===!1||b.duration===0&&!b.repeatDelay)&&(b.duration=0,b.delay===0&&(j=!0)),j&&!c&&i.get()!==void 0){const _e=getFinalKeyframe(b.keyframes,d);if(_e!==void 0)return frame.update(()=>{b.onUpdate(_e),b.onComplete()}),new GroupPlaybackControls([])}return!c&&AcceleratedAnimation.supports(b)?new AcceleratedAnimation(b):new MainThreadAnimation(b)};function shouldBlockAnimation({protectedKeys:e,needsAnimating:i},a){const s=e.hasOwnProperty(a)&&i[a]!==!0;return i[a]=!1,s}function animateTarget(e,i,{delay:a=0,transitionOverride:s,type:o}={}){var c;let{transition:h=e.getDefaultTransition(),transitionEnd:d,...g}=i;s&&(h=s);const _=[],b=o&&e.animationState&&e.animationState.getState()[o];for(const j in g){const _e=e.getValue(j,(c=e.latestValues[j])!==null&&c!==void 0?c:null),et=g[j];if(et===void 0||b&&shouldBlockAnimation(b,j))continue;const rt={delay:a,...getValueTransition(h||{},j)};let tt=!1;if(window.MotionHandoffAnimation){const nt=getOptimisedAppearId(e);if(nt){const at=window.MotionHandoffAnimation(nt,j,frame);at!==null&&(rt.startTime=at,tt=!0)}}addValueToWillChange(e,j),_e.start(animateMotionValue(j,_e,et,e.shouldReduceMotion&&positionalKeys.has(j)?{type:!1}:rt,e,tt));const it=_e.animation;it&&_.push(it)}return d&&Promise.all(_).then(()=>{frame.update(()=>{d&&setTarget(e,d)})}),_}function animateVariant(e,i,a={}){var s;const o=resolveVariant(e,i,a.type==="exit"?(s=e.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:c=e.getDefaultTransition()||{}}=o||{};a.transitionOverride&&(c=a.transitionOverride);const h=o?()=>Promise.all(animateTarget(e,o,a)):()=>Promise.resolve(),d=e.variantChildren&&e.variantChildren.size?(_=0)=>{const{delayChildren:b=0,staggerChildren:j,staggerDirection:_e}=c;return animateChildren(e,i,b+_,j,_e,a)}:()=>Promise.resolve(),{when:g}=c;if(g){const[_,b]=g==="beforeChildren"?[h,d]:[d,h];return _().then(()=>b())}else return Promise.all([h(),d(a.delay)])}function animateChildren(e,i,a=0,s=0,o=1,c){const h=[],d=(e.variantChildren.size-1)*s,g=o===1?(_=0)=>_*s:(_=0)=>d-_*s;return Array.from(e.variantChildren).sort(sortByTreeOrder).forEach((_,b)=>{_.notify("AnimationStart",i),h.push(animateVariant(_,i,{...c,delay:a+g(b)}).then(()=>_.notify("AnimationComplete",i)))}),Promise.all(h)}function sortByTreeOrder(e,i){return e.sortNodePosition(i)}function animateVisualElement(e,i,a={}){e.notify("AnimationStart",i);let s;if(Array.isArray(i)){const o=i.map(c=>animateVariant(e,c,a));s=Promise.all(o)}else if(typeof i=="string")s=animateVariant(e,i,a);else{const o=typeof i=="function"?resolveVariant(e,i,a.custom):i;s=Promise.all(animateTarget(e,o,a))}return s.then(()=>{e.notify("AnimationComplete",i)})}const numVariantProps=variantProps.length;function getVariantContext(e){if(!e)return;if(!e.isControllingVariants){const a=e.parent?getVariantContext(e.parent)||{}:{};return e.props.initial!==void 0&&(a.initial=e.props.initial),a}const i={};for(let a=0;a<numVariantProps;a++){const s=variantProps[a],o=e.props[s];(isVariantLabel(o)||o===!1)&&(i[s]=o)}return i}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(e){return i=>Promise.all(i.map(({animation:a,options:s})=>animateVisualElement(e,a,s)))}function createAnimationState(e){let i=animateList(e),a=createState(),s=!0;const o=g=>(_,b)=>{var j;const _e=resolveVariant(e,b,g==="exit"?(j=e.presenceContext)===null||j===void 0?void 0:j.custom:void 0);if(_e){const{transition:et,transitionEnd:rt,...tt}=_e;_={..._,...tt,...rt}}return _};function c(g){i=g(e)}function h(g){const{props:_}=e,b=getVariantContext(e.parent)||{},j=[],_e=new Set;let et={},rt=1/0;for(let it=0;it<numAnimationTypes;it++){const nt=reversePriorityOrder[it],at=a[nt],st=_[nt]!==void 0?_[nt]:b[nt],dt=isVariantLabel(st),lt=nt===g?at.isActive:null;lt===!1&&(rt=it);let ut=st===b[nt]&&st!==_[nt]&&dt;if(ut&&s&&e.manuallyAnimateOnMount&&(ut=!1),at.protectedKeys={...et},!at.isActive&&lt===null||!st&&!at.prevProp||isAnimationControls(st)||typeof st=="boolean")continue;const ot=checkVariantsDidChange(at.prevProp,st);let ft=ot||nt===g&&at.isActive&&!ut&&dt||it>rt&&dt,pt=!1;const St=Array.isArray(st)?st:[st];let gt=St.reduce(o(nt),{});lt===!1&&(gt={});const{prevResolvedValues:vt={}}=at,At={...vt,...gt},Gt=It=>{ft=!0,_e.has(It)&&(pt=!0,_e.delete(It)),at.needsAnimating[It]=!0;const Wt=e.getValue(It);Wt&&(Wt.liveStyle=!1)};for(const It in At){const Wt=gt[It],yt=vt[It];if(et.hasOwnProperty(It))continue;let Dt=!1;isKeyframesTarget(Wt)&&isKeyframesTarget(yt)?Dt=!shallowCompare(Wt,yt):Dt=Wt!==yt,Dt?Wt!=null?Gt(It):_e.add(It):Wt!==void 0&&_e.has(It)?Gt(It):at.protectedKeys[It]=!0}at.prevProp=st,at.prevResolvedValues=gt,at.isActive&&(et={...et,...gt}),s&&e.blockInitialAnimation&&(ft=!1),ft&&(!(ut&&ot)||pt)&&j.push(...St.map(It=>({animation:It,options:{type:nt}})))}if(_e.size){const it={};_e.forEach(nt=>{const at=e.getBaseTarget(nt),st=e.getValue(nt);st&&(st.liveStyle=!0),it[nt]=at??null}),j.push({animation:it})}let tt=!!j.length;return s&&(_.initial===!1||_.initial===_.animate)&&!e.manuallyAnimateOnMount&&(tt=!1),s=!1,tt?i(j):Promise.resolve()}function d(g,_){var b;if(a[g].isActive===_)return Promise.resolve();(b=e.variantChildren)===null||b===void 0||b.forEach(_e=>{var et;return(et=_e.animationState)===null||et===void 0?void 0:et.setActive(g,_)}),a[g].isActive=_;const j=h(g);for(const _e in a)a[_e].protectedKeys={};return j}return{animateChanges:h,setActive:d,setAnimateFunction:c,getState:()=>a,reset:()=>{a=createState(),s=!0}}}function checkVariantsDidChange(e,i){return typeof i=="string"?i!==e:Array.isArray(i)?!shallowCompare(i,e):!1}function createTypeState(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(i){this.isMounted=!1,this.node=i}update(){}}class AnimationFeature extends Feature{constructor(i){super(i),i.animationState||(i.animationState=createAnimationState(i))}updateAnimationControlsSubscription(){const{animate:i}=this.node.getProps();isAnimationControls(i)&&(this.unmountControls=i.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:i}=this.node.getProps(),{animate:a}=this.node.prevProps||{};i!==a&&this.updateAnimationControlsSubscription()}unmount(){var i;this.node.animationState.reset(),(i=this.unmountControls)===null||i===void 0||i.call(this)}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:i,onExitComplete:a}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||i===s)return;const o=this.node.animationState.setActive("exit",!i);a&&!i&&o.then(()=>a(this.id))}mount(){const{register:i}=this.node.presenceContext||{};i&&(this.unmount=i(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(e,i,a,s={passive:!0}){return e.addEventListener(i,a,s),()=>e.removeEventListener(i,a)}function extractEventInfo(e){return{point:{x:e.pageX,y:e.pageY}}}const addPointerInfo=e=>i=>isPrimaryPointer(i)&&e(i,extractEventInfo(i));function addPointerEvent(e,i,a,s){return addDomEvent(e,i,addPointerInfo(a),s)}const distance=(e,i)=>Math.abs(e-i);function distance2D(e,i){const a=distance(e.x,i.x),s=distance(e.y,i.y);return Math.sqrt(a**2+s**2)}class PanSession{constructor(i,a,{transformPagePoint:s,contextWindow:o,dragSnapToOrigin:c=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=getPanInfo(this.lastMoveEventInfo,this.history),_e=this.startEvent!==null,et=distance2D(j.offset,{x:0,y:0})>=3;if(!_e&&!et)return;const{point:rt}=j,{timestamp:tt}=frameData;this.history.push({...rt,timestamp:tt});const{onStart:it,onMove:nt}=this.handlers;_e||(it&&it(this.lastMoveEvent,j),this.startEvent=this.lastMoveEvent),nt&&nt(this.lastMoveEvent,j)},this.handlePointerMove=(j,_e)=>{this.lastMoveEvent=j,this.lastMoveEventInfo=transformPoint(_e,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(j,_e)=>{this.end();const{onEnd:et,onSessionEnd:rt,resumeAnimation:tt}=this.handlers;if(this.dragSnapToOrigin&&tt&&tt(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const it=getPanInfo(j.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(_e,this.transformPagePoint),this.history);this.startEvent&&et&&et(j,it),rt&&rt(j,it)},!isPrimaryPointer(i))return;this.dragSnapToOrigin=c,this.handlers=a,this.transformPagePoint=s,this.contextWindow=o||window;const h=extractEventInfo(i),d=transformPoint(h,this.transformPagePoint),{point:g}=d,{timestamp:_}=frameData;this.history=[{...g,timestamp:_}];const{onSessionStart:b}=a;b&&b(i,getPanInfo(d,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(i){this.handlers=i}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(e,i){return i?{point:i(e.point)}:e}function subtractPoint(e,i){return{x:e.x-i.x,y:e.y-i.y}}function getPanInfo({point:e},i){return{point:e,delta:subtractPoint(e,lastDevicePoint(i)),offset:subtractPoint(e,startDevicePoint(i)),velocity:getVelocity(i,.1)}}function startDevicePoint(e){return e[0]}function lastDevicePoint(e){return e[e.length-1]}function getVelocity(e,i){if(e.length<2)return{x:0,y:0};let a=e.length-1,s=null;const o=lastDevicePoint(e);for(;a>=0&&(s=e[a],!(o.timestamp-s.timestamp>secondsToMilliseconds(i)));)a--;if(!s)return{x:0,y:0};const c=millisecondsToSeconds(o.timestamp-s.timestamp);if(c===0)return{x:0,y:0};const h={x:(o.x-s.x)/c,y:(o.y-s.y)/c};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(e){return e.max-e.min}function isNear(e,i,a){return Math.abs(e-i)<=a}function calcAxisDelta(e,i,a,s=.5){e.origin=s,e.originPoint=mixNumber$1(i.min,i.max,e.origin),e.scale=calcLength(a)/calcLength(i),e.translate=mixNumber$1(a.min,a.max,e.origin)-e.originPoint,(e.scale>=SCALE_MIN&&e.scale<=SCALE_MAX||isNaN(e.scale))&&(e.scale=1),(e.translate>=TRANSLATE_MIN&&e.translate<=TRANSLATE_MAX||isNaN(e.translate))&&(e.translate=0)}function calcBoxDelta(e,i,a,s){calcAxisDelta(e.x,i.x,a.x,s?s.originX:void 0),calcAxisDelta(e.y,i.y,a.y,s?s.originY:void 0)}function calcRelativeAxis(e,i,a){e.min=a.min+i.min,e.max=e.min+calcLength(i)}function calcRelativeBox(e,i,a){calcRelativeAxis(e.x,i.x,a.x),calcRelativeAxis(e.y,i.y,a.y)}function calcRelativeAxisPosition(e,i,a){e.min=i.min-a.min,e.max=e.min+calcLength(i)}function calcRelativePosition(e,i,a){calcRelativeAxisPosition(e.x,i.x,a.x),calcRelativeAxisPosition(e.y,i.y,a.y)}function applyConstraints(e,{min:i,max:a},s){return i!==void 0&&e<i?e=s?mixNumber$1(i,e,s.min):Math.max(e,i):a!==void 0&&e>a&&(e=s?mixNumber$1(a,e,s.max):Math.min(e,a)),e}function calcRelativeAxisConstraints(e,i,a){return{min:i!==void 0?e.min+i:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function calcRelativeConstraints(e,{top:i,left:a,bottom:s,right:o}){return{x:calcRelativeAxisConstraints(e.x,a,o),y:calcRelativeAxisConstraints(e.y,i,s)}}function calcViewportAxisConstraints(e,i){let a=i.min-e.min,s=i.max-e.max;return i.max-i.min<e.max-e.min&&([a,s]=[s,a]),{min:a,max:s}}function calcViewportConstraints(e,i){return{x:calcViewportAxisConstraints(e.x,i.x),y:calcViewportAxisConstraints(e.y,i.y)}}function calcOrigin(e,i){let a=.5;const s=calcLength(e),o=calcLength(i);return o>s?a=progress(i.min,i.max-s,e.min):s>o&&(a=progress(e.min,e.max-o,i.min)),clamp(0,1,a)}function rebaseAxisConstraints(e,i){const a={};return i.min!==void 0&&(a.min=i.min-e.min),i.max!==void 0&&(a.max=i.max-e.min),a}const defaultElastic=.35;function resolveDragElastic(e=defaultElastic){return e===!1?e=0:e===!0&&(e=defaultElastic),{x:resolveAxisElastic(e,"left","right"),y:resolveAxisElastic(e,"top","bottom")}}function resolveAxisElastic(e,i,a){return{min:resolvePointElastic(e,i),max:resolvePointElastic(e,a)}}function resolvePointElastic(e,i){return typeof e=="number"?e:e[i]||0}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(e){return[e("x"),e("y")]}function convertBoundingBoxToBox({top:e,left:i,right:a,bottom:s}){return{x:{min:i,max:a},y:{min:e,max:s}}}function convertBoxToBoundingBox({x:e,y:i}){return{top:i.min,right:e.max,bottom:i.max,left:e.min}}function transformBoxPoints(e,i){if(!i)return e;const a=i({x:e.left,y:e.top}),s=i({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:s.y,right:s.x}}function isIdentityScale(e){return e===void 0||e===1}function hasScale({scale:e,scaleX:i,scaleY:a}){return!isIdentityScale(e)||!isIdentityScale(i)||!isIdentityScale(a)}function hasTransform(e){return hasScale(e)||has2DTranslate(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function has2DTranslate(e){return is2DTranslate(e.x)||is2DTranslate(e.y)}function is2DTranslate(e){return e&&e!=="0%"}function scalePoint(e,i,a){const s=e-a,o=i*s;return a+o}function applyPointDelta(e,i,a,s,o){return o!==void 0&&(e=scalePoint(e,o,s)),scalePoint(e,a,s)+i}function applyAxisDelta(e,i=0,a=1,s,o){e.min=applyPointDelta(e.min,i,a,s,o),e.max=applyPointDelta(e.max,i,a,s,o)}function applyBoxDelta(e,{x:i,y:a}){applyAxisDelta(e.x,i.translate,i.scale,i.originPoint),applyAxisDelta(e.y,a.translate,a.scale,a.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(e,i,a,s=!1){const o=a.length;if(!o)return;i.x=i.y=1;let c,h;for(let d=0;d<o;d++){c=a[d],h=c.projectionDelta;const{visualElement:g}=c.options;g&&g.props.style&&g.props.style.display==="contents"||(s&&c.options.layoutScroll&&c.scroll&&c!==c.root&&transformBox(e,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),h&&(i.x*=h.x.scale,i.y*=h.y.scale,applyBoxDelta(e,h)),s&&hasTransform(c.latestValues)&&transformBox(e,c.latestValues))}i.x<TREE_SCALE_SNAP_MAX&&i.x>TREE_SCALE_SNAP_MIN&&(i.x=1),i.y<TREE_SCALE_SNAP_MAX&&i.y>TREE_SCALE_SNAP_MIN&&(i.y=1)}function translateAxis(e,i){e.min=e.min+i,e.max=e.max+i}function transformAxis(e,i,a,s,o=.5){const c=mixNumber$1(e.min,e.max,o);applyAxisDelta(e,i,a,c,s)}function transformBox(e,i){transformAxis(e.x,i.x,i.scaleX,i.scale,i.originX),transformAxis(e.y,i.y,i.scaleY,i.scale,i.originY)}function measureViewportBox(e,i){return convertBoundingBoxToBox(transformBoxPoints(e.getBoundingClientRect(),i))}function measurePageBox(e,i,a){const s=measureViewportBox(e,a),{scroll:o}=i;return o&&(translateAxis(s.x,o.offset.x),translateAxis(s.y,o.offset.y)),s}const getContextWindow=({current:e})=>e?e.ownerDocument.defaultView:null,elementDragControls=new WeakMap;class VisualElementDragControls{constructor(i){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=i}start(i,{snapToCursor:a=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const o=b=>{const{dragSnapToOrigin:j}=this.getProps();j?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(extractEventInfo(b).point)},c=(b,j)=>{const{drag:_e,dragPropagation:et,onDragStart:rt}=this.getProps();if(_e&&!et&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(_e),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(it=>{let nt=this.getAxisMotionValue(it).get()||0;if(percent.test(nt)){const{projection:at}=this.visualElement;if(at&&at.layout){const st=at.layout.layoutBox[it];st&&(nt=calcLength(st)*(parseFloat(nt)/100))}}this.originPoint[it]=nt}),rt&&frame.postRender(()=>rt(b,j)),addValueToWillChange(this.visualElement,"transform");const{animationState:tt}=this.visualElement;tt&&tt.setActive("whileDrag",!0)},h=(b,j)=>{const{dragPropagation:_e,dragDirectionLock:et,onDirectionLock:rt,onDrag:tt}=this.getProps();if(!_e&&!this.openDragLock)return;const{offset:it}=j;if(et&&this.currentDirection===null){this.currentDirection=getCurrentDirection(it),this.currentDirection!==null&&rt&&rt(this.currentDirection);return}this.updateAxis("x",j.point,it),this.updateAxis("y",j.point,it),this.visualElement.render(),tt&&tt(b,j)},d=(b,j)=>this.stop(b,j),g=()=>eachAxis(b=>{var j;return this.getAnimationState(b)==="paused"&&((j=this.getAxisMotionValue(b).animation)===null||j===void 0?void 0:j.play())}),{dragSnapToOrigin:_}=this.getProps();this.panSession=new PanSession(i,{onSessionStart:o,onStart:c,onMove:h,onSessionEnd:d,resumeAnimation:g},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:_,contextWindow:getContextWindow(this.visualElement)})}stop(i,a){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:o}=a;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&frame.postRender(()=>c(i,a))}cancel(){this.isDragging=!1;const{projection:i,animationState:a}=this.visualElement;i&&(i.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(i,a,s){const{drag:o}=this.getProps();if(!s||!shouldDrag(i,o,this.currentDirection))return;const c=this.getAxisMotionValue(i);let h=this.originPoint[i]+s[i];this.constraints&&this.constraints[i]&&(h=applyConstraints(h,this.constraints[i],this.elastic[i])),c.set(h)}resolveConstraints(){var i;const{dragConstraints:a,dragElastic:s}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)===null||i===void 0?void 0:i.layout,c=this.constraints;a&&isRefObject(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&o?this.constraints=calcRelativeConstraints(o.layoutBox,a):this.constraints=!1,this.elastic=resolveDragElastic(s),c!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(h=>{this.constraints!==!1&&this.getAxisMotionValue(h)&&(this.constraints[h]=rebaseAxisConstraints(o.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:i,onMeasureDragConstraints:a}=this.getProps();if(!i||!isRefObject(i))return!1;const s=i.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const c=measurePageBox(s,o.root,this.visualElement.getTransformPagePoint());let h=calcViewportConstraints(o.layout.layoutBox,c);if(a){const d=a(convertBoxToBoundingBox(h));this.hasMutatedConstraints=!!d,d&&(h=convertBoundingBoxToBox(d))}return h}startAnimation(i){const{drag:a,dragMomentum:s,dragElastic:o,dragTransition:c,dragSnapToOrigin:h,onDragTransitionEnd:d}=this.getProps(),g=this.constraints||{},_=eachAxis(b=>{if(!shouldDrag(b,a,this.currentDirection))return;let j=g&&g[b]||{};h&&(j={min:0,max:0});const _e=o?200:1e6,et=o?40:1e7,rt={type:"inertia",velocity:s?i[b]:0,bounceStiffness:_e,bounceDamping:et,timeConstant:750,restDelta:1,restSpeed:10,...c,...j};return this.startAxisValueAnimation(b,rt)});return Promise.all(_).then(d)}startAxisValueAnimation(i,a){const s=this.getAxisMotionValue(i);return addValueToWillChange(this.visualElement,i),s.start(animateMotionValue(i,s,0,a,this.visualElement,!1))}stopAnimation(){eachAxis(i=>this.getAxisMotionValue(i).stop())}pauseAnimation(){eachAxis(i=>{var a;return(a=this.getAxisMotionValue(i).animation)===null||a===void 0?void 0:a.pause()})}getAnimationState(i){var a;return(a=this.getAxisMotionValue(i).animation)===null||a===void 0?void 0:a.state}getAxisMotionValue(i){const a=`_drag${i.toUpperCase()}`,s=this.visualElement.getProps(),o=s[a];return o||this.visualElement.getValue(i,(s.initial?s.initial[i]:void 0)||0)}snapToCursor(i){eachAxis(a=>{const{drag:s}=this.getProps();if(!shouldDrag(a,s,this.currentDirection))return;const{projection:o}=this.visualElement,c=this.getAxisMotionValue(a);if(o&&o.layout){const{min:h,max:d}=o.layout.layoutBox[a];c.set(i[a]-mixNumber$1(h,d,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:i,dragConstraints:a}=this.getProps(),{projection:s}=this.visualElement;if(!isRefObject(a)||!s||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};eachAxis(h=>{const d=this.getAxisMotionValue(h);if(d&&this.constraints!==!1){const g=d.get();o[h]=calcOrigin({min:g,max:g},this.constraints[h])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),eachAxis(h=>{if(!shouldDrag(h,i,null))return;const d=this.getAxisMotionValue(h),{min:g,max:_}=this.constraints[h];d.set(mixNumber$1(g,_,o[h]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const i=this.visualElement.current,a=addPointerEvent(i,"pointerdown",g=>{const{drag:_,dragListener:b=!0}=this.getProps();_&&b&&this.start(g)}),s=()=>{const{dragConstraints:g}=this.getProps();isRefObject(g)&&g.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,c=o.addEventListener("measure",s);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),frame.read(s);const h=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),d=o.addEventListener("didUpdate",({delta:g,hasLayoutChanged:_})=>{this.isDragging&&_&&(eachAxis(b=>{const j=this.getAxisMotionValue(b);j&&(this.originPoint[b]+=g[b].translate,j.set(j.get()+g[b].translate))}),this.visualElement.render())});return()=>{h(),a(),c(),d&&d()}}getProps(){const i=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:s=!1,dragPropagation:o=!1,dragConstraints:c=!1,dragElastic:h=defaultElastic,dragMomentum:d=!0}=i;return{...i,drag:a,dragDirectionLock:s,dragPropagation:o,dragConstraints:c,dragElastic:h,dragMomentum:d}}}function shouldDrag(e,i,a){return(i===!0||i===e)&&(a===null||a===e)}function getCurrentDirection(e,i=10){let a=null;return Math.abs(e.y)>i?a="y":Math.abs(e.x)>i&&(a="x"),a}class DragGesture extends Feature{constructor(i){super(i),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(i)}mount(){const{dragControls:i}=this.node.getProps();i&&(this.removeGroupControls=i.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=e=>(i,a)=>{e&&frame.postRender(()=>e(i,a))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(i){this.session=new PanSession(i,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:i,onPanStart:a,onPan:s,onPanEnd:o}=this.node.getProps();return{onSessionStart:asyncHandler(i),onStart:asyncHandler(a),onMove:s,onEnd:(c,h)=>{delete this.session,o&&frame.postRender(()=>o(c,h))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",i=>this.onPointerDown(i))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(e,i){return i.max===i.min?0:e/(i.max-i.min)*100}const correctBorderRadius={correct:(e,i)=>{if(!i.target)return e;if(typeof e=="string")if(px.test(e))e=parseFloat(e);else return e;const a=pixelsToPercent(e,i.target.x),s=pixelsToPercent(e,i.target.y);return`${a}% ${s}%`}},correctBoxShadow={correct:(e,{treeScale:i,projectionDelta:a})=>{const s=e,o=complex.parse(e);if(o.length>5)return s;const c=complex.createTransformer(e),h=typeof o[0]!="number"?1:0,d=a.x.scale*i.x,g=a.y.scale*i.y;o[0+h]/=d,o[1+h]/=g;const _=mixNumber$1(d,g,.5);return typeof o[2+h]=="number"&&(o[2+h]/=_),typeof o[3+h]=="number"&&(o[3+h]/=_),c(o)}};class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:i,layoutGroup:a,switchLayoutGroup:s,layoutId:o}=this.props,{projection:c}=i;addScaleCorrector(defaultScaleCorrectors),c&&(a.group&&a.group.add(c),s&&s.register&&o&&s.register(c),c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(i){const{layoutDependency:a,visualElement:s,drag:o,isPresent:c}=this.props,h=s.projection;return h&&(h.isPresent=c,o||i.layoutDependency!==a||a===void 0?h.willUpdate():this.safeToRemove(),i.isPresent!==c&&(c?h.promote():h.relegate()||frame.postRender(()=>{const d=h.getStack();(!d||!d.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:i}=this.props.visualElement;i&&(i.root.didUpdate(),microtask.postRender(()=>{!i.currentAnimation&&i.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:i,layoutGroup:a,switchLayoutGroup:s}=this.props,{projection:o}=i;o&&(o.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(o),s&&s.deregister&&s.deregister(o))}safeToRemove(){const{safeToRemove:i}=this.props;i&&i()}render(){return null}}function MeasureLayout(e){const[i,a]=usePresence(),s=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...e,layoutGroup:s,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:i,safeToRemove:a})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(e,i,a){const s=isMotionValue(e)?e:motionValue(e);return s.start(animateMotionValue("",s,i,a)),s.animation}function isSVGElement(e){return e instanceof SVGElement&&e.tagName!=="svg"}const compareByDepth=(e,i)=>e.depth-i.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(i){addUniqueItem(this.children,i),this.isDirty=!0}remove(i){removeItem(this.children,i),this.isDirty=!0}forEach(i){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(i)}}function delay(e,i){const a=time.now(),s=({timestamp:o})=>{const c=o-a;c>=i&&(cancelFrame(s),e(c-i))};return frame.read(s,!0),()=>cancelFrame(s)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=e=>typeof e=="string"?parseFloat(e):e,isPx=e=>typeof e=="number"||px.test(e);function mixValues(e,i,a,s,o,c){o?(e.opacity=mixNumber$1(0,a.opacity!==void 0?a.opacity:1,easeCrossfadeIn(s)),e.opacityExit=mixNumber$1(i.opacity!==void 0?i.opacity:1,0,easeCrossfadeOut(s))):c&&(e.opacity=mixNumber$1(i.opacity!==void 0?i.opacity:1,a.opacity!==void 0?a.opacity:1,s));for(let h=0;h<numBorders;h++){const d=`border${borders[h]}Radius`;let g=getRadius(i,d),_=getRadius(a,d);if(g===void 0&&_===void 0)continue;g||(g=0),_||(_=0),g===0||_===0||isPx(g)===isPx(_)?(e[d]=Math.max(mixNumber$1(asNumber(g),asNumber(_),s),0),(percent.test(_)||percent.test(g))&&(e[d]+="%")):e[d]=_}(i.rotate||a.rotate)&&(e.rotate=mixNumber$1(i.rotate||0,a.rotate||0,s))}function getRadius(e,i){return e[i]!==void 0?e[i]:e.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(e,i,a){return s=>s<e?0:s>i?1:a(progress(e,i,s))}function copyAxisInto(e,i){e.min=i.min,e.max=i.max}function copyBoxInto(e,i){copyAxisInto(e.x,i.x),copyAxisInto(e.y,i.y)}function copyAxisDeltaInto(e,i){e.translate=i.translate,e.scale=i.scale,e.originPoint=i.originPoint,e.origin=i.origin}function removePointDelta(e,i,a,s,o){return e-=i,e=scalePoint(e,1/a,s),o!==void 0&&(e=scalePoint(e,1/o,s)),e}function removeAxisDelta(e,i=0,a=1,s=.5,o,c=e,h=e){if(percent.test(i)&&(i=parseFloat(i),i=mixNumber$1(h.min,h.max,i/100)-h.min),typeof i!="number")return;let d=mixNumber$1(c.min,c.max,s);e===c&&(d-=i),e.min=removePointDelta(e.min,i,a,d,o),e.max=removePointDelta(e.max,i,a,d,o)}function removeAxisTransforms(e,i,[a,s,o],c,h){removeAxisDelta(e,i[a],i[s],i[o],i.scale,c,h)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(e,i,a,s){removeAxisTransforms(e.x,i,xKeys,a?a.x:void 0,s?s.x:void 0),removeAxisTransforms(e.y,i,yKeys,a?a.y:void 0,s?s.y:void 0)}function isAxisDeltaZero(e){return e.translate===0&&e.scale===1}function isDeltaZero(e){return isAxisDeltaZero(e.x)&&isAxisDeltaZero(e.y)}function axisEquals(e,i){return e.min===i.min&&e.max===i.max}function boxEquals(e,i){return axisEquals(e.x,i.x)&&axisEquals(e.y,i.y)}function axisEqualsRounded(e,i){return Math.round(e.min)===Math.round(i.min)&&Math.round(e.max)===Math.round(i.max)}function boxEqualsRounded(e,i){return axisEqualsRounded(e.x,i.x)&&axisEqualsRounded(e.y,i.y)}function aspectRatio(e){return calcLength(e.x)/calcLength(e.y)}function axisDeltaEquals(e,i){return e.translate===i.translate&&e.scale===i.scale&&e.originPoint===i.originPoint}class NodeStack{constructor(){this.members=[]}add(i){addUniqueItem(this.members,i),i.scheduleRender()}remove(i){if(removeItem(this.members,i),i===this.prevLead&&(this.prevLead=void 0),i===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(i){const a=this.members.findIndex(o=>i===o);if(a===0)return!1;let s;for(let o=a;o>=0;o--){const c=this.members[o];if(c.isPresent!==!1){s=c;break}}return s?(this.promote(s),!0):!1}promote(i,a){const s=this.lead;if(i!==s&&(this.prevLead=s,this.lead=i,i.show(),s)){s.instance&&s.scheduleRender(),i.scheduleRender(),i.resumeFrom=s,a&&(i.resumeFrom.preserveOpacity=!0),s.snapshot&&(i.snapshot=s.snapshot,i.snapshot.latestValues=s.animationValues||s.latestValues),i.root&&i.root.isUpdating&&(i.isLayoutDirty=!0);const{crossfade:o}=i.options;o===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(i=>{const{options:a,resumingFrom:s}=i;a.onExitComplete&&a.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(i=>{i.instance&&i.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(e,i,a){let s="";const o=e.x.translate/i.x,c=e.y.translate/i.y,h=(a==null?void 0:a.z)||0;if((o||c||h)&&(s=`translate3d(${o}px, ${c}px, ${h}px) `),(i.x!==1||i.y!==1)&&(s+=`scale(${1/i.x}, ${1/i.y}) `),a){const{transformPerspective:_,rotate:b,rotateX:j,rotateY:_e,skewX:et,skewY:rt}=a;_&&(s=`perspective(${_}px) ${s}`),b&&(s+=`rotate(${b}deg) `),j&&(s+=`rotateX(${j}deg) `),_e&&(s+=`rotateY(${_e}deg) `),et&&(s+=`skewX(${et}deg) `),rt&&(s+=`skewY(${rt}deg) `)}const d=e.x.scale*i.x,g=e.y.scale*i.y;return(d!==1||g!==1)&&(s+=`scale(${d}, ${g})`),s||"none"}const metrics={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},isDebug=typeof window<"u"&&window.MotionDebug!==void 0,transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id=0;function resetDistortingTransform(e,i,a,s){const{latestValues:o}=i;o[e]&&(a[e]=o[e],i.setStaticValue(e,0),s&&(s[e]=0))}function cancelTreeOptimisedTransformAnimations(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:i}=e.options;if(!i)return;const a=getOptimisedAppearId(i);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:o,layoutId:c}=e.options;window.MotionCancelOptimisedAnimation(a,"transform",frame,!(o||c))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(s)}function createProjectionNode({attachResizeListener:e,defaultParent:i,measureScroll:a,checkIsScrollRoot:s,resetTransform:o}){return class{constructor(h={},d=i==null?void 0:i()){this.id=id++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,isDebug&&(metrics.totalNodes=metrics.resolvedTargetDeltas=metrics.recalculatedProjection=0),this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),isDebug&&window.MotionDebug.record(metrics)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=d?d.root||d:this,this.path=d?[...d.path,d]:[],this.parent=d,this.depth=d?d.depth+1:0;for(let g=0;g<this.path.length;g++)this.path[g].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(h,d){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new SubscriptionManager),this.eventHandlers.get(h).add(d)}notifyListeners(h,...d){const g=this.eventHandlers.get(h);g&&g.notify(...d)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,d=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=isSVGElement(h),this.instance=h;const{layoutId:g,layout:_,visualElement:b}=this.options;if(b&&!b.current&&b.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),d&&(_||g)&&(this.isLayoutDirty=!0),e){let j;const _e=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,j&&j(),j=delay(_e,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}g&&this.root.registerSharedNode(g,this),this.options.animate!==!1&&b&&(g||_)&&this.addEventListener("didUpdate",({delta:j,hasLayoutChanged:_e,hasRelativeTargetChanged:et,layout:rt})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const tt=this.options.transition||b.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:it,onLayoutAnimationComplete:nt}=b.getProps(),at=!this.targetLayout||!boxEqualsRounded(this.targetLayout,rt)||et,st=!_e&&et;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||st||_e&&(at||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(j,st);const dt={...getValueTransition(tt,"layout"),onPlay:it,onComplete:nt};(b.shouldReduceMotion||this.options.layoutRoot)&&(dt.delay=0,dt.type=!1),this.startAnimation(dt)}else _e||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=rt})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let b=0;b<this.path.length;b++){const j=this.path[b];j.shouldResetTransform=!0,j.updateScroll("snapshot"),j.options.layoutRoot&&j.willUpdate(!1)}const{layoutId:d,layout:g}=this.options;if(d===void 0&&!g)return;const _=this.getTransformTemplate();this.prevTransformTemplateValue=_?_(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const d=time.now();frameData.delta=clamp(0,1e3/60,d-frameData.timestamp),frameData.timestamp=d,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let g=0;g<this.path.length;g++)this.path[g].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:d}=this.options;d&&d.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let d=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(d=!1),d){const g=s(this.instance);this.scroll={animationId:this.root.animationId,phase:h,isRoot:g,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:g}}}resetTransform(){if(!o)return;const h=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,d=this.projectionDelta&&!isDeltaZero(this.projectionDelta),g=this.getTransformTemplate(),_=g?g(this.latestValues,""):void 0,b=_!==this.prevTransformTemplateValue;h&&(d||hasTransform(this.latestValues)||b)&&(o(this.instance,_),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const d=this.measurePageBox();let g=this.removeElementScroll(d);return h&&(g=this.removeTransform(g)),roundBox(g),{animationId:this.root.animationId,measuredBox:d,layoutBox:g,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:d}=this.options;if(!d)return createBox();const g=d.measureViewportBox();if(!(((h=this.scroll)===null||h===void 0?void 0:h.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:b}=this.root;b&&(translateAxis(g.x,b.offset.x),translateAxis(g.y,b.offset.y))}return g}removeElementScroll(h){var d;const g=createBox();if(copyBoxInto(g,h),!((d=this.scroll)===null||d===void 0)&&d.wasRoot)return g;for(let _=0;_<this.path.length;_++){const b=this.path[_],{scroll:j,options:_e}=b;b!==this.root&&j&&_e.layoutScroll&&(j.wasRoot&&copyBoxInto(g,h),translateAxis(g.x,j.offset.x),translateAxis(g.y,j.offset.y))}return g}applyTransform(h,d=!1){const g=createBox();copyBoxInto(g,h);for(let _=0;_<this.path.length;_++){const b=this.path[_];!d&&b.options.layoutScroll&&b.scroll&&b!==b.root&&transformBox(g,{x:-b.scroll.offset.x,y:-b.scroll.offset.y}),hasTransform(b.latestValues)&&transformBox(g,b.latestValues)}return hasTransform(this.latestValues)&&transformBox(g,this.latestValues),g}removeTransform(h){const d=createBox();copyBoxInto(d,h);for(let g=0;g<this.path.length;g++){const _=this.path[g];if(!_.instance||!hasTransform(_.latestValues))continue;hasScale(_.latestValues)&&_.updateSnapshot();const b=createBox(),j=_.measurePageBox();copyBoxInto(b,j),removeBoxTransforms(d,_.latestValues,_.snapshot?_.snapshot.layoutBox:void 0,b)}return hasTransform(this.latestValues)&&removeBoxTransforms(d,this.latestValues),d}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var d;const g=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=g.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=g.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=g.isSharedProjectionDirty);const _=!!this.resumingFrom||this!==g;if(!(h||_&&this.isSharedProjectionDirty||this.isProjectionDirty||!((d=this.parent)===null||d===void 0)&&d.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:j,layoutId:_e}=this.options;if(!(!this.layout||!(j||_e))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const et=this.getClosestProjectingParent();et&&et.layout&&this.animationProgress!==1?(this.relativeParent=et,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,et.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const et=this.getClosestProjectingParent();et&&!!et.resumingFrom==!!this.resumingFrom&&!et.options.layoutScroll&&et.target&&this.animationProgress!==1?(this.relativeParent=et,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,et.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}isDebug&&metrics.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const d=this.getLead(),g=!!this.resumingFrom||this!==d;let _=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(_=!1),g&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(_=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(_=!1),_)return;const{layout:b,layoutId:j}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(b||j))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const _e=this.treeScale.x,et=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,g),d.layout&&!d.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(d.target=d.layout.layoutBox,d.targetWithTransforms=createBox());const{target:rt}=d;if(!rt){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,rt,this.latestValues),(this.treeScale.x!==_e||this.treeScale.y!==et||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",rt)),isDebug&&metrics.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){var d;if((d=this.options.visualElement)===null||d===void 0||d.scheduleRender(),h){const g=this.getStack();g&&g.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(h,d=!1){const g=this.snapshot,_=g?g.latestValues:{},b={...this.latestValues},j=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!d;const _e=createBox(),et=g?g.source:void 0,rt=this.layout?this.layout.source:void 0,tt=et!==rt,it=this.getStack(),nt=!it||it.members.length<=1,at=!!(tt&&!nt&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let st;this.mixTargetDelta=dt=>{const lt=dt/1e3;mixAxisDelta(j.x,h.x,lt),mixAxisDelta(j.y,h.y,lt),this.setTargetDelta(j),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(_e,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,_e,lt),st&&boxEquals(this.relativeTarget,st)&&(this.isProjectionDirty=!1),st||(st=createBox()),copyBoxInto(st,this.relativeTarget)),tt&&(this.animationValues=b,mixValues(b,_,this.latestValues,lt,at,nt)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=lt},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.currentAnimation=animateSingleValue(0,animationTarget,{...h,onUpdate:d=>{this.mixTargetDelta(d),h.onUpdate&&h.onUpdate(d)},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:d,target:g,layout:_,latestValues:b}=h;if(!(!d||!g||!_)){if(this!==h&&this.layout&&_&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,_.layoutBox)){g=this.target||createBox();const j=calcLength(this.layout.layoutBox.x);g.x.min=h.target.x.min,g.x.max=g.x.min+j;const _e=calcLength(this.layout.layoutBox.y);g.y.min=h.target.y.min,g.y.max=g.y.min+_e}copyBoxInto(d,g),transformBox(d,b),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,d,b)}}registerSharedNode(h,d){this.sharedNodes.has(h)||this.sharedNodes.set(h,new NodeStack),this.sharedNodes.get(h).add(d);const _=d.options.initialPromotionConfig;d.promote({transition:_?_.transition:void 0,preserveFollowOpacity:_&&_.shouldPreserveFollowOpacity?_.shouldPreserveFollowOpacity(d):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:d}=this.options;return d?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:d}=this.options;return d?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:d,preserveFollowOpacity:g}={}){const _=this.getStack();_&&_.promote(this,g),h&&(this.projectionDelta=void 0,this.needsReset=!0),d&&this.setOptions({transition:d})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetSkewAndRotation(){const{visualElement:h}=this.options;if(!h)return;let d=!1;const{latestValues:g}=h;if((g.z||g.rotate||g.rotateX||g.rotateY||g.rotateZ||g.skewX||g.skewY)&&(d=!0),!d)return;const _={};g.z&&resetDistortingTransform("z",h,_,this.animationValues);for(let b=0;b<transformAxes.length;b++)resetDistortingTransform(`rotate${transformAxes[b]}`,h,_,this.animationValues),resetDistortingTransform(`skew${transformAxes[b]}`,h,_,this.animationValues);h.render();for(const b in _)h.setStaticValue(b,_[b]),this.animationValues&&(this.animationValues[b]=_[b]);h.scheduleRender()}getProjectionStyles(h){var d,g;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const _={visibility:""},b=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,_.opacity="",_.pointerEvents=resolveMotionValue(h==null?void 0:h.pointerEvents)||"",_.transform=b?b(this.latestValues,""):"none",_;const j=this.getLead();if(!this.projectionDelta||!this.layout||!j.target){const tt={};return this.options.layoutId&&(tt.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,tt.pointerEvents=resolveMotionValue(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(tt.transform=b?b({},""):"none",this.hasProjected=!1),tt}const _e=j.animationValues||j.latestValues;this.applyTransformsToTarget(),_.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,_e),b&&(_.transform=b(_e,_.transform));const{x:et,y:rt}=this.projectionDelta;_.transformOrigin=`${et.origin*100}% ${rt.origin*100}% 0`,j.animationValues?_.opacity=j===this?(g=(d=_e.opacity)!==null&&d!==void 0?d:this.latestValues.opacity)!==null&&g!==void 0?g:1:this.preserveOpacity?this.latestValues.opacity:_e.opacityExit:_.opacity=j===this?_e.opacity!==void 0?_e.opacity:"":_e.opacityExit!==void 0?_e.opacityExit:0;for(const tt in scaleCorrectors){if(_e[tt]===void 0)continue;const{correct:it,applyTo:nt}=scaleCorrectors[tt],at=_.transform==="none"?_e[tt]:it(_e[tt],j);if(nt){const st=nt.length;for(let dt=0;dt<st;dt++)_[nt[dt]]=at}else _[tt]=at}return this.options.layoutId&&(_.pointerEvents=j===this?resolveMotionValue(h==null?void 0:h.pointerEvents)||"":"none"),_}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var d;return(d=h.currentAnimation)===null||d===void 0?void 0:d.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(e){e.updateLayout()}function notifyLayoutUpdate(e){var i;const a=((i=e.resumeFrom)===null||i===void 0?void 0:i.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&a&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:o}=e.layout,{animationType:c}=e.options,h=a.source!==e.layout.source;c==="size"?eachAxis(j=>{const _e=h?a.measuredBox[j]:a.layoutBox[j],et=calcLength(_e);_e.min=s[j].min,_e.max=_e.min+et}):shouldAnimatePositionOnly(c,a.layoutBox,s)&&eachAxis(j=>{const _e=h?a.measuredBox[j]:a.layoutBox[j],et=calcLength(s[j]);_e.max=_e.min+et,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[j].max=e.relativeTarget[j].min+et)});const d=createDelta();calcBoxDelta(d,s,a.layoutBox);const g=createDelta();h?calcBoxDelta(g,e.applyTransform(o,!0),a.measuredBox):calcBoxDelta(g,s,a.layoutBox);const _=!isDeltaZero(d);let b=!1;if(!e.resumeFrom){const j=e.getClosestProjectingParent();if(j&&!j.resumeFrom){const{snapshot:_e,layout:et}=j;if(_e&&et){const rt=createBox();calcRelativePosition(rt,a.layoutBox,_e.layoutBox);const tt=createBox();calcRelativePosition(tt,s,et.layoutBox),boxEqualsRounded(rt,tt)||(b=!0),j.options.layoutRoot&&(e.relativeTarget=tt,e.relativeTargetOrigin=rt,e.relativeParent=j)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:a,delta:g,layoutDelta:d,hasLayoutChanged:_,hasRelativeTargetChanged:b})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function propagateDirtyNodes(e){isDebug&&metrics.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function cleanDirtyNodes(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function clearSnapshot(e){e.clearSnapshot()}function clearMeasurements(e){e.clearMeasurements()}function clearIsLayoutDirty(e){e.isLayoutDirty=!1}function resetTransformStyle(e){const{visualElement:i}=e.options;i&&i.getProps().onBeforeLayoutMeasure&&i.notify("BeforeLayoutMeasure"),e.resetTransform()}function finishAnimation(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function resolveTargetDelta(e){e.resolveTargetDelta()}function calcProjection(e){e.calcProjection()}function resetSkewAndRotation(e){e.resetSkewAndRotation()}function removeLeadSnapshots(e){e.removeLeadSnapshot()}function mixAxisDelta(e,i,a){e.translate=mixNumber$1(i.translate,0,a),e.scale=mixNumber$1(i.scale,1,a),e.origin=i.origin,e.originPoint=i.originPoint}function mixAxis(e,i,a,s){e.min=mixNumber$1(i.min,a.min,s),e.max=mixNumber$1(i.max,a.max,s)}function mixBox(e,i,a,s){mixAxis(e.x,i.x,a.x,s),mixAxis(e.y,i.y,a.y,s)}function hasOpacityCrossfade(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(e){e.min=roundPoint(e.min),e.max=roundPoint(e.max)}function roundBox(e){roundAxis(e.x),roundAxis(e.y)}function shouldAnimatePositionOnly(e,i,a){return e==="position"||e==="preserve-aspect"&&!isNear(aspectRatio(i),aspectRatio(a),.2)}function checkNodeWasScrollRoot(e){var i;return e!==e.root&&((i=e.scroll)===null||i===void 0?void 0:i.wasRoot)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(e,i)=>addDomEvent(e,"resize",i),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const e=new DocumentProjectionNode({});e.mount(window),e.setOptions({layoutScroll:!0}),rootProjectionNode.current=e}return rootProjectionNode.current},resetTransform:(e,i)=>{e.style.transform=i!==void 0?i:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(e,i,a){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",a==="Start");const o="onHover"+a,c=s[o];c&&frame.postRender(()=>c(i,extractEventInfo(i)))}class HoverGesture extends Feature{mount(){const{current:i}=this.node;i&&(this.unmount=hover(i,a=>(handleHoverEvent(this.node,a,"Start"),s=>handleHoverEvent(this.node,s,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let i=!1;try{i=this.node.current.matches(":focus-visible")}catch{i=!0}!i||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(e,i,a){const{props:s}=e;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",a==="Start");const o="onTap"+(a==="End"?"":a),c=s[o];c&&frame.postRender(()=>c(i,extractEventInfo(i)))}class PressGesture extends Feature{mount(){const{current:i}=this.node;i&&(this.unmount=press(i,a=>(handlePressEvent(this.node,a,"Start"),(s,{success:o})=>handlePressEvent(this.node,s,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=e=>{const i=observerCallbacks.get(e.target);i&&i(e)},fireAllObserverCallbacks=e=>{e.forEach(fireObserverCallback)};function initIntersectionObserver({root:e,...i}){const a=e||document;observers.has(a)||observers.set(a,{});const s=observers.get(a),o=JSON.stringify(i);return s[o]||(s[o]=new IntersectionObserver(fireAllObserverCallbacks,{root:e,...i})),s[o]}function observeIntersection(e,i,a){const s=initIntersectionObserver(i);return observerCallbacks.set(e,a),s.observe(e),()=>{observerCallbacks.delete(e),s.unobserve(e)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:i={}}=this.node.getProps(),{root:a,margin:s,amount:o="some",once:c}=i,h={root:a?a.current:void 0,rootMargin:s,threshold:typeof o=="number"?o:thresholdNames[o]},d=g=>{const{isIntersecting:_}=g;if(this.isInView===_||(this.isInView=_,c&&!_&&this.hasEnteredView))return;_&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",_);const{onViewportEnter:b,onViewportLeave:j}=this.node.getProps(),_e=_?b:j;_e&&_e(g)};return observeIntersection(this.node.current,h,d)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:i,prevProps:a}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(i,a))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:e={}},{viewport:i={}}={}){return a=>e[a]!==i[a]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),i=()=>prefersReducedMotion.current=e.matches;e.addListener(i),i()}else prefersReducedMotion.current=!1}const valueTypes=[...dimensionValueTypes,color,complex],findValueType=e=>valueTypes.find(testValueType(e)),visualElementStore=new WeakMap;function updateMotionValuesFromProps(e,i,a){for(const s in i){const o=i[s],c=a[s];if(isMotionValue(o))e.addValue(s,o);else if(isMotionValue(c))e.addValue(s,motionValue(o,{owner:e}));else if(c!==o)if(e.hasValue(s)){const h=e.getValue(s);h.liveStyle===!0?h.jump(o):h.hasAnimated||h.set(o)}else{const h=e.getStaticValue(s);e.addValue(s,motionValue(h!==void 0?h:o,{owner:e}))}}for(const s in a)i[s]===void 0&&e.removeValue(s);return i}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(i,a,s){return{}}constructor({parent:i,props:a,presenceContext:s,reducedMotionConfig:o,blockInitialAnimation:c,visualState:h},d={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const et=time.now();this.renderScheduledAt<et&&(this.renderScheduledAt=et,frame.render(this.render,!1,!0))};const{latestValues:g,renderState:_,onUpdate:b}=h;this.onUpdate=b,this.latestValues=g,this.baseTarget={...g},this.initialValues=a.initial?{...g}:{},this.renderState=_,this.parent=i,this.props=a,this.presenceContext=s,this.depth=i?i.depth+1:0,this.reducedMotionConfig=o,this.options=d,this.blockInitialAnimation=!!c,this.isControllingVariants=isControllingVariants(a),this.isVariantNode=isVariantNode(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(i&&i.current);const{willChange:j,..._e}=this.scrapeMotionValuesFromProps(a,{},this);for(const et in _e){const rt=_e[et];g[et]!==void 0&&isMotionValue(rt)&&rt.set(g[et],!1)}}mount(i){this.current=i,visualElementStore.set(i,this),this.projection&&!this.projection.instance&&this.projection.mount(i),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,s)=>this.bindToMotionValue(s,a)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){visualElementStore.delete(this.current),this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(i=>i()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const i in this.events)this.events[i].clear();for(const i in this.features){const a=this.features[i];a&&(a.unmount(),a.isMounted=!1)}this.current=null}bindToMotionValue(i,a){this.valueSubscriptions.has(i)&&this.valueSubscriptions.get(i)();const s=transformProps.has(i),o=a.on("change",d=>{this.latestValues[i]=d,this.props.onUpdate&&frame.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),c=a.on("renderRequest",this.scheduleRender);let h;window.MotionCheckAppearSync&&(h=window.MotionCheckAppearSync(this,i,a)),this.valueSubscriptions.set(i,()=>{o(),c(),h&&h(),a.owner&&a.stop()})}sortNodePosition(i){return!this.current||!this.sortInstanceNodePosition||this.type!==i.type?0:this.sortInstanceNodePosition(this.current,i.current)}updateFeatures(){let i="animation";for(i in featureDefinitions){const a=featureDefinitions[i];if(!a)continue;const{isEnabled:s,Feature:o}=a;if(!this.features[i]&&o&&s(this.props)&&(this.features[i]=new o(this)),this.features[i]){const c=this.features[i];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(i){return this.latestValues[i]}setStaticValue(i,a){this.latestValues[i]=a}update(i,a){(i.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=i,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let s=0;s<propEventHandlers.length;s++){const o=propEventHandlers[s];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const c="on"+o,h=i[c];h&&(this.propEventSubscriptions[o]=this.on(o,h))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(i,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(i){return this.props.variants?this.props.variants[i]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(i){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(i),()=>a.variantChildren.delete(i)}addValue(i,a){const s=this.values.get(i);a!==s&&(s&&this.removeValue(i),this.bindToMotionValue(i,a),this.values.set(i,a),this.latestValues[i]=a.get())}removeValue(i){this.values.delete(i);const a=this.valueSubscriptions.get(i);a&&(a(),this.valueSubscriptions.delete(i)),delete this.latestValues[i],this.removeValueFromRenderState(i,this.renderState)}hasValue(i){return this.values.has(i)}getValue(i,a){if(this.props.values&&this.props.values[i])return this.props.values[i];let s=this.values.get(i);return s===void 0&&a!==void 0&&(s=motionValue(a===null?void 0:a,{owner:this}),this.addValue(i,s)),s}readValue(i,a){var s;let o=this.latestValues[i]!==void 0||!this.current?this.latestValues[i]:(s=this.getBaseTargetFromProps(this.props,i))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,i,this.options);return o!=null&&(typeof o=="string"&&(isNumericalString(o)||isZeroValueString(o))?o=parseFloat(o):!findValueType(o)&&complex.test(a)&&(o=getAnimatableNone(i,a)),this.setBaseTarget(i,isMotionValue(o)?o.get():o)),isMotionValue(o)?o.get():o}setBaseTarget(i,a){this.baseTarget[i]=a}getBaseTarget(i){var a;const{initial:s}=this.props;let o;if(typeof s=="string"||typeof s=="object"){const h=resolveVariantFromProps(this.props,s,(a=this.presenceContext)===null||a===void 0?void 0:a.custom);h&&(o=h[i])}if(s&&o!==void 0)return o;const c=this.getBaseTargetFromProps(this.props,i);return c!==void 0&&!isMotionValue(c)?c:this.initialValues[i]!==void 0&&o===void 0?void 0:this.baseTarget[i]}on(i,a){return this.events[i]||(this.events[i]=new SubscriptionManager),this.events[i].add(a)}notify(i,...a){this.events[i]&&this.events[i].notify(...a)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(i,a){return i.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(i,a){return i.style?i.style[a]:void 0}removeValueFromRenderState(i,{vars:a,style:s}){delete a[i],delete s[i]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:i}=this.props;isMotionValue(i)&&(this.childSubscription=i.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function getComputedStyle$1(e){return window.getComputedStyle(e)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(i,a){if(transformProps.has(a)){const s=getDefaultValueType(a);return s&&s.default||0}else{const s=getComputedStyle$1(i),o=(isCSSVariableName(a)?s.getPropertyValue(a):s[a])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(i,{transformPagePoint:a}){return measureViewportBox(i,a)}build(i,a,s){buildHTMLStyles(i,a,s.transformTemplate)}scrapeMotionValuesFromProps(i,a,s){return scrapeMotionValuesFromProps$1(i,a,s)}}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(i,a){return i[a]}readValueFromInstance(i,a){if(transformProps.has(a)){const s=getDefaultValueType(a);return s&&s.default||0}return a=camelCaseAttributes.has(a)?a:camelToDash(a),i.getAttribute(a)}scrapeMotionValuesFromProps(i,a,s){return scrapeMotionValuesFromProps(i,a,s)}build(i,a,s){buildSVGAttrs(i,a,this.isSVGTag,s.transformTemplate)}renderInstance(i,a,s,o){renderSVG(i,a,s,o)}mount(i){this.isSVGTag=isSVGTag(i.tagName),super.mount(i)}}const createDomVisualElement=(e,i)=>isSVGComponent(e)?new SVGVisualElement(i):new HTMLVisualElement(i,{allowProjection:e!==reactExports.Fragment}),createMotionComponent=createMotionComponentFactory({...animations,...gestureAnimations,...drag,...layout},createDomVisualElement),motion=createDOMMotionComponentProxy(createMotionComponent);function FileUpload({onFileUpload:e}){const[i,a]=reactExports.useState(!1),[s,o]=reactExports.useState(!1),[c,h]=reactExports.useState(null),d=reactExports.useRef(null),g=rt=>{rt.preventDefault(),a(!0)},_=rt=>{rt.preventDefault(),a(!1)},b=async rt=>{rt.preventDefault(),a(!1);const tt=Array.from(rt.dataTransfer.files);tt.length>0&&await _e(tt[0])},j=async rt=>{const tt=rt.target.files;tt&&tt.length>0&&await _e(tt[0])},_e=async rt=>{var nt;const tt=["txt","pdf","xlsx","xls"],it=(nt=rt.name.split(".").pop())==null?void 0:nt.toLowerCase();if(!it||!tt.includes(it)){alert("Bitte laden Sie eine TXT-, PDF- oder Excel-Datei hoch.");return}o(!0),h(rt.name);try{await e(rt)}catch(at){console.error("Upload error:",at),alert(at instanceof Error?at.message:"Fehler beim Hochladen der Datei")}finally{o(!1),d.current&&(d.current.value="")}},et=()=>{var rt;(rt=d.current)==null||rt.click()};return jsxRuntimeExports.jsx(Card,{className:"w-full",children:jsxRuntimeExports.jsx(CardContent,{className:"p-6",children:jsxRuntimeExports.jsxs(motion.div,{onDragOver:g,onDragLeave:_,onDrop:b,animate:{borderColor:i?"hsl(var(--primary))":"hsl(var(--border))",backgroundColor:i?"hsl(var(--accent))":"transparent"},className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${i?"border-primary bg-accent":"border-border"}`,children:[jsxRuntimeExports.jsx("input",{ref:d,type:"file",accept:".txt,.pdf,.xlsx,.xls",onChange:j,className:"hidden"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s?jsxRuntimeExports.jsx(motion.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:jsxRuntimeExports.jsx(Loader2,{size:48,className:"text-primary"})}):jsxRuntimeExports.jsx(Upload,{size:48,className:"text-muted-foreground"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("p",{className:"text-lg font-medium",children:s?"Datei wird verarbeitet...":"Datei hochladen"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"TXT, PDF oder Excel (XLSX/XLS)"}),c&&!s&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-sm text-primary",children:[jsxRuntimeExports.jsx(FileText,{size:16}),c]})]}),jsxRuntimeExports.jsxs(Button,{onClick:et,disabled:s,className:"gap-2",children:[jsxRuntimeExports.jsx(Upload,{size:18}),"Datei auswhlen"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"oder per Drag & Drop hier ablegen"})]})]})})})}function toDate(e){const i=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&i==="[object Date]"?new e.constructor(+e):typeof e=="number"||i==="[object Number]"||typeof e=="string"||i==="[object String]"?new Date(e):new Date(NaN)}function constructFrom(e,i){return e instanceof Date?new e.constructor(i):new Date(i)}function addMilliseconds(e,i){const a=+toDate(e);return constructFrom(e,a+i)}const millisecondsInWeek=6048e5,millisecondsInDay=864e5,millisecondsInMinute=6e4;let defaultOptions={};function getDefaultOptions(){return defaultOptions}function startOfWeek(e,i){var d,g,_,b;const a=getDefaultOptions(),s=(i==null?void 0:i.weekStartsOn)??((g=(d=i==null?void 0:i.locale)==null?void 0:d.options)==null?void 0:g.weekStartsOn)??a.weekStartsOn??((b=(_=a.locale)==null?void 0:_.options)==null?void 0:b.weekStartsOn)??0,o=toDate(e),c=o.getDay(),h=(c<s?7:0)+c-s;return o.setDate(o.getDate()-h),o.setHours(0,0,0,0),o}function startOfISOWeek(e){return startOfWeek(e,{weekStartsOn:1})}function getISOWeekYear(e){const i=toDate(e),a=i.getFullYear(),s=constructFrom(e,0);s.setFullYear(a+1,0,4),s.setHours(0,0,0,0);const o=startOfISOWeek(s),c=constructFrom(e,0);c.setFullYear(a,0,4),c.setHours(0,0,0,0);const h=startOfISOWeek(c);return i.getTime()>=o.getTime()?a+1:i.getTime()>=h.getTime()?a:a-1}function startOfDay(e){const i=toDate(e);return i.setHours(0,0,0,0),i}function getTimezoneOffsetInMilliseconds(e){const i=toDate(e),a=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return a.setUTCFullYear(i.getFullYear()),+e-+a}function differenceInCalendarDays(e,i){const a=startOfDay(e),s=startOfDay(i),o=+a-getTimezoneOffsetInMilliseconds(a),c=+s-getTimezoneOffsetInMilliseconds(s);return Math.round((o-c)/millisecondsInDay)}function startOfISOWeekYear(e){const i=getISOWeekYear(e),a=constructFrom(e,0);return a.setFullYear(i,0,4),a.setHours(0,0,0,0),startOfISOWeek(a)}function addMinutes(e,i){return addMilliseconds(e,i*millisecondsInMinute)}function isDate(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function isValid(e){if(!isDate(e)&&typeof e!="number")return!1;const i=toDate(e);return!isNaN(Number(i))}function startOfYear(e){const i=toDate(e),a=constructFrom(e,0);return a.setFullYear(i.getFullYear(),0,1),a.setHours(0,0,0,0),a}const formatDistanceLocale$1={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance$1=(e,i,a)=>{let s;const o=formatDistanceLocale$1[e];return typeof o=="string"?s=o:i===1?s=o.one:s=o.other.replace("{{count}}",i.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+s:s+" ago":s};function buildFormatLongFn(e){return(i={})=>{const a=i.width?String(i.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const dateFormats$1={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats$1={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats$1={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong$1={date:buildFormatLongFn({formats:dateFormats$1,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats$1,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats$1,defaultWidth:"full"})},formatRelativeLocale$1={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative$1=(e,i,a,s)=>formatRelativeLocale$1[e];function buildLocalizeFn(e){return(i,a)=>{const s=a!=null&&a.context?String(a.context):"standalone";let o;if(s==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,d=a!=null&&a.width?String(a.width):h;o=e.formattingValues[d]||e.formattingValues[h]}else{const h=e.defaultWidth,d=a!=null&&a.width?String(a.width):e.defaultWidth;o=e.values[d]||e.values[h]}const c=e.argumentCallback?e.argumentCallback(i):i;return o[c]}}const eraValues$1={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues$1={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues$1={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues$1={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues$1={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues$1={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber$1=(e,i)=>{const a=Number(e),s=a%100;if(s>20||s<10)switch(s%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},localize$1={ordinalNumber:ordinalNumber$1,era:buildLocalizeFn({values:eraValues$1,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues$1,defaultWidth:"wide",argumentCallback:e=>e-1}),month:buildLocalizeFn({values:monthValues$1,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues$1,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues$1,defaultWidth:"wide",formattingValues:formattingDayPeriodValues$1,defaultFormattingWidth:"wide"})};function buildMatchFn(e){return(i,a={})=>{const s=a.width,o=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],c=i.match(o);if(!c)return null;const h=c[0],d=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],g=Array.isArray(d)?findIndex(d,j=>j.test(h)):findKey(d,j=>j.test(h));let _;_=e.valueCallback?e.valueCallback(g):g,_=a.valueCallback?a.valueCallback(_):_;const b=i.slice(h.length);return{value:_,rest:b}}}function findKey(e,i){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&i(e[a]))return a}function findIndex(e,i){for(let a=0;a<e.length;a++)if(i(e[a]))return a}function buildMatchPatternFn(e){return(i,a={})=>{const s=i.match(e.matchPattern);if(!s)return null;const o=s[0],c=i.match(e.parsePattern);if(!c)return null;let h=e.valueCallback?e.valueCallback(c[0]):c[0];h=a.valueCallback?a.valueCallback(h):h;const d=i.slice(o.length);return{value:h,rest:d}}}const matchOrdinalNumberPattern$1=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern$1=/\d+/i,matchEraPatterns$1={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns$1={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns$1={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns$1={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns$1={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns$1={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns$1={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns$1={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns$1={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns$1={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match$1={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern$1,parsePattern:parseOrdinalNumberPattern$1,valueCallback:e=>parseInt(e,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns$1,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns$1,defaultParseWidth:"any",valueCallback:e=>e+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns$1,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns$1,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns$1,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns$1,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance:formatDistance$1,formatLong:formatLong$1,formatRelative:formatRelative$1,localize:localize$1,match:match$1,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getDayOfYear(e){const i=toDate(e);return differenceInCalendarDays(i,startOfYear(i))+1}function getISOWeek(e){const i=toDate(e),a=+startOfISOWeek(i)-+startOfISOWeekYear(i);return Math.round(a/millisecondsInWeek)+1}function getWeekYear(e,i){var b,j,_e,et;const a=toDate(e),s=a.getFullYear(),o=getDefaultOptions(),c=(i==null?void 0:i.firstWeekContainsDate)??((j=(b=i==null?void 0:i.locale)==null?void 0:b.options)==null?void 0:j.firstWeekContainsDate)??o.firstWeekContainsDate??((et=(_e=o.locale)==null?void 0:_e.options)==null?void 0:et.firstWeekContainsDate)??1,h=constructFrom(e,0);h.setFullYear(s+1,0,c),h.setHours(0,0,0,0);const d=startOfWeek(h,i),g=constructFrom(e,0);g.setFullYear(s,0,c),g.setHours(0,0,0,0);const _=startOfWeek(g,i);return a.getTime()>=d.getTime()?s+1:a.getTime()>=_.getTime()?s:s-1}function startOfWeekYear(e,i){var d,g,_,b;const a=getDefaultOptions(),s=(i==null?void 0:i.firstWeekContainsDate)??((g=(d=i==null?void 0:i.locale)==null?void 0:d.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(_=a.locale)==null?void 0:_.options)==null?void 0:b.firstWeekContainsDate)??1,o=getWeekYear(e,i),c=constructFrom(e,0);return c.setFullYear(o,0,s),c.setHours(0,0,0,0),startOfWeek(c,i)}function getWeek(e,i){const a=toDate(e),s=+startOfWeek(a,i)-+startOfWeekYear(a,i);return Math.round(s/millisecondsInWeek)+1}function addLeadingZeros(e,i){const a=e<0?"-":"",s=Math.abs(e).toString().padStart(i,"0");return a+s}const lightFormatters={y(e,i){const a=e.getFullYear(),s=a>0?a:1-a;return addLeadingZeros(i==="yy"?s%100:s,i.length)},M(e,i){const a=e.getMonth();return i==="M"?String(a+1):addLeadingZeros(a+1,2)},d(e,i){return addLeadingZeros(e.getDate(),i.length)},a(e,i){const a=e.getHours()/12>=1?"pm":"am";switch(i){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(e,i){return addLeadingZeros(e.getHours()%12||12,i.length)},H(e,i){return addLeadingZeros(e.getHours(),i.length)},m(e,i){return addLeadingZeros(e.getMinutes(),i.length)},s(e,i){return addLeadingZeros(e.getSeconds(),i.length)},S(e,i){const a=i.length,s=e.getMilliseconds(),o=Math.trunc(s*Math.pow(10,a-3));return addLeadingZeros(o,i.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function(e,i,a){const s=e.getFullYear()>0?1:0;switch(i){case"G":case"GG":case"GGG":return a.era(s,{width:"abbreviated"});case"GGGGG":return a.era(s,{width:"narrow"});case"GGGG":default:return a.era(s,{width:"wide"})}},y:function(e,i,a){if(i==="yo"){const s=e.getFullYear(),o=s>0?s:1-s;return a.ordinalNumber(o,{unit:"year"})}return lightFormatters.y(e,i)},Y:function(e,i,a,s){const o=getWeekYear(e,s),c=o>0?o:1-o;if(i==="YY"){const h=c%100;return addLeadingZeros(h,2)}return i==="Yo"?a.ordinalNumber(c,{unit:"year"}):addLeadingZeros(c,i.length)},R:function(e,i){const a=getISOWeekYear(e);return addLeadingZeros(a,i.length)},u:function(e,i){const a=e.getFullYear();return addLeadingZeros(a,i.length)},Q:function(e,i,a){const s=Math.ceil((e.getMonth()+1)/3);switch(i){case"Q":return String(s);case"QQ":return addLeadingZeros(s,2);case"Qo":return a.ordinalNumber(s,{unit:"quarter"});case"QQQ":return a.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,i,a){const s=Math.ceil((e.getMonth()+1)/3);switch(i){case"q":return String(s);case"qq":return addLeadingZeros(s,2);case"qo":return a.ordinalNumber(s,{unit:"quarter"});case"qqq":return a.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,i,a){const s=e.getMonth();switch(i){case"M":case"MM":return lightFormatters.M(e,i);case"Mo":return a.ordinalNumber(s+1,{unit:"month"});case"MMM":return a.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(s,{width:"wide",context:"formatting"})}},L:function(e,i,a){const s=e.getMonth();switch(i){case"L":return String(s+1);case"LL":return addLeadingZeros(s+1,2);case"Lo":return a.ordinalNumber(s+1,{unit:"month"});case"LLL":return a.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(s,{width:"wide",context:"standalone"})}},w:function(e,i,a,s){const o=getWeek(e,s);return i==="wo"?a.ordinalNumber(o,{unit:"week"}):addLeadingZeros(o,i.length)},I:function(e,i,a){const s=getISOWeek(e);return i==="Io"?a.ordinalNumber(s,{unit:"week"}):addLeadingZeros(s,i.length)},d:function(e,i,a){return i==="do"?a.ordinalNumber(e.getDate(),{unit:"date"}):lightFormatters.d(e,i)},D:function(e,i,a){const s=getDayOfYear(e);return i==="Do"?a.ordinalNumber(s,{unit:"dayOfYear"}):addLeadingZeros(s,i.length)},E:function(e,i,a){const s=e.getDay();switch(i){case"E":case"EE":case"EEE":return a.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(s,{width:"short",context:"formatting"});case"EEEE":default:return a.day(s,{width:"wide",context:"formatting"})}},e:function(e,i,a,s){const o=e.getDay(),c=(o-s.weekStartsOn+8)%7||7;switch(i){case"e":return String(c);case"ee":return addLeadingZeros(c,2);case"eo":return a.ordinalNumber(c,{unit:"day"});case"eee":return a.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(o,{width:"short",context:"formatting"});case"eeee":default:return a.day(o,{width:"wide",context:"formatting"})}},c:function(e,i,a,s){const o=e.getDay(),c=(o-s.weekStartsOn+8)%7||7;switch(i){case"c":return String(c);case"cc":return addLeadingZeros(c,i.length);case"co":return a.ordinalNumber(c,{unit:"day"});case"ccc":return a.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(o,{width:"narrow",context:"standalone"});case"cccccc":return a.day(o,{width:"short",context:"standalone"});case"cccc":default:return a.day(o,{width:"wide",context:"standalone"})}},i:function(e,i,a){const s=e.getDay(),o=s===0?7:s;switch(i){case"i":return String(o);case"ii":return addLeadingZeros(o,i.length);case"io":return a.ordinalNumber(o,{unit:"day"});case"iii":return a.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(s,{width:"short",context:"formatting"});case"iiii":default:return a.day(s,{width:"wide",context:"formatting"})}},a:function(e,i,a){const o=e.getHours()/12>=1?"pm":"am";switch(i){case"a":case"aa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,i,a){const s=e.getHours();let o;switch(s===12?o=dayPeriodEnum.noon:s===0?o=dayPeriodEnum.midnight:o=s/12>=1?"pm":"am",i){case"b":case"bb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,i,a){const s=e.getHours();let o;switch(s>=17?o=dayPeriodEnum.evening:s>=12?o=dayPeriodEnum.afternoon:s>=4?o=dayPeriodEnum.morning:o=dayPeriodEnum.night,i){case"B":case"BB":case"BBB":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,i,a){if(i==="ho"){let s=e.getHours()%12;return s===0&&(s=12),a.ordinalNumber(s,{unit:"hour"})}return lightFormatters.h(e,i)},H:function(e,i,a){return i==="Ho"?a.ordinalNumber(e.getHours(),{unit:"hour"}):lightFormatters.H(e,i)},K:function(e,i,a){const s=e.getHours()%12;return i==="Ko"?a.ordinalNumber(s,{unit:"hour"}):addLeadingZeros(s,i.length)},k:function(e,i,a){let s=e.getHours();return s===0&&(s=24),i==="ko"?a.ordinalNumber(s,{unit:"hour"}):addLeadingZeros(s,i.length)},m:function(e,i,a){return i==="mo"?a.ordinalNumber(e.getMinutes(),{unit:"minute"}):lightFormatters.m(e,i)},s:function(e,i,a){return i==="so"?a.ordinalNumber(e.getSeconds(),{unit:"second"}):lightFormatters.s(e,i)},S:function(e,i){return lightFormatters.S(e,i)},X:function(e,i,a){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(i){case"X":return formatTimezoneWithOptionalMinutes(s);case"XXXX":case"XX":return formatTimezone(s);case"XXXXX":case"XXX":default:return formatTimezone(s,":")}},x:function(e,i,a){const s=e.getTimezoneOffset();switch(i){case"x":return formatTimezoneWithOptionalMinutes(s);case"xxxx":case"xx":return formatTimezone(s);case"xxxxx":case"xxx":default:return formatTimezone(s,":")}},O:function(e,i,a){const s=e.getTimezoneOffset();switch(i){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(s,":");case"OOOO":default:return"GMT"+formatTimezone(s,":")}},z:function(e,i,a){const s=e.getTimezoneOffset();switch(i){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(s,":");case"zzzz":default:return"GMT"+formatTimezone(s,":")}},t:function(e,i,a){const s=Math.trunc(e.getTime()/1e3);return addLeadingZeros(s,i.length)},T:function(e,i,a){const s=e.getTime();return addLeadingZeros(s,i.length)}};function formatTimezoneShort(e,i=""){const a=e>0?"-":"+",s=Math.abs(e),o=Math.trunc(s/60),c=s%60;return c===0?a+String(o):a+String(o)+i+addLeadingZeros(c,2)}function formatTimezoneWithOptionalMinutes(e,i){return e%60===0?(e>0?"-":"+")+addLeadingZeros(Math.abs(e)/60,2):formatTimezone(e,i)}function formatTimezone(e,i=""){const a=e>0?"-":"+",s=Math.abs(e),o=addLeadingZeros(Math.trunc(s/60),2),c=addLeadingZeros(s%60,2);return a+o+i+c}const dateLongFormatter=(e,i)=>{switch(e){case"P":return i.date({width:"short"});case"PP":return i.date({width:"medium"});case"PPP":return i.date({width:"long"});case"PPPP":default:return i.date({width:"full"})}},timeLongFormatter=(e,i)=>{switch(e){case"p":return i.time({width:"short"});case"pp":return i.time({width:"medium"});case"ppp":return i.time({width:"long"});case"pppp":default:return i.time({width:"full"})}},dateTimeLongFormatter=(e,i)=>{const a=e.match(/(P+)(p+)?/)||[],s=a[1],o=a[2];if(!o)return dateLongFormatter(e,i);let c;switch(s){case"P":c=i.dateTime({width:"short"});break;case"PP":c=i.dateTime({width:"medium"});break;case"PPP":c=i.dateTime({width:"long"});break;case"PPPP":default:c=i.dateTime({width:"full"});break}return c.replace("{{date}}",dateLongFormatter(s,i)).replace("{{time}}",timeLongFormatter(o,i))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(e){return dayOfYearTokenRE.test(e)}function isProtectedWeekYearToken(e){return weekYearTokenRE.test(e)}function warnOrThrowProtectedError(e,i,a){const s=message(e,i,a);if(console.warn(s),throwTokens.includes(e))throw new RangeError(s)}function message(e,i,a){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${i}\`) for formatting ${s} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(e,i,a){var b,j,_e,et,rt,tt,it,nt;const s=getDefaultOptions(),o=(a==null?void 0:a.locale)??s.locale??enUS,c=(a==null?void 0:a.firstWeekContainsDate)??((j=(b=a==null?void 0:a.locale)==null?void 0:b.options)==null?void 0:j.firstWeekContainsDate)??s.firstWeekContainsDate??((et=(_e=s.locale)==null?void 0:_e.options)==null?void 0:et.firstWeekContainsDate)??1,h=(a==null?void 0:a.weekStartsOn)??((tt=(rt=a==null?void 0:a.locale)==null?void 0:rt.options)==null?void 0:tt.weekStartsOn)??s.weekStartsOn??((nt=(it=s.locale)==null?void 0:it.options)==null?void 0:nt.weekStartsOn)??0,d=toDate(e);if(!isValid(d))throw new RangeError("Invalid time value");let g=i.match(longFormattingTokensRegExp).map(at=>{const st=at[0];if(st==="p"||st==="P"){const dt=longFormatters[st];return dt(at,o.formatLong)}return at}).join("").match(formattingTokensRegExp).map(at=>{if(at==="''")return{isToken:!1,value:"'"};const st=at[0];if(st==="'")return{isToken:!1,value:cleanEscapedString(at)};if(formatters[st])return{isToken:!0,value:at};if(st.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+st+"`");return{isToken:!1,value:at}});o.localize.preprocessor&&(g=o.localize.preprocessor(d,g));const _={firstWeekContainsDate:c,weekStartsOn:h,locale:o};return g.map(at=>{if(!at.isToken)return at.value;const st=at.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&isProtectedWeekYearToken(st)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&isProtectedDayOfYearToken(st))&&warnOrThrowProtectedError(st,i,String(e));const dt=formatters[st[0]];return dt(d,st,o.localize,_)}).join("")}function cleanEscapedString(e){const i=e.match(escapedStringRegExp);return i?i[1].replace(doubleQuoteRegExp,"'"):e}const formatDistanceLocale={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},formatDistance=(e,i,a)=>{let s;const o=a!=null&&a.addSuffix?formatDistanceLocale[e].withPreposition:formatDistanceLocale[e].standalone;return typeof o=="string"?s=o:i===1?s=o.one:s=o.other.replace("{{count}}",String(i)),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+s:"vor "+s:s},dateFormats={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},timeFormats={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},dateTimeFormats={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},formatRelative=(e,i,a,s)=>formatRelativeLocale[e],eraValues={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mr","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},formattingMonthValues={narrow:monthValues.narrow,abbreviated:["Jan.","Feb.","Mrz","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:monthValues.wide},dayValues={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},dayPeriodValues={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},formattingDayPeriodValues={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},ordinalNumber=e=>Number(e)+".",localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:e=>e-1}),month:buildLocalizeFn({values:monthValues,formattingValues:formattingMonthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})},matchOrdinalNumberPattern=/^(\d+)(\.)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},parseEraPatterns={any:[/^v/i,/^n/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(j[a]n|feb|mr[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|mrz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[a]/i,/^f/i,/^mr/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},parseDayPatterns={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},parseDayPeriodPatterns={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:e=>parseInt(e)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:e=>e+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},de={code:"de",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:1,firstWeekContainsDate:4}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var i=[],a=0,s=e.length;a<s;++a)i[a]=e.charCodeAt(a);return i}function utf16leread(e){for(var i=[],a=0;a<e.length>>1;++a)i[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return i.join("")}function utf16beread(e){for(var i=[],a=0;a<e.length>>1;++a)i[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return i.join("")}var debom=function(e){var i=e.charCodeAt(0),a=e.charCodeAt(1);return i==255&&a==254?utf16leread(e.slice(2)):i==254&&a==255?utf16beread(e.slice(2)):i==65279?e.slice(1):e},_getchar=function(i){return String.fromCharCode(i)},_getansi=function(i){return String.fromCharCode(i)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var i="",a=0,s=0,o=0,c=0,h=0,d=0,g=0,_=0;_<e.length;)a=e.charCodeAt(_++),c=a>>2,s=e.charCodeAt(_++),h=(a&3)<<4|s>>4,o=e.charCodeAt(_++),d=(s&15)<<2|o>>6,g=o&63,isNaN(s)?d=g=64:isNaN(o)&&(g=64),i+=Base64_map.charAt(c)+Base64_map.charAt(h)+Base64_map.charAt(d)+Base64_map.charAt(g);return i}function Base64_decode(e){var i="",a=0,s=0,o=0,c=0,h=0,d=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var _=0;_<e.length;)c=Base64_map.indexOf(e.charAt(_++)),h=Base64_map.indexOf(e.charAt(_++)),a=c<<2|h>>4,i+=String.fromCharCode(a),d=Base64_map.indexOf(e.charAt(_++)),s=(h&15)<<4|d>>2,d!==64&&(i+=String.fromCharCode(s)),g=Base64_map.indexOf(e.charAt(_++)),o=(d&3)<<6|g,g!==64&&(i+=String.fromCharCode(o));return i}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(i,a){return a?new Buffer(i,a):new Buffer(i)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function(i){return has_buf?Buffer_from(i,"binary"):i.split("").map(function(a){return a.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var i=new ArrayBuffer(e.length),a=new Uint8Array(i),s=0;s!=e.length;++s)a[s]=e.charCodeAt(s)&255;return i}function a2s(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var i=[],a=0;a<e.length;++a)i[a]=String.fromCharCode(e[a]);return i.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var i=new Array(e.length),a=0;a<e.length;++a)i[a]=e[a];return i}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(i){return Buffer.isBuffer(i)?i:Buffer_from(i)}))}:function(e){if(typeof Uint8Array<"u"){var i=0,a=0;for(i=0;i<e.length;++i)a+=e[i].length;var s=new Uint8Array(a),o=0;for(i=0,a=0;i<e.length;a+=o,++i)if(o=e[i].length,e[i]instanceof Uint8Array)s.set(e[i],a);else{if(typeof e[i]=="string")throw"wtf";s.set(new Uint8Array(e[i]),a)}return s}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function utf8decode(e){for(var i=[],a=0,s=e.length+250,o=new_raw_buf(e.length+255),c=0;c<e.length;++c){var h=e.charCodeAt(c);if(h<128)o[a++]=h;else if(h<2048)o[a++]=192|h>>6&31,o[a++]=128|h&63;else if(h>=55296&&h<57344){h=(h&1023)+64;var d=e.charCodeAt(++c)&1023;o[a++]=240|h>>8&7,o[a++]=128|h>>2&63,o[a++]=128|d>>6&15|(h&3)<<4,o[a++]=128|d&63}else o[a++]=224|h>>12&15,o[a++]=128|h>>6&63,o[a++]=128|h&63;a>s&&(i.push(o.slice(0,a)),a=0,o=new_raw_buf(65535),s=65530)}return i.push(o.slice(0,a)),bconcat(i)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var i="",a=e.length-1;a>=0;)i+=e.charAt(a--);return i}function pad0(e,i){var a=""+e;return a.length>=i?a:fill("0",i-a.length)+a}function pad_(e,i){var a=""+e;return a.length>=i?a:fill(" ",i-a.length)+a}function rpad_(e,i){var a=""+e;return a.length>=i?a:a+fill(" ",i-a.length)}function pad0r1(e,i){var a=""+Math.round(e);return a.length>=i?a:fill("0",i-a.length)+a}function pad0r2(e,i){var a=""+e;return a.length>=i?a:fill("0",i-a.length)+a}var p2_32=Math.pow(2,32);function pad0r(e,i){if(e>p2_32||e<-p2_32)return pad0r1(e,i);var a=Math.round(e);return pad0r2(a,i)}function SSF_isgeneral(e,i){return i=i||0,e.length>=7+i&&(e.charCodeAt(i)|32)===103&&(e.charCodeAt(i+1)|32)===101&&(e.charCodeAt(i+2)|32)===110&&(e.charCodeAt(i+3)|32)===101&&(e.charCodeAt(i+4)|32)===114&&(e.charCodeAt(i+5)|32)===97&&(e.charCodeAt(i+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,i,a){for(var s=e<0?-1:1,o=e*s,c=0,h=1,d=0,g=1,_=0,b=0,j=Math.floor(o);_<i&&(j=Math.floor(o),d=j*h+c,b=j*_+g,!(o-j<5e-8));)o=1/(o-j),c=h,h=d,g=_,_=b;if(b>i&&(_>i?(b=g,d=c):(b=_,d=h)),!a)return[0,s*d,b];var _e=Math.floor(s*d/b);return[_e,s*d-_e*b,b]}function SSF_parse_date_code(e,i,a){if(e>2958465||e<0)return null;var s=e|0,o=Math.floor(86400*(e-s)),c=0,h=[],d={D:s,T:o,u:86400*(e-s)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),i&&i.date1904&&(s+=1462),d.u>.9999&&(d.u=0,++o==86400&&(d.T=o=0,++s,++d.D)),s===60)h=a?[1317,10,29]:[1900,2,29],c=3;else if(s===0)h=a?[1317,8,29]:[1900,1,0],c=6;else{s>60&&--s;var g=new Date(1900,0,1);g.setDate(g.getDate()+s-1),h=[g.getFullYear(),g.getMonth()+1,g.getDate()],c=g.getDay(),s<60&&(c=(c+6)%7),a&&(c=SSF_fix_hijri(g,h))}return d.y=h[0],d.m=h[1],d.d=h[2],d.S=o%60,o=Math.floor(o/60),d.M=o%60,o=Math.floor(o/60),d.H=o,d.q=c,d}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,i){var a=e.getTime();return i?a-=1461*24*60*60*1e3:e>=SSFbase1904&&(a+=24*60*60*1e3),(a-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var i=e<0?12:11,a=SSF_strip_decimal(e.toFixed(12));return a.length<=i||(a=e.toPrecision(10),a.length<=i)?a:e.toExponential(5)}function SSF_large_exp(e){var i=SSF_strip_decimal(e.toFixed(11));return i.length>(e<0?12:11)||i==="0"||i==="-0"?e.toPrecision(6):i}function SSF_general_num(e){var i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return i>=-4&&i<=-1?a=e.toPrecision(10+i):Math.abs(i)<=9?a=SSF_small_exp(e):i===10?a=e.toFixed(10).substr(0,12):a=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(a.toUpperCase()))}function SSF_general(e,i){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,i){i[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function SSF_write_date(e,i,a,s){var o="",c=0,h=0,d=a.y,g,_=0;switch(e){case 98:d=a.y+543;case 121:switch(i.length){case 1:case 2:g=d%100,_=2;break;default:g=d%1e4,_=4;break}break;case 109:switch(i.length){case 1:case 2:g=a.m,_=i.length;break;case 3:return months[a.m-1][1];case 5:return months[a.m-1][0];default:return months[a.m-1][2]}break;case 100:switch(i.length){case 1:case 2:g=a.d,_=i.length;break;case 3:return days[a.q][0];default:return days[a.q][1]}break;case 104:switch(i.length){case 1:case 2:g=1+(a.H+11)%12,_=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:g=a.H,_=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:g=a.M,_=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return a.u===0&&(i=="s"||i=="ss")?pad0(a.S,i.length):(s>=2?h=s===3?1e3:100:h=s===1?10:1,c=Math.round(h*(a.S+a.u)),c>=60*h&&(c=0),i==="s"?c===0?"0":""+c/h:(o=pad0(c,2+s),i==="ss"?o.substr(0,2):"."+o.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":g=a.D*24+a.H;break;case"[m]":case"[mm]":g=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":g=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+i}_=i.length===3?1:2;break;case 101:g=d,_=1;break}var b=_>0?pad0(g,_):"";return b}function commaify(e){var i=3;if(e.length<=i)return e;for(var a=e.length%i,s=e.substr(0,a);a!=e.length;a+=i)s+=(s.length>0?",":"")+e.substr(a,i);return s}var pct1=/%/g;function write_num_pct(e,i,a){var s=i.replace(pct1,""),o=i.length-s.length;return write_num(e,s,a*Math.pow(10,2*o))+fill("%",o)}function write_num_cm(e,i,a){for(var s=i.length-1;i.charCodeAt(s-1)===44;)--s;return write_num(e,i.substr(0,s),a/Math.pow(10,3*(i.length-s)))}function write_num_exp(e,i){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+write_num_exp(e,-i);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(i)*Math.LOG10E)%o;if(c<0&&(c+=o),a=(i/Math.pow(10,c)).toPrecision(s+1+(o+c)%o),a.indexOf("e")===-1){var h=Math.floor(Math.log(i)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(h-a.length+c):a+="E+"+(h-c);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,o)+"."+a.substr(2+o),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,g,_,b){return g+_+b.substr(0,(o+c)%o)+"."+b.substr(c)+"E"})}else a=i.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,i,a){var s=parseInt(e[4],10),o=Math.round(i*s),c=Math.floor(o/s),h=o-c*s,d=s;return a+(c===0?"":""+c)+" "+(h===0?fill(" ",e[1].length+1+e[4].length):pad_(h,e[1].length)+e[2]+"/"+e[3]+pad0(d,e[4].length))}function write_num_f2(e,i,a){return a+(i===0?"":""+i)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var i="",a,s=0;s!=e.length;++s)switch(a=e.charCodeAt(s)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(a)}return i}function rnd(e,i){var a=Math.pow(10,i);return""+Math.round(e*a)/a}function dec(e,i){var a=e-Math.floor(e),s=Math.pow(10,i);return i<(""+Math.round(a*s)).length?0:Math.round(a*s)}function carry(e,i){return i<(""+Math.round((e-Math.floor(e))*Math.pow(10,i))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,i,a){if(e.charCodeAt(0)===40&&!i.match(closeparen)){var s=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?write_num_flt("n",s,a):"("+write_num_flt("n",s,-a)+")"}if(i.charCodeAt(i.length-1)===44)return write_num_cm(e,i,a);if(i.indexOf("%")!==-1)return write_num_pct(e,i,a);if(i.indexOf("E")!==-1)return write_num_exp(i,a);if(i.charCodeAt(0)===36)return"$"+write_num_flt(e,i.substr(i.charAt(1)==" "?2:1),a);var o,c,h,d,g=Math.abs(a),_=a<0?"-":"";if(i.match(/^00+$/))return _+pad0r(g,i.length);if(i.match(/^[#?]+$/))return o=pad0r(a,0),o==="0"&&(o=""),o.length>i.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(frac1))return write_num_f1(c,g,_);if(i.match(/^#+0+$/))return _+pad0r(g,i.length-i.indexOf("0"));if(c=i.match(dec1))return o=rnd(a,c[1].length).replace(/^([^\.]+)$/,"$1."+hashq(c[1])).replace(/\.$/,"."+hashq(c[1])).replace(/\.(\d*)$/,function(rt,tt){return"."+tt+fill("0",hashq(c[1]).length-tt.length)}),i.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),c=i.match(/^(0*)\.(#*)$/))return _+rnd(g,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=i.match(/^#{1,3},##0(\.?)$/))return _+commaify(pad0r(g,0));if(c=i.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+write_num_flt(e,i,-a):commaify(""+(Math.floor(a)+carry(a,c[1].length)))+"."+pad0(dec(a,c[1].length),c[1].length);if(c=i.match(/^#,#*,#0/))return write_num_flt(e,i.replace(/^#,#*,/,""),a);if(c=i.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_flt(e,i.replace(/[\\-]/g,""),a)),h=0,_strrev(_strrev(i.replace(/\\/g,"")).replace(/[0#]/g,function(rt){return h<o.length?o.charAt(h++):rt==="0"?"0":""}));if(i.match(phone))return o=write_num_flt(e,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var b="";if(c=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),d=SSF_frac(g,Math.pow(10,h)-1,!1),o=""+_,b=write_num("n",c[1],d[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),o+=b+c[2]+"/"+c[3],b=rpad_(d[2],h),b.length<c[4].length&&(b=hashq(c[4].substr(c[4].length-b.length))+b),o+=b,o;if(c=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d=SSF_frac(g,Math.pow(10,h)-1,!0),_+(d[0]||(d[1]?"":"0"))+" "+(d[1]?pad_(d[1],h)+c[2]+"/"+c[3]+rpad_(d[2],h):fill(" ",2*h+1+c[2].length+c[3].length));if(c=i.match(/^[#0?]+$/))return o=pad0r(a,0),i.length<=o.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(/^([#0?]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),h=o.indexOf(".");var j=i.indexOf(".")-h,_e=i.length-o.length-j;return hashq(i.substr(0,j)+o+i.substr(i.length-_e))}if(c=i.match(/^00,000\.([#0]*0)$/))return h=dec(a,c[1].length),a<0?"-"+write_num_flt(e,i,-a):commaify(flr(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(rt){return"00,"+(rt.length<3?pad0(0,3-rt.length):"")+rt})+"."+pad0(h,c[1].length);switch(i){case"###,##0.00":return write_num_flt(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var et=commaify(pad0r(g,0));return et!=="0"?_+et:"";case"###,###.00":return write_num_flt(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+i+"|")}function write_num_cm2(e,i,a){for(var s=i.length-1;i.charCodeAt(s-1)===44;)--s;return write_num(e,i.substr(0,s),a/Math.pow(10,3*(i.length-s)))}function write_num_pct2(e,i,a){var s=i.replace(pct1,""),o=i.length-s.length;return write_num(e,s,a*Math.pow(10,2*o))+fill("%",o)}function write_num_exp2(e,i){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+write_num_exp2(e,-i);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(i)*Math.LOG10E)%o;if(c<0&&(c+=o),a=(i/Math.pow(10,c)).toPrecision(s+1+(o+c)%o),!a.match(/[Ee]/)){var h=Math.floor(Math.log(i)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(h-a.length+c):a+="E+"+(h-c),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,g,_,b){return g+_+b.substr(0,(o+c)%o)+"."+b.substr(c)+"E"})}else a=i.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function write_num_int(e,i,a){if(e.charCodeAt(0)===40&&!i.match(closeparen)){var s=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?write_num_int("n",s,a):"("+write_num_int("n",s,-a)+")"}if(i.charCodeAt(i.length-1)===44)return write_num_cm2(e,i,a);if(i.indexOf("%")!==-1)return write_num_pct2(e,i,a);if(i.indexOf("E")!==-1)return write_num_exp2(i,a);if(i.charCodeAt(0)===36)return"$"+write_num_int(e,i.substr(i.charAt(1)==" "?2:1),a);var o,c,h,d,g=Math.abs(a),_=a<0?"-":"";if(i.match(/^00+$/))return _+pad0(g,i.length);if(i.match(/^[#?]+$/))return o=""+a,a===0&&(o=""),o.length>i.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(frac1))return write_num_f2(c,g,_);if(i.match(/^#+0+$/))return _+pad0(g,i.length-i.indexOf("0"));if(c=i.match(dec1))return o=(""+a).replace(/^([^\.]+)$/,"$1."+hashq(c[1])).replace(/\.$/,"."+hashq(c[1])),o=o.replace(/\.(\d*)$/,function(rt,tt){return"."+tt+fill("0",hashq(c[1]).length-tt.length)}),i.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),c=i.match(/^(0*)\.(#*)$/))return _+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=i.match(/^#{1,3},##0(\.?)$/))return _+commaify(""+g);if(c=i.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+write_num_int(e,i,-a):commaify(""+a)+"."+fill("0",c[1].length);if(c=i.match(/^#,#*,#0/))return write_num_int(e,i.replace(/^#,#*,/,""),a);if(c=i.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_int(e,i.replace(/[\\-]/g,""),a)),h=0,_strrev(_strrev(i.replace(/\\/g,"")).replace(/[0#]/g,function(rt){return h<o.length?o.charAt(h++):rt==="0"?"0":""}));if(i.match(phone))return o=write_num_int(e,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var b="";if(c=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),d=SSF_frac(g,Math.pow(10,h)-1,!1),o=""+_,b=write_num("n",c[1],d[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),o+=b+c[2]+"/"+c[3],b=rpad_(d[2],h),b.length<c[4].length&&(b=hashq(c[4].substr(c[4].length-b.length))+b),o+=b,o;if(c=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d=SSF_frac(g,Math.pow(10,h)-1,!0),_+(d[0]||(d[1]?"":"0"))+" "+(d[1]?pad_(d[1],h)+c[2]+"/"+c[3]+rpad_(d[2],h):fill(" ",2*h+1+c[2].length+c[3].length));if(c=i.match(/^[#0?]+$/))return o=""+a,i.length<=o.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(/^([#0]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),h=o.indexOf(".");var j=i.indexOf(".")-h,_e=i.length-o.length-j;return hashq(i.substr(0,j)+o+i.substr(i.length-_e))}if(c=i.match(/^00,000\.([#0]*0)$/))return a<0?"-"+write_num_int(e,i,-a):commaify(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(rt){return"00,"+(rt.length<3?pad0(0,3-rt.length):"")+rt})+"."+pad0(0,c[1].length);switch(i){case"###,###":case"##,###":case"#,###":var et=commaify(""+g);return et!=="0"?_+et:"";default:if(i.match(/\.[0#?]*$/))return write_num_int(e,i.slice(0,i.lastIndexOf(".")),a)+hashq(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}function write_num(e,i,a){return(a|0)===a?write_num_int(e,i,a):write_num_flt(e,i,a)}function SSF_split_fmt(e){for(var i=[],a=!1,s=0,o=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:i[i.length]=e.substr(o,s-o),o=s+1}if(i[i.length]=e.substr(o),a===!0)throw new Error("Format |"+e+"| unterminated string ");return i}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var i=0,a="",s="";i<e.length;)switch(a=e.charAt(i)){case"G":SSF_isgeneral(e,i)&&(i+=6),i++;break;case'"':for(;e.charCodeAt(++i)!==34&&i<e.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(i,3).toUpperCase()==="A/P"||e.substr(i,5).toUpperCase()==="AM/PM"||e.substr(i,5).toUpperCase()==="/")return!0;++i;break;case"[":for(s=a;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;i<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++i))>-1||a=="\\"&&e.charAt(i+1)=="-"&&"0#".indexOf(e.charAt(i+2))>-1););break;case"?":for(;e.charAt(++i)===a;);break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}function eval_fmt(e,i,a,s){for(var o=[],c="",h=0,d="",g="t",_,b,j,_e="H";h<e.length;)switch(d=e.charAt(h)){case"G":if(!SSF_isgeneral(e,h))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},h+=7;break;case'"':for(c="";(j=e.charCodeAt(++h))!==34&&h<e.length;)c+=String.fromCharCode(j);o[o.length]={t:"t",v:c},++h;break;case"\\":var et=e.charAt(++h),rt=et==="("||et===")"?et:"t";o[o.length]={t:rt,v:et},++h;break;case"_":o[o.length]={t:"t",v:" "},h+=2;break;case"@":o[o.length]={t:"T",v:i},++h;break;case"B":case"b":if(e.charAt(h+1)==="1"||e.charAt(h+1)==="2"){if(_==null&&(_=SSF_parse_date_code(i,a,e.charAt(h+1)==="2"),_==null))return"";o[o.length]={t:"X",v:e.substr(h,2)},g=d,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||_==null&&(_=SSF_parse_date_code(i,a),_==null))return"";for(c=d;++h<e.length&&e.charAt(h).toLowerCase()===d;)c+=d;d==="m"&&g.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=_e),o[o.length]={t:d,v:c},g=d;break;case"A":case"a":case"":var tt={t:d,v:d};if(_==null&&(_=SSF_parse_date_code(i,a)),e.substr(h,3).toUpperCase()==="A/P"?(_!=null&&(tt.v=_.H>=12?"P":"A"),tt.t="T",_e="h",h+=3):e.substr(h,5).toUpperCase()==="AM/PM"?(_!=null&&(tt.v=_.H>=12?"PM":"AM"),tt.t="T",h+=5,_e="h"):e.substr(h,5).toUpperCase()==="/"?(_!=null&&(tt.v=_.H>=12?"":""),tt.t="T",h+=5,_e="h"):(tt.t="t",++h),_==null&&tt.t==="T")return"";o[o.length]=tt,g=d;break;case"[":for(c=d;e.charAt(h++)!=="]"&&h<e.length;)c+=e.charAt(h);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(SSF_abstime)){if(_==null&&(_=SSF_parse_date_code(i,a),_==null))return"";o[o.length]={t:"Z",v:c.toLowerCase()},g=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(o[o.length]={t:"t",v:c}));break;case".":if(_!=null){for(c=d;++h<e.length&&(d=e.charAt(h))==="0";)c+=d;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++h<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(h))>-1;)c+=d;o[o.length]={t:"n",v:c};break;case"?":for(c=d;e.charAt(++h)===d;)c+=d;o[o.length]={t:d,v:c},g=d;break;case"*":++h,(e.charAt(h)==" "||e.charAt(h)=="*")&&++h;break;case"(":case")":o[o.length]={t:s===1?"t":d,v:d},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;h<e.length&&"0123456789".indexOf(e.charAt(++h))>-1;)c+=e.charAt(h);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:d,v:d},++h;break;case"$":o[o.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++h;break}var it=0,nt=0,at;for(h=o.length-1,g="t";h>=0;--h)switch(o[h].t){case"h":case"H":o[h].t=_e,g="h",it<1&&(it=1);break;case"s":(at=o[h].v.match(/\.0+$/))&&(nt=Math.max(nt,at[0].length-1)),it<3&&(it=3);case"d":case"y":case"M":case"e":g=o[h].t;break;case"m":g==="s"&&(o[h].t="M",it<2&&(it=2));break;case"X":break;case"Z":it<1&&o[h].v.match(/[Hh]/)&&(it=1),it<2&&o[h].v.match(/[Mm]/)&&(it=2),it<3&&o[h].v.match(/[Ss]/)&&(it=3)}switch(it){case 0:break;case 1:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M),_.M>=60&&(_.M=0,++_.H);break;case 2:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M);break}var st="",dt;for(h=0;h<o.length;++h)switch(o[h].t){case"t":case"T":case" ":case"D":break;case"X":o[h].v="",o[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[h].v=SSF_write_date(o[h].t.charCodeAt(0),o[h].v,_,nt),o[h].t="t";break;case"n":case"?":for(dt=h+1;o[dt]!=null&&((d=o[dt].t)==="?"||d==="D"||(d===" "||d==="t")&&o[dt+1]!=null&&(o[dt+1].t==="?"||o[dt+1].t==="t"&&o[dt+1].v==="/")||o[h].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(o[dt].v==="/"||o[dt].v===" "&&o[dt+1]!=null&&o[dt+1].t=="?"));)o[h].v+=o[dt].v,o[dt]={v:"",t:";"},++dt;st+=o[h].v,h=dt-1;break;case"G":o[h].t="t",o[h].v=SSF_general(i,a);break}var lt="",ut,ot;if(st.length>0){st.charCodeAt(0)==40?(ut=i<0&&st.charCodeAt(0)===45?-i:i,ot=write_num("n",st,ut)):(ut=i<0&&s>1?-i:i,ot=write_num("n",st,ut),ut<0&&o[0]&&o[0].t=="t"&&(ot=ot.substr(1),o[0].v="-"+o[0].v)),dt=ot.length-1;var ft=o.length;for(h=0;h<o.length;++h)if(o[h]!=null&&o[h].t!="t"&&o[h].v.indexOf(".")>-1){ft=h;break}var pt=o.length;if(ft===o.length&&ot.indexOf("E")===-1){for(h=o.length-1;h>=0;--h)o[h]==null||"n?".indexOf(o[h].t)===-1||(dt>=o[h].v.length-1?(dt-=o[h].v.length,o[h].v=ot.substr(dt+1,o[h].v.length)):dt<0?o[h].v="":(o[h].v=ot.substr(0,dt+1),dt=-1),o[h].t="t",pt=h);dt>=0&&pt<o.length&&(o[pt].v=ot.substr(0,dt+1)+o[pt].v)}else if(ft!==o.length&&ot.indexOf("E")===-1){for(dt=ot.indexOf(".")-1,h=ft;h>=0;--h)if(!(o[h]==null||"n?".indexOf(o[h].t)===-1)){for(b=o[h].v.indexOf(".")>-1&&h===ft?o[h].v.indexOf(".")-1:o[h].v.length-1,lt=o[h].v.substr(b+1);b>=0;--b)dt>=0&&(o[h].v.charAt(b)==="0"||o[h].v.charAt(b)==="#")&&(lt=ot.charAt(dt--)+lt);o[h].v=lt,o[h].t="t",pt=h}for(dt>=0&&pt<o.length&&(o[pt].v=ot.substr(0,dt+1)+o[pt].v),dt=ot.indexOf(".")+1,h=ft;h<o.length;++h)if(!(o[h]==null||"n?(".indexOf(o[h].t)===-1&&h!==ft)){for(b=o[h].v.indexOf(".")>-1&&h===ft?o[h].v.indexOf(".")+1:0,lt=o[h].v.substr(0,b);b<o[h].v.length;++b)dt<ot.length&&(lt+=ot.charAt(dt++));o[h].v=lt,o[h].t="t",pt=h}}}for(h=0;h<o.length;++h)o[h]!=null&&"n?".indexOf(o[h].t)>-1&&(ut=s>1&&i<0&&h>0&&o[h-1].v==="-"?-i:i,o[h].v=write_num(o[h].t,o[h].v,ut),o[h].t="t");var St="";for(h=0;h!==o.length;++h)o[h]!=null&&(St+=o[h].v);return St}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,i){if(i==null)return!1;var a=parseFloat(i[2]);switch(i[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function choose_fmt(e,i){var a=SSF_split_fmt(e),s=a.length,o=a[s-1].indexOf("@");if(s<4&&o>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof i!="number")return[4,a.length===4||o>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=o>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=o>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=o>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var c=i>0?a[0]:i<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[s,c];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var h=a[0].match(cfregex2),d=a[1].match(cfregex2);return chkcond(i,h)?[s,a[0]]:chkcond(i,d)?[s,a[1]]:[s,a[h!=null&&d!=null?2:1]]}return[s,c]}function SSF_format(e,i,a){a==null&&(a={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?s=a.dateNF:s=e;break;case"number":e==14&&a.dateNF?s=a.dateNF:s=(a.table!=null?a.table:table_fmt)[e],s==null&&(s=a.table&&a.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),s==null&&(s=SSF_default_str[e]||"General");break}if(SSF_isgeneral(s,0))return SSF_general(i,a);i instanceof Date&&(i=datenum_local(i,a.date1904));var o=choose_fmt(s,i);if(SSF_isgeneral(o[1]))return SSF_general(i,a);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return eval_fmt(o[1],i,a,o[0])}function SSF_load(e,i){if(typeof i!="number"){i=+i||-1;for(var a=0;a<392;++a){if(table_fmt[a]==null){i<0&&(i=a);continue}if(table_fmt[a]==e){i=a;break}}i<0&&(i=391)}return table_fmt[i]=e,i}function SSF_load_table(e){for(var i=0;i!=392;++i)e[i]!==void 0&&SSF_load(e[i],i)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var i=typeof e=="number"?table_fmt[e]:e;return i=i.replace(dateNFregex,"(\\d+)"),new RegExp("^"+i+"$")}function dateNF_fix(e,i,a){var s=-1,o=-1,c=-1,h=-1,d=-1,g=-1;(i.match(dateNFregex)||[]).forEach(function(j,_e){var et=parseInt(a[_e+1],10);switch(j.toLowerCase().charAt(0)){case"y":s=et;break;case"d":c=et;break;case"h":h=et;break;case"s":g=et;break;case"m":h>=0?d=et:o=et;break}}),g>=0&&d==-1&&o>=0&&(d=o,o=-1);var _=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);_.length==7&&(_="0"+_),_.length==8&&(_="20"+_);var b=("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return h==-1&&d==-1&&g==-1?_:s==-1&&o==-1&&c==-1?b:_+"T"+b}var CRC32=function(){var e={};e.version="1.2.0";function i(){for(var ot=0,ft=new Array(256),pt=0;pt!=256;++pt)ot=pt,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ot=ot&1?-306674912^ot>>>1:ot>>>1,ft[pt]=ot;return typeof Int32Array<"u"?new Int32Array(ft):ft}var a=i();function s(ot){var ft=0,pt=0,St=0,gt=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(St=0;St!=256;++St)gt[St]=ot[St];for(St=0;St!=256;++St)for(pt=ot[St],ft=256+St;ft<4096;ft+=256)pt=gt[ft]=pt>>>8^ot[pt&255];var vt=[];for(St=1;St!=16;++St)vt[St-1]=typeof Int32Array<"u"?gt.subarray(St*256,St*256+256):gt.slice(St*256,St*256+256);return vt}var o=s(a),c=o[0],h=o[1],d=o[2],g=o[3],_=o[4],b=o[5],j=o[6],_e=o[7],et=o[8],rt=o[9],tt=o[10],it=o[11],nt=o[12],at=o[13],st=o[14];function dt(ot,ft){for(var pt=ft^-1,St=0,gt=ot.length;St<gt;)pt=pt>>>8^a[(pt^ot.charCodeAt(St++))&255];return~pt}function lt(ot,ft){for(var pt=ft^-1,St=ot.length-15,gt=0;gt<St;)pt=st[ot[gt++]^pt&255]^at[ot[gt++]^pt>>8&255]^nt[ot[gt++]^pt>>16&255]^it[ot[gt++]^pt>>>24]^tt[ot[gt++]]^rt[ot[gt++]]^et[ot[gt++]]^_e[ot[gt++]]^j[ot[gt++]]^b[ot[gt++]]^_[ot[gt++]]^g[ot[gt++]]^d[ot[gt++]]^h[ot[gt++]]^c[ot[gt++]]^a[ot[gt++]];for(St+=15;gt<St;)pt=pt>>>8^a[(pt^ot[gt++])&255];return~pt}function ut(ot,ft){for(var pt=ft^-1,St=0,gt=ot.length,vt=0,At=0;St<gt;)vt=ot.charCodeAt(St++),vt<128?pt=pt>>>8^a[(pt^vt)&255]:vt<2048?(pt=pt>>>8^a[(pt^(192|vt>>6&31))&255],pt=pt>>>8^a[(pt^(128|vt&63))&255]):vt>=55296&&vt<57344?(vt=(vt&1023)+64,At=ot.charCodeAt(St++)&1023,pt=pt>>>8^a[(pt^(240|vt>>8&7))&255],pt=pt>>>8^a[(pt^(128|vt>>2&63))&255],pt=pt>>>8^a[(pt^(128|At>>6&15|(vt&3)<<4))&255],pt=pt>>>8^a[(pt^(128|At&63))&255]):(pt=pt>>>8^a[(pt^(224|vt>>12&15))&255],pt=pt>>>8^a[(pt^(128|vt>>6&63))&255],pt=pt>>>8^a[(pt^(128|vt&63))&255]);return~pt}return e.table=a,e.bstr=dt,e.buf=lt,e.str=ut,e}(),CFB=function(){var i={};i.version="1.2.1";function a(wt,Lt){for(var kt=wt.split("/"),Pt=Lt.split("/"),Rt=0,Bt=0,tr=Math.min(kt.length,Pt.length);Rt<tr;++Rt){if(Bt=kt[Rt].length-Pt[Rt].length)return Bt;if(kt[Rt]!=Pt[Rt])return kt[Rt]<Pt[Rt]?-1:1}return kt.length-Pt.length}function s(wt){if(wt.charAt(wt.length-1)=="/")return wt.slice(0,-1).indexOf("/")===-1?wt:s(wt.slice(0,-1));var Lt=wt.lastIndexOf("/");return Lt===-1?wt:wt.slice(0,Lt+1)}function o(wt){if(wt.charAt(wt.length-1)=="/")return o(wt.slice(0,-1));var Lt=wt.lastIndexOf("/");return Lt===-1?wt:wt.slice(Lt+1)}function c(wt,Lt){typeof Lt=="string"&&(Lt=new Date(Lt));var kt=Lt.getHours();kt=kt<<6|Lt.getMinutes(),kt=kt<<5|Lt.getSeconds()>>>1,wt.write_shift(2,kt);var Pt=Lt.getFullYear()-1980;Pt=Pt<<4|Lt.getMonth()+1,Pt=Pt<<5|Lt.getDate(),wt.write_shift(2,Pt)}function h(wt){var Lt=wt.read_shift(2)&65535,kt=wt.read_shift(2)&65535,Pt=new Date,Rt=kt&31;kt>>>=5;var Bt=kt&15;kt>>>=4,Pt.setMilliseconds(0),Pt.setFullYear(kt+1980),Pt.setMonth(Bt-1),Pt.setDate(Rt);var tr=Lt&31;Lt>>>=5;var mr=Lt&63;return Lt>>>=6,Pt.setHours(Lt),Pt.setMinutes(mr),Pt.setSeconds(tr<<1),Pt}function d(wt){prep_blob(wt,0);for(var Lt={},kt=0;wt.l<=wt.length-4;){var Pt=wt.read_shift(2),Rt=wt.read_shift(2),Bt=wt.l+Rt,tr={};switch(Pt){case 21589:kt=wt.read_shift(1),kt&1&&(tr.mtime=wt.read_shift(4)),Rt>5&&(kt&2&&(tr.atime=wt.read_shift(4)),kt&4&&(tr.ctime=wt.read_shift(4))),tr.mtime&&(tr.mt=new Date(tr.mtime*1e3));break}wt.l=Bt,Lt[Pt]=tr}return Lt}var g;function _(){return g||(g={})}function b(wt,Lt){if(wt[0]==80&&wt[1]==75)return Wr(wt,Lt);if((wt[0]|32)==109&&(wt[1]|32)==105)return Kt(wt,Lt);if(wt.length<512)throw new Error("CFB file size "+wt.length+" < 512");var kt=3,Pt=512,Rt=0,Bt=0,tr=0,mr=0,or=0,sr=[],pr=wt.slice(0,512);prep_blob(pr,0);var Ar=j(pr);switch(kt=Ar[0],kt){case 3:Pt=512;break;case 4:Pt=4096;break;case 0:if(Ar[1]==0)return Wr(wt,Lt);default:throw new Error("Major Version: Expected 3 or 4 saw "+kt)}Pt!==512&&(pr=wt.slice(0,Pt),prep_blob(pr,28));var br=wt.slice(0,Pt);_e(pr,kt);var Ur=pr.read_shift(4,"i");if(kt===3&&Ur!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ur);pr.l+=4,tr=pr.read_shift(4,"i"),pr.l+=4,pr.chk("00100000","Mini Stream Cutoff Size: "),mr=pr.read_shift(4,"i"),Rt=pr.read_shift(4,"i"),or=pr.read_shift(4,"i"),Bt=pr.read_shift(4,"i");for(var Cr=-1,Br=0;Br<109&&(Cr=pr.read_shift(4,"i"),!(Cr<0));++Br)sr[Br]=Cr;var Xr=et(wt,Pt);it(or,Bt,Xr,Pt,sr);var Gr=at(Xr,tr,sr,Pt);Gr[tr].name="!Directory",Rt>0&&mr!==At&&(Gr[mr].name="!MiniFAT"),Gr[sr[0]].name="!FAT",Gr.fat_addrs=sr,Gr.ssz=Pt;var Kr={},Yr=[],on=[],ln=[];st(tr,Gr,Xr,Yr,Rt,Kr,on,mr),rt(on,ln,Yr),Yr.shift();var cn={FileIndex:on,FullPaths:ln};return Lt&&Lt.raw&&(cn.raw={header:br,sectors:Xr}),cn}function j(wt){if(wt[wt.l]==80&&wt[wt.l+1]==75)return[0,0];wt.chk(Gt,"Header Signature: "),wt.l+=16;var Lt=wt.read_shift(2,"u");return[wt.read_shift(2,"u"),Lt]}function _e(wt,Lt){var kt=9;switch(wt.l+=2,kt=wt.read_shift(2)){case 9:if(Lt!=3)throw new Error("Sector Shift: Expected 9 saw "+kt);break;case 12:if(Lt!=4)throw new Error("Sector Shift: Expected 12 saw "+kt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+kt)}wt.chk("0600","Mini Sector Shift: "),wt.chk("000000000000","Reserved: ")}function et(wt,Lt){for(var kt=Math.ceil(wt.length/Lt)-1,Pt=[],Rt=1;Rt<kt;++Rt)Pt[Rt-1]=wt.slice(Rt*Lt,(Rt+1)*Lt);return Pt[kt-1]=wt.slice(kt*Lt),Pt}function rt(wt,Lt,kt){for(var Pt=0,Rt=0,Bt=0,tr=0,mr=0,or=kt.length,sr=[],pr=[];Pt<or;++Pt)sr[Pt]=pr[Pt]=Pt,Lt[Pt]=kt[Pt];for(;mr<pr.length;++mr)Pt=pr[mr],Rt=wt[Pt].L,Bt=wt[Pt].R,tr=wt[Pt].C,sr[Pt]===Pt&&(Rt!==-1&&sr[Rt]!==Rt&&(sr[Pt]=sr[Rt]),Bt!==-1&&sr[Bt]!==Bt&&(sr[Pt]=sr[Bt])),tr!==-1&&(sr[tr]=Pt),Rt!==-1&&Pt!=sr[Pt]&&(sr[Rt]=sr[Pt],pr.lastIndexOf(Rt)<mr&&pr.push(Rt)),Bt!==-1&&Pt!=sr[Pt]&&(sr[Bt]=sr[Pt],pr.lastIndexOf(Bt)<mr&&pr.push(Bt));for(Pt=1;Pt<or;++Pt)sr[Pt]===Pt&&(Bt!==-1&&sr[Bt]!==Bt?sr[Pt]=sr[Bt]:Rt!==-1&&sr[Rt]!==Rt&&(sr[Pt]=sr[Rt]));for(Pt=1;Pt<or;++Pt)if(wt[Pt].type!==0){if(mr=Pt,mr!=sr[mr])do mr=sr[mr],Lt[Pt]=Lt[mr]+"/"+Lt[Pt];while(mr!==0&&sr[mr]!==-1&&mr!=sr[mr]);sr[Pt]=-1}for(Lt[0]+="/",Pt=1;Pt<or;++Pt)wt[Pt].type!==2&&(Lt[Pt]+="/")}function tt(wt,Lt,kt){for(var Pt=wt.start,Rt=wt.size,Bt=[],tr=Pt;kt&&Rt>0&&tr>=0;)Bt.push(Lt.slice(tr*vt,tr*vt+vt)),Rt-=vt,tr=__readInt32LE(kt,tr*4);return Bt.length===0?new_buf(0):bconcat(Bt).slice(0,wt.size)}function it(wt,Lt,kt,Pt,Rt){var Bt=At;if(wt===At){if(Lt!==0)throw new Error("DIFAT chain shorter than expected")}else if(wt!==-1){var tr=kt[wt],mr=(Pt>>>2)-1;if(!tr)return;for(var or=0;or<mr&&(Bt=__readInt32LE(tr,or*4))!==At;++or)Rt.push(Bt);it(__readInt32LE(tr,Pt-4),Lt-1,kt,Pt,Rt)}}function nt(wt,Lt,kt,Pt,Rt){var Bt=[],tr=[];Rt||(Rt=[]);var mr=Pt-1,or=0,sr=0;for(or=Lt;or>=0;){Rt[or]=!0,Bt[Bt.length]=or,tr.push(wt[or]);var pr=kt[Math.floor(or*4/Pt)];if(sr=or*4&mr,Pt<4+sr)throw new Error("FAT boundary crossed: "+or+" 4 "+Pt);if(!wt[pr])break;or=__readInt32LE(wt[pr],sr)}return{nodes:Bt,data:__toBuffer([tr])}}function at(wt,Lt,kt,Pt){var Rt=wt.length,Bt=[],tr=[],mr=[],or=[],sr=Pt-1,pr=0,Ar=0,br=0,Ur=0;for(pr=0;pr<Rt;++pr)if(mr=[],br=pr+Lt,br>=Rt&&(br-=Rt),!tr[br]){or=[];var Cr=[];for(Ar=br;Ar>=0;){Cr[Ar]=!0,tr[Ar]=!0,mr[mr.length]=Ar,or.push(wt[Ar]);var Br=kt[Math.floor(Ar*4/Pt)];if(Ur=Ar*4&sr,Pt<4+Ur)throw new Error("FAT boundary crossed: "+Ar+" 4 "+Pt);if(!wt[Br]||(Ar=__readInt32LE(wt[Br],Ur),Cr[Ar]))break}Bt[br]={nodes:mr,data:__toBuffer([or])}}return Bt}function st(wt,Lt,kt,Pt,Rt,Bt,tr,mr){for(var or=0,sr=Pt.length?2:0,pr=Lt[wt].data,Ar=0,br=0,Ur;Ar<pr.length;Ar+=128){var Cr=pr.slice(Ar,Ar+128);prep_blob(Cr,64),br=Cr.read_shift(2),Ur=__utf16le(Cr,0,br-sr),Pt.push(Ur);var Br={name:Ur,type:Cr.read_shift(1),color:Cr.read_shift(1),L:Cr.read_shift(4,"i"),R:Cr.read_shift(4,"i"),C:Cr.read_shift(4,"i"),clsid:Cr.read_shift(16),state:Cr.read_shift(4,"i"),start:0,size:0},Xr=Cr.read_shift(2)+Cr.read_shift(2)+Cr.read_shift(2)+Cr.read_shift(2);Xr!==0&&(Br.ct=dt(Cr,Cr.l-8));var Gr=Cr.read_shift(2)+Cr.read_shift(2)+Cr.read_shift(2)+Cr.read_shift(2);Gr!==0&&(Br.mt=dt(Cr,Cr.l-8)),Br.start=Cr.read_shift(4,"i"),Br.size=Cr.read_shift(4,"i"),Br.size<0&&Br.start<0&&(Br.size=Br.type=0,Br.start=At,Br.name=""),Br.type===5?(or=Br.start,Rt>0&&or!==At&&(Lt[or].name="!StreamData")):Br.size>=4096?(Br.storage="fat",Lt[Br.start]===void 0&&(Lt[Br.start]=nt(kt,Br.start,Lt.fat_addrs,Lt.ssz)),Lt[Br.start].name=Br.name,Br.content=Lt[Br.start].data.slice(0,Br.size)):(Br.storage="minifat",Br.size<0?Br.size=0:or!==At&&Br.start!==At&&Lt[or]&&(Br.content=tt(Br,Lt[or].data,(Lt[mr]||{}).data))),Br.content&&prep_blob(Br.content,0),Bt[Ur]=Br,tr.push(Br)}}function dt(wt,Lt){return new Date((__readUInt32LE(wt,Lt+4)/1e7*Math.pow(2,32)+__readUInt32LE(wt,Lt)/1e7-11644473600)*1e3)}function lt(wt,Lt){return _(),b(g.readFileSync(wt),Lt)}function ut(wt,Lt){var kt=Lt&&Lt.type;switch(kt||has_buf&&Buffer.isBuffer(wt)&&(kt="buffer"),kt||"base64"){case"file":return lt(wt,Lt);case"base64":return b(s2a(Base64_decode(wt)),Lt);case"binary":return b(s2a(wt),Lt)}return b(wt,Lt)}function ot(wt,Lt){var kt=Lt||{},Pt=kt.root||"Root Entry";if(wt.FullPaths||(wt.FullPaths=[]),wt.FileIndex||(wt.FileIndex=[]),wt.FullPaths.length!==wt.FileIndex.length)throw new Error("inconsistent CFB structure");wt.FullPaths.length===0&&(wt.FullPaths[0]=Pt+"/",wt.FileIndex[0]={name:Pt,type:5}),kt.CLSID&&(wt.FileIndex[0].clsid=kt.CLSID),ft(wt)}function ft(wt){var Lt="Sh33tJ5";if(!CFB.find(wt,"/"+Lt)){var kt=new_buf(4);kt[0]=55,kt[1]=kt[3]=50,kt[2]=54,wt.FileIndex.push({name:Lt,type:2,content:kt,size:4,L:69,R:69,C:69}),wt.FullPaths.push(wt.FullPaths[0]+Lt),pt(wt)}}function pt(wt,Lt){ot(wt);for(var kt=!1,Pt=!1,Rt=wt.FullPaths.length-1;Rt>=0;--Rt){var Bt=wt.FileIndex[Rt];switch(Bt.type){case 0:Pt?kt=!0:(wt.FileIndex.pop(),wt.FullPaths.pop());break;case 1:case 2:case 5:Pt=!0,isNaN(Bt.R*Bt.L*Bt.C)&&(kt=!0),Bt.R>-1&&Bt.L>-1&&Bt.R==Bt.L&&(kt=!0);break;default:kt=!0;break}}if(!(!kt&&!Lt)){var tr=new Date(1987,1,19),mr=0,or=Object.create?Object.create(null):{},sr=[];for(Rt=0;Rt<wt.FullPaths.length;++Rt)or[wt.FullPaths[Rt]]=!0,wt.FileIndex[Rt].type!==0&&sr.push([wt.FullPaths[Rt],wt.FileIndex[Rt]]);for(Rt=0;Rt<sr.length;++Rt){var pr=s(sr[Rt][0]);Pt=or[pr],Pt||(sr.push([pr,{name:o(pr).replace("/",""),type:1,clsid:Ht,ct:tr,mt:tr,content:null}]),or[pr]=!0)}for(sr.sort(function(Ur,Cr){return a(Ur[0],Cr[0])}),wt.FullPaths=[],wt.FileIndex=[],Rt=0;Rt<sr.length;++Rt)wt.FullPaths[Rt]=sr[Rt][0],wt.FileIndex[Rt]=sr[Rt][1];for(Rt=0;Rt<sr.length;++Rt){var Ar=wt.FileIndex[Rt],br=wt.FullPaths[Rt];if(Ar.name=o(br).replace("/",""),Ar.L=Ar.R=Ar.C=-(Ar.color=1),Ar.size=Ar.content?Ar.content.length:0,Ar.start=0,Ar.clsid=Ar.clsid||Ht,Rt===0)Ar.C=sr.length>1?1:-1,Ar.size=0,Ar.type=5;else if(br.slice(-1)=="/"){for(mr=Rt+1;mr<sr.length&&s(wt.FullPaths[mr])!=br;++mr);for(Ar.C=mr>=sr.length?-1:mr,mr=Rt+1;mr<sr.length&&s(wt.FullPaths[mr])!=s(br);++mr);Ar.R=mr>=sr.length?-1:mr,Ar.type=1}else s(wt.FullPaths[Rt+1]||"")==s(br)&&(Ar.R=Rt+1),Ar.type=2}}}function St(wt,Lt){var kt=Lt||{};if(kt.fileType=="mad")return lr(wt,kt);switch(pt(wt),kt.fileType){case"zip":return gr(wt,kt)}var Pt=function(Ur){for(var Cr=0,Br=0,Xr=0;Xr<Ur.FileIndex.length;++Xr){var Gr=Ur.FileIndex[Xr];if(Gr.content){var Kr=Gr.content.length;Kr>0&&(Kr<4096?Cr+=Kr+63>>6:Br+=Kr+511>>9)}}for(var Yr=Ur.FullPaths.length+3>>2,on=Cr+7>>3,ln=Cr+127>>7,cn=on+Br+Yr+ln,Jr=cn+127>>7,Dn=Jr<=109?0:Math.ceil((Jr-109)/127);cn+Jr+Dn+127>>7>Jr;)Dn=++Jr<=109?0:Math.ceil((Jr-109)/127);var Qr=[1,Dn,Jr,ln,Yr,Br,Cr,0];return Ur.FileIndex[0].size=Cr<<6,Qr[7]=(Ur.FileIndex[0].start=Qr[0]+Qr[1]+Qr[2]+Qr[3]+Qr[4]+Qr[5])+(Qr[6]+7>>3),Qr}(wt),Rt=new_buf(Pt[7]<<9),Bt=0,tr=0;{for(Bt=0;Bt<8;++Bt)Rt.write_shift(1,Nt[Bt]);for(Bt=0;Bt<8;++Bt)Rt.write_shift(2,0);for(Rt.write_shift(2,62),Rt.write_shift(2,3),Rt.write_shift(2,65534),Rt.write_shift(2,9),Rt.write_shift(2,6),Bt=0;Bt<3;++Bt)Rt.write_shift(2,0);for(Rt.write_shift(4,0),Rt.write_shift(4,Pt[2]),Rt.write_shift(4,Pt[0]+Pt[1]+Pt[2]+Pt[3]-1),Rt.write_shift(4,0),Rt.write_shift(4,4096),Rt.write_shift(4,Pt[3]?Pt[0]+Pt[1]+Pt[2]-1:At),Rt.write_shift(4,Pt[3]),Rt.write_shift(-4,Pt[1]?Pt[0]-1:At),Rt.write_shift(4,Pt[1]),Bt=0;Bt<109;++Bt)Rt.write_shift(-4,Bt<Pt[2]?Pt[1]+Bt:-1)}if(Pt[1])for(tr=0;tr<Pt[1];++tr){for(;Bt<236+tr*127;++Bt)Rt.write_shift(-4,Bt<Pt[2]?Pt[1]+Bt:-1);Rt.write_shift(-4,tr===Pt[1]-1?At:tr+1)}var mr=function(Ur){for(tr+=Ur;Bt<tr-1;++Bt)Rt.write_shift(-4,Bt+1);Ur&&(++Bt,Rt.write_shift(-4,At))};for(tr=Bt=0,tr+=Pt[1];Bt<tr;++Bt)Rt.write_shift(-4,It.DIFSECT);for(tr+=Pt[2];Bt<tr;++Bt)Rt.write_shift(-4,It.FATSECT);mr(Pt[3]),mr(Pt[4]);for(var or=0,sr=0,pr=wt.FileIndex[0];or<wt.FileIndex.length;++or)pr=wt.FileIndex[or],pr.content&&(sr=pr.content.length,!(sr<4096)&&(pr.start=tr,mr(sr+511>>9)));for(mr(Pt[6]+7>>3);Rt.l&511;)Rt.write_shift(-4,It.ENDOFCHAIN);for(tr=Bt=0,or=0;or<wt.FileIndex.length;++or)pr=wt.FileIndex[or],pr.content&&(sr=pr.content.length,!(!sr||sr>=4096)&&(pr.start=tr,mr(sr+63>>6)));for(;Rt.l&511;)Rt.write_shift(-4,It.ENDOFCHAIN);for(Bt=0;Bt<Pt[4]<<2;++Bt){var Ar=wt.FullPaths[Bt];if(!Ar||Ar.length===0){for(or=0;or<17;++or)Rt.write_shift(4,0);for(or=0;or<3;++or)Rt.write_shift(4,-1);for(or=0;or<12;++or)Rt.write_shift(4,0);continue}pr=wt.FileIndex[Bt],Bt===0&&(pr.start=pr.size?pr.start-1:At);var br=Bt===0&&kt.root||pr.name;if(sr=2*(br.length+1),Rt.write_shift(64,br,"utf16le"),Rt.write_shift(2,sr),Rt.write_shift(1,pr.type),Rt.write_shift(1,pr.color),Rt.write_shift(-4,pr.L),Rt.write_shift(-4,pr.R),Rt.write_shift(-4,pr.C),pr.clsid)Rt.write_shift(16,pr.clsid,"hex");else for(or=0;or<4;++or)Rt.write_shift(4,0);Rt.write_shift(4,pr.state||0),Rt.write_shift(4,0),Rt.write_shift(4,0),Rt.write_shift(4,0),Rt.write_shift(4,0),Rt.write_shift(4,pr.start),Rt.write_shift(4,pr.size),Rt.write_shift(4,0)}for(Bt=1;Bt<wt.FileIndex.length;++Bt)if(pr=wt.FileIndex[Bt],pr.size>=4096)if(Rt.l=pr.start+1<<9,has_buf&&Buffer.isBuffer(pr.content))pr.content.copy(Rt,Rt.l,0,pr.size),Rt.l+=pr.size+511&-512;else{for(or=0;or<pr.size;++or)Rt.write_shift(1,pr.content[or]);for(;or&511;++or)Rt.write_shift(1,0)}for(Bt=1;Bt<wt.FileIndex.length;++Bt)if(pr=wt.FileIndex[Bt],pr.size>0&&pr.size<4096)if(has_buf&&Buffer.isBuffer(pr.content))pr.content.copy(Rt,Rt.l,0,pr.size),Rt.l+=pr.size+63&-64;else{for(or=0;or<pr.size;++or)Rt.write_shift(1,pr.content[or]);for(;or&63;++or)Rt.write_shift(1,0)}if(has_buf)Rt.l=Rt.length;else for(;Rt.l<Rt.length;)Rt.write_shift(1,0);return Rt}function gt(wt,Lt){var kt=wt.FullPaths.map(function(or){return or.toUpperCase()}),Pt=kt.map(function(or){var sr=or.split("/");return sr[sr.length-(or.slice(-1)=="/"?2:1)]}),Rt=!1;Lt.charCodeAt(0)===47?(Rt=!0,Lt=kt[0].slice(0,-1)+Lt):Rt=Lt.indexOf("/")!==-1;var Bt=Lt.toUpperCase(),tr=Rt===!0?kt.indexOf(Bt):Pt.indexOf(Bt);if(tr!==-1)return wt.FileIndex[tr];var mr=!Bt.match(chr1);for(Bt=Bt.replace(chr0,""),mr&&(Bt=Bt.replace(chr1,"!")),tr=0;tr<kt.length;++tr)if((mr?kt[tr].replace(chr1,"!"):kt[tr]).replace(chr0,"")==Bt||(mr?Pt[tr].replace(chr1,"!"):Pt[tr]).replace(chr0,"")==Bt)return wt.FileIndex[tr];return null}var vt=64,At=-2,Gt="d0cf11e0a1b11ae1",Nt=[208,207,17,224,161,177,26,225],Ht="00000000000000000000000000000000",It={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:At,FREESECT:-1,HEADER_SIGNATURE:Gt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ht,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Wt(wt,Lt,kt){_();var Pt=St(wt,kt);g.writeFileSync(Lt,Pt)}function yt(wt){for(var Lt=new Array(wt.length),kt=0;kt<wt.length;++kt)Lt[kt]=String.fromCharCode(wt[kt]);return Lt.join("")}function Dt(wt,Lt){var kt=St(wt,Lt);switch(Lt&&Lt.type||"buffer"){case"file":return _(),g.writeFileSync(Lt.filename,kt),kt;case"binary":return typeof kt=="string"?kt:yt(kt);case"base64":return Base64_encode(typeof kt=="string"?kt:yt(kt));case"buffer":if(has_buf)return Buffer.isBuffer(kt)?kt:Buffer_from(kt);case"array":return typeof kt=="string"?s2a(kt):kt}return kt}var $t;function _t(wt){try{var Lt=wt.InflateRaw,kt=new Lt;if(kt._processChunk(new Uint8Array([3,0]),kt._finishFlushFlag),kt.bytesRead)$t=wt;else throw new Error("zlib does not expose bytesRead")}catch(Pt){console.error("cannot use native zlib: "+(Pt.message||Pt))}}function ht(wt,Lt){if(!$t)return Rr(wt,Lt);var kt=$t.InflateRaw,Pt=new kt,Rt=Pt._processChunk(wt.slice(wt.l),Pt._finishFlushFlag);return wt.l+=Pt.bytesRead,Rt}function ct(wt){return $t?$t.deflateRawSync(wt):Pr(wt)}var xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Et=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],bt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ct(wt){var Lt=(wt<<1|wt<<11)&139536|(wt<<5|wt<<15)&558144;return(Lt>>16|Lt>>8|Lt)&255}for(var Ot=typeof Uint8Array<"u",jt=Ot?new Uint8Array(256):[],er=0;er<256;++er)jt[er]=Ct(er);function Tt(wt,Lt){var kt=jt[wt&255];return Lt<=8?kt>>>8-Lt:(kt=kt<<8|jt[wt>>8&255],Lt<=16?kt>>>16-Lt:(kt=kt<<8|jt[wt>>16&255],kt>>>24-Lt))}function ur(wt,Lt){var kt=Lt&7,Pt=Lt>>>3;return(wt[Pt]|(kt<=6?0:wt[Pt+1]<<8))>>>kt&3}function cr(wt,Lt){var kt=Lt&7,Pt=Lt>>>3;return(wt[Pt]|(kt<=5?0:wt[Pt+1]<<8))>>>kt&7}function hr(wt,Lt){var kt=Lt&7,Pt=Lt>>>3;return(wt[Pt]|(kt<=4?0:wt[Pt+1]<<8))>>>kt&15}function Yt(wt,Lt){var kt=Lt&7,Pt=Lt>>>3;return(wt[Pt]|(kt<=3?0:wt[Pt+1]<<8))>>>kt&31}function Xt(wt,Lt){var kt=Lt&7,Pt=Lt>>>3;return(wt[Pt]|(kt<=1?0:wt[Pt+1]<<8))>>>kt&127}function Ft(wt,Lt,kt){var Pt=Lt&7,Rt=Lt>>>3,Bt=(1<<kt)-1,tr=wt[Rt]>>>Pt;return kt<8-Pt||(tr|=wt[Rt+1]<<8-Pt,kt<16-Pt)||(tr|=wt[Rt+2]<<16-Pt,kt<24-Pt)||(tr|=wt[Rt+3]<<24-Pt),tr&Bt}function Ut(wt,Lt,kt){var Pt=Lt&7,Rt=Lt>>>3;return Pt<=5?wt[Rt]|=(kt&7)<<Pt:(wt[Rt]|=kt<<Pt&255,wt[Rt+1]=(kt&7)>>8-Pt),Lt+3}function qt(wt,Lt,kt){var Pt=Lt&7,Rt=Lt>>>3;return kt=(kt&1)<<Pt,wt[Rt]|=kt,Lt+1}function Jt(wt,Lt,kt){var Pt=Lt&7,Rt=Lt>>>3;return kt<<=Pt,wt[Rt]|=kt&255,kt>>>=8,wt[Rt+1]=kt,Lt+8}function dr(wt,Lt,kt){var Pt=Lt&7,Rt=Lt>>>3;return kt<<=Pt,wt[Rt]|=kt&255,kt>>>=8,wt[Rt+1]=kt&255,wt[Rt+2]=kt>>>8,Lt+16}function vr(wt,Lt){var kt=wt.length,Pt=2*kt>Lt?2*kt:Lt+5,Rt=0;if(kt>=Lt)return wt;if(has_buf){var Bt=new_unsafe_buf(Pt);if(wt.copy)wt.copy(Bt);else for(;Rt<wt.length;++Rt)Bt[Rt]=wt[Rt];return Bt}else if(Ot){var tr=new Uint8Array(Pt);if(tr.set)tr.set(wt);else for(;Rt<kt;++Rt)tr[Rt]=wt[Rt];return tr}return wt.length=Pt,wt}function _r(wt){for(var Lt=new Array(wt),kt=0;kt<wt;++kt)Lt[kt]=0;return Lt}function Zt(wt,Lt,kt){var Pt=1,Rt=0,Bt=0,tr=0,mr=0,or=wt.length,sr=Ot?new Uint16Array(32):_r(32);for(Bt=0;Bt<32;++Bt)sr[Bt]=0;for(Bt=or;Bt<kt;++Bt)wt[Bt]=0;or=wt.length;var pr=Ot?new Uint16Array(or):_r(or);for(Bt=0;Bt<or;++Bt)sr[Rt=wt[Bt]]++,Pt<Rt&&(Pt=Rt),pr[Bt]=0;for(sr[0]=0,Bt=1;Bt<=Pt;++Bt)sr[Bt+16]=mr=mr+sr[Bt-1]<<1;for(Bt=0;Bt<or;++Bt)mr=wt[Bt],mr!=0&&(pr[Bt]=sr[mr+16]++);var Ar=0;for(Bt=0;Bt<or;++Bt)if(Ar=wt[Bt],Ar!=0)for(mr=Tt(pr[Bt],Pt)>>Pt-Ar,tr=(1<<Pt+4-Ar)-1;tr>=0;--tr)Lt[mr|tr<<Ar]=Ar&15|Bt<<4;return Pt}var Er=Ot?new Uint16Array(512):_r(512),Sr=Ot?new Uint16Array(32):_r(32);if(!Ot){for(var Vr=0;Vr<512;++Vr)Er[Vr]=0;for(Vr=0;Vr<32;++Vr)Sr[Vr]=0}(function(){for(var wt=[],Lt=0;Lt<32;Lt++)wt.push(5);Zt(wt,Sr,32);var kt=[];for(Lt=0;Lt<=143;Lt++)kt.push(8);for(;Lt<=255;Lt++)kt.push(9);for(;Lt<=279;Lt++)kt.push(7);for(;Lt<=287;Lt++)kt.push(8);Zt(kt,Er,288)})();var Nr=function(){for(var Lt=Ot?new Uint8Array(32768):[],kt=0,Pt=0;kt<bt.length-1;++kt)for(;Pt<bt[kt+1];++Pt)Lt[Pt]=kt;for(;Pt<32768;++Pt)Lt[Pt]=29;var Rt=Ot?new Uint8Array(259):[];for(kt=0,Pt=0;kt<Et.length-1;++kt)for(;Pt<Et[kt+1];++Pt)Rt[Pt]=kt;function Bt(mr,or){for(var sr=0;sr<mr.length;){var pr=Math.min(65535,mr.length-sr),Ar=sr+pr==mr.length;for(or.write_shift(1,+Ar),or.write_shift(2,pr),or.write_shift(2,~pr&65535);pr-- >0;)or[or.l++]=mr[sr++]}return or.l}function tr(mr,or){for(var sr=0,pr=0,Ar=Ot?new Uint16Array(32768):[];pr<mr.length;){var br=Math.min(65535,mr.length-pr);if(br<10){for(sr=Ut(or,sr,+(pr+br==mr.length)),sr&7&&(sr+=8-(sr&7)),or.l=sr/8|0,or.write_shift(2,br),or.write_shift(2,~br&65535);br-- >0;)or[or.l++]=mr[pr++];sr=or.l*8;continue}sr=Ut(or,sr,+(pr+br==mr.length)+2);for(var Ur=0;br-- >0;){var Cr=mr[pr];Ur=(Ur<<5^Cr)&32767;var Br=-1,Xr=0;if((Br=Ar[Ur])&&(Br|=pr&-32768,Br>pr&&(Br-=32768),Br<pr))for(;mr[Br+Xr]==mr[pr+Xr]&&Xr<250;)++Xr;if(Xr>2){Cr=Rt[Xr],Cr<=22?sr=Jt(or,sr,jt[Cr+1]>>1)-1:(Jt(or,sr,3),sr+=5,Jt(or,sr,jt[Cr-23]>>5),sr+=3);var Gr=Cr<8?0:Cr-4>>2;Gr>0&&(dr(or,sr,Xr-Et[Cr]),sr+=Gr),Cr=Lt[pr-Br],sr=Jt(or,sr,jt[Cr]>>3),sr-=3;var Kr=Cr<4?0:Cr-2>>1;Kr>0&&(dr(or,sr,pr-Br-bt[Cr]),sr+=Kr);for(var Yr=0;Yr<Xr;++Yr)Ar[Ur]=pr&32767,Ur=(Ur<<5^mr[pr])&32767,++pr;br-=Xr-1}else Cr<=143?Cr=Cr+48:sr=qt(or,sr,1),sr=Jt(or,sr,jt[Cr]),Ar[Ur]=pr&32767,++pr}sr=Jt(or,sr,0)-1}return or.l=(sr+7)/8|0,or.l}return function(or,sr){return or.length<8?Bt(or,sr):tr(or,sr)}}();function Pr(wt){var Lt=new_buf(50+Math.floor(wt.length*1.1)),kt=Nr(wt,Lt);return Lt.slice(0,kt)}var kr=Ot?new Uint16Array(32768):_r(32768),Dr=Ot?new Uint16Array(32768):_r(32768),jr=Ot?new Uint16Array(128):_r(128),Hr=1,yr=1;function rr(wt,Lt){var kt=Yt(wt,Lt)+257;Lt+=5;var Pt=Yt(wt,Lt)+1;Lt+=5;var Rt=hr(wt,Lt)+4;Lt+=4;for(var Bt=0,tr=Ot?new Uint8Array(19):_r(19),mr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],or=1,sr=Ot?new Uint8Array(8):_r(8),pr=Ot?new Uint8Array(8):_r(8),Ar=tr.length,br=0;br<Rt;++br)tr[xt[br]]=Bt=cr(wt,Lt),or<Bt&&(or=Bt),sr[Bt]++,Lt+=3;var Ur=0;for(sr[0]=0,br=1;br<=or;++br)pr[br]=Ur=Ur+sr[br-1]<<1;for(br=0;br<Ar;++br)(Ur=tr[br])!=0&&(mr[br]=pr[Ur]++);var Cr=0;for(br=0;br<Ar;++br)if(Cr=tr[br],Cr!=0){Ur=jt[mr[br]]>>8-Cr;for(var Br=(1<<7-Cr)-1;Br>=0;--Br)jr[Ur|Br<<Cr]=Cr&7|br<<3}var Xr=[];for(or=1;Xr.length<kt+Pt;)switch(Ur=jr[Xt(wt,Lt)],Lt+=Ur&7,Ur>>>=3){case 16:for(Bt=3+ur(wt,Lt),Lt+=2,Ur=Xr[Xr.length-1];Bt-- >0;)Xr.push(Ur);break;case 17:for(Bt=3+cr(wt,Lt),Lt+=3;Bt-- >0;)Xr.push(0);break;case 18:for(Bt=11+Xt(wt,Lt),Lt+=7;Bt-- >0;)Xr.push(0);break;default:Xr.push(Ur),or<Ur&&(or=Ur);break}var Gr=Xr.slice(0,kt),Kr=Xr.slice(kt);for(br=kt;br<286;++br)Gr[br]=0;for(br=Pt;br<30;++br)Kr[br]=0;return Hr=Zt(Gr,kr,286),yr=Zt(Kr,Dr,30),Lt}function ar(wt,Lt){if(wt[0]==3&&!(wt[1]&3))return[new_raw_buf(Lt),2];for(var kt=0,Pt=0,Rt=new_unsafe_buf(Lt||1<<18),Bt=0,tr=Rt.length>>>0,mr=0,or=0;!(Pt&1);){if(Pt=cr(wt,kt),kt+=3,Pt>>>1)Pt>>1==1?(mr=9,or=5):(kt=rr(wt,kt),mr=Hr,or=yr);else{kt&7&&(kt+=8-(kt&7));var sr=wt[kt>>>3]|wt[(kt>>>3)+1]<<8;if(kt+=32,sr>0)for(!Lt&&tr<Bt+sr&&(Rt=vr(Rt,Bt+sr),tr=Rt.length);sr-- >0;)Rt[Bt++]=wt[kt>>>3],kt+=8;continue}for(;;){!Lt&&tr<Bt+32767&&(Rt=vr(Rt,Bt+32767),tr=Rt.length);var pr=Ft(wt,kt,mr),Ar=Pt>>>1==1?Er[pr]:kr[pr];if(kt+=Ar&15,Ar>>>=4,!(Ar>>>8&255))Rt[Bt++]=Ar;else{if(Ar==256)break;Ar-=257;var br=Ar<8?0:Ar-4>>2;br>5&&(br=0);var Ur=Bt+Et[Ar];br>0&&(Ur+=Ft(wt,kt,br),kt+=br),pr=Ft(wt,kt,or),Ar=Pt>>>1==1?Sr[pr]:Dr[pr],kt+=Ar&15,Ar>>>=4;var Cr=Ar<4?0:Ar-2>>1,Br=bt[Ar];for(Cr>0&&(Br+=Ft(wt,kt,Cr),kt+=Cr),!Lt&&tr<Ur&&(Rt=vr(Rt,Ur+100),tr=Rt.length);Bt<Ur;)Rt[Bt]=Rt[Bt-Br],++Bt}}}return Lt?[Rt,kt+7>>>3]:[Rt.slice(0,Bt),kt+7>>>3]}function Rr(wt,Lt){var kt=wt.slice(wt.l||0),Pt=ar(kt,Lt);return wt.l+=Pt[1],Pt[0]}function zr(wt,Lt){if(wt)typeof console<"u"&&console.error(Lt);else throw new Error(Lt)}function Wr(wt,Lt){var kt=wt;prep_blob(kt,0);var Pt=[],Rt=[],Bt={FileIndex:Pt,FullPaths:Rt};ot(Bt,{root:Lt.root});for(var tr=kt.length-4;(kt[tr]!=80||kt[tr+1]!=75||kt[tr+2]!=5||kt[tr+3]!=6)&&tr>=0;)--tr;kt.l=tr+4,kt.l+=4;var mr=kt.read_shift(2);kt.l+=6;var or=kt.read_shift(4);for(kt.l=or,tr=0;tr<mr;++tr){kt.l+=20;var sr=kt.read_shift(4),pr=kt.read_shift(4),Ar=kt.read_shift(2),br=kt.read_shift(2),Ur=kt.read_shift(2);kt.l+=8;var Cr=kt.read_shift(4),Br=d(kt.slice(kt.l+Ar,kt.l+Ar+br));kt.l+=Ar+br+Ur;var Xr=kt.l;kt.l=Cr+4,zt(kt,sr,pr,Bt,Br),kt.l=Xr}return Bt}function zt(wt,Lt,kt,Pt,Rt){wt.l+=2;var Bt=wt.read_shift(2),tr=wt.read_shift(2),mr=h(wt);if(Bt&8257)throw new Error("Unsupported ZIP encryption");for(var or=wt.read_shift(4),sr=wt.read_shift(4),pr=wt.read_shift(4),Ar=wt.read_shift(2),br=wt.read_shift(2),Ur="",Cr=0;Cr<Ar;++Cr)Ur+=String.fromCharCode(wt[wt.l++]);if(br){var Br=d(wt.slice(wt.l,wt.l+br));(Br[21589]||{}).mt&&(mr=Br[21589].mt),((Rt||{})[21589]||{}).mt&&(mr=Rt[21589].mt)}wt.l+=br;var Xr=wt.slice(wt.l,wt.l+sr);switch(tr){case 8:Xr=ht(wt,pr);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+tr)}var Gr=!1;Bt&8&&(or=wt.read_shift(4),or==134695760&&(or=wt.read_shift(4),Gr=!0),sr=wt.read_shift(4),pr=wt.read_shift(4)),sr!=Lt&&zr(Gr,"Bad compressed size: "+Lt+" != "+sr),pr!=kt&&zr(Gr,"Bad uncompressed size: "+kt+" != "+pr),xr(Pt,Ur,Xr,{unsafe:!0,mt:mr})}function gr(wt,Lt){var kt=Lt||{},Pt=[],Rt=[],Bt=new_buf(1),tr=kt.compression?8:0,mr=0,or=0,sr=0,pr=0,Ar=0,br=wt.FullPaths[0],Ur=br,Cr=wt.FileIndex[0],Br=[],Xr=0;for(or=1;or<wt.FullPaths.length;++or)if(Ur=wt.FullPaths[or].slice(br.length),Cr=wt.FileIndex[or],!(!Cr.size||!Cr.content||Ur=="Sh33tJ5")){var Gr=pr,Kr=new_buf(Ur.length);for(sr=0;sr<Ur.length;++sr)Kr.write_shift(1,Ur.charCodeAt(sr)&127);Kr=Kr.slice(0,Kr.l),Br[Ar]=CRC32.buf(Cr.content,0);var Yr=Cr.content;tr==8&&(Yr=ct(Yr)),Bt=new_buf(30),Bt.write_shift(4,67324752),Bt.write_shift(2,20),Bt.write_shift(2,mr),Bt.write_shift(2,tr),Cr.mt?c(Bt,Cr.mt):Bt.write_shift(4,0),Bt.write_shift(-4,Br[Ar]),Bt.write_shift(4,Yr.length),Bt.write_shift(4,Cr.content.length),Bt.write_shift(2,Kr.length),Bt.write_shift(2,0),pr+=Bt.length,Pt.push(Bt),pr+=Kr.length,Pt.push(Kr),pr+=Yr.length,Pt.push(Yr),Bt=new_buf(46),Bt.write_shift(4,33639248),Bt.write_shift(2,0),Bt.write_shift(2,20),Bt.write_shift(2,mr),Bt.write_shift(2,tr),Bt.write_shift(4,0),Bt.write_shift(-4,Br[Ar]),Bt.write_shift(4,Yr.length),Bt.write_shift(4,Cr.content.length),Bt.write_shift(2,Kr.length),Bt.write_shift(2,0),Bt.write_shift(2,0),Bt.write_shift(2,0),Bt.write_shift(2,0),Bt.write_shift(4,0),Bt.write_shift(4,Gr),Xr+=Bt.l,Rt.push(Bt),Xr+=Kr.length,Rt.push(Kr),++Ar}return Bt=new_buf(22),Bt.write_shift(4,101010256),Bt.write_shift(2,0),Bt.write_shift(2,0),Bt.write_shift(2,Ar),Bt.write_shift(2,Ar),Bt.write_shift(4,Xr),Bt.write_shift(4,pr),Bt.write_shift(2,0),bconcat([bconcat(Pt),bconcat(Rt),Bt])}var Tr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lr(wt,Lt){if(wt.ctype)return wt.ctype;var kt=wt.name||"",Pt=kt.match(/\.([^\.]+)$/);return Pt&&Tr[Pt[1]]||Lt&&(Pt=(kt=Lt).match(/[\.\\]([^\.\\])+$/),Pt&&Tr[Pt[1]])?Tr[Pt[1]]:"application/octet-stream"}function Or(wt){for(var Lt=Base64_encode(wt),kt=[],Pt=0;Pt<Lt.length;Pt+=76)kt.push(Lt.slice(Pt,Pt+76));return kt.join(`\r
`)+`\r
`}function Fr(wt){var Lt=wt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(sr){var pr=sr.charCodeAt(0).toString(16).toUpperCase();return"="+(pr.length==1?"0"+pr:pr)});Lt=Lt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Lt.charAt(0)==`
`&&(Lt="=0D"+Lt.slice(1)),Lt=Lt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var kt=[],Pt=Lt.split(`\r
`),Rt=0;Rt<Pt.length;++Rt){var Bt=Pt[Rt];if(Bt.length==0){kt.push("");continue}for(var tr=0;tr<Bt.length;){var mr=76,or=Bt.slice(tr,tr+mr);or.charAt(mr-1)=="="?mr--:or.charAt(mr-2)=="="?mr-=2:or.charAt(mr-3)=="="&&(mr-=3),or=Bt.slice(tr,tr+mr),tr+=mr,tr<Bt.length&&(or+="="),kt.push(or)}}return kt.join(`\r
`)}function Vt(wt){for(var Lt=[],kt=0;kt<wt.length;++kt){for(var Pt=wt[kt];kt<=wt.length&&Pt.charAt(Pt.length-1)=="=";)Pt=Pt.slice(0,Pt.length-1)+wt[++kt];Lt.push(Pt)}for(var Rt=0;Rt<Lt.length;++Rt)Lt[Rt]=Lt[Rt].replace(/[=][0-9A-Fa-f]{2}/g,function(Bt){return String.fromCharCode(parseInt(Bt.slice(1),16))});return s2a(Lt.join(`\r
`))}function Mt(wt,Lt,kt){for(var Pt="",Rt="",Bt="",tr,mr=0;mr<10;++mr){var or=Lt[mr];if(!or||or.match(/^\s*$/))break;var sr=or.match(/^(.*?):\s*([^\s].*)$/);if(sr)switch(sr[1].toLowerCase()){case"content-location":Pt=sr[2].trim();break;case"content-type":Bt=sr[2].trim();break;case"content-transfer-encoding":Rt=sr[2].trim();break}}switch(++mr,Rt.toLowerCase()){case"base64":tr=s2a(Base64_decode(Lt.slice(mr).join("")));break;case"quoted-printable":tr=Vt(Lt.slice(mr));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Rt)}var pr=xr(wt,Pt.slice(kt.length),tr,{unsafe:!0});Bt&&(pr.ctype=Bt)}function Kt(wt,Lt){if(yt(wt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var kt=Lt&&Lt.root||"",Pt=(has_buf&&Buffer.isBuffer(wt)?wt.toString("binary"):yt(wt)).split(`\r
`),Rt=0,Bt="";for(Rt=0;Rt<Pt.length;++Rt)if(Bt=Pt[Rt],!!/^Content-Location:/i.test(Bt)&&(Bt=Bt.slice(Bt.indexOf("file")),kt||(kt=Bt.slice(0,Bt.lastIndexOf("/")+1)),Bt.slice(0,kt.length)!=kt))for(;kt.length>0&&(kt=kt.slice(0,kt.length-1),kt=kt.slice(0,kt.lastIndexOf("/")+1),Bt.slice(0,kt.length)!=kt););var tr=(Pt[1]||"").match(/boundary="(.*?)"/);if(!tr)throw new Error("MAD cannot find boundary");var mr="--"+(tr[1]||""),or=[],sr=[],pr={FileIndex:or,FullPaths:sr};ot(pr);var Ar,br=0;for(Rt=0;Rt<Pt.length;++Rt){var Ur=Pt[Rt];Ur!==mr&&Ur!==mr+"--"||(br++&&Mt(pr,Pt.slice(Ar,Rt),kt),Ar=Rt)}return pr}function lr(wt,Lt){var kt=Lt||{},Pt=kt.boundary||"SheetJS";Pt="------="+Pt;for(var Rt=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Pt.slice(2)+'"',"","",""],Bt=wt.FullPaths[0],tr=Bt,mr=wt.FileIndex[0],or=1;or<wt.FullPaths.length;++or)if(tr=wt.FullPaths[or].slice(Bt.length),mr=wt.FileIndex[or],!(!mr.size||!mr.content||tr=="Sh33tJ5")){tr=tr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xr){return"_x"+Xr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xr){return"_u"+Xr.charCodeAt(0).toString(16)+"_"});for(var sr=mr.content,pr=has_buf&&Buffer.isBuffer(sr)?sr.toString("binary"):yt(sr),Ar=0,br=Math.min(1024,pr.length),Ur=0,Cr=0;Cr<=br;++Cr)(Ur=pr.charCodeAt(Cr))>=32&&Ur<128&&++Ar;var Br=Ar>=br*4/5;Rt.push(Pt),Rt.push("Content-Location: "+(kt.root||"file:///C:/SheetJS/")+tr),Rt.push("Content-Transfer-Encoding: "+(Br?"quoted-printable":"base64")),Rt.push("Content-Type: "+Lr(mr,tr)),Rt.push(""),Rt.push(Br?Fr(pr):Or(pr))}return Rt.push(Pt+`--\r
`),Rt.join(`\r
`)}function fr(wt){var Lt={};return ot(Lt,wt),Lt}function xr(wt,Lt,kt,Pt){var Rt=Pt&&Pt.unsafe;Rt||ot(wt);var Bt=!Rt&&CFB.find(wt,Lt);if(!Bt){var tr=wt.FullPaths[0];Lt.slice(0,tr.length)==tr?tr=Lt:(tr.slice(-1)!="/"&&(tr+="/"),tr=(tr+Lt).replace("//","/")),Bt={name:o(Lt),type:2},wt.FileIndex.push(Bt),wt.FullPaths.push(tr),Rt||CFB.utils.cfb_gc(wt)}return Bt.content=kt,Bt.size=kt?kt.length:0,Pt&&(Pt.CLSID&&(Bt.clsid=Pt.CLSID),Pt.mt&&(Bt.mt=Pt.mt),Pt.ct&&(Bt.ct=Pt.ct)),Bt}function wr(wt,Lt){ot(wt);var kt=CFB.find(wt,Lt);if(kt){for(var Pt=0;Pt<wt.FileIndex.length;++Pt)if(wt.FileIndex[Pt]==kt)return wt.FileIndex.splice(Pt,1),wt.FullPaths.splice(Pt,1),!0}return!1}function Ir(wt,Lt,kt){ot(wt);var Pt=CFB.find(wt,Lt);if(Pt){for(var Rt=0;Rt<wt.FileIndex.length;++Rt)if(wt.FileIndex[Rt]==Pt)return wt.FileIndex[Rt].name=o(kt),wt.FullPaths[Rt]=kt,!0}return!1}function Mr(wt){pt(wt,!0)}return i.find=gt,i.read=ut,i.parse=b,i.write=Dt,i.writeFile=Wt,i.utils={cfb_new:fr,cfb_add:xr,cfb_del:wr,cfb_mov:Ir,cfb_gc:Mr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:_t,_deflateRaw:Pr,_inflateRaw:Rr,consts:It},i}();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,i,a){if(typeof Deno<"u"){if(a&&typeof i=="string")switch(a){case"utf8":i=new TextEncoder(a).encode(i);break;case"binary":i=s2ab(i);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,i)}var s=a=="utf8"?utf8write(i):i;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var o=new Blob([blobify(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var h=document.createElement("a");if(h.download!=null)return h.download=e,h.href=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(i)&&(i=a2s(i)),d.write(i),d.close(),i}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var i=File(e);i.open("r"),i.encoding="binary";var a=i.read();return i.close(),a}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function keys(e){for(var i=Object.keys(e),a=[],s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e,i[s])&&a.push(i[s]);return a}function evert_key(e,i){for(var a=[],s=keys(e),o=0;o!==s.length;++o)a[e[s[o]][i]]==null&&(a[e[s[o]][i]]=s[o]);return a}function evert(e){for(var i=[],a=keys(e),s=0;s!==a.length;++s)i[e[a[s]]]=a[s];return i}function evert_num(e){for(var i=[],a=keys(e),s=0;s!==a.length;++s)i[e[a[s]]]=parseInt(a[s],10);return i}function evert_arr(e){for(var i=[],a=keys(e),s=0;s!==a.length;++s)i[e[a[s]]]==null&&(i[e[a[s]]]=[]),i[e[a[s]]].push(a[s]);return i}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,i){var a=e.getTime(),s=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(a-s)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var i=new Date;return i.setTime(e*24*60*60*1e3+dnthresh),i.getTimezoneOffset()!==refoffset&&i.setTime(i.getTime()+(i.getTimezoneOffset()-refoffset)*6e4),i}function parse_isodur(e){var i=0,a=0,s=!1,o=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!o)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=o.length;++c)if(o[c]){switch(a=1,c>3&&(s=!0),o[c].slice(o[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+o[c].slice(o[c].length-1));case"D":a*=24;case"H":a*=60;case"M":if(s)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}i+=a*parseInt(o[c],10)}return i}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,i){var a=new Date(e);if(good_pd)return i>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):i<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(a.getFullYear())){var s=a.getFullYear();return e.indexOf(""+s)>-1||a.setFullYear(a.getFullYear()+100),a}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function cc2str(e,i){if(has_buf&&Buffer.isBuffer(e)){if(i){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(i){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return a[c]||c})}catch{}for(var s=[],o=0;o!=e.length;++o)s.push(String.fromCharCode(e[o]));return s.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i[a]=dup(e[a]));return i}function fill(e,i){for(var a="";a.length<i;)a+=e;return a}function fuzzynum(e){var i=Number(e);if(!isNaN(i))return isFinite(i)?i:NaN;if(!/\d/.test(e))return i;var a=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(i=Number(s))||(s=s.replace(/[(](.*)[)]/,function(o,c){return a=-a,c}),!isNaN(i=Number(s)))?i/a:i}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var i=new Date(e),a=new Date(NaN),s=i.getYear(),o=i.getMonth(),c=i.getDate();if(isNaN(c))return a;var h=e.toLowerCase();if(h.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(h=h.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),h.length>3&&lower_months.indexOf(h)==-1)return a}else if(h.match(/[a-z]/))return a;return s<0||s>8099?a:(o>0||c>1)&&s!=101?i:e.match(/[^-0-9:,\/\\]/)?a:i}var split_regex=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,s,o){if(e||typeof s=="string")return a.split(s);for(var c=a.split(s),h=[c[0]],d=1;d<c.length;++d)h.push(o),h.push(c[d]);return h}}();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var i=e._data.getContent();return typeof i=="string"?char_codes(i):Array.prototype.slice.call(i)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,i){for(var a=e.FullPaths||keys(e.files),s=i.toLowerCase().replace(/[\/]/g,"\\"),o=s.replace(/\\/g,"/"),c=0;c<a.length;++c){var h=a[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==h||o==h)return e.files?e.files[a[c]]:e.FileIndex[c]}return null}function getzipfile(e,i){var a=safegetzipfile(e,i);if(a==null)throw new Error("Cannot find file "+i+" in zip");return a}function getzipdata(e,i,a){if(!a)return getdata(getzipfile(e,i));if(!i)return null;try{return getzipdata(e,i)}catch{return null}}function getzipstr(e,i,a){if(!a)return getdatastr(getzipfile(e,i));if(!i)return null;try{return getzipstr(e,i)}catch{return null}}function getzipbin(e,i,a){return getdatabin(getzipfile(e,i))}function zipentries(e){for(var i=e.FullPaths||keys(e.files),a=[],s=0;s<i.length;++s)i[s].slice(-1)!="/"&&a.push(i[s].replace(/^Root Entry[\/]/,""));return a.sort()}function zip_add_file(e,i,a){if(e.FullPaths){if(typeof a=="string"){var s;return has_buf?s=Buffer_from(a):s=utf8decode(a),CFB.utils.cfb_add(e,i,s)}CFB.utils.cfb_add(e,i,a)}else e.file(i,a)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(e,i){switch(i.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+i.type)}function resolve_path(e,i){if(e.charAt(0)=="/")return e.slice(1);var a=i.split("/");i.slice(-1)!="/"&&a.pop();for(var s=e.split("/");s.length!==0;){var o=s.shift();o===".."?a.pop():o!=="."&&a.push(o)}return a.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,i,a){for(var s={},o=0,c=0;o!==e.length&&!((c=e.charCodeAt(o))===32||c===10||c===13);++o);if(i||(s[0]=e.slice(0,o)),o===e.length)return s;var h=e.match(attregexg),d=0,g="",_=0,b="",j="",_e=1;if(h)for(_=0;_!=h.length;++_){for(j=h[_],c=0;c!=j.length&&j.charCodeAt(c)!==61;++c);for(b=j.slice(0,c).trim();j.charCodeAt(c+1)==32;)++c;for(_e=(o=j.charCodeAt(c+1))==34||o==39?1:0,g=j.slice(c+1+_e,j.length-_e),d=0;d!=b.length&&b.charCodeAt(d)!==58;++d);if(d===b.length)b.indexOf("_")>0&&(b=b.slice(0,b.indexOf("_"))),s[b]=g,s[b.toLowerCase()]=g;else{var et=(d===5&&b.slice(0,5)==="xmlns"?"xmlns":"")+b.slice(d+1);if(s[et]&&b.slice(d-3,d)=="ext")continue;s[et]=g,s[et.toLowerCase()]=g}}return s}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,i=/_x([\da-fA-F]{4})_/ig;return function a(s){var o=s+"",c=o.indexOf("<![CDATA[");if(c==-1)return o.replace(e,function(d,g){return encodings[d]||String.fromCharCode(parseInt(g,d.indexOf("x")>-1?16:10))||d}).replace(i,function(d,g){return String.fromCharCode(parseInt(g,16))});var h=o.indexOf("]]>");return a(o.slice(0,c))+o.slice(c+9,h)+a(o.slice(h+3))}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var i=e+"";return i.replace(decregex,function(a){return rencoding[a]}).replace(charegex,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var i=e+"";return i.replace(decregex,function(a){return rencoding[a]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var i=e+"";return i.replace(decregex,function(a){return rencoding[a]}).replace(htmlcharegex,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var e=/&#(\d+);/g;function i(a,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,i)}}();function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var i="",a=0,s=0,o=0,c=0,h=0,d=0;a<e.length;){if(s=e.charCodeAt(a++),s<128){i+=String.fromCharCode(s);continue}if(o=e.charCodeAt(a++),s>191&&s<224){h=(s&31)<<6,h|=o&63,i+=String.fromCharCode(h);continue}if(c=e.charCodeAt(a++),s<240){i+=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63);continue}h=e.charCodeAt(a++),d=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536,i+=String.fromCharCode(55296+(d>>>10&1023)),i+=String.fromCharCode(56320+(d&1023))}return i}function utf8readb(e){var i=new_raw_buf(2*e.length),a,s,o=1,c=0,h=0,d;for(s=0;s<e.length;s+=o)o=1,(d=e.charCodeAt(s))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(s+1)&63),o=2):d<240?(a=(d&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),o=3):(o=4,a=(d&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),a-=65536,h=55296+(a>>>10&1023),a=56320+(a&1023)),h!==0&&(i[c++]=h&255,i[c++]=h>>>8,h=0),i[c++]=a%256,i[c++]=a>>>8;return i.slice(0,c).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var i=[],a=0,s=0,o=0;a<e.length;)switch(s=e.charCodeAt(a++),!0){case s<128:i.push(String.fromCharCode(s));break;case s<2048:i.push(String.fromCharCode(192+(s>>6))),i.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,o=e.charCodeAt(a++)-56320+(s<<10),i.push(String.fromCharCode(240+(o>>18&7))),i.push(String.fromCharCode(144+(o>>12&63))),i.push(String.fromCharCode(128+(o>>6&63))),i.push(String.fromCharCode(128+(o&63)));break;default:i.push(String.fromCharCode(224+(s>>12))),i.push(String.fromCharCode(128+(s>>6&63))),i.push(String.fromCharCode(128+(s&63)))}return i.join("")},matchtag=function(){var e={};return function(a,s){var o=a+"|"+(s||"");return e[o]?e[o]:e[o]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",s||"")}}(),htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(i){return[new RegExp("&"+i[0]+";","ig"),i[1]]});return function(a){for(var s=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<e.length;++o)s=s.replace(e[o][0],e[o][1]);return s}}(),vtregex=function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,i){var a=parsexmltag(e),s=e.match(vtregex(a.baseType))||[],o=[];if(s.length!=a.size){if(i.WTF)throw new Error("unexpected vector length "+s.length+" != "+a.size);return o}return s.forEach(function(c){var h=c.replace(vtvregex,"").match(vtmregex);h&&o.push({v:utf8read(h[2]),t:h[1]})}),o}var wtregex=/(^\s|\s$|\n)/;function writetag(e,i){return"<"+e+(i.match(wtregex)?' xml:space="preserve"':"")+">"+i+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(i){return" "+i+'="'+e[i]+'"'}).join("")}function writextag(e,i,a){return"<"+e+(a!=null?wxt_helper(a):"")+(i!=null?(i.match(wtregex)?' xml:space="preserve"':"")+">"+i+"</"+e:"/")+">"}function write_w3cdtf(e,i){try{return e.toISOString().replace(/\.\d*/,"")}catch(a){if(i)throw a}return""}function write_vt(e,i){switch(typeof e){case"string":var a=writextag("vt:lpwstr",escapexml(e));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,i){for(var a=1-2*(e[i+7]>>>7),s=((e[i+7]&127)<<4)+(e[i+6]>>>4&15),o=e[i+6]&15,c=5;c>=0;--c)o=o*256+e[i+c];return s==2047?o==0?a*(1/0):NaN:(s==0?s=-1022:(s-=1023,o+=Math.pow(2,52)),a*Math.pow(2,s-52)*o)}function write_double_le(e,i,a){var s=(i<0||1/i==-1/0?1:0)<<7,o=0,c=0,h=s?-i:i;isFinite(h)?h==0?o=c=0:(o=Math.floor(Math.log(h)/Math.LN2),c=h*Math.pow(2,52-o),o<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?o=-1022:(c-=Math.pow(2,52),o+=1023)):(o=2047,c=isNaN(i)?26985:0);for(var d=0;d<=5;++d,c/=256)e[a+d]=c&255;e[a+6]=(o&15)<<4|c&15,e[a+7]=o>>4|s}var ___toBuffer=function(e){for(var i=[],a=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var o=0,c=e[0][s].length;o<c;o+=a)i.push.apply(i,e[0][s].slice(o,o+a));return i},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(i){return Buffer.isBuffer(i)?i:Buffer_from(i)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,i,a){for(var s=[],o=i;o<a;o+=2)s.push(String.fromCharCode(__readUInt16LE(e,o)));return s.join("").replace(chr0,"")},__utf16le=has_buf?function(e,i,a){return Buffer.isBuffer(e)?e.toString("utf16le",i,a).replace(chr0,""):___utf16le(e,i,a)}:___utf16le,___hexlify=function(e,i,a){for(var s=[],o=i;o<i+a;++o)s.push(("0"+e[o].toString(16)).slice(-2));return s.join("")},__hexlify=has_buf?function(e,i,a){return Buffer.isBuffer(e)?e.toString("hex",i,i+a):___hexlify(e,i,a)}:___hexlify,___utf8=function(e,i,a){for(var s=[],o=i;o<a;o++)s.push(String.fromCharCode(__readUInt8(e,o)));return s.join("")},__utf8=has_buf?function(i,a,s){return Buffer.isBuffer(i)?i.toString("utf8",a,s):___utf8(i,a,s)}:___utf8,___lpstr=function(e,i){var a=__readUInt32LE(e,i);return a>0?__utf8(e,i+4,i+4+a-1):""},__lpstr=___lpstr,___cpstr=function(e,i){var a=__readUInt32LE(e,i);return a>0?__utf8(e,i+4,i+4+a-1):""},__cpstr=___cpstr,___lpwstr=function(e,i){var a=2*__readUInt32LE(e,i);return a>0?__utf8(e,i+4,i+4+a-1):""},__lpwstr=___lpwstr,___lpp4=function(i,a){var s=__readUInt32LE(i,a);return s>0?__utf16le(i,a+4,a+4+s):""},__lpp4=___lpp4,___8lpp4=function(e,i){var a=__readUInt32LE(e,i);return a>0?__utf8(e,i+4,i+4+a):""},__8lpp4=___8lpp4,___double=function(e,i){return read_double_le(e,i)},__double=___double,is_buf=function(i){return Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array};has_buf&&(__lpstr=function(i,a){if(!Buffer.isBuffer(i))return ___lpstr(i,a);var s=i.readUInt32LE(a);return s>0?i.toString("utf8",a+4,a+4+s-1):""},__cpstr=function(i,a){if(!Buffer.isBuffer(i))return ___cpstr(i,a);var s=i.readUInt32LE(a);return s>0?i.toString("utf8",a+4,a+4+s-1):""},__lpwstr=function(i,a){if(!Buffer.isBuffer(i))return ___lpwstr(i,a);var s=2*i.readUInt32LE(a);return i.toString("utf16le",a+4,a+4+s-1)},__lpp4=function(i,a){if(!Buffer.isBuffer(i))return ___lpp4(i,a);var s=i.readUInt32LE(a);return i.toString("utf16le",a+4,a+4+s)},__8lpp4=function(i,a){if(!Buffer.isBuffer(i))return ___8lpp4(i,a);var s=i.readUInt32LE(a);return i.toString("utf8",a+4,a+4+s)},__double=function(i,a){return Buffer.isBuffer(i)?i.readDoubleLE(a):___double(i,a)},is_buf=function(i){return Buffer.isBuffer(i)||Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array});var __readUInt8=function(e,i){return e[i]},__readUInt16LE=function(e,i){return e[i+1]*256+e[i]},__readInt16LE=function(e,i){var a=e[i+1]*256+e[i];return a<32768?a:(65535-a+1)*-1},__readUInt32LE=function(e,i){return e[i+3]*(1<<24)+(e[i+2]<<16)+(e[i+1]<<8)+e[i]},__readInt32LE=function(e,i){return e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]},__readInt32BE=function(e,i){return e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]};function ReadShift(e,i){var a="",s,o,c=[],h,d,g,_;switch(i){case"dbcs":if(_=this.l,has_buf&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)a+=String.fromCharCode(__readUInt16LE(this,_)),_+=2;e*=2;break;case"utf8":a=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,a=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":a=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":a=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":a=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),a=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),a=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(h=__readUInt8(this,this.l+e++))!==0;)c.push(_getchar(h));a=c.join("");break;case"_wstr":for(e=0,a="";(h=__readUInt16LE(this,this.l+e))!==0;)c.push(_getchar(h)),e+=2;e+=2,a=c.join("");break;case"dbcs-cont":for(a="",_=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(_)!==-1)return h=__readUInt8(this,_),this.l=_+1,d=ReadShift.call(this,e-g,h?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(_getchar(__readUInt16LE(this,_))),_+=2}a=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",_=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(_)!==-1)return h=__readUInt8(this,_),this.l=_+1,d=ReadShift.call(this,e-g,h?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(_getchar(__readUInt8(this,_))),_+=1}a=c.join("");break;default:switch(e){case 1:return s=__readUInt8(this,this.l),this.l++,s;case 2:return s=(i==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,s;case 4:case-4:return i==="i"||!(this[this.l+3]&128)?(s=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,s):(o=__readUInt32LE(this,this.l),this.l+=4,o);case 8:case-8:if(i==="f")return e==8?o=__double(this,this.l):o=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:a=__hexlify(this,this.l,e);break}}return this.l+=e,a}var __writeUInt32LE=function(e,i,a){e[a]=i&255,e[a+1]=i>>>8&255,e[a+2]=i>>>16&255,e[a+3]=i>>>24&255},__writeInt32LE=function(e,i,a){e[a]=i&255,e[a+1]=i>>8&255,e[a+2]=i>>16&255,e[a+3]=i>>24&255},__writeUInt16LE=function(e,i,a){e[a]=i&255,e[a+1]=i>>>8&255};function WriteShift(e,i,a){var s=0,o=0;if(a==="dbcs"){for(o=0;o!=i.length;++o)__writeUInt16LE(this,i.charCodeAt(o),this.l+2*o);s=2*i.length}else if(a==="sbcs"){for(i=i.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=i.length;++o)this[this.l+o]=i.charCodeAt(o)&255;s=i.length}else if(a==="hex"){for(;o<e;++o)this[this.l++]=parseInt(i.slice(2*o,2*o+2),16)||0;return this}else if(a==="utf16le"){var c=Math.min(this.l+e,this.length);for(o=0;o<Math.min(i.length,e);++o){var h=i.charCodeAt(o);this[this.l++]=h&255,this[this.l++]=h>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=i&255;break;case 2:s=2,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255;break;case 3:s=3,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255,i>>>=8,this[this.l+2]=i&255;break;case 4:s=4,__writeUInt32LE(this,i,this.l);break;case 8:if(s=8,a==="f"){write_double_le(this,i,this.l);break}case 16:break;case-4:s=4,__writeInt32LE(this,i,this.l);break}return this.l+=s,this}function CheckField(e,i){var a=__hexlify(this,this.l,e.length>>1);if(a!==e)throw new Error(i+"Expected "+e+" saw "+a);this.l+=e.length>>1}function prep_blob(e,i){e.l=i,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,i){e.l+=i}function new_buf(e){var i=new_raw_buf(e);return prep_blob(i,0),i}function recordhopper(e,i,a){if(e){var s,o,c;prep_blob(e,e.l||0);for(var h=e.length,d=0,g=0;e.l<h;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var _=XLSBRecordEnum[d]||XLSBRecordEnum[65535];for(s=e.read_shift(1),c=s&127,o=1;o<4&&s&128;++o)c+=((s=e.read_shift(1))&127)<<7*o;g=e.l+c;var b=_.f&&_.f(e,c,a);if(e.l=g,i(b,_,d))return}}}function buf_array(){var e=[],i=has_buf?256:2048,a=function(_){var b=new_buf(_);return prep_blob(b,0),b},s=a(i),o=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},c=function(_){return s&&_<s.length-s.l?s:(o(),s=a(Math.max(_+1,i)))},h=function(){return o(),bconcat(e)},d=function(_){o(),s=_,s.l==null&&(s.l=s.length),c(i)};return{next:c,push:d,end:h,_bufs:e}}function write_record(e,i,a,s){var o=+i,c;if(!isNaN(o)){s||(s=XLSBRecordEnum[o].p||(a||[]).length||0),c=1+(o>=128?1:0)+1,s>=128&&++c,s>=16384&&++c,s>=2097152&&++c;var h=e.next(c);o<=127?h.write_shift(1,o):(h.write_shift(1,(o&127)+128),h.write_shift(1,o>>7));for(var d=0;d!=4;++d)if(s>=128)h.write_shift(1,(s&127)+128),s>>=7;else{h.write_shift(1,s);break}s>0&&is_buf(a)&&e.push(a)}}function shift_cell_xls(e,i,a){var s=dup(e);if(i.s?(s.cRel&&(s.c+=i.s.c),s.rRel&&(s.r+=i.s.r)):(s.cRel&&(s.c+=i.c),s.rRel&&(s.r+=i.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function shift_range_xls(e,i,a){var s=dup(e);return s.s=shift_cell_xls(s.s,i.s,a),s.e=shift_cell_xls(s.e,i.s,a),s}function encode_cell_xls(e,i){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=i>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=i>8?1048576:i>5?65536:16384;var a=encode_cell(e);return!e.cRel&&e.cRel!=null&&(a=fix_col(a)),!e.rRel&&e.rRel!=null&&(a=fix_row(a)),a}function encode_range_xls(e,i){return e.s.r==0&&!e.s.rRel&&e.e.r==(i.biff>=12?1048575:i.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(i.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,i.biff)+":"+encode_cell_xls(e.e,i.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var i=unfix_col(e),a=0,s=0;s!==i.length;++s)a=26*a+i.charCodeAt(s)-64;return a-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var i="";for(++e;e;e=Math.floor((e-1)/26))i=String.fromCharCode((e-1)%26+65)+i;return i}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var i=0,a=0,s=0;s<e.length;++s){var o=e.charCodeAt(s);o>=48&&o<=57?i=10*i+(o-48):o>=65&&o<=90&&(a=26*a+(o-64))}return{c:a-1,r:i-1}}function encode_cell(e){for(var i=e.c+1,a="";i;i=(i-1)/26|0)a=String.fromCharCode((i-1)%26+65)+a;return a+(e.r+1)}function decode_range(e){var i=e.indexOf(":");return i==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,i)),e:decode_cell(e.slice(i+1))}}function encode_range(e,i){return typeof i>"u"||typeof i=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof i!="string"&&(i=encode_cell(i)),e==i?e:e+":"+i)}function safe_decode_range(e){var i={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,o=0,c=e.length;for(a=0;s<c&&!((o=e.charCodeAt(s)-64)<1||o>26);++s)a=26*a+o;for(i.s.c=--a,a=0;s<c&&!((o=e.charCodeAt(s)-48)<0||o>9);++s)a=10*a+o;if(i.s.r=--a,s===c||o!=10)return i.e.c=i.s.c,i.e.r=i.s.r,i;for(++s,a=0;s!=c&&!((o=e.charCodeAt(s)-64)<1||o>26);++s)a=26*a+o;for(i.e.c=--a,a=0;s!=c&&!((o=e.charCodeAt(s)-48)<0||o>9);++s)a=10*a+o;return i.e.r=--a,i}function safe_format_cell(e,i){var a=e.t=="d"&&i instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,a?datenum(i):i)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(a?14:0),a?datenum(i):i)}catch{return""+i}}function format_cell(e,i,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?BErr[e.v]||e.v:i==null?safe_format_cell(e,e.v):safe_format_cell(e,i))}function sheet_to_workbook(e,i){var a=i&&i.sheet?i.sheet:"Sheet1",s={};return s[a]=e,{SheetNames:[a],Sheets:s}}function sheet_add_aoa(e,i,a){var s=a||{},o=e?Array.isArray(e):s.dense,c=e||(o?[]:{}),h=0,d=0;if(c&&s.origin!=null){if(typeof s.origin=="number")h=s.origin;else{var g=typeof s.origin=="string"?decode_cell(s.origin):s.origin;h=g.r,d=g.c}c["!ref"]||(c["!ref"]="A1:A1")}var _={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var b=safe_decode_range(c["!ref"]);_.s.c=b.s.c,_.s.r=b.s.r,_.e.c=Math.max(_.e.c,b.e.c),_.e.r=Math.max(_.e.r,b.e.r),h==-1&&(_.e.r=h=b.e.r+1)}for(var j=0;j!=i.length;++j)if(i[j]){if(!Array.isArray(i[j]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _e=0;_e!=i[j].length;++_e)if(!(typeof i[j][_e]>"u")){var et={v:i[j][_e]},rt=h+j,tt=d+_e;if(_.s.r>rt&&(_.s.r=rt),_.s.c>tt&&(_.s.c=tt),_.e.r<rt&&(_.e.r=rt),_.e.c<tt&&(_.e.c=tt),i[j][_e]&&typeof i[j][_e]=="object"&&!Array.isArray(i[j][_e])&&!(i[j][_e]instanceof Date))et=i[j][_e];else if(Array.isArray(et.v)&&(et.f=i[j][_e][1],et.v=et.v[0]),et.v===null)if(et.f)et.t="n";else if(s.nullError)et.t="e",et.v=0;else if(s.sheetStubs)et.t="z";else continue;else typeof et.v=="number"?et.t="n":typeof et.v=="boolean"?et.t="b":et.v instanceof Date?(et.z=s.dateNF||table_fmt[14],s.cellDates?(et.t="d",et.w=SSF_format(et.z,datenum(et.v))):(et.t="n",et.v=datenum(et.v),et.w=SSF_format(et.z,et.v))):et.t="s";if(o)c[rt]||(c[rt]=[]),c[rt][tt]&&c[rt][tt].z&&(et.z=c[rt][tt].z),c[rt][tt]=et;else{var it=encode_cell({c:tt,r:rt});c[it]&&c[it].z&&(et.z=c[it].z),c[it]=et}}}return _.s.c<1e7&&(c["!ref"]=encode_range(_)),c}function aoa_to_sheet(e,i){return sheet_add_aoa(null,e,i)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,i){return i||(i=new_buf(4)),i.write_shift(4,e),i}function parse_XLWideString(e){var i=e.read_shift(4);return i===0?"":e.read_shift(i,"dbcs")}function write_XLWideString(e,i){var a=!1;return i==null&&(a=!0,i=new_buf(4+2*e.length)),i.write_shift(4,e.length),e.length>0&&i.write_shift(0,e,"dbcs"),a?i.slice(0,i.l):i}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,i){return i||(i=new_buf(4)),i.write_shift(2,0),i.write_shift(2,0),i}function parse_RichStr(e,i){var a=e.l,s=e.read_shift(1),o=parse_XLWideString(e),c=[],h={t:o,h:o};if(s&1){for(var d=e.read_shift(4),g=0;g!=d;++g)c.push(parse_StrRun(e));h.r=c}else h.r=[{ich:0,ifnt:0}];return e.l=a+i,h}function write_RichStr(e,i){var a=!1;return i==null&&(a=!0,i=new_buf(15+4*e.t.length)),i.write_shift(1,0),write_XLWideString(e.t,i),a?i.slice(0,i.l):i}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,i){var a=!1;return i==null&&(a=!0,i=new_buf(23+4*e.t.length)),i.write_shift(1,1),write_XLWideString(e.t,i),i.write_shift(4,1),write_StrRun({},i),a?i.slice(0,i.l):i}function parse_XLSBCell(e){var i=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:i,iStyleRef:a}}function write_XLSBCell(e,i){return i==null&&(i=new_buf(8)),i.write_shift(-4,e.c),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}function parse_XLSBShortCell(e){var i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:i}}function write_XLSBShortCell(e,i){return i==null&&(i=new_buf(4)),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var i=e.read_shift(4);return i===0||i===4294967295?"":e.read_shift(i,"dbcs")}function write_XLNullableWideString(e,i){var a=!1;return i==null&&(a=!0,i=new_buf(127)),i.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&i.write_shift(0,e,"dbcs"),a?i.slice(0,i.l):i}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var i=e.slice(e.l,e.l+4),a=i[0]&1,s=i[0]&2;e.l+=4;var o=s===0?__double([0,0,0,0,i[0]&252,i[1],i[2],i[3]],0):__readInt32LE(i,0)>>2;return a?o/100:o}function write_RkNumber(e,i){i==null&&(i=new_buf(4));var a=0,s=0,o=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:o==(o|0)&&o>=-536870912&&o<1<<29&&(s=1,a=1),s)i.write_shift(-4,((a?o:e)<<2)+(a+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var i={s:{},e:{}};return i.s.r=e.read_shift(4),i.e.r=e.read_shift(4),i.s.c=e.read_shift(4),i.e.c=e.read_shift(4),i}function write_RfX(e,i){return i||(i=new_buf(16)),i.write_shift(4,e.s.r),i.write_shift(4,e.e.r),i.write_shift(4,e.s.c),i.write_shift(4,e.e.c),i}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,i){return(i||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var i={},a=e.read_shift(1),s=a>>>1,o=e.read_shift(1),c=e.read_shift(2,"i"),h=e.read_shift(1),d=e.read_shift(1),g=e.read_shift(1);switch(e.l++,s){case 0:i.auto=1;break;case 1:i.index=o;var _=XLSIcv[o];_&&(i.rgb=rgb2Hex(_));break;case 2:i.rgb=rgb2Hex([h,d,g]);break;case 3:i.theme=o;break}return c!=0&&(i.tint=c>0?c/32767:c/32768),i}function write_BrtColor(e,i){if(i||(i=new_buf(8)),!e||e.auto)return i.write_shift(4,0),i.write_shift(4,0),i;e.index!=null?(i.write_shift(1,2),i.write_shift(1,e.index)):e.theme!=null?(i.write_shift(1,6),i.write_shift(1,e.theme)):(i.write_shift(1,5),i.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),i.write_shift(2,a),!e.rgb||e.theme!=null)i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),i.write_shift(1,parseInt(s.slice(0,2),16)),i.write_shift(1,parseInt(s.slice(2,4),16)),i.write_shift(1,parseInt(s.slice(4,6),16)),i.write_shift(1,255)}return i}function parse_FontFlags(e){var i=e.read_shift(1);e.l++;var a={fBold:i&1,fItalic:i&2,fUnderline:i&4,fStrikeout:i&8,fOutline:i&16,fShadow:i&32,fCondense:i&64,fExtend:i&128};return a}function write_FontFlags(e,i){i||(i=new_buf(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return i.write_shift(1,a),i.write_shift(1,0),i}function parse_ClipboardFormatOrString(e,i){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,i==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(i){return[i>>16&255,i>>8&255,i&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var i=new_ct();if(!e||!e.match)return i;var a={};if((e.match(tagregex)||[]).forEach(function(s){var o=parsexmltag(s);switch(o[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":i.xmlns=o["xmlns"+(o[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[o.Extension]=o.ContentType;break;case"<Override":i[ct2type[o.ContentType]]!==void 0&&i[ct2type[o.ContentType]].push(o.PartName);break}}),i.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+i.xmlns);return i.calcchain=i.calcchains.length>0?i.calcchains[0]:"",i.sst=i.strs.length>0?i.strs[0]:"",i.style=i.styles.length>0?i.styles[0]:"",i.defaults=a,delete i.calcchains,i}function write_ct(e,i){var a=evert_arr(ct2type),s=[],o;s[s.length]=XML_HEADER,s[s.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return writextag("Default",null,{Extension:g[0],ContentType:g[1]})}));var c=function(g){e[g]&&e[g].length>0&&(o=e[g][0],s[s.length]=writextag("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:CT_LIST[g][i.bookType]||CT_LIST[g].xlsx}))},h=function(g){(e[g]||[]).forEach(function(_){s[s.length]=writextag("Override",null,{PartName:(_[0]=="/"?"":"/")+_,ContentType:CT_LIST[g][i.bookType]||CT_LIST[g].xlsx})})},d=function(g){(e[g]||[]).forEach(function(_){s[s.length]=writextag("Override",null,{PartName:(_[0]=="/"?"":"/")+_,ContentType:a[g][0]})})};return c("workbooks"),h("sheets"),h("charts"),d("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),h("metadata"),d("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var i=e.lastIndexOf("/");return e.slice(0,i+1)+"_rels/"+e.slice(i+1)+".rels"}function parse_rels(e,i){var a={"!id":{}};if(!e)return a;i.charAt(0)!=="/"&&(i="/"+i);var s={};return(e.match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);if(c[0]==="<Relationship"){var h={};h.Type=c.Type,h.Target=c.Target,h.Id=c.Id,c.TargetMode&&(h.TargetMode=c.TargetMode);var d=c.TargetMode==="External"?c.Target:resolve_path(c.Target,i);a[d]=h,s[c.Id]=h}}),a["!id"]=s,a}function write_rels(e){var i=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(a){i[i.length]=writextag("Relationship",null,e["!id"][a])}),i.length>2&&(i[i.length]="</Relationships>",i[1]=i[1].replace("/>",">")),i.join("")}function add_rels(e,i,a,s,o,c){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),i<0)for(i=e["!idx"];e["!id"]["rId"+i];++i);if(e["!idx"]=i+1,o.Id="rId"+i,o.Type=s,o.Target=a,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+i);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,i}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,i){for(var a=xlml_normalize(e),s,o;s=xlmlregex.exec(a);)switch(s[3]){case"manifest":break;case"file-entry":if(o=parsexmltag(s[0],!1),o.path=="/"&&o.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(i&&i.WTF)throw s}}function write_manifest(e){var i=[XML_HEADER];i.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),i.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<e.length;++a)i.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+`"/>
`);return i.push("</manifest:manifest>"),i.join("")}function write_rdf_type(e,i,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+i+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,i){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var i=[XML_HEADER];i.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=e.length;++a)i.push(write_rdf_type(e[a][0],e[a][1])),i.push(write_rdf_has("",e[a][0]));return i.push(write_rdf_type("","Document","pkg")),i.push("</rdf:RDF>"),i.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var e=new Array(CORE_PROPS.length),i=0;i<CORE_PROPS.length;++i){var a=CORE_PROPS[i],s="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[i]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function parse_core_props(e){var i={};e=utf8read(e);for(var a=0;a<CORE_PROPS.length;++a){var s=CORE_PROPS[a],o=e.match(CORE_PROPS_REGEX[a]);o!=null&&o.length>0&&(i[s[1]]=unescapexml(o[1])),s[2]==="date"&&i[s[1]]&&(i[s[1]]=parseDate(i[s[1]]))}return i}function cp_doit(e,i,a,s,o){o[e]!=null||i==null||i===""||(o[e]=i,i=escapexml(i),s[s.length]=a?writextag(e,i,a):writetag(e,i))}function write_core_props(e,i){var a=i||{},s=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],o={};if(!e&&!a.Props)return s.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o));for(var c=0;c!=CORE_PROPS.length;++c){var h=CORE_PROPS[c],d=a.Props&&a.Props[h[1]]!=null?a.Props[h[1]]:e?e[h[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&cp_doit(h[0],d,null,s,o)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(e,i,a,s){var o=[];if(typeof e=="string")o=parseVector(e,s);else for(var c=0;c<e.length;++c)o=o.concat(e[c].map(function(b){return{v:b}}));var h=typeof i=="string"?parseVector(i,s).map(function(b){return b.v}):i,d=0,g=0;if(h.length>0)for(var _=0;_!==o.length;_+=2){switch(g=+o[_+1].v,o[_].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=g,a.SheetNames=h.slice(d,d+g);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=g,a.DefinedNames=h.slice(d,d+g);break;case"Charts":case"Diagramme":a.Chartsheets=g,a.ChartNames=h.slice(d,d+g);break}d+=g}}function parse_ext_props(e,i,a){var s={};return i||(i={}),e=utf8read(e),EXT_PROPS.forEach(function(o){var c=(e.match(matchtag(o[0]))||[])[1];switch(o[2]){case"string":c&&(i[o[1]]=unescapexml(c));break;case"bool":i[o[1]]=c==="true";break;case"raw":var h=e.match(new RegExp("<"+o[0]+"[^>]*>([\\s\\S]*?)</"+o[0]+">"));h&&h.length>0&&(s[o[1]]=h[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&load_props_pairs(s.HeadingPairs,s.TitlesOfParts,i,a),i}function write_ext_props(e){var i=[],a=writextag;return e||(e={}),e.Application="SheetJS",i[i.length]=XML_HEADER,i[i.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(s){if(e[s[1]]!==void 0){var o;switch(s[2]){case"string":o=escapexml(String(e[s[1]]));break;case"bool":o=e[s[1]]?"true":"false";break}o!==void 0&&(i[i.length]=a(s[0],o))}}),i[i.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),i[i.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+escapexml(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,i){var a={},s="",o=e.match(custregex);if(o)for(var c=0;c!=o.length;++c){var h=o[c],d=parsexmltag(h);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":s=unescapexml(d.name);break;case"</property>":s=null;break;default:if(h.indexOf("<vt:")===0){var g=h.split(">"),_=g[0].slice(4),b=g[1];switch(_){case"lpstr":case"bstr":case"lpwstr":a[s]=unescapexml(b);break;case"bool":a[s]=parsexmlbool(b);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[s]=parseInt(b,10);break;case"r4":case"r8":case"decimal":a[s]=parseFloat(b);break;case"filetime":case"date":a[s]=parseDate(b);break;case"cy":case"error":a[s]=unescapexml(b);break;default:if(_.slice(-1)=="/")break;i.WTF&&typeof console<"u"&&console.warn("Unexpected",h,_,g)}}else if(h.slice(0,2)!=="</"){if(i.WTF)throw new Error(h)}}}return a}function write_cust_props(e){var i=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return i.join("");var a=1;return keys(e).forEach(function(o){++a,i[i.length]=writextag("property",write_vt(e[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:escapexml(o)})}),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,i,a){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),i=evert_XLMLDPM[i]||i,e[i]=a}function xlml_write_docprops(e,i){var a=[];return keys(XLMLDocPropsMap).map(function(s){for(var o=0;o<CORE_PROPS.length;++o)if(CORE_PROPS[o][1]==s)return CORE_PROPS[o];for(o=0;o<EXT_PROPS.length;++o)if(EXT_PROPS[o][1]==s)return EXT_PROPS[o];throw s}).forEach(function(s){if(e[s[1]]!=null){var o=i&&i.Props&&i.Props[s[1]]!=null?i.Props[s[1]]:e[s[1]];switch(s[2]){case"date":o=new Date(o).toISOString().replace(/\.\d*Z/,"Z");break}typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),a.push(writetag(XLMLDocPropsMap[s[1]]||s[1],o))}}),writextag("DocumentProperties",a.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,i){var a=["Worksheets","SheetNames"],s="CustomDocumentProperties",o=[];return e&&keys(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var h=0;h<CORE_PROPS.length;++h)if(c==CORE_PROPS[h][1])return;for(h=0;h<EXT_PROPS.length;++h)if(c==EXT_PROPS[h][1])return;for(h=0;h<a.length;++h)if(c==a[h])return;var d=e[c],g="string";typeof d=="number"?(g="float",d=String(d)):d===!0||d===!1?(g="boolean",d=d?"1":"0"):d=String(d),o.push(writextag(escapexmltag(c),d,{"dt:dt":g}))}}),i&&keys(i).forEach(function(c){if(Object.prototype.hasOwnProperty.call(i,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var h=i[c],d="string";typeof h=="number"?(d="float",h=String(h)):h===!0||h===!1?(d="boolean",h=h?"1":"0"):h instanceof Date?(d="dateTime.tz",h=h.toISOString()):h=String(h),o.push(writextag(escapexmltag(c),h,{"dt:dt":d}))}}),"<"+s+' xmlns="'+XLMLNS.o+'">'+o.join("")+"</"+s+">"}function parse_FILETIME(e){var i=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+i/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(e){var i=typeof e=="string"?new Date(Date.parse(e)):e,a=i.getTime()/1e3+11644473600,s=a%Math.pow(2,32),o=(a-s)/Math.pow(2,32);s*=1e7,o*=1e7;var c=s/Math.pow(2,32)|0;c>0&&(s=s%Math.pow(2,32),o+=c);var h=new_buf(8);return h.write_shift(4,s),h.write_shift(4,o),h}function parse_lpstr(e,i,a){var s=e.l,o=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-s&3;)++e.l;return o}function parse_lpwstr(e,i,a){var s=e.read_shift(0,"lpwstr");return s}function parse_VtStringBase(e,i,a){return i===31?parse_lpwstr(e):parse_lpstr(e,i,a)}function parse_VtString(e,i,a){return parse_VtStringBase(e,i,a===!1?0:4)}function parse_VtUnalignedString(e,i){if(!i)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,i,0)}function parse_VtVecLpwstrValue(e){for(var i=e.read_shift(4),a=[],s=0;s!=i;++s){var o=e.l;a[s]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-o&2&&(e.l+=2)}return a}function parse_VtVecUnalignedLpstrValue(e){for(var i=e.read_shift(4),a=[],s=0;s!=i;++s)a[s]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return a}function parse_VtHeadingPair(e){var i=e.l,a=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-i&2&&(e.l+=2);var s=parse_TypedPropertyValue(e,VT_I4);return[a,s]}function parse_VtVecHeadingPairValue(e){for(var i=e.read_shift(4),a=[],s=0;s<i/2;++s)a.push(parse_VtHeadingPair(e));return a}function parse_dictionary(e,i){for(var a=e.read_shift(4),s={},o=0;o!=a;++o){var c=e.read_shift(4),h=e.read_shift(4);s[c]=e.read_shift(h,i===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),i===1200&&h%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function parse_BLOB(e){var i=e.read_shift(4),a=e.slice(e.l,e.l+i);return e.l+=i,(i&3)>0&&(e.l+=4-(i&3)&3),a}function parse_ClipboardData(e){var i={};return i.Size=e.read_shift(4),e.l+=i.Size+3-(i.Size-1)%4,i}function parse_TypedPropertyValue(e,i,a){var s=e.read_shift(2),o,c=a||{};if(e.l+=2,i!==VT_VARIANT&&s!==i&&VT_CUSTOM.indexOf(i)===-1&&!((i&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+i+" saw "+s);switch(i===VT_VARIANT?s:i){case 2:return o=e.read_shift(2,"i"),c.raw||(e.l+=2),o;case 3:return o=e.read_shift(4,"i"),o;case 11:return e.read_shift(4)!==0;case 19:return o=e.read_shift(4),o;case 30:return parse_lpstr(e,s,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,s,!c.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,s).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return s==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+i+" "+s)}}function write_TypedPropertyValue(e,i){var a=new_buf(4),s=new_buf(4);switch(a.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,i);break;case 5:s=new_buf(8),s.write_shift(8,i,"f");break;case 11:s.write_shift(4,i?1:0);break;case 64:s=write_FILETIME(i);break;case 31:case 80:for(s=new_buf(4+2*(i.length+1)+(i.length%2?0:2)),s.write_shift(4,i.length+1),s.write_shift(0,i,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}return bconcat([a,s])}function parse_PropertySet(e,i){var a=e.l,s=e.read_shift(4),o=e.read_shift(4),c=[],h=0,d=0,g=-1,_={};for(h=0;h!=o;++h){var b=e.read_shift(4),j=e.read_shift(4);c[h]=[b,j+a]}c.sort(function(at,st){return at[1]-st[1]});var _e={};for(h=0;h!=o;++h){if(e.l!==c[h][1]){var et=!0;if(h>0&&i)switch(i[c[h-1][0]].t){case 2:e.l+2===c[h][1]&&(e.l+=2,et=!1);break;case 80:e.l<=c[h][1]&&(e.l=c[h][1],et=!1);break;case 4108:e.l<=c[h][1]&&(e.l=c[h][1],et=!1);break}if((!i||h==0)&&e.l<=c[h][1]&&(et=!1,e.l=c[h][1]),et)throw new Error("Read Error: Expected address "+c[h][1]+" at "+e.l+" :"+h)}if(i){var rt=i[c[h][0]];if(_e[rt.n]=parse_TypedPropertyValue(e,rt.t,{raw:!0}),rt.p==="version"&&(_e[rt.n]=String(_e[rt.n]>>16)+"."+("0000"+String(_e[rt.n]&65535)).slice(-4)),rt.n=="CodePage")switch(_e[rt.n]){case 0:_e[rt.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(d=_e[rt.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_e[rt.n])}}else if(c[h][0]===1){if(d=_e.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(d),g!==-1){var tt=e.l;e.l=c[g][1],_=parse_dictionary(e,d),e.l=tt}}else if(c[h][0]===0){if(d===0){g=h,e.l=c[h+1][1];continue}_=parse_dictionary(e,d)}else{var it=_[c[h][0]],nt;switch(e[e.l]){case 65:e.l+=4,nt=parse_BLOB(e);break;case 30:e.l+=4,nt=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,nt=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,nt=e.read_shift(4,"i");break;case 19:e.l+=4,nt=e.read_shift(4);break;case 5:e.l+=4,nt=e.read_shift(8,"f");break;case 11:e.l+=4,nt=parsebool(e,4);break;case 64:e.l+=4,nt=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}_e[it]=nt}}return e.l=a+s,_e}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,i,a){var s=new_buf(8),o=[],c=[],h=8,d=0,g=new_buf(8),_=new_buf(8);if(g.write_shift(4,2),g.write_shift(4,1200),_.write_shift(4,1),c.push(g),o.push(_),h+=8+g.length,!i){_=new_buf(8),_.write_shift(4,0),o.unshift(_);var b=[new_buf(4)];for(b[0].write_shift(4,e.length),d=0;d<e.length;++d){var j=e[d][0];for(g=new_buf(8+2*(j.length+1)+(j.length%2?0:2)),g.write_shift(4,d+2),g.write_shift(4,j.length+1),g.write_shift(0,j,"dbcs");g.l!=g.length;)g.write_shift(1,0);b.push(g)}g=bconcat(b),c.unshift(g),h+=8+g.length}for(d=0;d<e.length;++d)if(!(i&&!i[e[d][0]])&&!(XLSPSSkip.indexOf(e[d][0])>-1||PseudoPropsPairs.indexOf(e[d][0])>-1)&&e[d][1]!=null){var _e=e[d][1],et=0;if(i){et=+i[e[d][0]];var rt=a[et];if(rt.p=="version"&&typeof _e=="string"){var tt=_e.split(".");_e=(+tt[0]<<16)+(+tt[1]||0)}g=write_TypedPropertyValue(rt.t,_e)}else{var it=guess_property_type(_e);it==-1&&(it=31,_e=String(_e)),g=write_TypedPropertyValue(it,_e)}c.push(g),_=new_buf(8),_.write_shift(4,i?et:2+d),o.push(_),h+=8+g.length}var nt=8*(c.length+1);for(d=0;d<c.length;++d)o[d].write_shift(4,nt),nt+=c[d].length;return s.write_shift(4,h),s.write_shift(4,c.length),bconcat([s].concat(o).concat(c))}function parse_PropertySetStream(e,i,a){var s=e.content;if(!s)return{};prep_blob(s,0);var o,c,h,d,g=0;s.chk("feff","Byte Order: "),s.read_shift(2);var _=s.read_shift(4),b=s.read_shift(16);if(b!==CFB.utils.consts.HEADER_CLSID&&b!==a)throw new Error("Bad PropertySet CLSID "+b);if(o=s.read_shift(4),o!==1&&o!==2)throw new Error("Unrecognized #Sets: "+o);if(c=s.read_shift(16),d=s.read_shift(4),o===1&&d!==s.l)throw new Error("Length mismatch: "+d+" !== "+s.l);o===2&&(h=s.read_shift(16),g=s.read_shift(4));var j=parse_PropertySet(s,i),_e={SystemIdentifier:_};for(var et in j)_e[et]=j[et];if(_e.FMTID=c,o===1)return _e;if(g-s.l==2&&(s.l+=2),s.l!==g)throw new Error("Length mismatch 2: "+s.l+" !== "+g);var rt;try{rt=parse_PropertySet(s,null)}catch{}for(et in rt)_e[et]=rt[et];return _e.FMTID=[c,h],_e}function write_PropertySetStream(e,i,a,s,o,c){var h=new_buf(o?68:48),d=[h];h.write_shift(2,65534),h.write_shift(2,0),h.write_shift(4,842412599),h.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),h.write_shift(4,o?2:1),h.write_shift(16,i,"hex"),h.write_shift(4,o?68:48);var g=write_PropertySet(e,a,s);if(d.push(g),o){var _=write_PropertySet(o,null,null);h.write_shift(16,c,"hex"),h.write_shift(4,68+g.length),d.push(_)}return bconcat(d)}function parsenoop2(e,i){return e.read_shift(i),null}function writezeroes(e,i){i||(i=new_buf(e));for(var a=0;a<e;++a)i.write_shift(1,0);return i}function parslurp(e,i,a){for(var s=[],o=e.l+i;e.l<o;)s.push(a(e,o-e.l));if(o!==e.l)throw new Error("Slurp error");return s}function parsebool(e,i){return e.read_shift(i)===1}function writebool(e,i){return i||(i=new_buf(2)),i.write_shift(2,+!!e),i}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,i){return i||(i=new_buf(2)),i.write_shift(2,e),i}function parseuint16a(e,i){return parslurp(e,i,parseuint16)}function parse_Bes(e){var i=e.read_shift(1),a=e.read_shift(1);return a===1?i:i===1}function write_Bes(e,i,a){return a||(a=new_buf(2)),a.write_shift(1,i=="e"?+e:+!!e),a.write_shift(1,i=="e"?1:0),a}function parse_ShortXLUnicodeString(e,i,a){var s=e.read_shift(a&&a.biff>=12?2:1),o="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var c=e.read_shift(1);c&&(o="dbcs-cont")}else a.biff==12&&(o="wstr");a.biff>=2&&a.biff<=5&&(o="cpstr");var h=s?e.read_shift(s,o):"";return h}function parse_XLUnicodeRichExtendedString(e){var i=e.read_shift(2),a=e.read_shift(1),s=a&4,o=a&8,c=1+(a&1),h=0,d,g={};o&&(h=e.read_shift(2)),s&&(d=e.read_shift(4));var _=c==2?"dbcs-cont":"sbcs-cont",b=i===0?"":e.read_shift(i,_);return o&&(e.l+=4*h),s&&(e.l+=d),g.t=b,o||(g.raw="<t>"+g.t+"</t>",g.r=g.t),g}function write_XLUnicodeRichExtendedString(e){var i=e.t||"",a=new_buf(3);a.write_shift(2,i.length),a.write_shift(1,1);var s=new_buf(2*i.length);s.write_shift(2*i.length,i,"utf16le");var o=[a,s];return bconcat(o)}function parse_XLUnicodeStringNoCch(e,i,a){var s;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(i,"cpstr");if(a.biff>=12)return e.read_shift(i,"dbcs-cont")}var o=e.read_shift(1);return o===0?s=e.read_shift(i,"sbcs-cont"):s=e.read_shift(i,"dbcs-cont"),s}function parse_XLUnicodeString(e,i,a){var s=e.read_shift(a&&a.biff==2?1:2);return s===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,s,a)}function parse_XLUnicodeString2(e,i,a){if(a.biff>5)return parse_XLUnicodeString(e,i,a);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,i,a){return a||(a=new_buf(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function parse_ControlInfo(e){var i=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[i,a]}function parse_URLMoniker(e){var i=e.read_shift(4),a=e.l,s=!1;i>24&&(e.l+=i-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=a);var o=e.read_shift((s?i-24:i)>>1,"utf16le").replace(chr0,"");return s&&(e.l+=24),o}function parse_FileMoniker(e){for(var i=e.read_shift(2),a="";i-- >0;)a+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var o=e.read_shift(4);if(o===0)return a+s.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var h=e.read_shift(c>>1,"utf16le").replace(chr0,"");return a+h}function parse_HyperlinkMoniker(e,i){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+a)}}function parse_HyperlinkString(e){var i=e.read_shift(4),a=i>0?e.read_shift(i,"utf16le").replace(chr0,""):"";return a}function write_HyperlinkString(e,i){i||(i=new_buf(6+e.length*2)),i.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)i.write_shift(2,e.charCodeAt(a));return i.write_shift(2,0),i}function parse_Hyperlink(e,i){var a=e.l+i,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var o=e.read_shift(2);e.l+=2;var c,h,d,g,_="",b,j;o&16&&(c=parse_HyperlinkString(e,a-e.l)),o&128&&(h=parse_HyperlinkString(e,a-e.l)),(o&257)===257&&(d=parse_HyperlinkString(e,a-e.l)),(o&257)===1&&(g=parse_HyperlinkMoniker(e,a-e.l)),o&8&&(_=parse_HyperlinkString(e,a-e.l)),o&32&&(b=e.read_shift(16)),o&64&&(j=parse_FILETIME(e)),e.l=a;var _e=h||d||g||"";_e&&_&&(_e+="#"+_),_e||(_e="#"+_),o&2&&_e.charAt(0)=="/"&&_e.charAt(1)!="/"&&(_e="file://"+_e);var et={Target:_e};return b&&(et.guid=b),j&&(et.time=j),c&&(et.Tooltip=c),et}function write_Hyperlink(e){var i=new_buf(512),a=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var o=s.indexOf("#"),c=o>-1?31:23;switch(s.charAt(0)){case"#":c=28;break;case".":c&=-3;break}i.write_shift(4,2),i.write_shift(4,c);var h=[8,6815827,6619237,4849780,83];for(a=0;a<h.length;++a)i.write_shift(4,h[a]);if(c==28)s=s.slice(1),write_HyperlinkString(s,i);else if(c&2){for(h="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<h.length;++a)i.write_shift(1,parseInt(h[a],16));var d=o>-1?s.slice(0,o):s;for(i.write_shift(4,2*(d.length+1)),a=0;a<d.length;++a)i.write_shift(2,d.charCodeAt(a));i.write_shift(2,0),c&8&&write_HyperlinkString(o>-1?s.slice(o+1):"",i)}else{for(h="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<h.length;++a)i.write_shift(1,parseInt(h[a],16));for(var g=0;s.slice(g*3,g*3+3)=="../"||s.slice(g*3,g*3+3)=="..\\";)++g;for(i.write_shift(2,g),i.write_shift(4,s.length-3*g+1),a=0;a<s.length-3*g;++a)i.write_shift(1,s.charCodeAt(a+3*g)&255);for(i.write_shift(1,0),i.write_shift(2,65535),i.write_shift(2,57005),a=0;a<6;++a)i.write_shift(4,0)}return i.slice(0,i.l)}function parse_LongRGBA(e){var i=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);return[i,a,s,o]}function parse_LongRGB(e,i){var a=parse_LongRGBA(e);return a[3]=0,a}function parse_XLSCell(e){var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{r:i,c:a,ixfe:s}}function write_XLSCell(e,i,a,s){return s||(s=new_buf(6)),s.write_shift(2,e),s.write_shift(2,i),s.write_shift(2,a||0),s}function parse_frtHeader(e){var i=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:i,flags:a}}function parse_OptXLUnicodeString(e,i,a){return i===0?"":parse_XLUnicodeString2(e,i,a)}function parse_XTI(e,i,a){var s=a.biff>8?4:2,o=e.read_shift(s),c=e.read_shift(s,"i"),h=e.read_shift(s,"i");return[o,c,h]}function parse_RkRec(e){var i=e.read_shift(2),a=parse_RkNumber(e);return[i,a]}function parse_AddinUdf(e,i,a){e.l+=4,i-=4;var s=e.l+i,o=parse_ShortXLUnicodeString(e,i,a),c=e.read_shift(2);if(s-=e.l,c!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+c);return e.l+=c,o}function parse_Ref8U(e){var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2);return{s:{c:s,r:i},e:{c:o,r:a}}}function write_Ref8U(e,i){return i||(i=new_buf(8)),i.write_shift(2,e.s.r),i.write_shift(2,e.e.r),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c),i}function parse_RefU(e){var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1);return{s:{c:s,r:i},e:{c:o,r:a}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[a,i,s]}function parse_FtNts(e){var i={};return e.l+=4,e.l+=16,i.fSharedNote=e.read_shift(2),e.l+=4,i}function parse_FtCf(e){var i={};return e.l+=4,e.cf=e.read_shift(2),i}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,i){for(var a=e.l+i,s=[];e.l<a;){var o=e.read_shift(2);e.l-=2;try{s.push(FtTab[o](e,a-e.l))}catch{return e.l=a,s}}return e.l!=a&&(e.l=a),s}function parse_BOF(e,i){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),i-=2,i>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(i>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(i),a}function write_BOF(e,i,a){var s=1536,o=16;switch(a.bookType){case"biff8":break;case"biff5":s=1280,o=8;break;case"biff4":s=4,o=6;break;case"biff3":s=3,o=6;break;case"biff2":s=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=new_buf(o);return c.write_shift(2,s),c.write_shift(2,i),o>4&&c.write_shift(2,29282),o>6&&c.write_shift(2,1997),o>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function parse_InterfaceHdr(e,i){return i===0||e.read_shift(2),1200}function parse_WriteAccess(e,i,a){if(a.enc)return e.l+=i,"";var s=e.l,o=parse_XLUnicodeString2(e,0,a);return e.read_shift(i+s-e.l),o}function write_WriteAccess(e,i){var a=!i||i.biff==8,s=new_buf(a?112:54);for(s.write_shift(i.biff==8?2:1,7),a&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(a?0:536870912));s.l<s.length;)s.write_shift(1,a?0:32);return s}function parse_WsBool(e,i,a){var s=a&&a.biff==8||i==2?e.read_shift(2):(e.l+=i,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function parse_BoundSheet8(e,i,a){var s=e.read_shift(4),o=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var h=parse_ShortXLUnicodeString(e,0,a);return h.length===0&&(h="Sheet1"),{pos:s,hs:o,dt:c,name:h}}function write_BoundSheet8(e,i){var a=!i||i.biff>=8?2:1,s=new_buf(8+a*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),i.biff>=8&&s.write_shift(1,1),s.write_shift(a*e.name.length,e.name,i.biff<8?"sbcs":"utf16le");var o=s.slice(0,s.l);return o.l=s.l,o}function parse_SST(e,i){for(var a=e.l+i,s=e.read_shift(4),o=e.read_shift(4),c=[],h=0;h!=o&&e.l<a;++h)c.push(parse_XLUnicodeRichExtendedString(e));return c.Count=s,c.Unique=o,c}function write_SST(e,i){var a=new_buf(8);a.write_shift(4,e.Count),a.write_shift(4,e.Unique);for(var s=[],o=0;o<e.length;++o)s[o]=write_XLUnicodeRichExtendedString(e[o]);var c=bconcat([a].concat(s));return c.parts=[a.length].concat(s.map(function(h){return h.length})),c}function parse_ExtSST(e,i){var a={};return a.dsst=e.read_shift(2),e.l+=i-2,a}function parse_Row(e){var i={};i.r=e.read_shift(2),i.c=e.read_shift(2),i.cnt=e.read_shift(2)-i.c;var a=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(i.level=s&7),s&32&&(i.hidden=!0),s&64&&(i.hpt=a/20),i}function parse_ForceFullCalculation(e){var i=parse_frtHeader(e);if(i.type!=2211)throw new Error("Invalid Future Record "+i.type);var a=e.read_shift(4);return a!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,i,a){var s=0;a&&a.biff==2||(s=e.read_shift(2));var o=e.read_shift(2);a&&a.biff==2&&(s=1-(o>>15),o&=32767);var c={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[c,o]}function parse_Window1(e){var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2),g=e.read_shift(2),_=e.read_shift(2);return{Pos:[i,a],Dim:[s,o],Flags:c,CurTab:h,FirstTab:d,Selected:g,TabRatio:_}}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function parse_Window2(e,i,a){if(a&&a.biff>=2&&a.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function write_Window2(e){var i=new_buf(18),a=1718;return e&&e.RTL&&(a|=64),i.write_shift(2,a),i.write_shift(4,0),i.write_shift(4,64),i.write_shift(4,0),i.write_shift(4,0),i}function parse_Pane(){}function parse_Font(e,i,a){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=parse_ShortXLUnicodeString(e,0,a),s}function write_Font(e,i){var a=e.name||"Arial",s=i&&i.biff==5,o=s?15+a.length:16+2*a.length,c=new_buf(o);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,a.length),s||c.write_shift(1,1),c.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le"),c}function parse_LabelSst(e){var i=parse_XLSCell(e);return i.isst=e.read_shift(4),i}function write_LabelSst(e,i,a,s){var o=new_buf(10);return write_XLSCell(e,i,s,o),o.write_shift(4,a),o}function parse_Label(e,i,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=e.l+i,o=parse_XLSCell(e);a.biff==2&&e.l++;var c=parse_XLUnicodeString(e,s-e.l,a);return o.val=c,o}function write_Label(e,i,a,s,o){var c=!o||o.biff==8,h=new_buf(8+ +c+(1+c)*a.length);return write_XLSCell(e,i,s,h),h.write_shift(2,a.length),c&&h.write_shift(1,1),h.write_shift((1+c)*a.length,a,c?"utf16le":"sbcs"),h}function parse_Format(e,i,a){var s=e.read_shift(2),o=parse_XLUnicodeString2(e,0,a);return[s,o]}function write_Format(e,i,a,s){var o=a&&a.biff==5;s||(s=new_buf(o?3+i.length:5+2*i.length)),s.write_shift(2,e),s.write_shift(o?1:2,i.length),o||s.write_shift(1,1),s.write_shift((o?1:2)*i.length,i,o?"sbcs":"utf16le");var c=s.length>s.l?s.slice(0,s.l):s;return c.l==null&&(c.l=c.length),c}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,i,a){var s=e.l+i,o=a.biff==8||!a.biff?4:2,c=e.read_shift(o),h=e.read_shift(o),d=e.read_shift(2),g=e.read_shift(2);return e.l=s,{s:{r:c,c:d},e:{r:h,c:g}}}function write_Dimensions(e,i){var a=i.biff==8||!i.biff?4:2,s=new_buf(2*a+6);return s.write_shift(a,e.s.r),s.write_shift(a,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function parse_RK(e){var i=e.read_shift(2),a=e.read_shift(2),s=parse_RkRec(e);return{r:i,c:a,ixfe:s[0],rknum:s[1]}}function parse_MulRk(e,i){for(var a=e.l+i-2,s=e.read_shift(2),o=e.read_shift(2),c=[];e.l<a;)c.push(parse_RkRec(e));if(e.l!==a)throw new Error("MulRK read error");var h=e.read_shift(2);if(c.length!=h-o+1)throw new Error("MulRK length mismatch");return{r:s,c:o,C:h,rkrec:c}}function parse_MulBlank(e,i){for(var a=e.l+i-2,s=e.read_shift(2),o=e.read_shift(2),c=[];e.l<a;)c.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var h=e.read_shift(2);if(c.length!=h-o+1)throw new Error("MulBlank length mismatch");return{r:s,c:o,C:h,ixfe:c}}function parse_CellStyleXF(e,i,a,s){var o={},c=e.read_shift(4),h=e.read_shift(4),d=e.read_shift(4),g=e.read_shift(2);return o.patternType=XLSFillPattern[d>>26],s.cellStyles&&(o.alc=c&7,o.fWrap=c>>3&1,o.alcV=c>>4&7,o.fJustLast=c>>7&1,o.trot=c>>8&255,o.cIndent=c>>16&15,o.fShrinkToFit=c>>20&1,o.iReadOrder=c>>22&2,o.fAtrNum=c>>26&1,o.fAtrFnt=c>>27&1,o.fAtrAlc=c>>28&1,o.fAtrBdr=c>>29&1,o.fAtrPat=c>>30&1,o.fAtrProt=c>>31&1,o.dgLeft=h&15,o.dgRight=h>>4&15,o.dgTop=h>>8&15,o.dgBottom=h>>12&15,o.icvLeft=h>>16&127,o.icvRight=h>>23&127,o.grbitDiag=h>>30&3,o.icvTop=d&127,o.icvBottom=d>>7&127,o.icvDiag=d>>14&127,o.dgDiag=d>>21&15,o.icvFore=g&127,o.icvBack=g>>7&127,o.fsxButton=g>>14&1),o}function parse_XF(e,i,a){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,i-=6,s.data=parse_CellStyleXF(e,i,s.fStyle,a),s}function write_XF(e,i,a,s){var o=a&&a.biff==5;s||(s=new_buf(o?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,i<<4));var c=0;return e.numFmtId>0&&o&&(c|=1024),s.write_shift(4,c),s.write_shift(4,0),o||s.write_shift(4,0),s.write_shift(2,0),s}function parse_Guts(e){e.l+=4;var i=[e.read_shift(2),e.read_shift(2)];if(i[0]!==0&&i[0]--,i[1]!==0&&i[1]--,i[0]>7||i[1]>7)throw new Error("Bad Gutters: "+i.join("|"));return i}function write_Guts(e){var i=new_buf(8);return i.write_shift(4,0),i.write_shift(2,0),i.write_shift(2,0),i}function parse_BoolErr(e,i,a){var s=parse_XLSCell(e);(a.biff==2||i==9)&&++e.l;var o=parse_Bes(e);return s.val=o,s.t=o===!0||o===!1?"b":"e",s}function write_BoolErr(e,i,a,s,o,c){var h=new_buf(8);return write_XLSCell(e,i,s,h),write_Bes(a,c,h),h}function parse_Number(e,i,a){a.biffguess&&a.biff==2&&(a.biff=5);var s=parse_XLSCell(e),o=parse_Xnum(e);return s.val=o,s}function write_Number(e,i,a,s){var o=new_buf(14);return write_XLSCell(e,i,s,o),write_Xnum(a,o),o}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,i,a){var s=e.l+i,o=e.read_shift(2),c=e.read_shift(2);if(a.sbcch=c,c==1025||c==14849)return[c,o];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var h=parse_XLUnicodeStringNoCch(e,c),d=[];s>e.l;)d.push(parse_XLUnicodeString(e));return[c,o,h,d]}function parse_ExternName(e,i,a){var s=e.read_shift(2),o,c={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return a.sbcch===14849&&(o=parse_AddinUdf(e,i-2,a)),c.body=o||e.read_shift(i-2),typeof o=="string"&&(c.Name=o),c}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,i,a){var s=e.l+i,o=e.read_shift(2),c=e.read_shift(1),h=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),g=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),g=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var _=parse_XLUnicodeStringNoCch(e,h,a);o&32&&(_=XLSLblBuiltIn[_.charCodeAt(0)]);var b=s-e.l;a&&a.biff==2&&--b;var j=s==e.l||d===0||!(b>0)?[]:parse_NameParsedFormula(e,b,a,d);return{chKey:c,Name:_,itab:g,rgce:j}}function parse_ExternSheet(e,i,a){if(a.biff<8)return parse_BIFF5ExternSheet(e,i,a);for(var s=[],o=e.l+i,c=e.read_shift(a.biff>8?4:2);c--!==0;)s.push(parse_XTI(e,a.biff>8?12:6,a));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return s}function parse_BIFF5ExternSheet(e,i,a){e[e.l+1]==3&&e[e.l]++;var s=parse_ShortXLUnicodeString(e,i,a);return s.charCodeAt(0)==3?s.slice(1):s}function parse_NameCmt(e,i,a){if(a.biff<8){e.l+=i;return}var s=e.read_shift(2),o=e.read_shift(2),c=parse_XLUnicodeStringNoCch(e,s,a),h=parse_XLUnicodeStringNoCch(e,o,a);return[c,h]}function parse_ShrFmla(e,i,a){var s=parse_RefU(e);e.l++;var o=e.read_shift(1);return i-=8,[parse_SharedParsedFormula(e,i,a),o,s]}function parse_Array(e,i,a){var s=parse_Ref(e);switch(a.biff){case 2:e.l++,i-=7;break;case 3:case 4:e.l+=2,i-=8;break;default:e.l+=6,i-=12}return[s,parse_ArrayParsedFormula(e,i,a)]}function parse_MTRSettings(e){var i=e.read_shift(4)!==0,a=e.read_shift(4)!==0,s=e.read_shift(4);return[i,a,s]}function parse_NoteSh(e,i,a){if(!(a.biff<8)){var s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),d=parse_XLUnicodeString2(e,0,a);return a.biff<8&&e.read_shift(1),[{r:s,c:o},d,h,c]}}function parse_Note(e,i,a){return parse_NoteSh(e,i,a)}function parse_MergeCells(e,i){for(var a=[],s=e.read_shift(2);s--;)a.push(parse_Ref8U(e));return a}function write_MergeCells(e){var i=new_buf(2+e.length*8);i.write_shift(2,e.length);for(var a=0;a<e.length;++a)write_Ref8U(e[a],i);return i}function parse_Obj(e,i,a){if(a&&a.biff<8)return parse_BIFF5Obj(e,i,a);var s=parse_FtCmo(e),o=parse_FtArray(e,i-22,s[1]);return{cmo:s,ft:o}}var parse_BIFF5OT={8:function(e,i){var a=e.l+i;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var o=e.read_shift(1);return e.l+=o,e.l=a,{fmt:s}}};function parse_BIFF5Obj(e,i,a){e.l+=4;var s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,i-=36;var h=[];return h.push((parse_BIFF5OT[s]||parsenoop)(e,i,a)),{cmo:[o,s,c],ft:h}}function parse_TxO(e,i,a){var s=e.l,o="";try{e.l+=4;var c=(a.lastobj||{cmo:[0,0]}).cmo[1],h;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:h=parse_ControlInfo(e,6,a);var d=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var g=e.read_shift(2);e.l+=g;for(var _=1;_<e.lens.length-1;++_){if(e.l-s!=e.lens[_])throw new Error("TxO: bad continue record");var b=e[e.l],j=parse_XLUnicodeStringNoCch(e,e.lens[_+1]-e.lens[_]-1);if(o+=j,o.length>=(b?d:2*d))break}if(o.length!==d&&o.length!==d*2)throw new Error("cchText: "+d+" != "+o.length);return e.l=s+i,{t:o}}catch{return e.l=s+i,{t:o}}}function parse_HLink(e,i){var a=parse_Ref8U(e);e.l+=16;var s=parse_Hyperlink(e,i-24);return[a,s]}function write_HLink(e){var i=new_buf(24),a=decode_cell(e[0]);i.write_shift(2,a.r),i.write_shift(2,a.r),i.write_shift(2,a.c),i.write_shift(2,a.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)i.write_shift(1,parseInt(s[o],16));return bconcat([i,write_Hyperlink(e[1])])}function parse_HLinkTooltip(e,i){e.read_shift(2);var a=parse_Ref8U(e),s=e.read_shift((i-10)/2,"dbcs-cont");return s=s.replace(chr0,""),[a,s]}function write_HLinkTooltip(e){var i=e[1].Tooltip,a=new_buf(10+2*(i.length+1));a.write_shift(2,2048);var s=decode_cell(e[0]);a.write_shift(2,s.r),a.write_shift(2,s.r),a.write_shift(2,s.c),a.write_shift(2,s.c);for(var o=0;o<i.length;++o)a.write_shift(2,i.charCodeAt(o));return a.write_shift(2,0),a}function parse_Country(e){var i=[0,0],a;return a=e.read_shift(2),i[0]=CountryEnum[a]||a,a=e.read_shift(2),i[1]=CountryEnum[a]||a,i}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ClrtClient(e){for(var i=e.read_shift(2),a=[];i-- >0;)a.push(parse_LongRGB(e));return a}function parse_Palette(e){for(var i=e.read_shift(2),a=[];i-- >0;)a.push(parse_LongRGB(e));return a}function parse_XFCRC(e){e.l+=2;var i={cxfs:0,crc:0};return i.cxfs=e.read_shift(2),i.crc=e.read_shift(4),i}function parse_ColInfo(e,i,a){if(!a.cellStyles)return parsenoop(e,i);var s=a&&a.biff>=12?4:2,o=e.read_shift(s),c=e.read_shift(s),h=e.read_shift(s),d=e.read_shift(s),g=e.read_shift(2);s==2&&(e.l+=2);var _={s:o,e:c,w:h,ixfe:d,flags:g};return(a.biff>=5||!a.biff)&&(_.level=g>>8&7),_}function write_ColInfo(e,i){var a=new_buf(12);a.write_shift(2,i),a.write_shift(2,i),a.write_shift(2,e.width*256),a.write_shift(2,0);var s=0;return e.hidden&&(s|=1),a.write_shift(1,s),s=e.level||0,a.write_shift(1,s),a.write_shift(2,0),a}function parse_Setup(e,i){var a={};return i<32||(e.l+=16,a.header=parse_Xnum(e),a.footer=parse_Xnum(e),e.l+=2),a}function parse_ShtProps(e,i,a){var s={area:!1};if(a.biff!=5)return e.l+=i,s;var o=e.read_shift(1);return e.l+=3,o&16&&(s.area=!0),s}function write_RRTabId(e){for(var i=new_buf(2*e),a=0;a<e;++a)i.write_shift(2,a+1);return i}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),o={fmt:i,env:a,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,o}function parse_BIFF2STR(e,i,a){a.biffguess&&a.biff==5&&(a.biff=2);var s=parse_XLSCell(e);++e.l;var o=parse_XLUnicodeString2(e,i-7,a);return s.t="str",s.val=o,s}function parse_BIFF2NUM(e){var i=parse_XLSCell(e);++e.l;var a=parse_Xnum(e);return i.t="n",i.val=a,i}function write_BIFF2NUM(e,i,a){var s=new_buf(15);return write_BIFF2Cell(s,e,i),s.write_shift(8,a,"f"),s}function parse_BIFF2INT(e){var i=parse_XLSCell(e);++e.l;var a=e.read_shift(2);return i.t="n",i.val=a,i}function write_BIFF2INT(e,i,a){var s=new_buf(9);return write_BIFF2Cell(s,e,i),s.write_shift(2,a),s}function parse_BIFF2STRING(e){var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,i){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=i-13}function parse_RString(e,i,a){var s=e.l+i,o=parse_XLSCell(e),c=e.read_shift(2),h=parse_XLUnicodeStringNoCch(e,c,a);return e.l=s,o.t="str",o.val=h,o}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},i=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,g){var _=[],b=new_raw_buf(1);switch(g.type){case"base64":b=s2a(Base64_decode(d));break;case"binary":b=s2a(d);break;case"buffer":case"array":b=d;break}prep_blob(b,0);var j=b.read_shift(1),_e=!!(j&136),et=!1,rt=!1;switch(j){case 2:break;case 3:break;case 48:et=!0,_e=!0;break;case 49:et=!0,_e=!0;break;case 131:break;case 139:break;case 140:rt=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+j.toString(16))}var tt=0,it=521;j==2&&(tt=b.read_shift(2)),b.l+=3,j!=2&&(tt=b.read_shift(4)),tt>1048576&&(tt=1e6),j!=2&&(it=b.read_shift(2));var nt=b.read_shift(2),at=g.codepage||1252;j!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(at=e[b[b.l]]),b.l+=1,b.l+=2),rt&&(b.l+=36);for(var st=[],dt={},lt=Math.min(b.length,j==2?521:it-10-(et?264:0)),ut=rt?32:11;b.l<lt&&b[b.l]!=13;)switch(dt={},dt.name=$cptable.utils.decode(at,b.slice(b.l,b.l+ut)).replace(/[\u0000\r\n].*$/g,""),b.l+=ut,dt.type=String.fromCharCode(b.read_shift(1)),j!=2&&!rt&&(dt.offset=b.read_shift(4)),dt.len=b.read_shift(1),j==2&&(dt.offset=b.read_shift(2)),dt.dec=b.read_shift(1),dt.name.length&&st.push(dt),j!=2&&(b.l+=rt?13:14),dt.type){case"B":(!et||dt.len!=8)&&g.WTF&&console.log("Skipping "+dt.name+":"+dt.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+dt.name+":"+dt.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+dt.type)}if(b[b.l]!==13&&(b.l=it-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=it;var ot=0,ft=0;for(_[0]=[],ft=0;ft!=st.length;++ft)_[0][ft]=st[ft].name;for(;tt-- >0;){if(b[b.l]===42){b.l+=nt;continue}for(++b.l,_[++ot]=[],ft=0,ft=0;ft!=st.length;++ft){var pt=b.slice(b.l,b.l+st[ft].len);b.l+=st[ft].len,prep_blob(pt,0);var St=$cptable.utils.decode(at,pt);switch(st[ft].type){case"C":St.trim().length&&(_[ot][ft]=St.replace(/\s+$/,""));break;case"D":St.length===8?_[ot][ft]=new Date(+St.slice(0,4),+St.slice(4,6)-1,+St.slice(6,8)):_[ot][ft]=St;break;case"F":_[ot][ft]=parseFloat(St.trim());break;case"+":case"I":_[ot][ft]=rt?pt.read_shift(-4,"i")^2147483648:pt.read_shift(4,"i");break;case"L":switch(St.trim().toUpperCase()){case"Y":case"T":_[ot][ft]=!0;break;case"N":case"F":_[ot][ft]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+St+"|")}break;case"M":if(!_e)throw new Error("DBF Unexpected MEMO for type "+j.toString(16));_[ot][ft]="##MEMO##"+(rt?parseInt(St.trim(),10):pt.read_shift(4));break;case"N":St=St.replace(/\u0000/g,"").trim(),St&&St!="."&&(_[ot][ft]=+St||0);break;case"@":_[ot][ft]=new Date(pt.read_shift(-8,"f")-621356832e5);break;case"T":_[ot][ft]=new Date((pt.read_shift(4)-2440588)*864e5+pt.read_shift(4));break;case"Y":_[ot][ft]=pt.read_shift(4,"i")/1e4+pt.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":_[ot][ft]=-pt.read_shift(-8,"f");break;case"B":if(et&&st[ft].len==8){_[ot][ft]=pt.read_shift(8,"f");break}case"G":case"P":pt.l+=st[ft].len;break;case"0":if(st[ft].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+st[ft].type)}}}if(j!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),g.DBF=st,_}function s(d,g){var _=g||{};_.dateNF||(_.dateNF="yyyymmdd");var b=aoa_to_sheet(a(d,_),_);return b["!cols"]=_.DBF.map(function(j){return{wch:j.len,DBF:j}}),delete _.DBF,b}function o(d,g){try{return sheet_to_workbook(s(d,g),g)}catch(_){if(g&&g.WTF)throw _}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function h(d,g){var _=g||{};if(+_.codepage>=0&&set_cp(+_.codepage),_.type=="string")throw new Error("Cannot write DBF to JS string");var b=buf_array(),j=sheet_to_json(d,{header:1,raw:!0,cellDates:!0}),_e=j[0],et=j.slice(1),rt=d["!cols"]||[],tt=0,it=0,nt=0,at=1;for(tt=0;tt<_e.length;++tt){if(((rt[tt]||{}).DBF||{}).name){_e[tt]=rt[tt].DBF.name,++nt;continue}if(_e[tt]!=null){if(++nt,typeof _e[tt]=="number"&&(_e[tt]=_e[tt].toString(10)),typeof _e[tt]!="string")throw new Error("DBF Invalid column name "+_e[tt]+" |"+typeof _e[tt]+"|");if(_e.indexOf(_e[tt])!==tt){for(it=0;it<1024;++it)if(_e.indexOf(_e[tt]+"_"+it)==-1){_e[tt]+="_"+it;break}}}}var st=safe_decode_range(d["!ref"]),dt=[],lt=[],ut=[];for(tt=0;tt<=st.e.c-st.s.c;++tt){var ot="",ft="",pt=0,St=[];for(it=0;it<et.length;++it)et[it][tt]!=null&&St.push(et[it][tt]);if(St.length==0||_e[tt]==null){dt[tt]="?";continue}for(it=0;it<St.length;++it){switch(typeof St[it]){case"number":ft="B";break;case"string":ft="C";break;case"boolean":ft="L";break;case"object":ft=St[it]instanceof Date?"D":"C";break;default:ft="C"}pt=Math.max(pt,String(St[it]).length),ot=ot&&ot!=ft?"C":ft}pt>250&&(pt=250),ft=((rt[tt]||{}).DBF||{}).type,ft=="C"&&rt[tt].DBF.len>pt&&(pt=rt[tt].DBF.len),ot=="B"&&ft=="N"&&(ot="N",ut[tt]=rt[tt].DBF.dec,pt=rt[tt].DBF.len),lt[tt]=ot=="C"||ft=="N"?pt:c[ot]||0,at+=lt[tt],dt[tt]=ot}var gt=b.next(32);for(gt.write_shift(4,318902576),gt.write_shift(4,et.length),gt.write_shift(2,296+32*nt),gt.write_shift(2,at),tt=0;tt<4;++tt)gt.write_shift(4,0);for(gt.write_shift(4,0|(+i[current_ansi]||3)<<8),tt=0,it=0;tt<_e.length;++tt)if(_e[tt]!=null){var vt=b.next(32),At=(_e[tt].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);vt.write_shift(1,At,"sbcs"),vt.write_shift(1,dt[tt]=="?"?"C":dt[tt],"sbcs"),vt.write_shift(4,it),vt.write_shift(1,lt[tt]||c[dt[tt]]||0),vt.write_shift(1,ut[tt]||0),vt.write_shift(1,2),vt.write_shift(4,0),vt.write_shift(1,0),vt.write_shift(4,0),vt.write_shift(4,0),it+=lt[tt]||c[dt[tt]]||0}var Gt=b.next(264);for(Gt.write_shift(4,13),tt=0;tt<65;++tt)Gt.write_shift(4,0);for(tt=0;tt<et.length;++tt){var Nt=b.next(at);for(Nt.write_shift(1,0),it=0;it<_e.length;++it)if(_e[it]!=null)switch(dt[it]){case"L":Nt.write_shift(1,et[tt][it]==null?63:et[tt][it]?84:70);break;case"B":Nt.write_shift(8,et[tt][it]||0,"f");break;case"N":var Ht="0";for(typeof et[tt][it]=="number"&&(Ht=et[tt][it].toFixed(ut[it]||0)),nt=0;nt<lt[it]-Ht.length;++nt)Nt.write_shift(1,32);Nt.write_shift(1,Ht,"sbcs");break;case"D":et[tt][it]?(Nt.write_shift(4,("0000"+et[tt][it].getFullYear()).slice(-4),"sbcs"),Nt.write_shift(2,("00"+(et[tt][it].getMonth()+1)).slice(-2),"sbcs"),Nt.write_shift(2,("00"+et[tt][it].getDate()).slice(-2),"sbcs")):Nt.write_shift(8,"00000000","sbcs");break;case"C":var It=String(et[tt][it]!=null?et[tt][it]:"").slice(0,lt[it]);for(Nt.write_shift(1,It,"sbcs"),nt=0;nt<lt[it]-It.length;++nt)Nt.write_shift(1,32);break}}return b.next(1).write_shift(1,26),b.end()}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},i=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(_e,et){var rt=e[et];return typeof rt=="number"?_getansi(rt):rt},s=function(_e,et,rt){var tt=et.charCodeAt(0)-32<<4|rt.charCodeAt(0)-48;return tt==59?_e:_getansi(tt)};e["|"]=254;function o(_e,et){switch(et.type){case"base64":return c(Base64_decode(_e),et);case"binary":return c(_e,et);case"buffer":return c(has_buf&&Buffer.isBuffer(_e)?_e.toString("binary"):a2s(_e),et);case"array":return c(cc2str(_e),et)}throw new Error("Unrecognized type "+et.type)}function c(_e,et){var rt=_e.split(/[\n\r]+/),tt=-1,it=-1,nt=0,at=0,st=[],dt=[],lt=null,ut={},ot=[],ft=[],pt=[],St=0,gt;for(+et.codepage>=0&&set_cp(+et.codepage);nt!==rt.length;++nt){St=0;var vt=rt[nt].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(i,a),At=vt.replace(/;;/g,"\0").split(";").map(function(xt){return xt.replace(/\u0000/g,";")}),Gt=At[0],Nt;if(vt.length>0)switch(Gt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":At[1].charAt(0)=="P"&&dt.push(vt.slice(3).replace(/;;/g,";"));break;case"C":var Ht=!1,It=!1,Wt=!1,yt=!1,Dt=-1,$t=-1;for(at=1;at<At.length;++at)switch(At[at].charAt(0)){case"A":break;case"X":it=parseInt(At[at].slice(1))-1,It=!0;break;case"Y":for(tt=parseInt(At[at].slice(1))-1,It||(it=0),gt=st.length;gt<=tt;++gt)st[gt]=[];break;case"K":Nt=At[at].slice(1),Nt.charAt(0)==='"'?Nt=Nt.slice(1,Nt.length-1):Nt==="TRUE"?Nt=!0:Nt==="FALSE"?Nt=!1:isNaN(fuzzynum(Nt))?isNaN(fuzzydate(Nt).getDate())||(Nt=parseDate(Nt)):(Nt=fuzzynum(Nt),lt!==null&&fmt_is_date(lt)&&(Nt=numdate(Nt))),Ht=!0;break;case"E":yt=!0;var _t=rc_to_a1(At[at].slice(1),{r:tt,c:it});st[tt][it]=[st[tt][it],_t];break;case"S":Wt=!0,st[tt][it]=[st[tt][it],"S5S"];break;case"G":break;case"R":Dt=parseInt(At[at].slice(1))-1;break;case"C":$t=parseInt(At[at].slice(1))-1;break;default:if(et&&et.WTF)throw new Error("SYLK bad record "+vt)}if(Ht&&(st[tt][it]&&st[tt][it].length==2?st[tt][it][0]=Nt:st[tt][it]=Nt,lt=null),Wt){if(yt)throw new Error("SYLK shared formula cannot have own formula");var ht=Dt>-1&&st[Dt][$t];if(!ht||!ht[1])throw new Error("SYLK shared formula cannot find base");st[tt][it][1]=shift_formula_str(ht[1],{r:tt-Dt,c:it-$t})}break;case"F":var ct=0;for(at=1;at<At.length;++at)switch(At[at].charAt(0)){case"X":it=parseInt(At[at].slice(1))-1,++ct;break;case"Y":for(tt=parseInt(At[at].slice(1))-1,gt=st.length;gt<=tt;++gt)st[gt]=[];break;case"M":St=parseInt(At[at].slice(1))/20;break;case"F":break;case"G":break;case"P":lt=dt[parseInt(At[at].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(pt=At[at].slice(1).split(" "),gt=parseInt(pt[0],10);gt<=parseInt(pt[1],10);++gt)St=parseInt(pt[2],10),ft[gt-1]=St===0?{hidden:!0}:{wch:St},process_col(ft[gt-1]);break;case"C":it=parseInt(At[at].slice(1))-1,ft[it]||(ft[it]={});break;case"R":tt=parseInt(At[at].slice(1))-1,ot[tt]||(ot[tt]={}),St>0?(ot[tt].hpt=St,ot[tt].hpx=pt2px(St)):St===0&&(ot[tt].hidden=!0);break;default:if(et&&et.WTF)throw new Error("SYLK bad record "+vt)}ct<1&&(lt=null);break;default:if(et&&et.WTF)throw new Error("SYLK bad record "+vt)}}return ot.length>0&&(ut["!rows"]=ot),ft.length>0&&(ut["!cols"]=ft),et&&et.sheetRows&&(st=st.slice(0,et.sheetRows)),[st,ut]}function h(_e,et){var rt=o(_e,et),tt=rt[0],it=rt[1],nt=aoa_to_sheet(tt,et);return keys(it).forEach(function(at){nt[at]=it[at]}),nt}function d(_e,et){return sheet_to_workbook(h(_e,et),et)}function g(_e,et,rt,tt){var it="C;Y"+(rt+1)+";X"+(tt+1)+";K";switch(_e.t){case"n":it+=_e.v||0,_e.f&&!_e.F&&(it+=";E"+a1_to_rc(_e.f,{r:rt,c:tt}));break;case"b":it+=_e.v?"TRUE":"FALSE";break;case"e":it+=_e.w||_e.v;break;case"d":it+='"'+(_e.w||_e.v)+'"';break;case"s":it+='"'+_e.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return it}function _(_e,et){et.forEach(function(rt,tt){var it="F;W"+(tt+1)+" "+(tt+1)+" ";rt.hidden?it+="0":(typeof rt.width=="number"&&!rt.wpx&&(rt.wpx=width2px(rt.width)),typeof rt.wpx=="number"&&!rt.wch&&(rt.wch=px2char(rt.wpx)),typeof rt.wch=="number"&&(it+=Math.round(rt.wch))),it.charAt(it.length-1)!=" "&&_e.push(it)})}function b(_e,et){et.forEach(function(rt,tt){var it="F;";rt.hidden?it+="M0;":rt.hpt?it+="M"+20*rt.hpt+";":rt.hpx&&(it+="M"+20*px2pt(rt.hpx)+";"),it.length>2&&_e.push(it+"R"+(tt+1))})}function j(_e,et){var rt=["ID;PWXL;N;E"],tt=[],it=safe_decode_range(_e["!ref"]),nt,at=Array.isArray(_e),st=`\r
`;rt.push("P;PGeneral"),rt.push("F;P0;DG0G8;M255"),_e["!cols"]&&_(rt,_e["!cols"]),_e["!rows"]&&b(rt,_e["!rows"]),rt.push("B;Y"+(it.e.r-it.s.r+1)+";X"+(it.e.c-it.s.c+1)+";D"+[it.s.c,it.s.r,it.e.c,it.e.r].join(" "));for(var dt=it.s.r;dt<=it.e.r;++dt)for(var lt=it.s.c;lt<=it.e.c;++lt){var ut=encode_cell({r:dt,c:lt});nt=at?(_e[dt]||[])[lt]:_e[ut],!(!nt||nt.v==null&&(!nt.f||nt.F))&&tt.push(g(nt,_e,dt,lt))}return rt.join(st)+st+tt.join(st)+st+"E"+st}return{to_workbook:d,to_sheet:h,from_sheet:j}}(),DIF=function(){function e(c,h){switch(h.type){case"base64":return i(Base64_decode(c),h);case"binary":return i(c,h);case"buffer":return i(has_buf&&Buffer.isBuffer(c)?c.toString("binary"):a2s(c),h);case"array":return i(cc2str(c),h)}throw new Error("Unrecognized type "+h.type)}function i(c,h){for(var d=c.split(`
`),g=-1,_=-1,b=0,j=[];b!==d.length;++b){if(d[b].trim()==="BOT"){j[++g]=[],_=0;continue}if(!(g<0)){var _e=d[b].trim().split(","),et=_e[0],rt=_e[1];++b;for(var tt=d[b]||"";(tt.match(/["]/g)||[]).length&1&&b<d.length-1;)tt+=`
`+d[++b];switch(tt=tt.trim(),+et){case-1:if(tt==="BOT"){j[++g]=[],_=0;continue}else if(tt!=="EOD")throw new Error("Unrecognized DIF special command "+tt);break;case 0:tt==="TRUE"?j[g][_]=!0:tt==="FALSE"?j[g][_]=!1:isNaN(fuzzynum(rt))?isNaN(fuzzydate(rt).getDate())?j[g][_]=rt:j[g][_]=parseDate(rt):j[g][_]=fuzzynum(rt),++_;break;case 1:tt=tt.slice(1,tt.length-1),tt=tt.replace(/""/g,'"'),tt&&tt.match(/^=".*"$/)&&(tt=tt.slice(2,-1)),j[g][_++]=tt!==""?tt:null;break}if(tt==="EOD")break}}return h&&h.sheetRows&&(j=j.slice(0,h.sheetRows)),j}function a(c,h){return aoa_to_sheet(e(c,h),h)}function s(c,h){return sheet_to_workbook(a(c,h),h)}var o=function(){var c=function(g,_,b,j,_e){g.push(_),g.push(b+","+j),g.push('"'+_e.replace(/"/g,'""')+'"')},h=function(g,_,b,j){g.push(_+","+b),g.push(_==1?'"'+j.replace(/"/g,'""')+'"':j)};return function(g){var _=[],b=safe_decode_range(g["!ref"]),j,_e=Array.isArray(g);c(_,"TABLE",0,1,"sheetjs"),c(_,"VECTORS",0,b.e.r-b.s.r+1,""),c(_,"TUPLES",0,b.e.c-b.s.c+1,""),c(_,"DATA",0,0,"");for(var et=b.s.r;et<=b.e.r;++et){h(_,-1,0,"BOT");for(var rt=b.s.c;rt<=b.e.c;++rt){var tt=encode_cell({r:et,c:rt});if(j=_e?(g[et]||[])[rt]:g[tt],!j){h(_,1,0,"");continue}switch(j.t){case"n":var it=j.w;!it&&j.v!=null&&(it=j.v),it==null?j.f&&!j.F?h(_,1,0,"="+j.f):h(_,1,0,""):h(_,0,it,"V");break;case"b":h(_,0,j.v?1:0,j.v?"TRUE":"FALSE");break;case"s":h(_,1,0,isNaN(j.v)?j.v:'="'+j.v+'"');break;case"d":j.w||(j.w=SSF_format(j.z||table_fmt[14],datenum(parseDate(j.v)))),h(_,0,j.w,"V");break;default:h(_,1,0,"")}}}h(_,-1,0,"EOD");var nt=`\r
`,at=_.join(nt);return at}}();return{to_workbook:s,to_sheet:a,from_sheet:o}}(),ETH=function(){function e(j){return j.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function i(j){return j.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(j,_e){for(var et=j.split(`
`),rt=-1,tt=-1,it=0,nt=[];it!==et.length;++it){var at=et[it].trim().split(":");if(at[0]==="cell"){var st=decode_cell(at[1]);if(nt.length<=st.r)for(rt=nt.length;rt<=st.r;++rt)nt[rt]||(nt[rt]=[]);switch(rt=st.r,tt=st.c,at[2]){case"t":nt[rt][tt]=e(at[3]);break;case"v":nt[rt][tt]=+at[3];break;case"vtf":var dt=at[at.length-1];case"vtc":switch(at[3]){case"nl":nt[rt][tt]=!!+at[4];break;default:nt[rt][tt]=+at[4];break}at[2]=="vtf"&&(nt[rt][tt]=[nt[rt][tt],dt])}}}return _e&&_e.sheetRows&&(nt=nt.slice(0,_e.sheetRows)),nt}function s(j,_e){return aoa_to_sheet(a(j,_e),_e)}function o(j,_e){return sheet_to_workbook(s(j,_e),_e)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),h=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function _(j){if(!j||!j["!ref"])return"";for(var _e=[],et=[],rt,tt="",it=decode_range(j["!ref"]),nt=Array.isArray(j),at=it.s.r;at<=it.e.r;++at)for(var st=it.s.c;st<=it.e.c;++st)if(tt=encode_cell({r:at,c:st}),rt=nt?(j[at]||[])[st]:j[tt],!(!rt||rt.v==null||rt.t==="z")){switch(et=["cell",tt,"t"],rt.t){case"s":case"str":et.push(i(rt.v));break;case"n":rt.f?(et[2]="vtf",et[3]="n",et[4]=rt.v,et[5]=i(rt.f)):(et[2]="v",et[3]=rt.v);break;case"b":et[2]="vt"+(rt.f?"f":"c"),et[3]="nl",et[4]=rt.v?"1":"0",et[5]=i(rt.f||(rt.v?"TRUE":"FALSE"));break;case"d":var dt=datenum(parseDate(rt.v));et[2]="vtc",et[3]="nd",et[4]=""+dt,et[5]=rt.w||SSF_format(rt.z||table_fmt[14],dt);break;case"e":continue}_e.push(et.join(":"))}return _e.push("sheet:c:"+(it.e.c-it.s.c+1)+":r:"+(it.e.r-it.s.r+1)+":tvf:1"),_e.push("valueformat:1:text-wiki"),_e.join(`
`)}function b(j){return[c,h,d,h,_(j),g].join(`
`)}return{to_workbook:o,to_sheet:s,from_sheet:b}}(),PRN=function(){function e(b,j,_e,et,rt){rt.raw?j[_e][et]=b:b===""||(b==="TRUE"?j[_e][et]=!0:b==="FALSE"?j[_e][et]=!1:isNaN(fuzzynum(b))?isNaN(fuzzydate(b).getDate())?j[_e][et]=b:j[_e][et]=parseDate(b):j[_e][et]=fuzzynum(b))}function i(b,j){var _e=j||{},et=[];if(!b||b.length===0)return et;for(var rt=b.split(/[\r\n]/),tt=rt.length-1;tt>=0&&rt[tt].length===0;)--tt;for(var it=10,nt=0,at=0;at<=tt;++at)nt=rt[at].indexOf(" "),nt==-1?nt=rt[at].length:nt++,it=Math.max(it,nt);for(at=0;at<=tt;++at){et[at]=[];var st=0;for(e(rt[at].slice(0,it).trim(),et,at,st,_e),st=1;st<=(rt[at].length-it)/10+1;++st)e(rt[at].slice(it+(st-1)*10,it+st*10).trim(),et,at,st,_e)}return _e.sheetRows&&(et=et.slice(0,_e.sheetRows)),et}var a={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function o(b){for(var j={},_e=!1,et=0,rt=0;et<b.length;++et)(rt=b.charCodeAt(et))==34?_e=!_e:!_e&&rt in a&&(j[rt]=(j[rt]||0)+1);rt=[];for(et in j)Object.prototype.hasOwnProperty.call(j,et)&&rt.push([j[et],et]);if(!rt.length){j=s;for(et in j)Object.prototype.hasOwnProperty.call(j,et)&&rt.push([j[et],et])}return rt.sort(function(tt,it){return tt[0]-it[0]||s[tt[1]]-s[it[1]]}),a[rt.pop()[1]]||44}function c(b,j){var _e=j||{},et="",rt=_e.dense?[]:{},tt={s:{c:0,r:0},e:{c:0,r:0}};b.slice(0,4)=="sep="?b.charCodeAt(5)==13&&b.charCodeAt(6)==10?(et=b.charAt(4),b=b.slice(7)):b.charCodeAt(5)==13||b.charCodeAt(5)==10?(et=b.charAt(4),b=b.slice(6)):et=o(b.slice(0,1024)):_e&&_e.FS?et=_e.FS:et=o(b.slice(0,1024));var it=0,nt=0,at=0,st=0,dt=0,lt=et.charCodeAt(0),ut=!1,ot=0,ft=b.charCodeAt(0);b=b.replace(/\r\n/mg,`
`);var pt=_e.dateNF!=null?dateNF_regex(_e.dateNF):null;function St(){var gt=b.slice(st,dt),vt={};if(gt.charAt(0)=='"'&&gt.charAt(gt.length-1)=='"'&&(gt=gt.slice(1,-1).replace(/""/g,'"')),gt.length===0)vt.t="z";else if(_e.raw)vt.t="s",vt.v=gt;else if(gt.trim().length===0)vt.t="s",vt.v=gt;else if(gt.charCodeAt(0)==61)gt.charCodeAt(1)==34&&gt.charCodeAt(gt.length-1)==34?(vt.t="s",vt.v=gt.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(gt)?(vt.t="n",vt.f=gt.slice(1)):(vt.t="s",vt.v=gt);else if(gt=="TRUE")vt.t="b",vt.v=!0;else if(gt=="FALSE")vt.t="b",vt.v=!1;else if(!isNaN(at=fuzzynum(gt)))vt.t="n",_e.cellText!==!1&&(vt.w=gt),vt.v=at;else if(!isNaN(fuzzydate(gt).getDate())||pt&&gt.match(pt)){vt.z=_e.dateNF||table_fmt[14];var At=0;pt&&gt.match(pt)&&(gt=dateNF_fix(gt,_e.dateNF,gt.match(pt)||[]),At=1),_e.cellDates?(vt.t="d",vt.v=parseDate(gt,At)):(vt.t="n",vt.v=datenum(parseDate(gt,At))),_e.cellText!==!1&&(vt.w=SSF_format(vt.z,vt.v instanceof Date?datenum(vt.v):vt.v)),_e.cellNF||delete vt.z}else vt.t="s",vt.v=gt;if(vt.t=="z"||(_e.dense?(rt[it]||(rt[it]=[]),rt[it][nt]=vt):rt[encode_cell({c:nt,r:it})]=vt),st=dt+1,ft=b.charCodeAt(st),tt.e.c<nt&&(tt.e.c=nt),tt.e.r<it&&(tt.e.r=it),ot==lt)++nt;else if(nt=0,++it,_e.sheetRows&&_e.sheetRows<=it)return!0}e:for(;dt<b.length;++dt)switch(ot=b.charCodeAt(dt)){case 34:ft===34&&(ut=!ut);break;case lt:case 10:case 13:if(!ut&&St())break e;break}return dt-st>0&&St(),rt["!ref"]=encode_range(tt),rt}function h(b,j){return!(j&&j.PRN)||j.FS||b.slice(0,4)=="sep="||b.indexOf("	")>=0||b.indexOf(",")>=0||b.indexOf(";")>=0?c(b,j):aoa_to_sheet(i(b,j),j)}function d(b,j){var _e="",et=j.type=="string"?[0,0,0,0]:firstbyte(b,j);switch(j.type){case"base64":_e=Base64_decode(b);break;case"binary":_e=b;break;case"buffer":j.codepage==65001?_e=b.toString("utf8"):j.codepage&&typeof $cptable<"u"||(_e=has_buf&&Buffer.isBuffer(b)?b.toString("binary"):a2s(b));break;case"array":_e=cc2str(b);break;case"string":_e=b;break;default:throw new Error("Unrecognized type "+j.type)}return et[0]==239&&et[1]==187&&et[2]==191?_e=utf8read(_e.slice(3)):j.type!="string"&&j.type!="buffer"&&j.codepage==65001?_e=utf8read(_e):j.type=="binary"&&typeof $cptable<"u",_e.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(j.type=="string"?_e:utf8read(_e),j):h(_e,j)}function g(b,j){return sheet_to_workbook(d(b,j),j)}function _(b){for(var j=[],_e=safe_decode_range(b["!ref"]),et,rt=Array.isArray(b),tt=_e.s.r;tt<=_e.e.r;++tt){for(var it=[],nt=_e.s.c;nt<=_e.e.c;++nt){var at=encode_cell({r:tt,c:nt});if(et=rt?(b[tt]||[])[nt]:b[at],!et||et.v==null){it.push("          ");continue}for(var st=(et.w||(format_cell(et),et.w)||"").slice(0,10);st.length<10;)st+=" ";it.push(st+(nt===0?" ":""))}j.push(it.join(""))}return j.join(`
`)}return{to_workbook:g,to_sheet:d,from_sheet:_}}();function read_wb_ID(e,i){var a=i||{},s=!!a.WTF;a.WTF=!0;try{var o=SYLK.to_workbook(e,a);return a.WTF=s,o}catch(c){if(a.WTF=s,!c.message.match(/SYLK bad record ID/)&&s)throw c;return PRN.to_workbook(e,i)}}var WK_=function(){function e(_t,ht,ct){if(_t){prep_blob(_t,_t.l||0);for(var xt=ct.Enum||Dt;_t.l<_t.length;){var Et=_t.read_shift(2),bt=xt[Et]||xt[65535],Ct=_t.read_shift(2),Ot=_t.l+Ct,jt=bt.f&&bt.f(_t,Ct,ct);if(_t.l=Ot,ht(jt,bt,Et))return}}}function i(_t,ht){switch(ht.type){case"base64":return a(s2a(Base64_decode(_t)),ht);case"binary":return a(s2a(_t),ht);case"buffer":case"array":return a(_t,ht)}throw"Unsupported type "+ht.type}function a(_t,ht){if(!_t)return _t;var ct=ht||{},xt=ct.dense?[]:{},Et="Sheet1",bt="",Ct=0,Ot={},jt=[],er=[],Tt={s:{r:0,c:0},e:{r:0,c:0}},ur=ct.sheetRows||0;if(_t[2]==0&&(_t[3]==8||_t[3]==9)&&_t.length>=16&&_t[14]==5&&_t[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_t[2]==2)ct.Enum=Dt,e(_t,function(Xt,Ft,Ut){switch(Ut){case 0:ct.vers=Xt,Xt>=4096&&(ct.qpro=!0);break;case 6:Tt=Xt;break;case 204:Xt&&(bt=Xt);break;case 222:bt=Xt;break;case 15:case 51:ct.qpro||(Xt[1].v=Xt[1].v.slice(1));case 13:case 14:case 16:Ut==14&&(Xt[2]&112)==112&&(Xt[2]&15)>1&&(Xt[2]&15)<15&&(Xt[1].z=ct.dateNF||table_fmt[14],ct.cellDates&&(Xt[1].t="d",Xt[1].v=numdate(Xt[1].v))),ct.qpro&&Xt[3]>Ct&&(xt["!ref"]=encode_range(Tt),Ot[Et]=xt,jt.push(Et),xt=ct.dense?[]:{},Tt={s:{r:0,c:0},e:{r:0,c:0}},Ct=Xt[3],Et=bt||"Sheet"+(Ct+1),bt="");var qt=ct.dense?(xt[Xt[0].r]||[])[Xt[0].c]:xt[encode_cell(Xt[0])];if(qt){qt.t=Xt[1].t,qt.v=Xt[1].v,Xt[1].z!=null&&(qt.z=Xt[1].z),Xt[1].f!=null&&(qt.f=Xt[1].f);break}ct.dense?(xt[Xt[0].r]||(xt[Xt[0].r]=[]),xt[Xt[0].r][Xt[0].c]=Xt[1]):xt[encode_cell(Xt[0])]=Xt[1];break}},ct);else if(_t[2]==26||_t[2]==14)ct.Enum=$t,_t[2]==14&&(ct.qpro=!0,_t.l=0),e(_t,function(Xt,Ft,Ut){switch(Ut){case 204:Et=Xt;break;case 22:Xt[1].v=Xt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Xt[3]>Ct&&(xt["!ref"]=encode_range(Tt),Ot[Et]=xt,jt.push(Et),xt=ct.dense?[]:{},Tt={s:{r:0,c:0},e:{r:0,c:0}},Ct=Xt[3],Et="Sheet"+(Ct+1)),ur>0&&Xt[0].r>=ur)break;ct.dense?(xt[Xt[0].r]||(xt[Xt[0].r]=[]),xt[Xt[0].r][Xt[0].c]=Xt[1]):xt[encode_cell(Xt[0])]=Xt[1],Tt.e.c<Xt[0].c&&(Tt.e.c=Xt[0].c),Tt.e.r<Xt[0].r&&(Tt.e.r=Xt[0].r);break;case 27:Xt[14e3]&&(er[Xt[14e3][0]]=Xt[14e3][1]);break;case 1537:er[Xt[0]]=Xt[1],Xt[0]==Ct&&(Et=Xt[1]);break}},ct);else throw new Error("Unrecognized LOTUS BOF "+_t[2]);if(xt["!ref"]=encode_range(Tt),Ot[bt||Et]=xt,jt.push(bt||Et),!er.length)return{SheetNames:jt,Sheets:Ot};for(var cr={},hr=[],Yt=0;Yt<er.length;++Yt)Ot[jt[Yt]]?(hr.push(er[Yt]||jt[Yt]),cr[er[Yt]]=Ot[er[Yt]]||Ot[jt[Yt]]):(hr.push(er[Yt]),cr[er[Yt]]={"!ref":"A1"});return{SheetNames:hr,Sheets:cr}}function s(_t,ht){var ct=ht||{};if(+ct.codepage>=0&&set_cp(+ct.codepage),ct.type=="string")throw new Error("Cannot write WK1 to JS string");var xt=buf_array(),Et=safe_decode_range(_t["!ref"]),bt=Array.isArray(_t),Ct=[];write_biff_rec(xt,0,c(1030)),write_biff_rec(xt,6,g(Et));for(var Ot=Math.min(Et.e.r,8191),jt=Et.s.r;jt<=Ot;++jt)for(var er=encode_row(jt),Tt=Et.s.c;Tt<=Et.e.c;++Tt){jt===Et.s.r&&(Ct[Tt]=encode_col(Tt));var ur=Ct[Tt]+er,cr=bt?(_t[jt]||[])[Tt]:_t[ur];if(!(!cr||cr.t=="z"))if(cr.t=="n")(cr.v|0)==cr.v&&cr.v>=-32768&&cr.v<=32767?write_biff_rec(xt,13,et(jt,Tt,cr.v)):write_biff_rec(xt,14,tt(jt,Tt,cr.v));else{var hr=format_cell(cr);write_biff_rec(xt,15,j(jt,Tt,hr.slice(0,239)))}}return write_biff_rec(xt,1),xt.end()}function o(_t,ht){var ct=ht||{};if(+ct.codepage>=0&&set_cp(+ct.codepage),ct.type=="string")throw new Error("Cannot write WK3 to JS string");var xt=buf_array();write_biff_rec(xt,0,h(_t));for(var Et=0,bt=0;Et<_t.SheetNames.length;++Et)(_t.Sheets[_t.SheetNames[Et]]||{})["!ref"]&&write_biff_rec(xt,27,yt(_t.SheetNames[Et],bt++));var Ct=0;for(Et=0;Et<_t.SheetNames.length;++Et){var Ot=_t.Sheets[_t.SheetNames[Et]];if(!(!Ot||!Ot["!ref"])){for(var jt=safe_decode_range(Ot["!ref"]),er=Array.isArray(Ot),Tt=[],ur=Math.min(jt.e.r,8191),cr=jt.s.r;cr<=ur;++cr)for(var hr=encode_row(cr),Yt=jt.s.c;Yt<=jt.e.c;++Yt){cr===jt.s.r&&(Tt[Yt]=encode_col(Yt));var Xt=Tt[Yt]+hr,Ft=er?(Ot[cr]||[])[Yt]:Ot[Xt];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")write_biff_rec(xt,23,St(cr,Yt,Ct,Ft.v));else{var Ut=format_cell(Ft);write_biff_rec(xt,22,ot(cr,Yt,Ct,Ut.slice(0,239)))}}++Ct}}return write_biff_rec(xt,1),xt.end()}function c(_t){var ht=new_buf(2);return ht.write_shift(2,_t),ht}function h(_t){var ht=new_buf(26);ht.write_shift(2,4096),ht.write_shift(2,4),ht.write_shift(4,0);for(var ct=0,xt=0,Et=0,bt=0;bt<_t.SheetNames.length;++bt){var Ct=_t.SheetNames[bt],Ot=_t.Sheets[Ct];if(!(!Ot||!Ot["!ref"])){++Et;var jt=decode_range(Ot["!ref"]);ct<jt.e.r&&(ct=jt.e.r),xt<jt.e.c&&(xt=jt.e.c)}}return ct>8191&&(ct=8191),ht.write_shift(2,ct),ht.write_shift(1,Et),ht.write_shift(1,xt),ht.write_shift(2,0),ht.write_shift(2,0),ht.write_shift(1,1),ht.write_shift(1,2),ht.write_shift(4,0),ht.write_shift(4,0),ht}function d(_t,ht,ct){var xt={s:{c:0,r:0},e:{c:0,r:0}};return ht==8&&ct.qpro?(xt.s.c=_t.read_shift(1),_t.l++,xt.s.r=_t.read_shift(2),xt.e.c=_t.read_shift(1),_t.l++,xt.e.r=_t.read_shift(2),xt):(xt.s.c=_t.read_shift(2),xt.s.r=_t.read_shift(2),ht==12&&ct.qpro&&(_t.l+=2),xt.e.c=_t.read_shift(2),xt.e.r=_t.read_shift(2),ht==12&&ct.qpro&&(_t.l+=2),xt.s.c==65535&&(xt.s.c=xt.e.c=xt.s.r=xt.e.r=0),xt)}function g(_t){var ht=new_buf(8);return ht.write_shift(2,_t.s.c),ht.write_shift(2,_t.s.r),ht.write_shift(2,_t.e.c),ht.write_shift(2,_t.e.r),ht}function _(_t,ht,ct){var xt=[{c:0,r:0},{t:"n",v:0},0,0];return ct.qpro&&ct.vers!=20768?(xt[0].c=_t.read_shift(1),xt[3]=_t.read_shift(1),xt[0].r=_t.read_shift(2),_t.l+=2):(xt[2]=_t.read_shift(1),xt[0].c=_t.read_shift(2),xt[0].r=_t.read_shift(2)),xt}function b(_t,ht,ct){var xt=_t.l+ht,Et=_(_t,ht,ct);if(Et[1].t="s",ct.vers==20768){_t.l++;var bt=_t.read_shift(1);return Et[1].v=_t.read_shift(bt,"utf8"),Et}return ct.qpro&&_t.l++,Et[1].v=_t.read_shift(xt-_t.l,"cstr"),Et}function j(_t,ht,ct){var xt=new_buf(7+ct.length);xt.write_shift(1,255),xt.write_shift(2,ht),xt.write_shift(2,_t),xt.write_shift(1,39);for(var Et=0;Et<xt.length;++Et){var bt=ct.charCodeAt(Et);xt.write_shift(1,bt>=128?95:bt)}return xt.write_shift(1,0),xt}function _e(_t,ht,ct){var xt=_(_t,ht,ct);return xt[1].v=_t.read_shift(2,"i"),xt}function et(_t,ht,ct){var xt=new_buf(7);return xt.write_shift(1,255),xt.write_shift(2,ht),xt.write_shift(2,_t),xt.write_shift(2,ct,"i"),xt}function rt(_t,ht,ct){var xt=_(_t,ht,ct);return xt[1].v=_t.read_shift(8,"f"),xt}function tt(_t,ht,ct){var xt=new_buf(13);return xt.write_shift(1,255),xt.write_shift(2,ht),xt.write_shift(2,_t),xt.write_shift(8,ct,"f"),xt}function it(_t,ht,ct){var xt=_t.l+ht,Et=_(_t,ht,ct);if(Et[1].v=_t.read_shift(8,"f"),ct.qpro)_t.l=xt;else{var bt=_t.read_shift(2);dt(_t.slice(_t.l,_t.l+bt),Et),_t.l+=bt}return Et}function nt(_t,ht,ct){var xt=ht&32768;return ht&=-32769,ht=(xt?_t:0)+(ht>=8192?ht-16384:ht),(xt?"":"$")+(ct?encode_col(ht):encode_row(ht))}var at={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},st=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function dt(_t,ht){prep_blob(_t,0);for(var ct=[],xt=0,Et="",bt="",Ct="",Ot="";_t.l<_t.length;){var jt=_t[_t.l++];switch(jt){case 0:ct.push(_t.read_shift(8,"f"));break;case 1:bt=nt(ht[0].c,_t.read_shift(2),!0),Et=nt(ht[0].r,_t.read_shift(2),!1),ct.push(bt+Et);break;case 2:{var er=nt(ht[0].c,_t.read_shift(2),!0),Tt=nt(ht[0].r,_t.read_shift(2),!1);bt=nt(ht[0].c,_t.read_shift(2),!0),Et=nt(ht[0].r,_t.read_shift(2),!1),ct.push(er+Tt+":"+bt+Et)}break;case 3:if(_t.l<_t.length){console.error("WK1 premature formula end");return}break;case 4:ct.push("("+ct.pop()+")");break;case 5:ct.push(_t.read_shift(2));break;case 6:{for(var ur="";jt=_t[_t.l++];)ur+=String.fromCharCode(jt);ct.push('"'+ur.replace(/"/g,'""')+'"')}break;case 8:ct.push("-"+ct.pop());break;case 23:ct.push("+"+ct.pop());break;case 22:ct.push("NOT("+ct.pop()+")");break;case 20:case 21:Ot=ct.pop(),Ct=ct.pop(),ct.push(["AND","OR"][jt-20]+"("+Ct+","+Ot+")");break;default:if(jt<32&&st[jt])Ot=ct.pop(),Ct=ct.pop(),ct.push(Ct+st[jt]+Ot);else if(at[jt]){if(xt=at[jt][1],xt==69&&(xt=_t[_t.l++]),xt>ct.length){console.error("WK1 bad formula parse 0x"+jt.toString(16)+":|"+ct.join("|")+"|");return}var cr=ct.slice(-xt);ct.length-=xt,ct.push(at[jt][0]+"("+cr.join(",")+")")}else return jt<=7?console.error("WK1 invalid opcode "+jt.toString(16)):jt<=24?console.error("WK1 unsupported op "+jt.toString(16)):jt<=30?console.error("WK1 invalid opcode "+jt.toString(16)):jt<=115?console.error("WK1 unsupported function opcode "+jt.toString(16)):console.error("WK1 unrecognized opcode "+jt.toString(16))}}ct.length==1?ht[1].f=""+ct[0]:console.error("WK1 bad formula parse |"+ct.join("|")+"|")}function lt(_t){var ht=[{c:0,r:0},{t:"n",v:0},0];return ht[0].r=_t.read_shift(2),ht[3]=_t[_t.l++],ht[0].c=_t[_t.l++],ht}function ut(_t,ht){var ct=lt(_t);return ct[1].t="s",ct[1].v=_t.read_shift(ht-4,"cstr"),ct}function ot(_t,ht,ct,xt){var Et=new_buf(6+xt.length);Et.write_shift(2,_t),Et.write_shift(1,ct),Et.write_shift(1,ht),Et.write_shift(1,39);for(var bt=0;bt<xt.length;++bt){var Ct=xt.charCodeAt(bt);Et.write_shift(1,Ct>=128?95:Ct)}return Et.write_shift(1,0),Et}function ft(_t,ht){var ct=lt(_t);ct[1].v=_t.read_shift(2);var xt=ct[1].v>>1;if(ct[1].v&1)switch(xt&7){case 0:xt=(xt>>3)*5e3;break;case 1:xt=(xt>>3)*500;break;case 2:xt=(xt>>3)/20;break;case 3:xt=(xt>>3)/200;break;case 4:xt=(xt>>3)/2e3;break;case 5:xt=(xt>>3)/2e4;break;case 6:xt=(xt>>3)/16;break;case 7:xt=(xt>>3)/64;break}return ct[1].v=xt,ct}function pt(_t,ht){var ct=lt(_t),xt=_t.read_shift(4),Et=_t.read_shift(4),bt=_t.read_shift(2);if(bt==65535)return xt===0&&Et===3221225472?(ct[1].t="e",ct[1].v=15):xt===0&&Et===3489660928?(ct[1].t="e",ct[1].v=42):ct[1].v=0,ct;var Ct=bt&32768;return bt=(bt&32767)-16446,ct[1].v=(1-Ct*2)*(Et*Math.pow(2,bt+32)+xt*Math.pow(2,bt)),ct}function St(_t,ht,ct,xt){var Et=new_buf(14);if(Et.write_shift(2,_t),Et.write_shift(1,ct),Et.write_shift(1,ht),xt==0)return Et.write_shift(4,0),Et.write_shift(4,0),Et.write_shift(2,65535),Et;var bt=0,Ct=0,Ot=0,jt=0;return xt<0&&(bt=1,xt=-xt),Ct=Math.log2(xt)|0,xt/=Math.pow(2,Ct-31),jt=xt>>>0,jt&2147483648||(xt/=2,++Ct,jt=xt>>>0),xt-=jt,jt|=2147483648,jt>>>=0,xt*=Math.pow(2,32),Ot=xt>>>0,Et.write_shift(4,Ot),Et.write_shift(4,jt),Ct+=16383+(bt?32768:0),Et.write_shift(2,Ct),Et}function gt(_t,ht){var ct=pt(_t);return _t.l+=ht-14,ct}function vt(_t,ht){var ct=lt(_t),xt=_t.read_shift(4);return ct[1].v=xt>>6,ct}function At(_t,ht){var ct=lt(_t),xt=_t.read_shift(8,"f");return ct[1].v=xt,ct}function Gt(_t,ht){var ct=At(_t);return _t.l+=ht-10,ct}function Nt(_t,ht){return _t[_t.l+ht-1]==0?_t.read_shift(ht,"cstr"):""}function Ht(_t,ht){var ct=_t[_t.l++];ct>ht-1&&(ct=ht-1);for(var xt="";xt.length<ct;)xt+=String.fromCharCode(_t[_t.l++]);return xt}function It(_t,ht,ct){if(!(!ct.qpro||ht<21)){var xt=_t.read_shift(1);_t.l+=17,_t.l+=1,_t.l+=2;var Et=_t.read_shift(ht-21,"cstr");return[xt,Et]}}function Wt(_t,ht){for(var ct={},xt=_t.l+ht;_t.l<xt;){var Et=_t.read_shift(2);if(Et==14e3){for(ct[Et]=[0,""],ct[Et][0]=_t.read_shift(2);_t[_t.l];)ct[Et][1]+=String.fromCharCode(_t[_t.l]),_t.l++;_t.l++}}return ct}function yt(_t,ht){var ct=new_buf(5+_t.length);ct.write_shift(2,14e3),ct.write_shift(2,ht);for(var xt=0;xt<_t.length;++xt){var Et=_t.charCodeAt(xt);ct[ct.l++]=Et>127?95:Et}return ct[ct.l++]=0,ct}var Dt={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_e},14:{n:"NUMBER",f:rt},15:{n:"LABEL",f:b},16:{n:"FORMULA",f:it},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:b},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Nt},222:{n:"SHEETNAMELP",f:Ht},65535:{n:""}},$t={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ut},23:{n:"NUMBER17",f:pt},24:{n:"NUMBER18",f:ft},25:{n:"FORMULA19",f:gt},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Wt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:vt},38:{n:"??"},39:{n:"NUMBER27",f:At},40:{n:"FORMULA28",f:Gt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Nt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:It},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:o,to_workbook:i}}();function parse_rpr(e){var i={},a=e.match(tagregex),s=0,o=!1;if(a)for(;s!=a.length;++s){var c=parsexmltag(a[s]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":i.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;i.cp=CS2CP[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":i.outline=1;break;case"</outline>":break;case"<rFont":i.name=c.val;break;case"<sz":i.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":i.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":i.uval="double";break;case"singleAccounting":i.uval="single-accounting";break;case"doubleAccounting":i.uval="double-accounting";break}case"<u>":case"<u/>":i.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":i.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":i.i=1;break;case"</i>":break;case"<color":c.rgb&&(i.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":i.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":i.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(c[0].charCodeAt(1)!==47&&!o)throw new Error("Unrecognized rich format "+c[0])}}return i}var parse_rs=function(){var e=matchtag("t"),i=matchtag("rPr");function a(c){var h=c.match(e);if(!h)return{t:"s",v:""};var d={t:"s",v:unescapexml(h[1])},g=c.match(i);return g&&(d.s=parse_rpr(g[1])),d}var s=/<(?:\w+:)?r>/g,o=/<\/(?:\w+:)?r>/;return function(h){return h.replace(s,"").split(o).map(a).filter(function(d){return d.v})}}(),rs_to_html=function(){var i=/(\r\n|\n)/g;function a(o,c,h){var d=[];o.u&&d.push("text-decoration: underline;"),o.uval&&d.push("text-underline-style:"+o.uval+";"),o.sz&&d.push("font-size:"+o.sz+"pt;"),o.outline&&d.push("text-effect: outline;"),o.shadow&&d.push("text-shadow: auto;"),c.push('<span style="'+d.join("")+'">'),o.b&&(c.push("<b>"),h.push("</b>")),o.i&&(c.push("<i>"),h.push("</i>")),o.strike&&(c.push("<s>"),h.push("</s>"));var g=o.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(c.push("<"+g+">"),h.push("</"+g+">")),h.push("</span>"),o}function s(o){var c=[[],o.v,[]];return o.v?(o.s&&a(o.s,c[0],c[2]),c[0].join("")+c[1].replace(i,"<br/>")+c[2].join("")):""}return function(c){return c.map(s).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,i){var a=i?i.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=utf8read(e),a&&(s.h=escapehtml(s.t))):e.match(sirregex)&&(s.r=utf8read(e),s.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),a&&(s.h=rs_to_html(parse_rs(s.r)))),s):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,i){var a=[],s="";if(!e)return a;var o=e.match(sstr0);if(o){s=o[2].replace(sstr1,"").split(sstr2);for(var c=0;c!=s.length;++c){var h=parse_si(s[c].trim(),i);h!=null&&(a[a.length]=h)}o=parsexmltag(o[1]),a.Count=o.count,a.Unique=o.uniqueCount}return a}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,i){if(!i.bookSST)return"";var a=[XML_HEADER];a[a.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var o=e[s],c="<si>";o.r?c+=o.r:(c+="<t",o.t||(o.t=""),o.t.match(straywsregex)&&(c+=' xml:space="preserve"'),c+=">"+escapexml(o.t)+"</t>"),c+="</si>",a[a.length]=c}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,i){var a=[],s=!1;return recordhopper(e,function(c,h,d){switch(d){case 159:a.Count=c[0],a.Unique=c[1];break;case 19:a.push(c);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(h.T,!s||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function write_BrtBeginSst(e,i){return i||(i=new_buf(8)),i.write_shift(4,e.Count),i.write_shift(4,e.Unique),i}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var i=buf_array();write_record(i,159,write_BrtBeginSst(e));for(var a=0;a<e.length;++a)write_record(i,19,write_BrtSSTItem(e[a]));return write_record(i,160),i.end()}function _JS2ANSI(e){for(var i=[],a=e.split(""),s=0;s<a.length;++s)i[s]=a[s].charCodeAt(0);return i}function parse_CRYPTOVersion(e,i){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),i>=4&&(e.l+=i-4),a}function parse_DataSpaceVersionInfo(e){var i={};return i.id=e.read_shift(0,"lpp4"),i.R=parse_CRYPTOVersion(e,4),i.U=parse_CRYPTOVersion(e,4),i.W=parse_CRYPTOVersion(e,4),i}function parse_DataSpaceMapEntry(e){for(var i=e.read_shift(4),a=e.l+i-4,s={},o=e.read_shift(4),c=[];o-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=c,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return s}function parse_DataSpaceMap(e){var i=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)i.push(parse_DataSpaceMapEntry(e));return i}function parse_DataSpaceDefinition(e){var i=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)i.push(e.read_shift(0,"lpp4"));return i}function parse_TransformInfoHeader(e){var i={};return e.read_shift(4),e.l+=4,i.id=e.read_shift(0,"lpp4"),i.name=e.read_shift(0,"lpp4"),i.R=parse_CRYPTOVersion(e,4),i.U=parse_CRYPTOVersion(e,4),i.W=parse_CRYPTOVersion(e,4),i}function parse_Primary(e){var i=parse_TransformInfoHeader(e);if(i.ename=e.read_shift(0,"8lpp4"),i.blksz=e.read_shift(4),i.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return i}function parse_EncryptionHeader(e,i){var a=e.l+i,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var o=!1;switch(s.AlgID){case 26126:case 26127:case 26128:o=s.Flags==36;break;case 26625:o=s.Flags==4;break;case 0:o=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!o)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,s}function parse_EncryptionVerifier(e,i){var a={},s=e.l+i;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,s),e.l=s,a}function parse_EncryptionInfo(e){var i=parse_CRYPTOVersion(e);switch(i.Minor){case 2:return[i.Minor,parse_EncInfoStd(e)];case 3:return[i.Minor,parse_EncInfoExt()];case 4:return[i.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+i.Minor)}function parse_EncInfoStd(e){var i=e.read_shift(4);if((i&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),s=parse_EncryptionHeader(e,a),o=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:s,v:o}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var i=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),s={};return a.replace(tagregex,function(c){var h=parsexmltag(c);switch(strip_ns(h[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":i.forEach(function(d){s[d]=h[d]});break;case"<dataIntegrity":s.encryptedHmacKey=h.encryptedHmacKey,s.encryptedHmacValue=h.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=h.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(h);break;default:throw h[0]}}),s}function parse_RC4CryptoHeader(e,i){var a={},s=a.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(i-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);a.Flags=e.read_shift(4),i-=4;var o=e.read_shift(4);return i-=4,a.EncryptionHeader=parse_EncryptionHeader(e,o),i-=o,a.EncryptionVerifier=parse_EncryptionVerifier(e,i),a}function parse_RC4Header(e){var i={},a=i.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return i.Salt=e.read_shift(16),i.EncryptedVerifier=e.read_shift(16),i.EncryptedVerifierHash=e.read_shift(16),i}function crypto_CreatePasswordVerifier_Method1(e){var i=0,a,s=_JS2ANSI(e),o=s.length+1,c,h,d,g,_;for(a=new_raw_buf(o),a[0]=s.length,c=1;c!=o;++c)a[c]=s[c-1];for(c=o-1;c>=0;--c)h=a[c],d=i&16384?1:0,g=i<<1&32767,_=d|g,i=_^h;return i^52811}var crypto_CreateXorArray_Method1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],i=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(h){return(h/2|h*128)&255},o=function(h,d){return s(h^d)},c=function(h){for(var d=i[h.length-1],g=104,_=h.length-1;_>=0;--_)for(var b=h[_],j=0;j!=7;++j)b&64&&(d^=a[g]),b*=2,--g;return d};return function(h){for(var d=_JS2ANSI(h),g=c(d),_=d.length,b=new_raw_buf(16),j=0;j!=16;++j)b[j]=0;var _e,et,rt;for((_&1)===1&&(_e=g>>8,b[_]=o(e[0],_e),--_,_e=g&255,et=d[d.length-1],b[_]=o(et,_e));_>0;)--_,_e=g>>8,b[_]=o(d[_],_e),--_,_e=g&255,b[_]=o(d[_],_e);for(_=15,rt=15-d.length;rt>0;)_e=g>>8,b[_]=o(e[rt],_e),--_,--rt,_e=g&255,b[_]=o(d[_],_e),--_,--rt;return b}}(),crypto_DecryptData_Method1=function(e,i,a,s,o){o||(o=i),s||(s=crypto_CreateXorArray_Method1(e));var c,h;for(c=0;c!=i.length;++c)h=i[c],h^=s[a],h=(h>>5|h<<3)&255,o[c]=h,++a;return[o,a,s]},crypto_MakeXorDecryptor=function(e){var i=0,a=crypto_CreateXorArray_Method1(e);return function(s){var o=crypto_DecryptData_Method1("",s,i,a);return i=o[1],o[0]}};function parse_XORObfuscation(e,i,a,s){var o={key:parseuint16(e),verificationBytes:parseuint16(e)};return a.password&&(o.verifier=crypto_CreatePasswordVerifier_Method1(a.password)),s.valid=o.verificationBytes===o.verifier,s.valid&&(s.insitu=crypto_MakeXorDecryptor(a.password)),o}function parse_FilePassHeader(e,i,a){var s=a||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=parse_RC4Header(e):s.Data=parse_RC4CryptoHeader(e,i),s}function parse_FilePass(e,i,a){var s={Type:a.biff>=8?e.read_shift(2):0};return s.Type?parse_FilePassHeader(e,i-2,s):parse_XORObfuscation(e,a.biff>=8?i:i-2,a,s),s}var RTF=function(){function e(o,c){switch(c.type){case"base64":return i(Base64_decode(o),c);case"binary":return i(o,c);case"buffer":return i(has_buf&&Buffer.isBuffer(o)?o.toString("binary"):a2s(o),c);case"array":return i(cc2str(o),c)}throw new Error("Unrecognized type "+c.type)}function i(o,c){var h=c||{},d=h.dense?[]:{},g=o.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var _={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(b,j){Array.isArray(d)&&(d[j]=[]);for(var _e=/\\\w+\b/g,et=0,rt,tt=-1;rt=_e.exec(b);){switch(rt[0]){case"\\cell":var it=b.slice(et,_e.lastIndex-rt[0].length);if(it[0]==" "&&(it=it.slice(1)),++tt,it.length){var nt={v:it,t:"s"};Array.isArray(d)?d[j][tt]=nt:d[encode_cell({r:j,c:tt})]=nt}break}et=_e.lastIndex}tt>_.e.c&&(_.e.c=tt)}),d["!ref"]=encode_range(_),d}function a(o,c){return sheet_to_workbook(e(o,c),c)}function s(o){for(var c=["{\\rtf1\\ansi"],h=safe_decode_range(o["!ref"]),d,g=Array.isArray(o),_=h.s.r;_<=h.e.r;++_){c.push("\\trowd\\trautofit1");for(var b=h.s.c;b<=h.e.c;++b)c.push("\\cellx"+(b+1));for(c.push("\\pard\\intbl"),b=h.s.c;b<=h.e.c;++b){var j=encode_cell({r:_,c:b});d=g?(o[_]||[])[b]:o[j],!(!d||d.v==null&&(!d.f||d.F))&&(c.push(" "+(d.w||(format_cell(d),d.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:s}}();function hex2RGB(e){var i=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(i.slice(0,2),16),parseInt(i.slice(2,4),16),parseInt(i.slice(4,6),16)]}function rgb2Hex(e){for(var i=0,a=1;i!=3;++i)a=a*256+(e[i]>255?255:e[i]<0?0:e[i]);return a.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var i=e[0]/255,a=e[1]/255,s=e[2]/255,o=Math.max(i,a,s),c=Math.min(i,a,s),h=o-c;if(h===0)return[0,0,i];var d=0,g=0,_=o+c;switch(g=h/(_>1?2-_:_),o){case i:d=((a-s)/h+6)%6;break;case a:d=(s-i)/h+2;break;case s:d=(i-a)/h+4;break}return[d/6,g,_/2]}function hsl2RGB(e){var i=e[0],a=e[1],s=e[2],o=a*2*(s<.5?s:1-s),c=s-o/2,h=[c,c,c],d=6*i,g;if(a!==0)switch(d|0){case 0:case 6:g=o*d,h[0]+=o,h[1]+=g;break;case 1:g=o*(2-d),h[0]+=g,h[1]+=o;break;case 2:g=o*(d-2),h[1]+=o,h[2]+=g;break;case 3:g=o*(4-d),h[1]+=g,h[2]+=o;break;case 4:g=o*(d-4),h[2]+=o,h[0]+=g;break;case 5:g=o*(6-d),h[2]+=g,h[0]+=o;break}for(var _=0;_!=3;++_)h[_]=Math.round(h[_]*255);return h}function rgb_tint(e,i){if(i===0)return e;var a=rgb2HSL(hex2RGB(e));return i<0?a[2]=a[2]*(1+i):a[2]=1-(1-a[2])*(1-i),rgb2Hex(hsl2RGB(a))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var i=Math.abs(e-cycle_width(e)),a=MDW;if(i>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=i&&(i=Math.abs(e-cycle_width(e)),a=MDW);MDW=a}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,i,a,s){i.Borders=[];var o={},c=!1;(e[0].match(tagregex)||[]).forEach(function(h){var d=parsexmltag(h);switch(strip_ns(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":o={},d.diagonalUp&&(o.diagonalUp=parsexmlbool(d.diagonalUp)),d.diagonalDown&&(o.diagonalDown=parsexmlbool(d.diagonalDown)),i.Borders.push(o);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(s&&s.WTF&&!c)throw new Error("unrecognized "+d[0]+" in borders")}})}function parse_fills(e,i,a,s){i.Fills=[];var o={},c=!1;(e[0].match(tagregex)||[]).forEach(function(h){var d=parsexmltag(h);switch(strip_ns(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":o={},i.Fills.push(o);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":i.Fills.push(o),o={};break;case"<patternFill":case"<patternFill>":d.patternType&&(o.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":o.bgColor||(o.bgColor={}),d.indexed&&(o.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(o.bgColor.theme=parseInt(d.theme,10)),d.tint&&(o.bgColor.tint=parseFloat(d.tint)),d.rgb&&(o.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":o.fgColor||(o.fgColor={}),d.theme&&(o.fgColor.theme=parseInt(d.theme,10)),d.tint&&(o.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(o.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(s&&s.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fills")}})}function parse_fonts(e,i,a,s){i.Fonts=[];var o={},c=!1;(e[0].match(tagregex)||[]).forEach(function(h){var d=parsexmltag(h);switch(strip_ns(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":i.Fonts.push(o),o={};break;case"<name":d.val&&(o.name=utf8read(d.val));break;case"<name/>":case"</name>":break;case"<b":o.bold=d.val?parsexmlbool(d.val):1;break;case"<b/>":o.bold=1;break;case"<i":o.italic=d.val?parsexmlbool(d.val):1;break;case"<i/>":o.italic=1;break;case"<u":switch(d.val){case"none":o.underline=0;break;case"single":o.underline=1;break;case"double":o.underline=2;break;case"singleAccounting":o.underline=33;break;case"doubleAccounting":o.underline=34;break}break;case"<u/>":o.underline=1;break;case"<strike":o.strike=d.val?parsexmlbool(d.val):1;break;case"<strike/>":o.strike=1;break;case"<outline":o.outline=d.val?parsexmlbool(d.val):1;break;case"<outline/>":o.outline=1;break;case"<shadow":o.shadow=d.val?parsexmlbool(d.val):1;break;case"<shadow/>":o.shadow=1;break;case"<condense":o.condense=d.val?parsexmlbool(d.val):1;break;case"<condense/>":o.condense=1;break;case"<extend":o.extend=d.val?parsexmlbool(d.val):1;break;case"<extend/>":o.extend=1;break;case"<sz":d.val&&(o.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(o.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(o.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(o.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=CS2CP[parseInt(d.val,10)];break;case"<color":if(o.color||(o.color={}),d.auto&&(o.color.auto=parsexmlbool(d.auto)),d.rgb)o.color.rgb=d.rgb.slice(-6);else if(d.indexed){o.color.index=parseInt(d.indexed,10);var g=XLSIcv[o.color.index];o.color.index==81&&(g=XLSIcv[1]),g||(g=XLSIcv[1]),o.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else d.theme&&(o.color.theme=parseInt(d.theme,10),d.tint&&(o.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(o.color.rgb=rgb_tint(a.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(s&&s.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fonts")}})}function parse_numFmts(e,i,a){i.NumberFmt=[];for(var s=keys(table_fmt),o=0;o<s.length;++o)i.NumberFmt[s[o]]=table_fmt[s[o]];var c=e[0].match(tagregex);if(c)for(o=0;o<c.length;++o){var h=parsexmltag(c[o]);switch(strip_ns(h[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=unescapexml(utf8read(h.formatCode)),g=parseInt(h.numFmtId,10);if(i.NumberFmt[g]=d,g>0){if(g>392){for(g=392;g>60&&i.NumberFmt[g]!=null;--g);i.NumberFmt[g]=d}SSF_load(d,g)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+h[0]+" in numFmts")}}}function write_numFmts(e){var i=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&(i[i.length]=writextag("numFmt",null,{numFmtId:s,formatCode:escapexml(e[s])}))}),i.length===1?"":(i[i.length]="</numFmts>",i[0]=writextag("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,i,a){i.CellXf=[];var s,o=!1;(e[0].match(tagregex)||[]).forEach(function(c){var h=parsexmltag(c),d=0;switch(strip_ns(h[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=h,delete s[0],d=0;d<cellXF_uint.length;++d)s[cellXF_uint[d]]&&(s[cellXF_uint[d]]=parseInt(s[cellXF_uint[d]],10));for(d=0;d<cellXF_bool.length;++d)s[cellXF_bool[d]]&&(s[cellXF_bool[d]]=parsexmlbool(s[cellXF_bool[d]]));if(i.NumberFmt&&s.numFmtId>392){for(d=392;d>60;--d)if(i.NumberFmt[s.numFmtId]==i.NumberFmt[d]){s.numFmtId=d;break}}i.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};h.vertical&&(g.vertical=h.vertical),h.horizontal&&(g.horizontal=h.horizontal),h.textRotation!=null&&(g.textRotation=h.textRotation),h.indent&&(g.indent=h.indent),h.wrapText&&(g.wrapText=parsexmlbool(h.wrapText)),s.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+h[0]+" in cellXfs")}})}function write_cellXfs(e){var i=[];return i[i.length]=writextag("cellXfs",null),e.forEach(function(a){i[i.length]=writextag("xf",null,a)}),i[i.length]="</cellXfs>",i.length===2?"":(i[0]=writextag("cellXfs",null,{count:i.length-2}).replace("/>",">"),i.join(""))}var parse_sty_xml=function(){var i=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,o=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,g,_){var b={};if(!d)return b;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var j;return(j=d.match(i))&&parse_numFmts(j,b,_),(j=d.match(o))&&parse_fonts(j,b,g,_),(j=d.match(s))&&parse_fills(j,b,g,_),(j=d.match(c))&&parse_borders(j,b,g,_),(j=d.match(a))&&parse_cellXfs(j,b,_),b}}();function write_sty_xml(e,i){var a=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],s;return e.SSF&&(s=write_numFmts(e.SSF))!=null&&(a[a.length]=s),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=write_cellXfs(i.cellXfs))&&(a[a.length]=s),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function parse_BrtFmt(e,i){var a=e.read_shift(2),s=parse_XLWideString(e);return[a,s]}function write_BrtFmt(e,i,a){a||(a=new_buf(6+4*i.length)),a.write_shift(2,e),write_XLWideString(i,a);var s=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),s}function parse_BrtFont(e,i,a){var s={};s.sz=e.read_shift(2)/20;var o=parse_FontFlags(e);o.fItalic&&(s.italic=1),o.fCondense&&(s.condense=1),o.fExtend&&(s.extend=1),o.fShadow&&(s.shadow=1),o.fOutline&&(s.outline=1),o.fStrikeout&&(s.strike=1);var c=e.read_shift(2);switch(c===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var h=e.read_shift(1);h!=0&&(s.underline=h);var d=e.read_shift(1);d>0&&(s.family=d);var g=e.read_shift(1);switch(g>0&&(s.charset=g),e.l++,s.color=parse_BrtColor(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=parse_XLWideString(e),s}function write_BrtFont(e,i){i||(i=new_buf(25+4*32)),i.write_shift(2,e.sz*20),write_FontFlags(e,i),i.write_shift(2,e.bold?700:400);var a=0;e.vertAlign=="superscript"?a=1:e.vertAlign=="subscript"&&(a=2),i.write_shift(2,a),i.write_shift(1,e.underline||0),i.write_shift(1,e.family||0),i.write_shift(1,e.charset||0),i.write_shift(1,0),write_BrtColor(e.color,i);var s=0;return s=2,i.write_shift(1,s),write_XLWideString(e.name,i),i.length>i.l?i.slice(0,i.l):i}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,i){i||(i=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var a=rev_XLSBFillPTNames[e.patternType];a==null&&(a=40),i.write_shift(4,a);var s=0;if(a!=40)for(write_BrtColor({auto:1},i),write_BrtColor({auto:1},i);s<12;++s)i.write_shift(4,0);else{for(;s<4;++s)i.write_shift(4,0);for(;s<12;++s)i.write_shift(4,0)}return i.length>i.l?i.slice(0,i.l):i}function parse_BrtXF(e,i){var a=e.l+i,s=e.read_shift(2),o=e.read_shift(2);return e.l=a,{ixfe:s,numFmtId:o}}function write_BrtXF(e,i,a){a||(a=new_buf(16)),a.write_shift(2,i||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var s=0;return a.write_shift(1,s),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function write_Blxf(e,i){return i||(i=new_buf(10)),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(4,0),i}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,i){return i||(i=new_buf(51)),i.write_shift(1,0),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),i.length>i.l?i.slice(0,i.l):i}function write_BrtStyle(e,i){return i||(i=new_buf(12+4*10)),i.write_shift(4,e.xfId),i.write_shift(2,1),i.write_shift(1,0),i.write_shift(1,0),write_XLNullableWideString(e.name||"",i),i.length>i.l?i.slice(0,i.l):i}function write_BrtBeginTableStyles(e,i,a){var s=new_buf(2052);return s.write_shift(4,e),write_XLNullableWideString(i,s),write_XLNullableWideString(a,s),s.length>s.l?s.slice(0,s.l):s}function parse_sty_bin(e,i,a){var s={};s.NumberFmt=[];for(var o in table_fmt)s.NumberFmt[o]=table_fmt[o];s.CellXf=[],s.Fonts=[];var c=[],h=!1;return recordhopper(e,function(g,_,b){switch(b){case 44:s.NumberFmt[g[0]]=g[1],SSF_load(g[1],g[0]);break;case 43:s.Fonts.push(g),g.color.theme!=null&&i&&i.themeElements&&i.themeElements.clrScheme&&(g.color.rgb=rgb_tint(i.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&s.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:h=!0;break;case 36:h=!1;break;case 37:c.push(b),h=!0;break;case 38:c.pop(),h=!1;break;default:if(_.T>0)c.push(b);else if(_.T<0)c.pop();else if(!h||a.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+b.toString(16))}}),s}function write_FMTS_bin(e,i){if(i){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)i[o]!=null&&++a}),a!=0&&(write_record(e,615,write_UInt32LE(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)i[o]!=null&&write_record(e,44,write_BrtFmt(o,i[o]))}),write_record(e,616))}}function write_FONTS_bin(e){var i=1;write_record(e,611,write_UInt32LE(i)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(e,612)}function write_FILLS_bin(e){var i=2;write_record(e,603,write_UInt32LE(i)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var i=1;write_record(e,613,write_UInt32LE(i)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var i=1;write_record(e,626,write_UInt32LE(i)),write_record(e,47,write_BrtXF({numFmtId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,i){write_record(e,617,write_UInt32LE(i.length)),i.forEach(function(a){write_record(e,47,write_BrtXF(a,0))}),write_record(e,618)}function write_STYLES_bin(e){var i=1;write_record(e,619,write_UInt32LE(i)),write_record(e,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var i=0;write_record(e,505,write_UInt32LE(i)),write_record(e,506)}function write_TABLESTYLES_bin(e){var i=0;write_record(e,508,write_BrtBeginTableStyles(i,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,i){var a=buf_array();return write_record(a,278),write_FMTS_bin(a,e.SSF),write_FONTS_bin(a),write_FILLS_bin(a),write_BORDERS_bin(a),write_CELLSTYLEXFS_bin(a),write_CELLXFS_bin(a,i.cellXfs),write_STYLES_bin(a),write_DXFS_bin(a),write_TABLESTYLES_bin(a),write_record(a,279),a.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,i,a){i.themeElements.clrScheme=[];var s={};(e[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=c.val;break;case"<a:sysClr":s.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(i.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(c[0])]=s,s={}):s.name=c[0].slice(3,c[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,i,a){i.themeElements={};var s;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(o){if(!(s=e.match(o[1])))throw new Error(o[0]+" not found in themeElements");o[2](s,i,a)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,i){(!e||e.length===0)&&(e=write_theme());var a,s={};if(!(a=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(a[0],s,i),s.raw=e,s}function write_theme(e,i){if(i&&i.themeXLSX)return i.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[XML_HEADER];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function parse_Theme(e,i,a){var s=e.l+i,o=e.read_shift(4);if(o!==124226){if(!a.cellStyles){e.l=s;return}var c=e.slice(e.l);e.l=s;var h;try{h=zip_read(c,{type:"array"})}catch{return}var d=getzipstr(h,"theme/theme/theme1.xml",!0);if(d)return parse_theme_xml(d,a)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var i={};switch(i.xclrType=e.read_shift(2),i.nTintShade=e.read_shift(2),i.xclrType){case 0:e.l+=4;break;case 1:i.xclrValue=parse_IcvXF(e,4);break;case 2:i.xclrValue=parse_LongRGBA(e);break;case 3:i.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,i}function parse_IcvXF(e,i){return parsenoop(e,i)}function parse_XFExtGradient(e,i){return parsenoop(e,i)}function parse_ExtProp(e){var i=e.read_shift(2),a=e.read_shift(2)-4,s=[i];switch(i){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=parse_FullColorExt(e);break;case 6:s[1]=parse_XFExtGradient(e,a);break;case 14:case 15:s[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+i+" "+a)}return s}function parse_XFExt(e,i){var a=e.l+i;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var o=e.read_shift(2),c=[];o-- >0;)c.push(parse_ExtProp(e,a-e.l));return{ixfe:s,ext:c}}function update_xfext(e,i){i.forEach(function(a){switch(a[0]){}})}function parse_BrtMdtinfo(e,i){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var i=new_buf(12+2*e.name.length);return i.write_shift(4,e.flags),i.write_shift(4,e.version),write_XLWideString(e.name,i),i.slice(0,i.l)}function parse_BrtMdb(e){for(var i=[],a=e.read_shift(4);a-- >0;)i.push([e.read_shift(4),e.read_shift(4)]);return i}function write_BrtMdb(e){var i=new_buf(4+8*e.length);i.write_shift(4,e.length);for(var a=0;a<e.length;++a)i.write_shift(4,e[a][0]),i.write_shift(4,e[a][1]);return i}function write_BrtBeginEsfmd(e,i){var a=new_buf(8+2*i.length);return a.write_shift(4,e),write_XLWideString(i,a),a.slice(0,a.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,i){var a=new_buf(8);return a.write_shift(4,e),a.write_shift(4,1),a}function parse_xlmeta_bin(e,i,a){var s={Types:[],Cell:[],Value:[]},o=a||{},c=[],h=!1,d=2;return recordhopper(e,function(g,_,b){switch(b){case 335:s.Types.push({name:g.name});break;case 51:g.forEach(function(j){d==1?s.Cell.push({type:s.Types[j[0]-1].name,index:j[1]}):d==0&&s.Value.push({type:s.Types[j[0]-1].name,index:j[1]})});break;case 337:d=g?1:0;break;case 338:d=2;break;case 35:c.push(b),h=!0;break;case 36:c.pop(),h=!1;break;default:if(!_.T){if(!h||o.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+b.toString(16))}}}),s}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function parse_xlmeta_xml(e,i,a){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var o=!1,c=2,h;return e.replace(tagregex,function(d){var g=parsexmltag(d);switch(strip_ns(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var _=0;_<s.Types.length;++_)s.Types[_].name==g.name&&(h=s.Types[_]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?s.Cell.push({type:s.Types[g.t-1].name,index:+g.v}):c==0&&s.Value.push({type:s.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!h)break;h.offsets||(h.offsets=[]),h.offsets.push(+g.i);break;default:if(!o&&a.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return d}),s}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_cc_xml(e){var i=[];if(!e)return i;var a=1;return(e.match(tagregex)||[]).forEach(function(s){var o=parsexmltag(s);switch(o[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete o[0],o.i?a=o.i:o.i=a,i.push(o);break}}),i}function parse_BrtCalcChainItem$(e){var i={};i.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),i.r=encode_cell(a);var s=e.read_shift(1);return s&2&&(i.l="1"),s&8&&(i.a="1"),i}function parse_cc_bin(e,i,a){var s=[];return recordhopper(e,function(c,h,d){switch(d){case 63:s.push(c);break;default:if(!h.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function parse_xlink_xml(){}function parse_xlink_bin(e,i,a,s){if(!e)return e;var o=s||{},c=!1;recordhopper(e,function(d,g,_){switch(_){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!g.T){if(!c||o.WTF)throw new Error("Unexpected record 0x"+_.toString(16))}}},o)}function parse_drawing(e,i){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return i["!id"][a].Target}var _shapeid=1024;function write_comments_vml(e,i){for(var a=[21600,21600],s=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),o=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:s})];_shapeid<e*1e3;)_shapeid+=1e3;return i.forEach(function(c){var h=decode_cell(c[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var g=d.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,_=writextag("v:fill",g,d),b={on:"t",obscured:"t"};++_shapeid,o=o.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",_,writextag("v:shadow",null,b),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[h.c+1,0,h.r+1,0,h.c+3,20,h.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(h.r)),writetag("x:Column",String(h.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function sheet_insert_comments(e,i,a,s){var o=Array.isArray(e),c;i.forEach(function(h){var d=decode_cell(h.ref);if(o?(e[d.r]||(e[d.r]=[]),c=e[d.r][d.c]):c=e[h.ref],!c){c={t:"z"},o?e[d.r][d.c]=c:e[h.ref]=c;var g=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");g.s.r>d.r&&(g.s.r=d.r),g.e.r<d.r&&(g.e.r=d.r),g.s.c>d.c&&(g.s.c=d.c),g.e.c<d.c&&(g.e.c=d.c);var _=encode_range(g);_!==e["!ref"]&&(e["!ref"]=_)}c.c||(c.c=[]);var b={a:h.author,t:h.t,r:h.r,T:a};h.h&&(b.h=h.h);for(var j=c.c.length-1;j>=0;--j){if(!a&&c.c[j].T)return;a&&!c.c[j].T&&c.c.splice(j,1)}if(a&&s){for(j=0;j<s.length;++j)if(b.a==s[j].id){b.a=s[j].name||b.a;break}}c.c.push(b)})}function parse_comments_xml(e,i){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],s=[],o=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);o&&o[1]&&o[1].split(/<\/\w*:?author>/).forEach(function(h){if(!(h===""||h.trim()==="")){var d=h.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(h){if(!(h===""||h.trim()==="")){var d=h.match(/<(?:\w+:)?comment[^>]*>/);if(d){var g=parsexmltag(d[0]),_={author:g.authorId&&a[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},b=decode_cell(g.ref);if(!(i.sheetRows&&i.sheetRows<=b.r)){var j=h.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_e=!!j&&!!j[1]&&parse_si(j[1])||{r:"",t:"",h:""};_.r=_e.r,_e.r=="<t></t>"&&(_e.t=_e.h=""),_.t=(_e.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),i.cellHTML&&(_.h=_e.h),s.push(_)}}}}),s}function write_comments_xml(e){var i=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],a=[];return i.push("<authors>"),e.forEach(function(s){s[1].forEach(function(o){var c=escapexml(o.a);a.indexOf(c)==-1&&(a.push(c),i.push("<author>"+c+"</author>")),o.T&&o.ID&&a.indexOf("tc="+o.ID)==-1&&(a.push("tc="+o.ID),i.push("<author>tc="+o.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),i.push("<author>SheetJ5</author>")),i.push("</authors>"),i.push("<commentList>"),e.forEach(function(s){var o=0,c=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?o=a.indexOf("tc="+s[1][0].ID):s[1].forEach(function(g){g.a&&(o=a.indexOf(escapexml(g.a))),c.push(g.t||"")}),i.push('<comment ref="'+s[0]+'" authorId="'+o+'"><text>'),c.length<=1)i.push(writetag("t",escapexml(c[0]||"")));else{for(var h=`Comment:
    `+c[0]+`
`,d=1;d<c.length;++d)h+=`Reply:
    `+c[d]+`
`;i.push(writetag("t",escapexml(h)))}i.push("</text></comment>")}),i.push("</commentList>"),i.length>2&&(i[i.length]="</comments>",i[1]=i[1].replace("/>",">")),i.join("")}function parse_tcmnt_xml(e,i){var a=[],s=!1,o={},c=0;return e.replace(tagregex,function(d,g){var _=parsexmltag(d);switch(strip_ns(_[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":o={author:_.personId,guid:_.id,ref:_.ref,T:1};break;case"</threadedComment>":o.t!=null&&a.push(o);break;case"<text>":case"<text":c=g+d.length;break;case"</text>":o.t=e.slice(c,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&i.WTF)throw new Error("unrecognized "+_[0]+" in threaded comments")}return d}),a}function write_tcmnt_xml(e,i,a){var s=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var c="";(o[1]||[]).forEach(function(h,d){if(!h.T){delete h.ID;return}h.a&&i.indexOf(h.a)==-1&&i.push(h.a);var g={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};d==0?c=g.id:g.parentId=c,h.ID=g.id,h.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+i.indexOf(h.a)).slice(-12)+"}"),s.push(writextag("threadedComment",writetag("text",h.t||""),g))})}),s.push("</ThreadedComments>"),s.join("")}function parse_people_xml(e,i){var a=[],s=!1;return e.replace(tagregex,function(c){var h=parsexmltag(c);switch(strip_ns(h[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:h.displayname,id:h.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&i.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),a}function write_people_xml(e){var i=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(a,s){i.push(writextag("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:a,providerId:"None"}))}),i.push("</personList>"),i.join("")}function parse_BrtBeginComment(e){var i={};i.iauthor=e.read_shift(4);var a=parse_UncheckedRfX(e);return i.rfx=a.s,i.ref=encode_cell(a.s),e.l+=16,i}function write_BrtBeginComment(e,i){return i==null&&(i=new_buf(36)),i.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],i),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function parse_comments_bin(e,i){var a=[],s=[],o={},c=!1;return recordhopper(e,function(d,g,_){switch(_){case 632:s.push(d);break;case 635:o=d;break;case 637:o.t=d.t,o.h=d.h,o.r=d.r;break;case 636:if(o.author=s[o.iauthor],delete o.iauthor,i.sheetRows&&o.rfx&&i.sheetRows<=o.rfx.r)break;o.t||(o.t=""),delete o.rfx,a.push(o);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!c||i.WTF)throw new Error("Unexpected record 0x"+_.toString(16))}}}),a}function write_comments_bin(e){var i=buf_array(),a=[];return write_record(i,628),write_record(i,630),e.forEach(function(s){s[1].forEach(function(o){a.indexOf(o.a)>-1||(a.push(o.a.slice(0,54)),write_record(i,632,write_BrtCommentAuthor(o.a)))})}),write_record(i,631),write_record(i,633),e.forEach(function(s){s[1].forEach(function(o){o.iauthor=a.indexOf(o.a);var c={s:decode_cell(s[0]),e:decode_cell(s[0])};write_record(i,635,write_BrtBeginComment([c,o])),o.t&&o.t.length>0&&write_record(i,637,write_BrtCommentText(o)),write_record(i,636),delete o.iauthor})}),write_record(i,634),write_record(i,629),i.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var i=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,s){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var o=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(i,o,e.FileIndex[s].content)}}),CFB.write(i)}function fill_vba_xls(e,i){i.FullPaths.forEach(function(a,s){if(s!=0){var o=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&CFB.utils.cfb_add(e,o,i.FileIndex[s].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,i={r:0,c:0};function a(s,o,c,h){var d=!1,g=!1;c.length==0?g=!0:c.charAt(0)=="["&&(g=!0,c=c.slice(1,-1)),h.length==0?d=!0:h.charAt(0)=="["&&(d=!0,h=h.slice(1,-1));var _=c.length>0?parseInt(c,10)|0:0,b=h.length>0?parseInt(h,10)|0:0;return d?b+=i.c:--b,g?_+=i.r:--_,o+(d?"":"$")+encode_col(b)+(g?"":"$")+encode_row(_)}return function(o,c){return i=c,o.replace(e,a)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(i,a){return i.replace(crefregex,function(s,o,c,h,d,g){var _=decode_col(h)-(c?0:a.c),b=decode_row(g)-(d?0:a.r),j=b==0?"":d?b+1:"["+b+"]",_e=_==0?"":c?_+1:"["+_+"]";return o+"R"+j+"C"+_e})}}();function shift_formula_str(e,i){return e.replace(crefregex,function(a,s,o,c,h,d){return s+(o=="$"?o+c:encode_col(decode_col(c)+i.c))+(h=="$"?h+d:encode_row(decode_row(d)+i.r))})}function shift_formula_xlsx(e,i,a){var s=decode_range(i),o=s.s,c=decode_cell(a),h={r:c.r-o.r,c:c.c-o.c};return shift_formula_str(e,h)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,i){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function parse_RgceArea(e,i,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return parse_RgceArea_BIFF2(e);a.biff==12&&(s=4)}var o=e.read_shift(s),c=e.read_shift(s),h=parse_ColRelU(e),d=parse_ColRelU(e);return{s:{r:o,c:h[0],cRel:h[1],rRel:h[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function parse_RgceArea_BIFF2(e){var i=parse_ColRelU(e),a=parse_ColRelU(e),s=e.read_shift(1),o=e.read_shift(1);return{s:{r:i[0],c:s,cRel:i[1],rRel:i[2]},e:{r:a[0],c:o,cRel:a[1],rRel:a[2]}}}function parse_RgceAreaRel(e,i,a){if(a.biff<8)return parse_RgceArea_BIFF2(e);var s=e.read_shift(a.biff==12?4:2),o=e.read_shift(a.biff==12?4:2),c=parse_ColRelU(e),h=parse_ColRelU(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:h[0],cRel:h[1],rRel:h[2]}}}function parse_RgceLoc(e,i,a){if(a&&a.biff>=2&&a.biff<=5)return parse_RgceLoc_BIFF2(e);var s=e.read_shift(a&&a.biff==12?4:2),o=parse_ColRelU(e);return{r:s,c:o[0],cRel:o[1],rRel:o[2]}}function parse_RgceLoc_BIFF2(e){var i=parse_ColRelU(e),a=e.read_shift(1);return{r:i[0],c:a,cRel:i[1],rRel:i[2]}}function parse_RgceElfLoc(e){var i=e.read_shift(2),a=e.read_shift(2);return{r:i,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function parse_RgceLocRel(e,i,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return parse_RgceLocRel_BIFF2(e);var o=e.read_shift(s>=12?4:2),c=e.read_shift(2),h=(c&16384)>>14,d=(c&32768)>>15;if(c&=16383,d==1)for(;o>524287;)o-=1048576;if(h==1)for(;c>8191;)c=c-16384;return{r:o,c,cRel:h,rRel:d}}function parse_RgceLocRel_BIFF2(e){var i=e.read_shift(2),a=e.read_shift(1),s=(i&32768)>>15,o=(i&16384)>>14;return i&=16383,s==1&&i>=8192&&(i=i-16384),o==1&&a>=128&&(a=a-256),{r:i,c:a,cRel:o,rRel:s}}function parse_PtgArea(e,i,a){var s=(e[e.l++]&96)>>5,o=parse_RgceArea(e,a.biff>=2&&a.biff<=5?6:8,a);return[s,o]}function parse_PtgArea3d(e,i,a){var s=(e[e.l++]&96)>>5,o=e.read_shift(2,"i"),c=8;if(a)switch(a.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var h=parse_RgceArea(e,c,a);return[s,o,h]}function parse_PtgAreaErr(e,i,a){var s=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}function parse_PtgAreaErr3d(e,i,a){var s=(e[e.l++]&96)>>5,o=e.read_shift(2),c=8;if(a)switch(a.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[s,o]}function parse_PtgAreaN(e,i,a){var s=(e[e.l++]&96)>>5,o=parse_RgceAreaRel(e,i-1,a);return[s,o]}function parse_PtgArray(e,i,a){var s=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[s]}function parse_PtgAttrBaxcel(e){var i=e[e.l+1]&1,a=1;return e.l+=4,[i,a]}function parse_PtgAttrChoose(e,i,a){e.l+=2;for(var s=e.read_shift(a&&a.biff==2?1:2),o=[],c=0;c<=s;++c)o.push(e.read_shift(a&&a.biff==2?1:2));return o}function parse_PtgAttrGoto(e,i,a){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(a&&a.biff==2?1:2)]}function parse_PtgAttrIf(e,i,a){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(a&&a.biff==2?1:2)]}function parse_PtgAttrIfError(e){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(2)]}function parse_PtgAttrSemi(e,i,a){var s=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[s]}function parse_PtgAttrSpaceType(e){var i=e.read_shift(1),a=e.read_shift(1);return[i,a]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,i,a){var s=(e[e.l]&96)>>5;e.l+=1;var o=parse_RgceLoc(e,0,a);return[s,o]}function parse_PtgRefN(e,i,a){var s=(e[e.l]&96)>>5;e.l+=1;var o=parse_RgceLocRel(e,0,a);return[s,o]}function parse_PtgRef3d(e,i,a){var s=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var c=parse_RgceLoc(e,0,a);return[s,o,c]}function parse_PtgFunc(e,i,a){var s=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(a&&a.biff<=3?1:2);return[FtabArgc[o],Ftab[o],s]}function parse_PtgFuncVar(e,i,a){var s=e[e.l++],o=e.read_shift(1),c=a&&a.biff<=3?[s==88?-1:0,e.read_shift(1)]:parsetab(e);return[o,(c[0]===0?Ftab:Cetab)[c[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,i,a){e.l+=a&&a.biff==2?3:4}function parse_PtgExp(e,i,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),o=e.read_shift(a&&a.biff==2?1:2);return[s,o]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,i,a){return e.l++,parse_ShortXLUnicodeString(e,i-1,a)}function parse_SerAr(e,i){var a=[e.read_shift(1)];if(i==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=parsebool(e,1)?"TRUE":"FALSE",i!=12&&(e.l+=7);break;case 37:case 16:a[1]=BErr[e[e.l]],e.l+=i==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=parse_Xnum(e);break;case 2:a[1]=parse_XLUnicodeString2(e,0,{biff:i>0&&i<8?2:i});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function parse_PtgExtraMem(e,i,a){for(var s=e.read_shift(a.biff==12?4:2),o=[],c=0;c!=s;++c)o.push((a.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return o}function parse_PtgExtraArray(e,i,a){var s=0,o=0;a.biff==12?(s=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),s=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,--o==0&&(o=256));for(var c=0,h=[];c!=s&&(h[c]=[]);++c)for(var d=0;d!=o;++d)h[c][d]=parse_SerAr(e,a.biff);return h}function parse_PtgName(e,i,a){var s=e.read_shift(1)>>>5&3,o=!a||a.biff>=8?4:2,c=e.read_shift(o);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,c]}function parse_PtgNameX(e,i,a){if(a.biff==5)return parse_PtgNameX_BIFF5(e);var s=e.read_shift(1)>>>5&3,o=e.read_shift(2),c=e.read_shift(4);return[s,o,c]}function parse_PtgNameX_BIFF5(e){var i=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[i,a,s]}function parse_PtgMemArea(e,i,a){var s=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var o=e.read_shift(a&&a.biff==2?1:2);return[s,o]}function parse_PtgMemFunc(e,i,a){var s=e.read_shift(1)>>>5&3,o=e.read_shift(a&&a.biff==2?1:2);return[s,o]}function parse_PtgRefErr(e,i,a){var s=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[s]}function parse_PtgRefErr3d(e,i,a){var s=(e[e.l++]&96)>>5,o=e.read_shift(2),c=4;if(a)switch(a.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[s,o]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,i,a){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),o=e.read_shift(2),c=e.read_shift(2),h=PtgListRT[a>>2&31];return{ixti:i,coltype:a&3,rt:h,idx:s,c:o,C:c}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,i,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,i,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var i=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[i,a]}function parse_PtgMemNoMemN(e){var i=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[i,a]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,i,a,s){if(s.biff<8)return parsenoop(e,i);for(var o=e.l+i,c=[],h=0;h!==a.length;++h)switch(a[h][0]){case"PtgArray":a[h][1]=parse_PtgExtraArray(e,0,s),c.push(a[h][1]);break;case"PtgMemArea":a[h][2]=parse_PtgExtraMem(e,a[h][1],s),c.push(a[h][2]);break;case"PtgExp":s&&s.biff==12&&(a[h][1][1]=e.read_shift(4),c.push(a[h][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[h][0]}return i=o-e.l,i!==0&&c.push(parsenoop(e,i)),c}function parse_Rgce(e,i,a){for(var s=e.l+i,o,c,h=[];s!=e.l;)i=s-e.l,c=e[e.l],o=PtgTypes[c]||PtgTypes[PtgDupes[c]],(c===24||c===25)&&(o=(c===24?Ptg18:Ptg19)[e[e.l+1]]),!o||!o.f?parsenoop(e,i):h.push([o.n,o.f(e,i,a)]);return h}function stringify_array(e){for(var i=[],a=0;a<e.length;++a){for(var s=e[a],o=[],c=0;c<s.length;++c){var h=s[c];if(h)switch(h[0]){case 2:o.push('"'+h[1].replace(/"/g,'""')+'"');break;default:o.push(h[1])}else o.push("")}i.push(o.join(","))}return i.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,i){if(!e&&!(i&&i.biff<=5&&i.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,i,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[i]))return e.SheetNames[i];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[i];if(a.biff<8)return i>1e4&&(i-=65536),i<0&&(i=-i),i==0?"":e.XTI[i-1];if(!s)return"SH33TJSERR1";var o="";if(a.biff>8)switch(e[s[0]][0]){case 357:return o=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?o:o+":"+e.SheetNames[s[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return o=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?o:o+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[s[0]][0][3]?(o=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?o:o+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function get_ixti(e,i,a){var s=get_ixti_raw(e,i,a);return s=="#REF"?s:formula_quote_sheet_name(s,a)}function stringify_formula(e,i,a,s,o){var c=o&&o.biff||8,h={s:{c:0,r:0}},d=[],g,_,b,j=0,_e=0,et,rt="";if(!e[0]||!e[0][0])return"";for(var tt=-1,it="",nt=0,at=e[0].length;nt<at;++nt){var st=e[0][nt];switch(st[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=d.pop(),_=d.pop(),tt>=0){switch(e[0][tt][1][0]){case 0:it=fill(" ",e[0][tt][1][1]);break;case 1:it=fill("\r",e[0][tt][1][1]);break;default:if(it="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][tt][1][0])}_=_+it,tt=-1}d.push(_+PtgBinOp[st[0]]+g);break;case"PtgIsect":g=d.pop(),_=d.pop(),d.push(_+" "+g);break;case"PtgUnion":g=d.pop(),_=d.pop(),d.push(_+","+g);break;case"PtgRange":g=d.pop(),_=d.pop(),d.push(_+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":b=shift_cell_xls(st[1][1],h,o),d.push(encode_cell_xls(b,c));break;case"PtgRefN":b=a?shift_cell_xls(st[1][1],a,o):st[1][1],d.push(encode_cell_xls(b,c));break;case"PtgRef3d":j=st[1][1],b=shift_cell_xls(st[1][2],h,o),rt=get_ixti(s,j,o),d.push(rt+"!"+encode_cell_xls(b,c));break;case"PtgFunc":case"PtgFuncVar":var dt=st[1][0],lt=st[1][1];dt||(dt=0),dt&=127;var ut=dt==0?[]:d.slice(-dt);d.length-=dt,lt==="User"&&(lt=ut.shift()),d.push(lt+"("+ut.join(",")+")");break;case"PtgBool":d.push(st[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(st[1]);break;case"PtgNum":d.push(String(st[1]));break;case"PtgStr":d.push('"'+st[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(st[1]);break;case"PtgAreaN":et=shift_range_xls(st[1][1],a?{s:a}:h,o),d.push(encode_range_xls(et,o));break;case"PtgArea":et=shift_range_xls(st[1][1],h,o),d.push(encode_range_xls(et,o));break;case"PtgArea3d":j=st[1][1],et=st[1][2],rt=get_ixti(s,j,o),d.push(rt+"!"+encode_range_xls(et,o));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_e=st[1][2];var ot=(s.names||[])[_e-1]||(s[0]||[])[_e],ft=ot?ot.Name:"SH33TJSNAME"+String(_e);ft&&ft.slice(0,6)=="_xlfn."&&!o.xlfn&&(ft=ft.slice(6)),d.push(ft);break;case"PtgNameX":var pt=st[1][1];_e=st[1][2];var St;if(o.biff<=5)pt<0&&(pt=-pt),s[pt]&&(St=s[pt][_e]);else{var gt="";if(((s[pt]||[])[0]||[])[0]==14849||(((s[pt]||[])[0]||[])[0]==1025?s[pt][_e]&&s[pt][_e].itab>0&&(gt=s.SheetNames[s[pt][_e].itab-1]+"!"):gt=s.SheetNames[_e-1]+"!"),s[pt]&&s[pt][_e])gt+=s[pt][_e].Name;else if(s[0]&&s[0][_e])gt+=s[0][_e].Name;else{var vt=(get_ixti_raw(s,pt,o)||"").split(";;");vt[_e-1]?gt=vt[_e-1]:gt+="SH33TJSERRX"}d.push(gt);break}St||(St={Name:"SH33TJSERRY"}),d.push(St.Name);break;case"PtgParen":var At="(",Gt=")";if(tt>=0){switch(it="",e[0][tt][1][0]){case 2:At=fill(" ",e[0][tt][1][1])+At;break;case 3:At=fill("\r",e[0][tt][1][1])+At;break;case 4:Gt=fill(" ",e[0][tt][1][1])+Gt;break;case 5:Gt=fill("\r",e[0][tt][1][1])+Gt;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][tt][1][0])}tt=-1}d.push(At+d.pop()+Gt);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":b={c:st[1][1],r:st[1][0]};var Nt={c:a.c,r:a.r};if(s.sharedf[encode_cell(b)]){var Ht=s.sharedf[encode_cell(b)];d.push(stringify_formula(Ht,h,Nt,s,o))}else{var It=!1;for(g=0;g!=s.arrayf.length;++g)if(_=s.arrayf[g],!(b.c<_[0].s.c||b.c>_[0].e.c)&&!(b.r<_[0].s.r||b.r>_[0].e.r)){d.push(stringify_formula(_[1],h,Nt,s,o)),It=!0;break}It||d.push(st[1])}break;case"PtgArray":d.push("{"+stringify_array(st[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":tt=nt;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+st[1].idx+"[#"+st[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(st));default:throw new Error("Unrecognized Formula Token: "+String(st))}var Wt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&tt>=0&&Wt.indexOf(e[0][nt][0])==-1){st=e[0][tt];var yt=!0;switch(st[1][0]){case 4:yt=!1;case 0:it=fill(" ",st[1][1]);break;case 5:yt=!1;case 1:it=fill("\r",st[1][1]);break;default:if(it="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+st[1][0])}d.push((yt?it:"")+d.pop()+(yt?"":it)),tt=-1}}if(d.length>1&&o.WTF)throw new Error("bad formula stack");return d[0]}function parse_ArrayParsedFormula(e,i,a){var s=e.l+i,o=a.biff==2?1:2,c,h=e.read_shift(o);if(h==65535)return[[],parsenoop(e,i-2)];var d=parse_Rgce(e,h,a);return i!==h+o&&(c=parse_RgbExtra(e,i-h-o,d,a)),e.l=s,[d,c]}function parse_XLSCellParsedFormula(e,i,a){var s=e.l+i,o=a.biff==2?1:2,c,h=e.read_shift(o);if(h==65535)return[[],parsenoop(e,i-2)];var d=parse_Rgce(e,h,a);return i!==h+o&&(c=parse_RgbExtra(e,i-h-o,d,a)),e.l=s,[d,c]}function parse_NameParsedFormula(e,i,a,s){var o=e.l+i,c=parse_Rgce(e,s,a),h;return o!==e.l&&(h=parse_RgbExtra(e,o-e.l,c,a)),[c,h]}function parse_SharedParsedFormula(e,i,a){var s=e.l+i,o,c=e.read_shift(2),h=parse_Rgce(e,c,a);return c==65535?[[],parsenoop(e,i-2)]:(i!==c+2&&(o=parse_RgbExtra(e,s-c-2,h,a)),[h,o])}function parse_FormulaValue(e){var i;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return i=e[e.l+2]===1,e.l+=8,[i,"b"];case 2:return i=e[e.l+2],e.l+=8,[i,"e"];case 3:return e.l+=8,["","s"]}return[]}function write_FormulaValue(e){if(e==null){var i=new_buf(8);return i.write_shift(1,3),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,65535),i}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function parse_Formula(e,i,a){var s=e.l+i,o=parse_XLSCell(e);a.biff==2&&++e.l;var c=parse_FormulaValue(e),h=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=parse_XLSCellParsedFormula(e,s-e.l,a);return{cell:o,val:c[0],formula:d,shared:h>>3&1,tt:c[1]}}function write_Formula(e,i,a,s,o){var c=write_XLSCell(i,a,o),h=write_FormulaValue(e.v),d=new_buf(6),g=33;d.write_shift(2,g),d.write_shift(4,0);for(var _=new_buf(e.bf.length),b=0;b<e.bf.length;++b)_[b]=e.bf[b];var j=bconcat([c,h,d,_]);return j}function parse_XLSBParsedFormula(e,i,a){var s=e.read_shift(4),o=parse_Rgce(e,s,a),c=e.read_shift(4),h=c>0?parse_RgbExtra(e,c,o,a):null;return[o,h]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(i,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(e){var i="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return i.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(e){var i=e.split(":"),a=i[0].split(".")[0];return[a,i[0].split(".")[1]+(i.length>1?":"+(i[1].split(".")[1]||i[1].split(".")[0]):"")]}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(e,i,a){var s=0,o=e.length;if(a){if(browser_has_Map?a.has(i):Object.prototype.hasOwnProperty.call(a,i)){for(var c=browser_has_Map?a.get(i):a[i];s<c.length;++s)if(e[c[s]].t===i)return e.Count++,c[s]}}else for(;s<o;++s)if(e[s].t===i)return e.Count++,s;return e[o]={t:i},e.Count++,e.Unique++,a&&(browser_has_Map?(a.has(i)||a.set(i,[]),a.get(i).push(o)):(Object.prototype.hasOwnProperty.call(a,i)||(a[i]=[]),a[i].push(o))),o}function col_obj_w(e,i){var a={min:e+1,max:e+1},s=-1;return i.MDW&&(MDW=i.MDW),i.width!=null?a.customWidth=1:i.wpx!=null?s=px2char(i.wpx):i.wch!=null&&(s=i.wch),s>-1?(a.width=char2width(s),a.customWidth=1):i.width!=null&&(a.width=i.width),i.hidden&&(a.hidden=!0),i.level!=null&&(a.outlineLevel=a.level=i.level),a}function default_margins(e,i){if(e){var a=[.7,.7,.75,.75,.3,.3];i=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function get_cell_style(e,i,a){var s=a.revssf[i.z!=null?i.z:"General"],o=60,c=e.length;if(s==null&&a.ssf){for(;o<392;++o)if(a.ssf[o]==null){SSF_load(i.z,o),a.ssf[o]=i.z,a.revssf[i.z]=s=o;break}}for(o=0;o!=c;++o)if(e[o].numFmtId===s)return o;return e[c]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function safe_format(e,i,a,s,o,c){try{s.cellNF&&(e.z=table_fmt[i])}catch(d){if(s.WTF)throw d}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(table_fmt[i]==null&&SSF_load(SSFImplicit[i]||"General",i),e.t==="e")e.w=e.w||BErr[e.v];else if(i===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var h=datenum(e.v);(h|0)===h?e.w=h.toString(10):e.w=SSF_general_num(h)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(i,datenum(e.v),_ssfopts):e.w=SSF_format(i,e.v,_ssfopts)}catch(d){if(s.WTF)throw d}if(s.cellStyles&&a!=null)try{e.s=c.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(o.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=o.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(o.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=o.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(s.WTF&&c.Fills)throw d}}}function check_ws(e,i,a){if(e&&e["!ref"]){var s=safe_decode_range(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}function parse_ws_xml_dim(e,i){var a=safe_decode_range(i);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=encode_range(a))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,i,a,s,o,c,h){if(!e)return e;s||(s={"!id":{}});var d=i.dense?[]:{},g={s:{r:2e6,c:2e6},e:{r:0,c:0}},_="",b="",j=e.match(sheetdataregex);j?(_=e.slice(0,j.index),b=e.slice(j.index+j[0].length)):_=b=e;var _e=_.match(sheetprregex);_e?parse_ws_xml_sheetpr(_e[0],d,o,a):(_e=_.match(sheetprregex2))&&parse_ws_xml_sheetpr2(_e[0],_e[1]||"",d,o,a);var et=(_.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(et>0){var rt=_.slice(et,et+50).match(dimregex);rt&&parse_ws_xml_dim(d,rt[1])}var tt=_.match(svsregex);tt&&tt[1]&&parse_ws_xml_sheetviews(tt[1],o);var it=[];if(i.cellStyles){var nt=_.match(colregex);nt&&parse_ws_xml_cols(it,nt)}j&&parse_ws_xml_data(j[1],d,i,g,c,h);var at=b.match(afregex);at&&(d["!autofilter"]=parse_ws_xml_autofilter(at[0]));var st=[],dt=b.match(mergecregex);if(dt)for(et=0;et!=dt.length;++et)st[et]=safe_decode_range(dt[et].slice(dt[et].indexOf('"')+1));var lt=b.match(hlinkregex);lt&&parse_ws_xml_hlinks(d,lt,s);var ut=b.match(marginregex);if(ut&&(d["!margins"]=parse_ws_xml_margins(parsexmltag(ut[0]))),!d["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(d["!ref"]=encode_range(g)),i.sheetRows>0&&d["!ref"]){var ot=safe_decode_range(d["!ref"]);i.sheetRows<=+ot.e.r&&(ot.e.r=i.sheetRows-1,ot.e.r>g.e.r&&(ot.e.r=g.e.r),ot.e.r<ot.s.r&&(ot.s.r=ot.e.r),ot.e.c>g.e.c&&(ot.e.c=g.e.c),ot.e.c<ot.s.c&&(ot.s.c=ot.e.c),d["!fullref"]=d["!ref"],d["!ref"]=encode_range(ot))}return it.length>0&&(d["!cols"]=it),st.length>0&&(d["!merges"]=st),d}function write_ws_xml_merges(e){if(e.length===0)return"";for(var i='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)i+='<mergeCell ref="'+encode_range(e[a])+'"/>';return i+"</mergeCells>"}function parse_ws_xml_sheetpr(e,i,a,s){var o=parsexmltag(e);a.Sheets[s]||(a.Sheets[s]={}),o.codeName&&(a.Sheets[s].CodeName=unescapexml(utf8read(o.codeName)))}function parse_ws_xml_sheetpr2(e,i,a,s,o){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),a,s,o)}function write_ws_xml_sheetpr(e,i,a,s,o){var c=!1,h={},d=null;if(s.bookType!=="xlsx"&&i.vbaraw){var g=i.SheetNames[a];try{i.Workbook&&(g=i.Workbook.Sheets[a].CodeName||g)}catch{}c=!0,h.codeName=utf8write(escapexml(g))}if(e&&e["!outline"]){var _={summaryBelow:1,summaryRight:1};e["!outline"].above&&(_.summaryBelow=0),e["!outline"].left&&(_.summaryRight=0),d=(d||"")+writextag("outlinePr",null,_)}!c&&!d||(o[o.length]=writextag("sheetPr",d,h))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var i={sheet:1};return sheetprot_deffalse.forEach(function(a){e[a]!=null&&e[a]&&(i[a]="1")}),sheetprot_deftrue.forEach(function(a){e[a]!=null&&!e[a]&&(i[a]="0")}),e.password&&(i.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,i)}function parse_ws_xml_hlinks(e,i,a){for(var s=Array.isArray(e),o=0;o!=i.length;++o){var c=parsexmltag(utf8read(i[o]),!0);if(!c.ref)return;var h=((a||{})["!id"]||[])[c.id];h?(c.Target=h.Target,c.location&&(c.Target+="#"+unescapexml(c.location))):(c.Target="#"+unescapexml(c.location),h={Target:c.Target,TargetMode:"Internal"}),c.Rel=h,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var d=safe_decode_range(c.ref),g=d.s.r;g<=d.e.r;++g)for(var _=d.s.c;_<=d.e.c;++_){var b=encode_cell({c:_,r:g});s?(e[g]||(e[g]=[]),e[g][_]||(e[g][_]={t:"z",v:void 0}),e[g][_].l=c):(e[b]||(e[b]={t:"z",v:void 0}),e[b].l=c)}}}function parse_ws_xml_margins(e){var i={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(i[a]=parseFloat(e[a]))}),i}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function parse_ws_xml_cols(e,i){for(var a=!1,s=0;s!=i.length;++s){var o=parsexmltag(i[s],!0);o.hidden&&(o.hidden=parsexmlbool(o.hidden));var c=parseInt(o.min,10)-1,h=parseInt(o.max,10)-1;for(o.outlineLevel&&(o.level=+o.outlineLevel||0),delete o.min,delete o.max,o.width=+o.width,!a&&o.width&&(a=!0,find_mdw_colw(o.width)),process_col(o);c<=h;)e[c++]=dup(o)}}function write_ws_xml_cols(e,i){for(var a=["<cols>"],s,o=0;o!=i.length;++o)(s=i[o])&&(a[a.length]=writextag("col",null,col_obj_w(o,s)));return a[a.length]="</cols>",a.join("")}function parse_ws_xml_autofilter(e){var i={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return i}function write_ws_xml_autofilter(e,i,a,s){var o=typeof e.ref=="string"?e.ref:encode_range(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var c=a.Workbook.Names,h=decode_range(o);h.s.r==h.e.r&&(h.e.r=decode_range(i["!ref"]).e.r,o=encode_range(h));for(var d=0;d<c.length;++d){var g=c[d];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==s){g.Ref="'"+a.SheetNames[s]+"'!"+o;break}}return d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+o}),writextag("autoFilter",null,{ref:o})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,i){i.Views||(i.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(a,s){var o=parsexmltag(a);i.Views[s]||(i.Views[s]={}),+o.zoomScale&&(i.Views[s].zoom=+o.zoomScale),parsexmlbool(o.rightToLeft)&&(i.Views[s].RTL=!0)})}function write_ws_xml_sheetviews(e,i,a,s){var o={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,o),{})}function write_ws_xml_cell(e,i,a,s){if(e.c&&a["!comments"].push([i,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var o="",c=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=BErr[e.v];break;case"d":s&&s.cellDates?o=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",o=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:o=e.v;break}var d=writetag("v",escapexml(o)),g={r:i},_=get_cell_style(s.cellXfs,e,s);switch(_!==0&&(g.s=_),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){d=writetag("v",""+get_sst_id(s.Strings,e.v,s.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=c&&(e.t=c,e.v=h),typeof e.f=="string"&&e.f){var b=e.F&&e.F.slice(0,i.length)==i?{t:"array",ref:e.F}:null;d=writextag("f",escapexml(e.f),b)+(e.v!=null?d:"")}return e.l&&a["!links"].push([i,e.l]),e.D&&(g.cm=1),writextag("c",d,g)}var parse_ws_xml_data=function(){var e=/<(?:\w+:)?c[ \/>]/,i=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,o=/ref=["']([^"']*)["']/,c=matchtag("v"),h=matchtag("f");return function(g,_,b,j,_e,et){for(var rt=0,tt="",it=[],nt=[],at=0,st=0,dt=0,lt="",ut,ot,ft=0,pt=0,St,gt,vt=0,At=0,Gt=Array.isArray(et.CellXf),Nt,Ht=[],It=[],Wt=Array.isArray(_),yt=[],Dt={},$t=!1,_t=!!b.sheetStubs,ht=g.split(i),ct=0,xt=ht.length;ct!=xt;++ct){tt=ht[ct].trim();var Et=tt.length;if(Et!==0){var bt=0;e:for(rt=0;rt<Et;++rt)switch(tt[rt]){case">":if(tt[rt-1]!="/"){++rt;break e}if(b&&b.cellStyles){if(ot=parsexmltag(tt.slice(bt,rt),!0),ft=ot.r!=null?parseInt(ot.r,10):ft+1,pt=-1,b.sheetRows&&b.sheetRows<ft)continue;Dt={},$t=!1,ot.ht&&($t=!0,Dt.hpt=parseFloat(ot.ht),Dt.hpx=pt2px(Dt.hpt)),ot.hidden=="1"&&($t=!0,Dt.hidden=!0),ot.outlineLevel!=null&&($t=!0,Dt.level=+ot.outlineLevel),$t&&(yt[ft-1]=Dt)}break;case"<":bt=rt;break}if(bt>=rt)break;if(ot=parsexmltag(tt.slice(bt,rt),!0),ft=ot.r!=null?parseInt(ot.r,10):ft+1,pt=-1,!(b.sheetRows&&b.sheetRows<ft)){j.s.r>ft-1&&(j.s.r=ft-1),j.e.r<ft-1&&(j.e.r=ft-1),b&&b.cellStyles&&(Dt={},$t=!1,ot.ht&&($t=!0,Dt.hpt=parseFloat(ot.ht),Dt.hpx=pt2px(Dt.hpt)),ot.hidden=="1"&&($t=!0,Dt.hidden=!0),ot.outlineLevel!=null&&($t=!0,Dt.level=+ot.outlineLevel),$t&&(yt[ft-1]=Dt)),it=tt.slice(rt).split(e);for(var Ct=0;Ct!=it.length&&it[Ct].trim().charAt(0)=="<";++Ct);for(it=it.slice(Ct),rt=0;rt!=it.length;++rt)if(tt=it[rt].trim(),tt.length!==0){if(nt=tt.match(a),at=rt,st=0,dt=0,tt="<c "+(tt.slice(0,1)=="<"?">":"")+tt,nt!=null&&nt.length===2){for(at=0,lt=nt[1],st=0;st!=lt.length&&!((dt=lt.charCodeAt(st)-64)<1||dt>26);++st)at=26*at+dt;--at,pt=at}else++pt;for(st=0;st!=tt.length&&tt.charCodeAt(st)!==62;++st);if(++st,ot=parsexmltag(tt.slice(0,st),!0),ot.r||(ot.r=encode_cell({r:ft-1,c:pt})),lt=tt.slice(st),ut={t:""},(nt=lt.match(c))!=null&&nt[1]!==""&&(ut.v=unescapexml(nt[1])),b.cellFormula){if((nt=lt.match(h))!=null&&nt[1]!==""){if(ut.f=unescapexml(utf8read(nt[1])).replace(/\r\n/g,`
`),b.xlfn||(ut.f=_xlfn(ut.f)),nt[0].indexOf('t="array"')>-1)ut.F=(lt.match(o)||[])[1],ut.F.indexOf(":")>-1&&Ht.push([safe_decode_range(ut.F),ut.F]);else if(nt[0].indexOf('t="shared"')>-1){gt=parsexmltag(nt[0]);var Ot=unescapexml(utf8read(nt[1]));b.xlfn||(Ot=_xlfn(Ot)),It[parseInt(gt.si,10)]=[gt,Ot,ot.r]}}else(nt=lt.match(/<f[^>]*\/>/))&&(gt=parsexmltag(nt[0]),It[gt.si]&&(ut.f=shift_formula_xlsx(It[gt.si][1],It[gt.si][2],ot.r)));var jt=decode_cell(ot.r);for(st=0;st<Ht.length;++st)jt.r>=Ht[st][0].s.r&&jt.r<=Ht[st][0].e.r&&jt.c>=Ht[st][0].s.c&&jt.c<=Ht[st][0].e.c&&(ut.F=Ht[st][1])}if(ot.t==null&&ut.v===void 0)if(ut.f||ut.F)ut.v=0,ut.t="n";else if(_t)ut.t="z";else continue;else ut.t=ot.t||"n";switch(j.s.c>pt&&(j.s.c=pt),j.e.c<pt&&(j.e.c=pt),ut.t){case"n":if(ut.v==""||ut.v==null){if(!_t)continue;ut.t="z"}else ut.v=parseFloat(ut.v);break;case"s":if(typeof ut.v>"u"){if(!_t)continue;ut.t="z"}else St=strs[parseInt(ut.v,10)],ut.v=St.t,ut.r=St.r,b.cellHTML&&(ut.h=St.h);break;case"str":ut.t="s",ut.v=ut.v!=null?utf8read(ut.v):"",b.cellHTML&&(ut.h=escapehtml(ut.v));break;case"inlineStr":nt=lt.match(s),ut.t="s",nt!=null&&(St=parse_si(nt[1]))?(ut.v=St.t,b.cellHTML&&(ut.h=St.h)):ut.v="";break;case"b":ut.v=parsexmlbool(ut.v);break;case"d":b.cellDates?ut.v=parseDate(ut.v,1):(ut.v=datenum(parseDate(ut.v,1)),ut.t="n");break;case"e":(!b||b.cellText!==!1)&&(ut.w=ut.v),ut.v=RBErr[ut.v];break}if(vt=At=0,Nt=null,Gt&&ot.s!==void 0&&(Nt=et.CellXf[ot.s],Nt!=null&&(Nt.numFmtId!=null&&(vt=Nt.numFmtId),b.cellStyles&&Nt.fillId!=null&&(At=Nt.fillId))),safe_format(ut,vt,At,b,_e,et),b.cellDates&&Gt&&ut.t=="n"&&fmt_is_date(table_fmt[vt])&&(ut.t="d",ut.v=numdate(ut.v)),ot.cm&&b.xlmeta){var er=(b.xlmeta.Cell||[])[+ot.cm-1];er&&er.type=="XLDAPR"&&(ut.D=!0)}if(Wt){var Tt=decode_cell(ot.r);_[Tt.r]||(_[Tt.r]=[]),_[Tt.r][Tt.c]=ut}else _[ot.r]=ut}}}}yt.length>0&&(_["!rows"]=yt)}}();function write_ws_xml_data(e,i,a,s){var o=[],c=[],h=safe_decode_range(e["!ref"]),d="",g,_="",b=[],j=0,_e=0,et=e["!rows"],rt=Array.isArray(e),tt={r:_},it,nt=-1;for(_e=h.s.c;_e<=h.e.c;++_e)b[_e]=encode_col(_e);for(j=h.s.r;j<=h.e.r;++j){for(c=[],_=encode_row(j),_e=h.s.c;_e<=h.e.c;++_e){g=b[_e]+_;var at=rt?(e[j]||[])[_e]:e[g];at!==void 0&&(d=write_ws_xml_cell(at,g,e,i))!=null&&c.push(d)}(c.length>0||et&&et[j])&&(tt={r:_},et&&et[j]&&(it=et[j],it.hidden&&(tt.hidden=1),nt=-1,it.hpx?nt=px2pt(it.hpx):it.hpt&&(nt=it.hpt),nt>-1&&(tt.ht=nt,tt.customHeight=1),it.level&&(tt.outlineLevel=it.level)),o[o.length]=writextag("row",c.join(""),tt))}if(et)for(;j<et.length;++j)et&&et[j]&&(tt={r:j+1},it=et[j],it.hidden&&(tt.hidden=1),nt=-1,it.hpx?nt=px2pt(it.hpx):it.hpt&&(nt=it.hpt),nt>-1&&(tt.ht=nt,tt.customHeight=1),it.level&&(tt.outlineLevel=it.level),o[o.length]=writextag("row","",tt));return o.join("")}function write_ws_xml(e,i,a,s){var o=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],c=a.SheetNames[e],h=0,d="",g=a.Sheets[c];g==null&&(g={});var _=g["!ref"]||"A1",b=safe_decode_range(_);if(b.e.c>16383||b.e.r>1048575){if(i.WTF)throw new Error("Range "+_+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575),_=encode_range(b)}s||(s={}),g["!comments"]=[];var j=[];write_ws_xml_sheetpr(g,a,e,i,o),o[o.length]=writextag("dimension",null,{ref:_}),o[o.length]=write_ws_xml_sheetviews(g,i,e,a),i.sheetFormat&&(o[o.length]=writextag("sheetFormatPr",null,{defaultRowHeight:i.sheetFormat.defaultRowHeight||"16",baseColWidth:i.sheetFormat.baseColWidth||"10",outlineLevelRow:i.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(o[o.length]=write_ws_xml_cols(g,g["!cols"])),o[h=o.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(d=write_ws_xml_data(g,i),d.length>0&&(o[o.length]=d)),o.length>h+1&&(o[o.length]="</sheetData>",o[h]=o[h].replace("/>",">")),g["!protect"]&&(o[o.length]=write_ws_xml_protection(g["!protect"])),g["!autofilter"]!=null&&(o[o.length]=write_ws_xml_autofilter(g["!autofilter"],g,a,e)),g["!merges"]!=null&&g["!merges"].length>0&&(o[o.length]=write_ws_xml_merges(g["!merges"]));var _e=-1,et,rt=-1;return g["!links"].length>0&&(o[o.length]="<hyperlinks>",g["!links"].forEach(function(tt){tt[1].Target&&(et={ref:tt[0]},tt[1].Target.charAt(0)!="#"&&(rt=add_rels(s,-1,escapexml(tt[1].Target).replace(/#.*$/,""),RELS.HLINK),et["r:id"]="rId"+rt),(_e=tt[1].Target.indexOf("#"))>-1&&(et.location=escapexml(tt[1].Target.slice(_e+1))),tt[1].Tooltip&&(et.tooltip=escapexml(tt[1].Tooltip)),o[o.length]=writextag("hyperlink",null,et))}),o[o.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(o[o.length]=write_ws_xml_margins(g["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&(o[o.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:_}))),j.length>0&&(rt=add_rels(s,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),o[o.length]=writextag("drawing",null,{"r:id":"rId"+rt}),g["!drawing"]=j),g["!comments"].length>0&&(rt=add_rels(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),o[o.length]=writextag("legacyDrawing",null,{"r:id":"rId"+rt}),g["!legacy"]=rt),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtRowHdr(e,i){var a={},s=e.l+i;a.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=s,c&7&&(a.level=c&7),c&16&&(a.hidden=!0),c&32&&(a.hpt=o/20),a}function write_BrtRowHdr(e,i,a){var s=new_buf(145),o=(a["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var c=320;o.hpx?c=px2pt(o.hpx)*20:o.hpt&&(c=o.hpt*20),s.write_shift(2,c),s.write_shift(1,0);var h=0;o.level&&(h|=o.level),o.hidden&&(h|=16),(o.hpx||o.hpt)&&(h|=32),s.write_shift(1,h),s.write_shift(1,0);var d=0,g=s.l;s.l+=4;for(var _={r:e,c:0},b=0;b<16;++b)if(!(i.s.c>b+1<<10||i.e.c<b<<10)){for(var j=-1,_e=-1,et=b<<10;et<b+1<<10;++et){_.c=et;var rt=Array.isArray(a)?(a[_.r]||[])[_.c]:a[encode_cell(_)];rt&&(j<0&&(j=et),_e=et)}j<0||(++d,s.write_shift(4,j),s.write_shift(4,_e))}var tt=s.l;return s.l=g,s.write_shift(4,d),s.l=tt,s.length>s.l?s.slice(0,s.l):s}function write_row_header(e,i,a,s){var o=write_BrtRowHdr(s,a,i);(o.length>17||(i["!rows"]||[])[s])&&write_record(e,0,o)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,i){var a={},s=e[e.l];return++e.l,a.above=!(s&64),a.left=!(s&128),e.l+=18,a.name=parse_XLSBCodeName(e),a}function write_BrtWsProp(e,i,a){a==null&&(a=new_buf(84+4*e.length));var s=192;i&&(i.above&&(s&=-65),i.left&&(s&=-129)),a.write_shift(1,s);for(var o=1;o<3;++o)a.write_shift(1,0);return write_BrtColor({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),write_XLSBCodeName(e,a),a.slice(0,a.l)}function parse_BrtCellBlank(e){var i=parse_XLSBCell(e);return[i]}function write_BrtCellBlank(e,i,a){return a==null&&(a=new_buf(8)),write_XLSBCell(i,a)}function parse_BrtShortBlank(e){var i=parse_XLSBShortCell(e);return[i]}function write_BrtShortBlank(e,i,a){return a==null&&(a=new_buf(4)),write_XLSBShortCell(i,a)}function parse_BrtCellBool(e){var i=parse_XLSBCell(e),a=e.read_shift(1);return[i,a,"b"]}function write_BrtCellBool(e,i,a){return a==null&&(a=new_buf(9)),write_XLSBCell(i,a),a.write_shift(1,e.v?1:0),a}function parse_BrtShortBool(e){var i=parse_XLSBShortCell(e),a=e.read_shift(1);return[i,a,"b"]}function write_BrtShortBool(e,i,a){return a==null&&(a=new_buf(5)),write_XLSBShortCell(i,a),a.write_shift(1,e.v?1:0),a}function parse_BrtCellError(e){var i=parse_XLSBCell(e),a=e.read_shift(1);return[i,a,"e"]}function write_BrtCellError(e,i,a){return a==null&&(a=new_buf(9)),write_XLSBCell(i,a),a.write_shift(1,e.v),a}function parse_BrtShortError(e){var i=parse_XLSBShortCell(e),a=e.read_shift(1);return[i,a,"e"]}function write_BrtShortError(e,i,a){return a==null&&(a=new_buf(8)),write_XLSBShortCell(i,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}function parse_BrtCellIsst(e){var i=parse_XLSBCell(e),a=e.read_shift(4);return[i,a,"s"]}function write_BrtCellIsst(e,i,a){return a==null&&(a=new_buf(12)),write_XLSBCell(i,a),a.write_shift(4,i.v),a}function parse_BrtShortIsst(e){var i=parse_XLSBShortCell(e),a=e.read_shift(4);return[i,a,"s"]}function write_BrtShortIsst(e,i,a){return a==null&&(a=new_buf(8)),write_XLSBShortCell(i,a),a.write_shift(4,i.v),a}function parse_BrtCellReal(e){var i=parse_XLSBCell(e),a=parse_Xnum(e);return[i,a,"n"]}function write_BrtCellReal(e,i,a){return a==null&&(a=new_buf(16)),write_XLSBCell(i,a),write_Xnum(e.v,a),a}function parse_BrtShortReal(e){var i=parse_XLSBShortCell(e),a=parse_Xnum(e);return[i,a,"n"]}function write_BrtShortReal(e,i,a){return a==null&&(a=new_buf(12)),write_XLSBShortCell(i,a),write_Xnum(e.v,a),a}function parse_BrtCellRk(e){var i=parse_XLSBCell(e),a=parse_RkNumber(e);return[i,a,"n"]}function write_BrtCellRk(e,i,a){return a==null&&(a=new_buf(12)),write_XLSBCell(i,a),write_RkNumber(e.v,a),a}function parse_BrtShortRk(e){var i=parse_XLSBShortCell(e),a=parse_RkNumber(e);return[i,a,"n"]}function write_BrtShortRk(e,i,a){return a==null&&(a=new_buf(8)),write_XLSBShortCell(i,a),write_RkNumber(e.v,a),a}function parse_BrtCellRString(e){var i=parse_XLSBCell(e),a=parse_RichStr(e);return[i,a,"is"]}function parse_BrtCellSt(e){var i=parse_XLSBCell(e),a=parse_XLWideString(e);return[i,a,"str"]}function write_BrtCellSt(e,i,a){return a==null&&(a=new_buf(12+4*e.v.length)),write_XLSBCell(i,a),write_XLWideString(e.v,a),a.length>a.l?a.slice(0,a.l):a}function parse_BrtShortSt(e){var i=parse_XLSBShortCell(e),a=parse_XLWideString(e);return[i,a,"str"]}function write_BrtShortSt(e,i,a){return a==null&&(a=new_buf(8+4*e.v.length)),write_XLSBShortCell(i,a),write_XLWideString(e.v,a),a.length>a.l?a.slice(0,a.l):a}function parse_BrtFmlaBool(e,i,a){var s=e.l+i,o=parse_XLSBCell(e);o.r=a["!row"];var c=e.read_shift(1),h=[o,c,"b"];if(a.cellFormula){e.l+=2;var d=parse_XLSBCellParsedFormula(e,s-e.l,a);h[3]=stringify_formula(d,null,o,a.supbooks,a)}else e.l=s;return h}function parse_BrtFmlaError(e,i,a){var s=e.l+i,o=parse_XLSBCell(e);o.r=a["!row"];var c=e.read_shift(1),h=[o,c,"e"];if(a.cellFormula){e.l+=2;var d=parse_XLSBCellParsedFormula(e,s-e.l,a);h[3]=stringify_formula(d,null,o,a.supbooks,a)}else e.l=s;return h}function parse_BrtFmlaNum(e,i,a){var s=e.l+i,o=parse_XLSBCell(e);o.r=a["!row"];var c=parse_Xnum(e),h=[o,c,"n"];if(a.cellFormula){e.l+=2;var d=parse_XLSBCellParsedFormula(e,s-e.l,a);h[3]=stringify_formula(d,null,o,a.supbooks,a)}else e.l=s;return h}function parse_BrtFmlaString(e,i,a){var s=e.l+i,o=parse_XLSBCell(e);o.r=a["!row"];var c=parse_XLWideString(e),h=[o,c,"str"];if(a.cellFormula){e.l+=2;var d=parse_XLSBCellParsedFormula(e,s-e.l,a);h[3]=stringify_formula(d,null,o,a.supbooks,a)}else e.l=s;return h}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,i){return i==null&&(i=new_buf(4)),i.write_shift(4,e),i}function parse_BrtHLink(e,i){var a=e.l+i,s=parse_UncheckedRfX(e),o=parse_XLNullableWideString(e),c=parse_XLWideString(e),h=parse_XLWideString(e),d=parse_XLWideString(e);e.l=a;var g={rfx:s,relId:o,loc:c,display:d};return h&&(g.Tooltip=h),g}function write_BrtHLink(e,i){var a=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},a),write_RelID("rId"+i,a);var s=e[1].Target.indexOf("#"),o=s==-1?"":e[1].Target.slice(s+1);return write_XLWideString(o||"",a),write_XLWideString(e[1].Tooltip||"",a),write_XLWideString("",a),a.slice(0,a.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,i,a){var s=e.l+i,o=parse_RfX(e),c=e.read_shift(1),h=[o];if(h[2]=c,a.cellFormula){var d=parse_XLSBArrayParsedFormula(e,s-e.l,a);h[1]=d}else e.l=s;return h}function parse_BrtShrFmla(e,i,a){var s=e.l+i,o=parse_UncheckedRfX(e),c=[o];if(a.cellFormula){var h=parse_XLSBSharedParsedFormula(e,s-e.l,a);c[1]=h,e.l=s}else e.l=s;return c}function write_BrtColInfo(e,i,a){a==null&&(a=new_buf(18));var s=col_obj_w(e,i);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,(s.width||10)*256),a.write_shift(4,0);var o=0;return i.hidden&&(o|=1),typeof s.width=="number"&&(o|=2),i.level&&(o|=i.level<<8),a.write_shift(2,o),a}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var i={};return BrtMarginKeys.forEach(function(a){i[a]=parse_Xnum(e)}),i}function write_BrtMargins(e,i){return i==null&&(i=new_buf(6*8)),default_margins(e),BrtMarginKeys.forEach(function(a){write_Xnum(e[a],i)}),i}function parse_BrtBeginWsView(e){var i=e.read_shift(2);return e.l+=28,{RTL:i&32}}function write_BrtBeginWsView(e,i,a){a==null&&(a=new_buf(30));var s=924;return(((i||{}).Views||[])[0]||{}).RTL&&(s|=32),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function write_BrtCellIgnoreEC(e){var i=new_buf(24);return i.write_shift(4,4),i.write_shift(4,1),write_UncheckedRfX(e,i),i}function write_BrtSheetProtection(e,i){return i==null&&(i=new_buf(16*4+2)),i.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),i.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?i.write_shift(4,e[a[0]]!=null&&!e[a[0]]?1:0):i.write_shift(4,e[a[0]]!=null&&e[a[0]]?0:1)}),i}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,i,a,s,o,c,h){if(!e)return e;var d=i||{};s||(s={"!id":{}});var g=d.dense?[]:{},_,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=!1,_e=!1,et,rt,tt,it,nt,at,st,dt,lt,ut=[];d.biff=12,d["!row"]=0;var ot=0,ft=!1,pt=[],St={},gt=d.supbooks||o.supbooks||[[]];if(gt.sharedf=St,gt.arrayf=pt,gt.SheetNames=o.SheetNames||o.Sheets.map(function(Wt){return Wt.name}),!d.supbooks&&(d.supbooks=gt,o.Names))for(var vt=0;vt<o.Names.length;++vt)gt[0][vt+1]=o.Names[vt];var At=[],Gt=[],Nt=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var Ht;if(recordhopper(e,function(yt,Dt,$t){if(!_e)switch($t){case 148:_=yt;break;case 0:et=yt,d.sheetRows&&d.sheetRows<=et.r&&(_e=!0),dt=encode_row(it=et.r),d["!row"]=et.r,(yt.hidden||yt.hpt||yt.level!=null)&&(yt.hpt&&(yt.hpx=pt2px(yt.hpt)),Gt[yt.r]=yt);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(rt={t:yt[2]},yt[2]){case"n":rt.v=yt[1];break;case"s":st=strs[yt[1]],rt.v=st.t,rt.r=st.r;break;case"b":rt.v=!!yt[1];break;case"e":rt.v=yt[1],d.cellText!==!1&&(rt.w=BErr[rt.v]);break;case"str":rt.t="s",rt.v=yt[1];break;case"is":rt.t="s",rt.v=yt[1].t;break}if((tt=h.CellXf[yt[0].iStyleRef])&&safe_format(rt,tt.numFmtId,null,d,c,h),nt=yt[0].c==-1?nt+1:yt[0].c,d.dense?(g[it]||(g[it]=[]),g[it][nt]=rt):g[encode_col(nt)+dt]=rt,d.cellFormula){for(ft=!1,ot=0;ot<pt.length;++ot){var _t=pt[ot];et.r>=_t[0].s.r&&et.r<=_t[0].e.r&&nt>=_t[0].s.c&&nt<=_t[0].e.c&&(rt.F=encode_range(_t[0]),ft=!0)}!ft&&yt.length>3&&(rt.f=yt[3])}if(b.s.r>et.r&&(b.s.r=et.r),b.s.c>nt&&(b.s.c=nt),b.e.r<et.r&&(b.e.r=et.r),b.e.c<nt&&(b.e.c=nt),d.cellDates&&tt&&rt.t=="n"&&fmt_is_date(table_fmt[tt.numFmtId])){var ht=SSF_parse_date_code(rt.v);ht&&(rt.t="d",rt.v=new Date(ht.y,ht.m-1,ht.d,ht.H,ht.M,ht.S,ht.u))}Ht&&(Ht.type=="XLDAPR"&&(rt.D=!0),Ht=void 0);break;case 1:case 12:if(!d.sheetStubs||j)break;rt={t:"z",v:void 0},nt=yt[0].c==-1?nt+1:yt[0].c,d.dense?(g[it]||(g[it]=[]),g[it][nt]=rt):g[encode_col(nt)+dt]=rt,b.s.r>et.r&&(b.s.r=et.r),b.s.c>nt&&(b.s.c=nt),b.e.r<et.r&&(b.e.r=et.r),b.e.c<nt&&(b.e.c=nt),Ht&&(Ht.type=="XLDAPR"&&(rt.D=!0),Ht=void 0);break;case 176:ut.push(yt);break;case 49:Ht=((d.xlmeta||{}).Cell||[])[yt-1];break;case 494:var ct=s["!id"][yt.relId];for(ct?(yt.Target=ct.Target,yt.loc&&(yt.Target+="#"+yt.loc),yt.Rel=ct):yt.relId==""&&(yt.Target="#"+yt.loc),it=yt.rfx.s.r;it<=yt.rfx.e.r;++it)for(nt=yt.rfx.s.c;nt<=yt.rfx.e.c;++nt)d.dense?(g[it]||(g[it]=[]),g[it][nt]||(g[it][nt]={t:"z",v:void 0}),g[it][nt].l=yt):(at=encode_cell({c:nt,r:it}),g[at]||(g[at]={t:"z",v:void 0}),g[at].l=yt);break;case 426:if(!d.cellFormula)break;pt.push(yt),lt=d.dense?g[it][nt]:g[encode_col(nt)+dt],lt.f=stringify_formula(yt[1],b,{r:et.r,c:nt},gt,d),lt.F=encode_range(yt[0]);break;case 427:if(!d.cellFormula)break;St[encode_cell(yt[0].s)]=yt[1],lt=d.dense?g[it][nt]:g[encode_col(nt)+dt],lt.f=stringify_formula(yt[1],b,{r:et.r,c:nt},gt,d);break;case 60:if(!d.cellStyles)break;for(;yt.e>=yt.s;)At[yt.e--]={width:yt.w/256,hidden:!!(yt.flags&1),level:yt.level},Nt||(Nt=!0,find_mdw_colw(yt.w/256)),process_col(At[yt.e+1]);break;case 161:g["!autofilter"]={ref:encode_range(yt)};break;case 476:g["!margins"]=yt;break;case 147:o.Sheets[a]||(o.Sheets[a]={}),yt.name&&(o.Sheets[a].CodeName=yt.name),(yt.above||yt.left)&&(g["!outline"]={above:yt.above,left:yt.left});break;case 137:o.Views||(o.Views=[{}]),o.Views[0]||(o.Views[0]={}),yt.RTL&&(o.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:j=!0;break;case 36:j=!1;break;case 37:j=!0;break;case 38:j=!1;break;default:if(!Dt.T){if(!j||d.WTF)throw new Error("Unexpected record 0x"+$t.toString(16))}}},d),delete d.supbooks,delete d["!row"],!g["!ref"]&&(b.s.r<2e6||_&&(_.e.r>0||_.e.c>0||_.s.r>0||_.s.c>0))&&(g["!ref"]=encode_range(_||b)),d.sheetRows&&g["!ref"]){var It=safe_decode_range(g["!ref"]);d.sheetRows<=+It.e.r&&(It.e.r=d.sheetRows-1,It.e.r>b.e.r&&(It.e.r=b.e.r),It.e.r<It.s.r&&(It.s.r=It.e.r),It.e.c>b.e.c&&(It.e.c=b.e.c),It.e.c<It.s.c&&(It.s.c=It.e.c),g["!fullref"]=g["!ref"],g["!ref"]=encode_range(It))}return ut.length>0&&(g["!merges"]=ut),At.length>0&&(g["!cols"]=At),Gt.length>0&&(g["!rows"]=Gt),g}function write_ws_bin_cell(e,i,a,s,o,c,h){if(i.v===void 0)return!1;var d="";switch(i.t){case"b":d=i.v?"1":"0";break;case"d":i=dup(i),i.z=i.z||table_fmt[14],i.v=datenum(parseDate(i.v)),i.t="n";break;case"n":case"e":d=""+i.v;break;default:d=i.v;break}var g={r:a,c:s};switch(g.s=get_cell_style(o.cellXfs,i,o),i.l&&c["!links"].push([encode_cell(g),i.l]),i.c&&c["!comments"].push([encode_cell(g),i.c]),i.t){case"s":case"str":return o.bookSST?(d=get_sst_id(o.Strings,i.v,o.revStrings),g.t="s",g.v=d,h?write_record(e,18,write_BrtShortIsst(i,g)):write_record(e,7,write_BrtCellIsst(i,g))):(g.t="str",h?write_record(e,17,write_BrtShortSt(i,g)):write_record(e,6,write_BrtCellSt(i,g))),!0;case"n":return i.v==(i.v|0)&&i.v>-1e3&&i.v<1e3?h?write_record(e,13,write_BrtShortRk(i,g)):write_record(e,2,write_BrtCellRk(i,g)):h?write_record(e,16,write_BrtShortReal(i,g)):write_record(e,5,write_BrtCellReal(i,g)),!0;case"b":return g.t="b",h?write_record(e,15,write_BrtShortBool(i,g)):write_record(e,4,write_BrtCellBool(i,g)),!0;case"e":return g.t="e",h?write_record(e,14,write_BrtShortError(i,g)):write_record(e,3,write_BrtCellError(i,g)),!0}return h?write_record(e,12,write_BrtShortBlank(i,g)):write_record(e,1,write_BrtCellBlank(i,g)),!0}function write_CELLTABLE(e,i,a,s){var o=safe_decode_range(i["!ref"]||"A1"),c,h="",d=[];write_record(e,145);var g=Array.isArray(i),_=o.e.r;i["!rows"]&&(_=Math.max(o.e.r,i["!rows"].length-1));for(var b=o.s.r;b<=_;++b){h=encode_row(b),write_row_header(e,i,o,b);var j=!1;if(b<=o.e.r)for(var _e=o.s.c;_e<=o.e.c;++_e){b===o.s.r&&(d[_e]=encode_col(_e)),c=d[_e]+h;var et=g?(i[b]||[])[_e]:i[c];if(!et){j=!1;continue}j=write_ws_bin_cell(e,et,b,_e,s,i,j)}}write_record(e,146)}function write_MERGECELLS(e,i){!i||!i["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(i["!merges"].length)),i["!merges"].forEach(function(a){write_record(e,176,write_BrtMergeCell(a))}),write_record(e,178))}function write_COLINFOS(e,i){!i||!i["!cols"]||(write_record(e,390),i["!cols"].forEach(function(a,s){a&&write_record(e,60,write_BrtColInfo(s,a))}),write_record(e,391))}function write_IGNOREECS(e,i){!i||!i["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(i["!ref"]))),write_record(e,650))}function write_HLINKS(e,i,a){i["!links"].forEach(function(s){if(s[1].Target){var o=add_rels(a,-1,s[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(s,o))}}),delete i["!links"]}function write_LEGACYDRAWING(e,i,a,s){if(i["!comments"].length>0){var o=add_rels(s,-1,"../drawings/vmlDrawing"+(a+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+o)),i["!legacy"]=o}}function write_AUTOFILTER(e,i,a,s){if(i["!autofilter"]){var o=i["!autofilter"],c=typeof o.ref=="string"?o.ref:encode_range(o.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var h=a.Workbook.Names,d=decode_range(c);d.s.r==d.e.r&&(d.e.r=decode_range(i["!ref"]).e.r,c=encode_range(d));for(var g=0;g<h.length;++g){var _=h[g];if(_.Name=="_xlnm._FilterDatabase"&&_.Sheet==s){_.Ref="'"+a.SheetNames[s]+"'!"+c;break}}g==h.length&&h.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+c}),write_record(e,161,write_UncheckedRfX(safe_decode_range(c))),write_record(e,162)}}function write_WSVIEWS2(e,i,a){write_record(e,133),write_record(e,137,write_BrtBeginWsView(i,a)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,i){i["!protect"]&&write_record(e,535,write_BrtSheetProtection(i["!protect"]))}function write_ws_bin(e,i,a,s){var o=buf_array(),c=a.SheetNames[e],h=a.Sheets[c]||{},d=c;try{a&&a.Workbook&&(d=a.Workbook.Sheets[e].CodeName||d)}catch{}var g=safe_decode_range(h["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(i.WTF)throw new Error("Range "+(h["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return h["!links"]=[],h["!comments"]=[],write_record(o,129),(a.vbaraw||h["!outline"])&&write_record(o,147,write_BrtWsProp(d,h["!outline"])),write_record(o,148,write_BrtWsDim(g)),write_WSVIEWS2(o,h,a.Workbook),write_COLINFOS(o,h),write_CELLTABLE(o,h,e,i),write_SHEETPROTECT(o,h),write_AUTOFILTER(o,h,a,e),write_MERGECELLS(o,h),write_HLINKS(o,h,s),h["!margins"]&&write_record(o,476,write_BrtMargins(h["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&write_IGNOREECS(o,h),write_LEGACYDRAWING(o,h,e,s),write_record(o,130),o.end()}function parse_Cache(e){var i=[],a=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var h=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);h&&(i[+h[1]]=a?+h[2]:h[2])});var o=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){s=c.replace(/<.*?>/g,"")}),[i,o,s]}function parse_chart(e,i,a,s,o,c){var h=c||{"!type":"chart"};if(!e)return c;var d=0,g=0,_="A",b={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(j){var _e=parse_Cache(j);b.s.r=b.s.c=0,b.e.c=d,_=encode_col(d),_e[0].forEach(function(et,rt){h[_+encode_row(rt)]={t:"n",v:et,z:_e[1]},g=rt}),b.e.r<g&&(b.e.r=g),++d}),d>0&&(h["!ref"]=encode_range(b)),h}function parse_cs_xml(e,i,a,s,o){if(!e)return e;s||(s={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},h,d=e.match(sheetprregex);return d&&parse_ws_xml_sheetpr(d[0],c,o,a),(h=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=h[1]),s["!id"][c["!rel"]]&&(c["!drawel"]=s["!id"][c["!rel"]]),c}function parse_BrtCsProp(e,i){e.l+=10;var a=parse_XLWideString(e);return{name:a}}function parse_cs_bin(e,i,a,s,o){if(!e)return e;s||(s={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},h=!1;return recordhopper(e,function(g,_,b){switch(b){case 550:c["!rel"]=g;break;case 651:o.Sheets[a]||(o.Sheets[a]={}),g.name&&(o.Sheets[a].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:h=!0;break;case 36:h=!1;break;case 37:break;case 38:break;default:if(!(_.T>0)){if(!(_.T<0)){if(!h||i.WTF)throw new Error("Unexpected record 0x"+b.toString(16))}}}},i),s["!id"][c["!rel"]]&&(c["!drawel"]=s["!id"][c["!rel"]]),c}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,i){for(var a=0;a!=e.length;++a)for(var s=e[a],o=0;o!=i.length;++o){var c=i[o];if(s[c[0]]==null)s[c[0]]=c[1];else switch(c[2]){case"bool":typeof s[c[0]]=="string"&&(s[c[0]]=parsexmlbool(s[c[0]]));break;case"int":typeof s[c[0]]=="string"&&(s[c[0]]=parseInt(s[c[0]],10));break}}}function push_defaults(e,i){for(var a=0;a!=i.length;++a){var s=i[a];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=parsexmlbool(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,i){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return badchars.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function check_wb_names(e,i,a){e.forEach(function(s,o){check_ws_name(s);for(var c=0;c<o;++c)if(s==e[c])throw new Error("Duplicate Sheet Name: "+s);if(a){var h=i&&i[o]&&i[o].CodeName||s;if(h.charCodeAt(0)==95&&h.length>22)throw new Error("Bad Code Name: Worksheet"+h)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var i=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,i,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)check_ws(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,i){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,o="xmlns",c={},h=0;if(e.replace(tagregex,function(g,_){var b=parsexmltag(g);switch(strip_ns(b[0])){case"<?xml":break;case"<workbook":g.match(wbnsregex)&&(o="xmlns"+g.match(/<(\w+):/)[1]),a.xmlns=b[o];break;case"</workbook>":break;case"<fileVersion":delete b[0],a.AppVersion=b;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(j){if(b[j[0]]!=null)switch(j[2]){case"bool":a.WBProps[j[0]]=parsexmlbool(b[j[0]]);break;case"int":a.WBProps[j[0]]=parseInt(b[j[0]],10);break;default:a.WBProps[j[0]]=b[j[0]]}}),b.codeName&&(a.WBProps.CodeName=utf8read(b.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete b[0],a.WBView.push(b);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(b.state){case"hidden":b.Hidden=1;break;case"veryHidden":b.Hidden=2;break;default:b.Hidden=0}delete b.state,b.name=unescapexml(utf8read(b.name)),delete b[0],a.Sheets.push(b);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":c={},c.Name=utf8read(b.name),b.comment&&(c.Comment=b.comment),b.localSheetId&&(c.Sheet=+b.localSheetId),parsexmlbool(b.hidden||"0")&&(c.Hidden=!0),h=_+g.length;break;case"</definedName>":c.Ref=unescapexml(utf8read(e.slice(h,_))),a.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete b[0],a.CalcPr=b;break;case"<calcPr/>":delete b[0],a.CalcPr=b;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&i.WTF)throw new Error("unrecognized "+b[0]+" in workbook")}return g}),XMLNS_main.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return parse_wb_defaults(a),a}function write_wb_xml(e){var i=[XML_HEADER];i[i.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(s[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),i[i.length]=writextag("workbookPr",null,s);var o=e.Workbook&&e.Workbook.Sheets||[],c=0;if(o&&o[0]&&o[0].Hidden){for(i[i.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!o[c]||!o[c].Hidden);++c);c==e.SheetNames.length&&(c=0),i[i.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',i[i.length]="</bookViews>"}for(i[i.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var h={name:escapexml(e.SheetNames[c].slice(0,31))};if(h.sheetId=""+(c+1),h["r:id"]="rId"+(c+1),o[c])switch(o[c].Hidden){case 1:h.state="hidden";break;case 2:h.state="veryHidden";break}i[i.length]=writextag("sheet",null,h)}return i[i.length]="</sheets>",a&&(i[i.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var g={name:d.Name};d.Comment&&(g.comment=d.Comment),d.Sheet!=null&&(g.localSheetId=""+d.Sheet),d.Hidden&&(g.hidden="1"),d.Ref&&(i[i.length]=writextag("definedName",escapexml(d.Ref),g))}),i[i.length]="</definedNames>"),i.length>2&&(i[i.length]="</workbook>",i[1]=i[1].replace("/>",">")),i.join("")}function parse_BrtBundleSh(e,i){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=parse_RelID(e),a.name=parse_XLWideString(e),a}function write_BrtBundleSh(e,i){return i||(i=new_buf(127)),i.write_shift(4,e.Hidden),i.write_shift(4,e.iTabID),write_RelID(e.strRelID,i),write_XLWideString(e.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i}function parse_BrtWbProp(e,i){var a={},s=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var o=i>8?parse_XLWideString(e):"";return o.length>0&&(a.CodeName=o),a.autoCompressPictures=!!(s&65536),a.backupFile=!!(s&64),a.checkCompatibility=!!(s&4096),a.date1904=!!(s&1),a.filterPrivacy=!!(s&8),a.hidePivotFieldList=!!(s&1024),a.promptedSolutions=!!(s&16),a.publishItems=!!(s&2048),a.refreshAllConnections=!!(s&262144),a.saveExternalLinkValues=!!(s&128),a.showBorderUnselectedTables=!!(s&4),a.showInkAnnotation=!!(s&32),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(s&32768),a.updateLinks=["userSet","never","always"][s>>8&3],a}function write_BrtWbProp(e,i){i||(i=new_buf(72));var a=0;return e&&e.filterPrivacy&&(a|=8),i.write_shift(4,a),i.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",i),i.slice(0,i.l)}function parse_BrtFRTArchID$(e,i){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=i-8,a}function parse_BrtName(e,i,a){var s=e.l+i;e.l+=4,e.l+=1;var o=e.read_shift(4),c=parse_XLNameWideString(e),h=parse_XLSBNameParsedFormula(e,0,a),d=parse_XLNullableWideString(e);e.l=s;var g={Name:c,Ptg:h};return o<268435455&&(g.Sheet=o),d&&(g.Comment=d),g}function parse_wb_bin(e,i){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],o=!1;i||(i={}),i.biff=12;var c=[],h=[[]];return h.SheetNames=[],h.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(g,_,b){switch(b){case 156:h.SheetNames.push(g.name),a.Sheets.push(g);break;case 153:a.WBProps=g;break;case 39:g.Sheet!=null&&(i.SID=g.Sheet),g.Ref=stringify_formula(g.Ptg,null,null,h,i),delete i.SID,delete g.Ptg,c.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:h[0].length?h.push([b,g]):h[0]=[b,g],h[h.length-1].XTI=[];break;case 362:h.length===0&&(h[0]=[],h[0].XTI=[]),h[h.length-1].XTI=h[h.length-1].XTI.concat(g),h.XTI=h.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(b),o=!0;break;case 36:s.pop(),o=!1;break;case 37:s.push(b),o=!0;break;case 38:s.pop(),o=!1;break;case 16:break;default:if(!_.T){if(!o||i.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+b.toString(16))}}},i),parse_wb_defaults(a),a.Names=c,a.supbooks=h,a}function write_BUNDLESHS(e,i){write_record(e,143);for(var a=0;a!=i.SheetNames.length;++a){var s=i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[a]&&i.Workbook.Sheets[a].Hidden||0,o={Hidden:s,iTabID:a+1,strRelID:"rId"+(a+1),name:i.SheetNames[a]};write_record(e,156,write_BrtBundleSh(o))}write_record(e,144)}function write_BrtFileVersion(e,i){i||(i=new_buf(127));for(var a=0;a!=4;++a)i.write_shift(4,0);return write_XLWideString("SheetJS",i),write_XLWideString(XLSX.version,i),write_XLWideString(XLSX.version,i),write_XLWideString("7262",i),i.length>i.l?i.slice(0,i.l):i}function write_BrtBookView(e,i){i||(i=new_buf(29)),i.write_shift(-4,0),i.write_shift(-4,460),i.write_shift(4,28800),i.write_shift(4,17600),i.write_shift(4,500),i.write_shift(4,e),i.write_shift(4,e);var a=120;return i.write_shift(1,a),i.length>i.l?i.slice(0,i.l):i}function write_BOOKVIEWS(e,i){if(!(!i.Workbook||!i.Workbook.Sheets)){for(var a=i.Workbook.Sheets,s=0,o=-1,c=-1;s<a.length;++s)!a[s]||!a[s].Hidden&&o==-1?o=s:a[s].Hidden==1&&c==-1&&(c=s);c>o||(write_record(e,135),write_record(e,158,write_BrtBookView(o)),write_record(e,136))}}function write_wb_bin(e,i){var a=buf_array();return write_record(a,131),write_record(a,128,write_BrtFileVersion()),write_record(a,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(a,e),write_BUNDLESHS(a,e),write_record(a,132),a.end()}function parse_wb(e,i,a){return i.slice(-4)===".bin"?parse_wb_bin(e,a):parse_wb_xml(e,a)}function parse_ws(e,i,a,s,o,c,h,d){return i.slice(-4)===".bin"?parse_ws_bin(e,s,a,o,c,h,d):parse_ws_xml(e,s,a,o,c,h,d)}function parse_cs(e,i,a,s,o,c,h,d){return i.slice(-4)===".bin"?parse_cs_bin(e,s,a,o,c):parse_cs_xml(e,s,a,o,c)}function parse_ms(e,i,a,s,o,c,h,d){return i.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,i,a,s,o,c,h,d){return i.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,i,a,s){return i.slice(-4)===".bin"?parse_sty_bin(e,a,s):parse_sty_xml(e,a,s)}function parse_theme(e,i,a){return parse_theme_xml(e,a)}function parse_sst(e,i,a){return i.slice(-4)===".bin"?parse_sst_bin(e,a):parse_sst_xml(e,a)}function parse_cmnt(e,i,a){return i.slice(-4)===".bin"?parse_comments_bin(e,a):parse_comments_xml(e,a)}function parse_cc(e,i,a){return i.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,i,a,s){return a.slice(-4)===".bin"?parse_xlink_bin(e,i,a,s):void 0}function parse_xlmeta(e,i,a){return i.slice(-4)===".bin"?parse_xlmeta_bin(e,i,a):parse_xlmeta_xml(e,i,a)}function write_wb(e,i,a){return(i.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,i,a,s,o){return(i.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,a,s,o)}function write_sty(e,i,a){return(i.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,a)}function write_sst(e,i,a){return(i.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,a)}function write_cmnt(e,i,a){return(i.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,i){var a=e.split(/\s+/),s=[];if(s[0]=a[0],a.length===1)return s;var o=e.match(attregexg2),c,h,d,g;if(o)for(g=0;g!=o.length;++g)c=o[g].match(attregex2),(h=c[1].indexOf(":"))===-1?s[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?d="xmlns"+c[1].slice(6):d=c[1].slice(h+1),s[d]=c[2].slice(1,c[2].length-1));return s}function xlml_parsexmltagobj(e){var i=e.split(/\s+/),a={};if(i.length===1)return a;var s=e.match(attregexg2),o,c,h,d;if(s)for(d=0;d!=s.length;++d)o=s[d].match(attregex2),(c=o[1].indexOf(":"))===-1?a[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?h="xmlns"+o[1].slice(6):h=o[1].slice(c+1),a[h]=o[2].slice(1,o[2].length-1));return a}var XLMLFormatMap;function xlml_format(e,i){var a=XLMLFormatMap[e]||unescapexml(e);return a==="General"?SSF_general(i):SSF_format(a,i)}function xlml_set_custprop(e,i,a,s){var o=s;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":o=parsexmlbool(s);break;case"i2":case"int":o=parseInt(s,10);break;case"r4":case"float":o=parseFloat(s);break;case"date":case"dateTime.tz":o=parseDate(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[unescapexml(i)]=o}function safe_format_xlml(e,i,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:i==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(i||"General",e.v)}catch(c){if(a.WTF)throw c}try{var s=XLMLFormatMap[i]||i||"General";if(a.cellNF&&(e.z=s),a.cellDates&&e.t=="n"&&fmt_is_date(s)){var o=SSF_parse_date_code(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(c){if(a.WTF)throw c}}}function process_style_xlml(e,i,a){if(a.cellStyles&&i.Interior){var s=i.Interior;s.Pattern&&(s.patternType=XLMLPatternTypeMap[s.Pattern]||s.Pattern)}e[i.ID]=i}function parse_xlml_data(e,i,a,s,o,c,h,d,g,_){var b="General",j=s.StyleID,_e={};_=_||{};var et=[],rt=0;for(j===void 0&&d&&(j=d.StyleID),j===void 0&&h&&(j=h.StyleID);c[j]!==void 0&&(c[j].nf&&(b=c[j].nf),c[j].Interior&&et.push(c[j].Interior),!!c[j].Parent);)j=c[j].Parent;switch(a.Type){case"Boolean":s.t="b",s.v=parsexmlbool(e);break;case"String":s.t="s",s.r=xlml_fixstr(unescapexml(e)),s.v=e.indexOf("<")>-1?unescapexml(i||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=unescapexml(e):s.v<60&&(s.v=s.v-1),(!b||b=="General")&&(b="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=RBErr[e],_.cellText!==!1&&(s.w=e);break;default:e==""&&i==""?s.t="z":(s.t="s",s.v=xlml_fixstr(i||e));break}if(safe_format_xlml(s,b,_),_.cellFormula!==!1)if(s.Formula){var tt=unescapexml(s.Formula);tt.charCodeAt(0)==61&&(tt=tt.slice(1)),s.f=rc_to_a1(tt,o),delete s.Formula,s.ArrayRange=="RC"?s.F=rc_to_a1("RC:RC",o):s.ArrayRange&&(s.F=rc_to_a1(s.ArrayRange,o),g.push([safe_decode_range(s.F),s.F]))}else for(rt=0;rt<g.length;++rt)o.r>=g[rt][0].s.r&&o.r<=g[rt][0].e.r&&o.c>=g[rt][0].s.c&&o.c<=g[rt][0].e.c&&(s.F=g[rt][1]);_.cellStyles&&(et.forEach(function(it){!_e.patternType&&it.patternType&&(_e.patternType=it.patternType)}),s.s=_e),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,i){var a=i||{};make_ssf();var s=debom(xlml_normalize(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(s=utf8read(s));var o=s.slice(0,1024).toLowerCase(),c=!1;if(o=o.replace(/".*?"/g,""),(o.indexOf(">")&1023)>Math.min(o.indexOf(",")&1023,o.indexOf(";")&1023)){var h=dup(a);return h.type="string",PRN.to_workbook(s,h)}if(o.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){o.indexOf("<"+Ft)>=0&&(c=!0)}),c)return html_to_workbook(s,a);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,g=[],_,b={},j=[],_e=a.dense?[]:{},et="",rt={},tt={},it=xlml_parsexmltag('<Data ss:Type="String">'),nt=0,at=0,st=0,dt={s:{r:2e6,c:2e6},e:{r:0,c:0}},lt={},ut={},ot="",ft=0,pt=[],St={},gt={},vt=0,At=[],Gt=[],Nt={},Ht=[],It,Wt=!1,yt=[],Dt=[],$t={},_t=0,ht=0,ct={Sheets:[],WBProps:{date1904:!1}},xt={};xlmlregex.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var Et="";d=xlmlregex.exec(s);)switch(d[3]=(Et=d[3]).toLowerCase()){case"data":if(Et=="data"){if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&g.push([d[3],!0]);break}if(g[g.length-1][1])break;d[1]==="/"?parse_xlml_data(s.slice(nt,d.index),ot,it,g[g.length-1][0]=="comment"?Nt:rt,{c:at,r:st},lt,Ht[at],tt,yt,a):(ot="",it=xlml_parsexmltag(d[0]),nt=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(Gt.length>0&&(rt.c=Gt),(!a.sheetRows||a.sheetRows>st)&&rt.v!==void 0&&(a.dense?(_e[st]||(_e[st]=[]),_e[st][at]=rt):_e[encode_col(at)+encode_row(st)]=rt),rt.HRef&&(rt.l={Target:unescapexml(rt.HRef)},rt.HRefScreenTip&&(rt.l.Tooltip=rt.HRefScreenTip),delete rt.HRef,delete rt.HRefScreenTip),(rt.MergeAcross||rt.MergeDown)&&(_t=at+(parseInt(rt.MergeAcross,10)|0),ht=st+(parseInt(rt.MergeDown,10)|0),pt.push({s:{c:at,r:st},e:{c:_t,r:ht}})),!a.sheetStubs)rt.MergeAcross?at=_t+1:++at;else if(rt.MergeAcross||rt.MergeDown){for(var bt=at;bt<=_t;++bt)for(var Ct=st;Ct<=ht;++Ct)(bt>at||Ct>st)&&(a.dense?(_e[Ct]||(_e[Ct]=[]),_e[Ct][bt]={t:"z"}):_e[encode_col(bt)+encode_row(Ct)]={t:"z"});at=_t+1}else++at;else rt=xlml_parsexmltagobj(d[0]),rt.Index&&(at=+rt.Index-1),at<dt.s.c&&(dt.s.c=at),at>dt.e.c&&(dt.e.c=at),d[0].slice(-2)==="/>"&&++at,Gt=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(st<dt.s.r&&(dt.s.r=st),st>dt.e.r&&(dt.e.r=st),d[0].slice(-2)==="/>"&&(tt=xlml_parsexmltag(d[0]),tt.Index&&(st=+tt.Index-1)),at=0,++st):(tt=xlml_parsexmltag(d[0]),tt.Index&&(st=+tt.Index-1),$t={},(tt.AutoFitHeight=="0"||tt.Height)&&($t.hpx=parseInt(tt.Height,10),$t.hpt=px2pt($t.hpx),Dt[st]=$t),tt.Hidden=="1"&&($t.hidden=!0,Dt[st]=$t));break;case"worksheet":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"));j.push(et),dt.s.r<=dt.e.r&&dt.s.c<=dt.e.c&&(_e["!ref"]=encode_range(dt),a.sheetRows&&a.sheetRows<=dt.e.r&&(_e["!fullref"]=_e["!ref"],dt.e.r=a.sheetRows-1,_e["!ref"]=encode_range(dt))),pt.length&&(_e["!merges"]=pt),Ht.length>0&&(_e["!cols"]=Ht),Dt.length>0&&(_e["!rows"]=Dt),b[et]=_e}else dt={s:{r:2e6,c:2e6},e:{r:0,c:0}},st=at=0,g.push([d[3],!1]),_=xlml_parsexmltag(d[0]),et=unescapexml(_.Name),_e=a.dense?[]:{},pt=[],yt=[],Dt=[],xt={name:et,Hidden:0},ct.Sheets.push(xt);break;case"table":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"))}else{if(d[0].slice(-2)=="/>")break;g.push([d[3],!1]),Ht=[],Wt=!1}break;case"style":d[1]==="/"?process_style_xlml(lt,ut,a):ut=xlml_parsexmltag(d[0]);break;case"numberformat":ut.nf=unescapexml(xlml_parsexmltag(d[0]).Format||"General"),XLMLFormatMap[ut.nf]&&(ut.nf=XLMLFormatMap[ut.nf]);for(var Ot=0;Ot!=392&&table_fmt[Ot]!=ut.nf;++Ot);if(Ot==392){for(Ot=57;Ot!=392;++Ot)if(table_fmt[Ot]==null){SSF_load(ut.nf,Ot);break}}break;case"column":if(g[g.length-1][0]!=="table")break;if(It=xlml_parsexmltag(d[0]),It.Hidden&&(It.hidden=!0,delete It.Hidden),It.Width&&(It.wpx=parseInt(It.Width,10)),!Wt&&It.wpx>10){Wt=!0,MDW=DEF_MDW;for(var jt=0;jt<Ht.length;++jt)Ht[jt]&&process_col(Ht[jt])}Wt&&process_col(It),Ht[It.Index-1||Ht.length]=It;for(var er=0;er<+It.Span;++er)Ht[Ht.length]=dup(It);break;case"namedrange":if(d[1]==="/")break;ct.Names||(ct.Names=[]);var Tt=parsexmltag(d[0]),ur={Name:Tt.Name,Ref:rc_to_a1(Tt.RefersTo.slice(1),{r:0,c:0})};ct.Sheets.length>0&&(ur.Sheet=ct.Sheets.length-1),ct.Names.push(ur);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?ot+=s.slice(ft,d.index):ft=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;ut.Interior=xlml_parsexmltag(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?xlml_set_prop(St,Et,s.slice(vt,d.index)):vt=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"))}else g.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"));xlml_clean_comment(Nt),Gt.push(Nt)}else g.push([d[3],!1]),_=xlml_parsexmltag(d[0]),Nt={a:_.Author};break;case"autofilter":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var cr=xlml_parsexmltag(d[0]);_e["!autofilter"]={ref:rc_to_a1(cr.Range).replace(/\$/g,"")},g.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&g.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((_=g.pop())[0]!==d[3])throw new Error("Bad state: "+_.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&g.push([d[3],!0]);break;case"null":break;default:if(g.length==0&&d[3]=="document"||g.length==0&&d[3]=="uof")return parse_fods(s,a);var hr=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:hr=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:hr=!1}break;case"excelworkbook":switch(d[3]){case"date1904":ct.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:hr=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:hr=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(s.slice(vt,d.index)){case"SheetHidden":xt.Hidden=1;break;case"SheetVeryHidden":xt.Hidden=2;break}else vt=d.index+d[0].length;break;case"header":_e["!margins"]||default_margins(_e["!margins"]={},"xlml"),isNaN(+parsexmltag(d[0]).Margin)||(_e["!margins"].header=+parsexmltag(d[0]).Margin);break;case"footer":_e["!margins"]||default_margins(_e["!margins"]={},"xlml"),isNaN(+parsexmltag(d[0]).Margin)||(_e["!margins"].footer=+parsexmltag(d[0]).Margin);break;case"pagemargins":var Yt=parsexmltag(d[0]);_e["!margins"]||default_margins(_e["!margins"]={},"xlml"),isNaN(+Yt.Top)||(_e["!margins"].top=+Yt.Top),isNaN(+Yt.Left)||(_e["!margins"].left=+Yt.Left),isNaN(+Yt.Right)||(_e["!margins"].right=+Yt.Right),isNaN(+Yt.Bottom)||(_e["!margins"].bottom=+Yt.Bottom);break;case"displayrighttoleft":ct.Views||(ct.Views=[]),ct.Views[0]||(ct.Views[0]={}),ct.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_e["!outline"]||(_e["!outline"]={}),_e["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_e["!outline"]||(_e["!outline"]={}),_e["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:hr=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:hr=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:hr=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:hr=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:hr=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:hr=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:hr=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:hr=!1}break;case"smarttags":break;default:hr=!1;break}if(hr||d[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?xlml_set_custprop(gt,Et,At,s.slice(vt,d.index)):(At=d,vt=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+g.join("|")}var Xt={};return!a.bookSheets&&!a.bookProps&&(Xt.Sheets=b),Xt.SheetNames=j,Xt.Workbook=ct,Xt.SSF=dup(table_fmt),Xt.Props=St,Xt.Custprops=gt,Xt}function parse_xlml(e,i){switch(fix_read_opts(i=i||{}),i.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),i);case"binary":case"buffer":case"file":return parse_xlml_xml(e,i);case"array":return parse_xlml_xml(a2s(e),i)}}function write_props_xlml(e,i){var a=[];return e.Props&&a.push(xlml_write_docprops(e.Props,i)),e.Custprops&&a.push(xlml_write_custprops(e.Props,e.Custprops)),a.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,i){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return i.cellXfs.forEach(function(s,o){var c=[];c.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[s.numFmtId])}));var h={"ss:ID":"s"+(21+o)};a.push(writextag("Style",c.join(""),h))}),writextag("Styles",a.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var i=e.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||a.push(write_name_xlml(o)))}return writextag("Names",a.join(""))}function write_ws_xlml_names(e,i,a,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var o=s.Workbook.Names,c=[],h=0;h<o.length;++h){var d=o[h];d.Sheet==a&&(d.Name.match(/^_xlfn\./)||c.push(write_name_xlml(d)))}return c.join("")}function write_ws_xlml_wsopts(e,i,a,s){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[a])if(s.Workbook.Sheets[a].Hidden)o.push(writextag("Visible",s.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<a&&!(s.Workbook.Sheets[c]&&!s.Workbook.Sheets[c].Hidden);++c);c==a&&o.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(writetag("ProtectContents","True")),e["!protect"].objects&&o.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&o.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?o.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&o.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(h){e["!protect"][h[0]]&&o.push("<"+h[1]+"/>")})),o.length==0?"":writextag("WorksheetOptions",o.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(i){var a=xlml_unfixstr(i.t||""),s=writextag("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",s,{"ss:Author":i.a})}).join("")}function write_ws_xlml_cell(e,i,a,s,o,c,h){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+escapexml(a1_to_rc(e.f,h))),e.F&&e.F.slice(0,i.length)==i){var g=decode_cell(e.F.slice(i.length+1));d["ss:ArrayRange"]="RC:R"+(g.r==h.r?"":"["+(g.r-h.r)+"]")+"C"+(g.c==h.c?"":"["+(g.c-h.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),a["!merges"])for(var _=a["!merges"],b=0;b!=_.length;++b)_[b].s.c!=h.c||_[b].s.r!=h.r||(_[b].e.c>_[b].s.c&&(d["ss:MergeAcross"]=_[b].e.c-_[b].s.c),_[b].e.r>_[b].s.r&&(d["ss:MergeDown"]=_[b].e.r-_[b].s.r));var j="",_e="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":j="Number",_e=String(e.v);break;case"b":j="Boolean",_e=e.v?"1":"0";break;case"e":j="Error",_e=BErr[e.v];break;case"d":j="DateTime",_e=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":j="String",_e=escapexlml(e.v||"");break}var et=get_cell_style(s.cellXfs,e,s);d["ss:StyleID"]="s"+(21+et),d["ss:Index"]=h.c+1;var rt=e.v!=null?_e:"",tt=e.t=="z"?"":'<Data ss:Type="'+j+'">'+rt+"</Data>";return(e.c||[]).length>0&&(tt+=write_ws_xlml_comment(e.c)),writextag("Cell",tt,d)}function write_ws_xlml_row(e,i){var a='<Row ss:Index="'+(e+1)+'"';return i&&(i.hpt&&!i.hpx&&(i.hpx=pt2px(i.hpt)),i.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+i.hpx+'"'),i.hidden&&(a+=' ss:Hidden="1"')),a+">"}function write_ws_xlml_table(e,i,a,s){if(!e["!ref"])return"";var o=safe_decode_range(e["!ref"]),c=e["!merges"]||[],h=0,d=[];e["!cols"]&&e["!cols"].forEach(function(it,nt){process_col(it);var at=!!it.width,st=col_obj_w(nt,it),dt={"ss:Index":nt+1};at&&(dt["ss:Width"]=width2px(st.width)),it.hidden&&(dt["ss:Hidden"]="1"),d.push(writextag("Column",null,dt))});for(var g=Array.isArray(e),_=o.s.r;_<=o.e.r;++_){for(var b=[write_ws_xlml_row(_,(e["!rows"]||[])[_])],j=o.s.c;j<=o.e.c;++j){var _e=!1;for(h=0;h!=c.length;++h)if(!(c[h].s.c>j)&&!(c[h].s.r>_)&&!(c[h].e.c<j)&&!(c[h].e.r<_)){(c[h].s.c!=j||c[h].s.r!=_)&&(_e=!0);break}if(!_e){var et={r:_,c:j},rt=encode_cell(et),tt=g?(e[_]||[])[j]:e[rt];b.push(write_ws_xlml_cell(tt,rt,e,i,a,s,et))}}b.push("</Row>"),b.length>2&&d.push(b.join(""))}return d.join("")}function write_ws_xlml(e,i,a){var s=[],o=a.SheetNames[e],c=a.Sheets[o],h=c?write_ws_xlml_names(c,i,e,a):"";return h.length>0&&s.push("<Names>"+h+"</Names>"),h=c?write_ws_xlml_table(c,i,e,a):"",h.length>0&&s.push("<Table>"+h+"</Table>"),s.push(write_ws_xlml_wsopts(c,i,e,a)),s.join("")}function write_xlml(e,i){i||(i={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF,i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(write_props_xlml(e,i)),a.push(write_wb_xlml()),a.push(""),a.push("");for(var s=0;s<e.SheetNames.length;++s)a.push(writextag("Worksheet",write_ws_xlml(s,i,e),{"ss:Name":escapexml(e.SheetNames[s])}));return a[2]=write_sty_xlml(e,i),a[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",a.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(e){var i={},a=e.content;if(a.l=28,i.AnsiUserType=a.read_shift(0,"lpstr-ansi"),i.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(a),a.length-a.l<=4)return i;var s=a.read_shift(4);if(s==0||s>40||(a.l-=4,i.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(s=a.read_shift(4),s!==1907505652)||(i.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(a),s=a.read_shift(4),s==0||s>40))return i;a.l-=4,i.Reserved2=a.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,i,a,s,o){var c=s,h=[],d=a.slice(a.l,a.l+c);if(o&&o.enc&&o.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:o.enc.insitu(d)}h.push(d),a.l+=c;for(var g=__readUInt16LE(a,a.l),_=XLSRecordEnum[g],b=0;_!=null&&CONTINUE_RT.indexOf(g)>-1;)c=__readUInt16LE(a,a.l+2),b=a.l+4,g==2066?b+=4:(g==2165||g==2175)&&(b+=12),d=a.slice(b,a.l+4+c),h.push(d),a.l+=4+c,_=XLSRecordEnum[g=__readUInt16LE(a,a.l)];var j=bconcat(h);prep_blob(j,0);var _e=0;j.lens=[];for(var et=0;et<h.length;++et)j.lens.push(_e),_e+=h[et].length;if(j.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+j.length+" < "+s;return i.f(j,j.length,o)}function safe_format_xf(e,i,a){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,i.cellNF&&(e.z=table_fmt[s])}catch(c){if(i.WTF)throw c}if(!i||i.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(s,e.v,{date1904:!!a,dateNF:i&&i.dateNF})}catch(c){if(i.WTF)throw c}if(i.cellDates&&s&&e.t=="n"&&fmt_is_date(table_fmt[s]||String(s))){var o=SSF_parse_date_code(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}}function make_cell(e,i,a){return{v:e,ixfe:i,t:a}}function parse_workbook(e,i){var a={opts:{}},s={},o=i.dense?[]:{},c={},h={},d=null,g=[],_="",b={},j,_e="",et,rt,tt,it,nt={},at=[],st,dt,lt=[],ut=[],ot={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ft={},pt=function(Pr){return Pr<8?XLSIcv[Pr]:Pr<64&&ut[Pr-8]||XLSIcv[Pr]},St=function(Pr,kr,Dr){var jr=kr.XF.data;if(!(!jr||!jr.patternType||!Dr||!Dr.cellStyles)){kr.s={},kr.s.patternType=jr.patternType;var Hr;(Hr=rgb2Hex(pt(jr.icvFore)))&&(kr.s.fgColor={rgb:Hr}),(Hr=rgb2Hex(pt(jr.icvBack)))&&(kr.s.bgColor={rgb:Hr})}},gt=function(Pr,kr,Dr){if(!($t>1)&&!(Dr.sheetRows&&Pr.r>=Dr.sheetRows)){if(Dr.cellStyles&&kr.XF&&kr.XF.data&&St(Pr,kr,Dr),delete kr.ixfe,delete kr.XF,j=Pr,_e=encode_cell(Pr),(!h||!h.s||!h.e)&&(h={s:{r:0,c:0},e:{r:0,c:0}}),Pr.r<h.s.r&&(h.s.r=Pr.r),Pr.c<h.s.c&&(h.s.c=Pr.c),Pr.r+1>h.e.r&&(h.e.r=Pr.r+1),Pr.c+1>h.e.c&&(h.e.c=Pr.c+1),Dr.cellFormula&&kr.f){for(var jr=0;jr<at.length;++jr)if(!(at[jr][0].s.c>Pr.c||at[jr][0].s.r>Pr.r)&&!(at[jr][0].e.c<Pr.c||at[jr][0].e.r<Pr.r)){kr.F=encode_range(at[jr][0]),(at[jr][0].s.c!=Pr.c||at[jr][0].s.r!=Pr.r)&&delete kr.f,kr.f&&(kr.f=""+stringify_formula(at[jr][1],h,Pr,yt,vt));break}}Dr.dense?(o[Pr.r]||(o[Pr.r]=[]),o[Pr.r][Pr.c]=kr):o[_e]=kr}},vt={enc:!1,sbcch:0,snames:[],sharedf:nt,arrayf:at,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!i&&!!i.cellStyles,WTF:!!i&&!!i.wtf};i.password&&(vt.password=i.password);var At,Gt=[],Nt=[],Ht=[],It=[],Wt=!1,yt=[];yt.SheetNames=vt.snames,yt.sharedf=vt.sharedf,yt.arrayf=vt.arrayf,yt.names=[],yt.XTI=[];var Dt=0,$t=0,_t=0,ht=[],ct=[],xt;vt.codepage=1200,set_cp(1200);for(var Et=!1;e.l<e.length-1;){var bt=e.l,Ct=e.read_shift(2);if(Ct===0&&Dt===10)break;var Ot=e.l===e.length?0:e.read_shift(2),jt=XLSRecordEnum[Ct];if(jt&&jt.f){if(i.bookSheets&&Dt===133&&Ct!==133)break;if(Dt=Ct,jt.r===2||jt.r==12){var er=e.read_shift(2);if(Ot-=2,!vt.enc&&er!==Ct&&((er&255)<<8|er>>8)!==Ct)throw new Error("rt mismatch: "+er+"!="+Ct);jt.r==12&&(e.l+=10,Ot-=10)}var Tt={};if(Ct===10?Tt=jt.f(e,Ot,vt):Tt=slurp(Ct,jt,e,Ot,vt),$t==0&&[9,521,1033,2057].indexOf(Dt)===-1)continue;switch(Ct){case 34:a.opts.Date1904=ot.WBProps.date1904=Tt;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(vt.enc||(e.l=0),vt.enc=Tt,!i.password)throw new Error("File is password-protected");if(Tt.valid==null)throw new Error("Encryption scheme unsupported");if(!Tt.valid)throw new Error("Password is incorrect");break;case 92:vt.lastuser=Tt;break;case 66:var ur=Number(Tt);switch(ur){case 21010:ur=1200;break;case 32768:ur=1e4;break;case 32769:ur=1252;break}set_cp(vt.codepage=ur),Et=!0;break;case 317:vt.rrtabid=Tt;break;case 25:vt.winlocked=Tt;break;case 439:a.opts.RefreshAll=Tt;break;case 12:a.opts.CalcCount=Tt;break;case 16:a.opts.CalcDelta=Tt;break;case 17:a.opts.CalcIter=Tt;break;case 13:a.opts.CalcMode=Tt;break;case 14:a.opts.CalcPrecision=Tt;break;case 95:a.opts.CalcSaveRecalc=Tt;break;case 15:vt.CalcRefMode=Tt;break;case 2211:a.opts.FullCalc=Tt;break;case 129:Tt.fDialog&&(o["!type"]="dialog"),Tt.fBelow||((o["!outline"]||(o["!outline"]={})).above=!0),Tt.fRight||((o["!outline"]||(o["!outline"]={})).left=!0);break;case 224:lt.push(Tt);break;case 430:yt.push([Tt]),yt[yt.length-1].XTI=[];break;case 35:case 547:yt[yt.length-1].push(Tt);break;case 24:case 536:xt={Name:Tt.Name,Ref:stringify_formula(Tt.rgce,h,null,yt,vt)},Tt.itab>0&&(xt.Sheet=Tt.itab-1),yt.names.push(xt),yt[0]||(yt[0]=[],yt[0].XTI=[]),yt[yt.length-1].push(Tt),Tt.Name=="_xlnm._FilterDatabase"&&Tt.itab>0&&Tt.rgce&&Tt.rgce[0]&&Tt.rgce[0][0]&&Tt.rgce[0][0][0]=="PtgArea3d"&&(ct[Tt.itab-1]={ref:encode_range(Tt.rgce[0][0][1][2])});break;case 22:vt.ExternCount=Tt;break;case 23:yt.length==0&&(yt[0]=[],yt[0].XTI=[]),yt[yt.length-1].XTI=yt[yt.length-1].XTI.concat(Tt),yt.XTI=yt.XTI.concat(Tt);break;case 2196:if(vt.biff<8)break;xt!=null&&(xt.Comment=Tt[1]);break;case 18:o["!protect"]=Tt;break;case 19:Tt!==0&&vt.WTF&&console.error("Password verifier: "+Tt);break;case 133:c[Tt.pos]=Tt,vt.snames.push(Tt.name);break;case 10:{if(--$t)break;if(h.e){if(h.e.r>0&&h.e.c>0){if(h.e.r--,h.e.c--,o["!ref"]=encode_range(h),i.sheetRows&&i.sheetRows<=h.e.r){var cr=h.e.r;h.e.r=i.sheetRows-1,o["!fullref"]=o["!ref"],o["!ref"]=encode_range(h),h.e.r=cr}h.e.r++,h.e.c++}Gt.length>0&&(o["!merges"]=Gt),Nt.length>0&&(o["!objects"]=Nt),Ht.length>0&&(o["!cols"]=Ht),It.length>0&&(o["!rows"]=It),ot.Sheets.push(ft)}_===""?b=o:s[_]=o,o=i.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(vt.biff===8&&(vt.biff={9:2,521:3,1033:4}[Ct]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Tt.BIFFVer]||8),vt.biffguess=Tt.BIFFVer==0,Tt.BIFFVer==0&&Tt.dt==4096&&(vt.biff=5,Et=!0,set_cp(vt.codepage=28591)),vt.biff==8&&Tt.BIFFVer==0&&Tt.dt==16&&(vt.biff=2),$t++)break;if(o=i.dense?[]:{},vt.biff<8&&!Et&&(Et=!0,set_cp(vt.codepage=i.codepage||1252)),vt.biff<5||Tt.BIFFVer==0&&Tt.dt==4096){_===""&&(_="Sheet1"),h={s:{r:0,c:0},e:{r:0,c:0}};var hr={pos:e.l-Ot,name:_};c[hr.pos]=hr,vt.snames.push(_)}else _=(c[bt]||{name:""}).name;Tt.dt==32&&(o["!type"]="chart"),Tt.dt==64&&(o["!type"]="macro"),Gt=[],Nt=[],vt.arrayf=at=[],Ht=[],It=[],Wt=!1,ft={Hidden:(c[bt]||{hs:0}).hs,name:_}}break;case 515:case 3:case 2:o["!type"]=="chart"&&(i.dense?(o[Tt.r]||[])[Tt.c]:o[encode_cell({c:Tt.c,r:Tt.r})])&&++Tt.c,st={ixfe:Tt.ixfe,XF:lt[Tt.ixfe]||{},v:Tt.val,t:"n"},_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Tt.c,r:Tt.r},st,i);break;case 5:case 517:st={ixfe:Tt.ixfe,XF:lt[Tt.ixfe],v:Tt.val,t:Tt.t},_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Tt.c,r:Tt.r},st,i);break;case 638:st={ixfe:Tt.ixfe,XF:lt[Tt.ixfe],v:Tt.rknum,t:"n"},_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Tt.c,r:Tt.r},st,i);break;case 189:for(var Yt=Tt.c;Yt<=Tt.C;++Yt){var Xt=Tt.rkrec[Yt-Tt.c][0];st={ixfe:Xt,XF:lt[Xt],v:Tt.rkrec[Yt-Tt.c][1],t:"n"},_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Yt,r:Tt.r},st,i)}break;case 6:case 518:case 1030:{if(Tt.val=="String"){d=Tt;break}if(st=make_cell(Tt.val,Tt.cell.ixfe,Tt.tt),st.XF=lt[st.ixfe],i.cellFormula){var Ft=Tt.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var Ut=Ft[0][0][1][0],qt=Ft[0][0][1][1],Jt=encode_cell({r:Ut,c:qt});nt[Jt]?st.f=""+stringify_formula(Tt.formula,h,Tt.cell,yt,vt):st.F=((i.dense?(o[Ut]||[])[qt]:o[Jt])||{}).F}else st.f=""+stringify_formula(Tt.formula,h,Tt.cell,yt,vt)}_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt(Tt.cell,st,i),d=Tt}break;case 7:case 519:if(d)d.val=Tt,st=make_cell(Tt,d.cell.ixfe,"s"),st.XF=lt[st.ixfe],i.cellFormula&&(st.f=""+stringify_formula(d.formula,h,d.cell,yt,vt)),_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt(d.cell,st,i),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{at.push(Tt);var dr=encode_cell(Tt[0].s);if(et=i.dense?(o[Tt[0].s.r]||[])[Tt[0].s.c]:o[dr],i.cellFormula&&et){if(!d||!dr||!et)break;et.f=""+stringify_formula(Tt[1],h,Tt[0],yt,vt),et.F=encode_range(Tt[0])}}break;case 1212:{if(!i.cellFormula)break;if(_e){if(!d)break;nt[encode_cell(d.cell)]=Tt[0],et=i.dense?(o[d.cell.r]||[])[d.cell.c]:o[encode_cell(d.cell)],(et||{}).f=""+stringify_formula(Tt[0],h,j,yt,vt)}}break;case 253:st=make_cell(g[Tt.isst].t,Tt.ixfe,"s"),g[Tt.isst].h&&(st.h=g[Tt.isst].h),st.XF=lt[st.ixfe],_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Tt.c,r:Tt.r},st,i);break;case 513:i.sheetStubs&&(st={ixfe:Tt.ixfe,XF:lt[Tt.ixfe],t:"z"},_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Tt.c,r:Tt.r},st,i));break;case 190:if(i.sheetStubs)for(var vr=Tt.c;vr<=Tt.C;++vr){var _r=Tt.ixfe[vr-Tt.c];st={ixfe:_r,XF:lt[_r],t:"z"},_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:vr,r:Tt.r},st,i)}break;case 214:case 516:case 4:st=make_cell(Tt.val,Tt.ixfe,"s"),st.XF=lt[st.ixfe],_t>0&&(st.z=ht[st.ixfe>>8&63]),safe_format_xf(st,i,a.opts.Date1904),gt({c:Tt.c,r:Tt.r},st,i);break;case 0:case 512:$t===1&&(h=Tt);break;case 252:g=Tt;break;case 1054:if(vt.biff==4){ht[_t++]=Tt[1];for(var Zt=0;Zt<_t+163&&table_fmt[Zt]!=Tt[1];++Zt);Zt>=163&&SSF_load(Tt[1],_t+163)}else SSF_load(Tt[1],Tt[0]);break;case 30:{ht[_t++]=Tt;for(var Er=0;Er<_t+163&&table_fmt[Er]!=Tt;++Er);Er>=163&&SSF_load(Tt,_t+163)}break;case 229:Gt=Gt.concat(Tt);break;case 93:Nt[Tt.cmo[0]]=vt.lastobj=Tt;break;case 438:vt.lastobj.TxO=Tt;break;case 127:vt.lastobj.ImData=Tt;break;case 440:for(it=Tt[0].s.r;it<=Tt[0].e.r;++it)for(tt=Tt[0].s.c;tt<=Tt[0].e.c;++tt)et=i.dense?(o[it]||[])[tt]:o[encode_cell({c:tt,r:it})],et&&(et.l=Tt[1]);break;case 2048:for(it=Tt[0].s.r;it<=Tt[0].e.r;++it)for(tt=Tt[0].s.c;tt<=Tt[0].e.c;++tt)et=i.dense?(o[it]||[])[tt]:o[encode_cell({c:tt,r:it})],et&&et.l&&(et.l.Tooltip=Tt[1]);break;case 28:{if(vt.biff<=5&&vt.biff>=2)break;et=i.dense?(o[Tt[0].r]||[])[Tt[0].c]:o[encode_cell(Tt[0])];var Sr=Nt[Tt[2]];et||(i.dense?(o[Tt[0].r]||(o[Tt[0].r]=[]),et=o[Tt[0].r][Tt[0].c]={t:"z"}):et=o[encode_cell(Tt[0])]={t:"z"},h.e.r=Math.max(h.e.r,Tt[0].r),h.s.r=Math.min(h.s.r,Tt[0].r),h.e.c=Math.max(h.e.c,Tt[0].c),h.s.c=Math.min(h.s.c,Tt[0].c)),et.c||(et.c=[]),rt={a:Tt[1],t:Sr.TxO.t},et.c.push(rt)}break;case 2173:update_xfext(lt[Tt.ixfe],Tt.ext);break;case 125:{if(!vt.cellStyles)break;for(;Tt.e>=Tt.s;)Ht[Tt.e--]={width:Tt.w/256,level:Tt.level||0,hidden:!!(Tt.flags&1)},Wt||(Wt=!0,find_mdw_colw(Tt.w/256)),process_col(Ht[Tt.e+1])}break;case 520:{var Vr={};Tt.level!=null&&(It[Tt.r]=Vr,Vr.level=Tt.level),Tt.hidden&&(It[Tt.r]=Vr,Vr.hidden=!0),Tt.hpt&&(It[Tt.r]=Vr,Vr.hpt=Tt.hpt,Vr.hpx=pt2px(Tt.hpt))}break;case 38:case 39:case 40:case 41:o["!margins"]||default_margins(o["!margins"]={}),o["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ct]]=Tt;break;case 161:o["!margins"]||default_margins(o["!margins"]={}),o["!margins"].header=Tt.header,o["!margins"].footer=Tt.footer;break;case 574:Tt.RTL&&(ot.Views[0].RTL=!0);break;case 146:ut=Tt;break;case 2198:At=Tt;break;case 140:dt=Tt;break;case 442:_?ft.CodeName=Tt||ft.name:ot.WBProps.CodeName=Tt||"ThisWorkbook";break}}else jt||console.error("Missing Info for XLS Record 0x"+Ct.toString(16)),e.l+=Ot}return a.SheetNames=keys(c).sort(function(Nr,Pr){return Number(Nr)-Number(Pr)}).map(function(Nr){return c[Nr].name}),i.bookSheets||(a.Sheets=s),!a.SheetNames.length&&b["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=b)):a.Preamble=b,a.Sheets&&ct.forEach(function(Nr,Pr){a.Sheets[a.SheetNames[Pr]]["!autofilter"]=Nr}),a.Strings=g,a.SSF=dup(table_fmt),vt.enc&&(a.Encryption=vt.enc),At&&(a.Themes=At),a.Metadata={},dt!==void 0&&(a.Metadata.Country=dt),yt.names.length>0&&(ot.Names=yt.names),a.Workbook=ot,a}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,i,a){var s=CFB.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var o=parse_PropertySetStream(s,DocSummaryPIDDSI,PSCLSID.DSI);for(var c in o)i[c]=o[c]}catch(_){if(a.WTF)throw _}var h=CFB.find(e,"/!SummaryInformation");if(h&&h.size>0)try{var d=parse_PropertySetStream(h,SummaryPIDSI,PSCLSID.SI);for(var g in d)i[g]==null&&(i[g]=d[g])}catch(_){if(a.WTF)throw _}i.HeadingPairs&&i.TitlesOfParts&&(load_props_pairs(i.HeadingPairs,i.TitlesOfParts,i,a),delete i.HeadingPairs,delete i.TitlesOfParts)}function write_xls_props(e,i){var a=[],s=[],o=[],c=0,h,d=evert_key(DocSummaryPIDDSI,"n"),g=evert_key(SummaryPIDSI,"n");if(e.Props)for(h=keys(e.Props),c=0;c<h.length;++c)(Object.prototype.hasOwnProperty.call(d,h[c])?a:Object.prototype.hasOwnProperty.call(g,h[c])?s:o).push([h[c],e.Props[h[c]]]);if(e.Custprops)for(h=keys(e.Custprops),c=0;c<h.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},h[c])||(Object.prototype.hasOwnProperty.call(d,h[c])?a:Object.prototype.hasOwnProperty.call(g,h[c])?s:o).push([h[c],e.Custprops[h[c]]]);var _=[];for(c=0;c<o.length;++c)XLSPSSkip.indexOf(o[c][0])>-1||PseudoPropsPairs.indexOf(o[c][0])>-1||o[c][1]!=null&&_.push(o[c]);s.length&&CFB.utils.cfb_add(i,"/SummaryInformation",write_PropertySetStream(s,PSCLSID.SI,g,SummaryPIDSI)),(a.length||_.length)&&CFB.utils.cfb_add(i,"/DocumentSummaryInformation",write_PropertySetStream(a,PSCLSID.DSI,d,DocSummaryPIDDSI,_.length?_:null,PSCLSID.UDI))}function parse_xlscfb(e,i){i||(i={}),fix_read_opts(i),reset_cp(),i.codepage&&set_ansi(i.codepage);var a,s;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");a=CFB.find(e,"!CompObj"),s=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(i.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),s={content:e}}var o,c;if(a&&parse_compobj(a),i.bookProps&&!i.bookSheets)o={};else{var h=has_buf?"buffer":"array";if(s&&s.content)o=parse_workbook(s.content,i);else if((c=CFB.find(e,"PerfectOffice_MAIN"))&&c.content)o=WK_.to_workbook(c.content,(i.type=h,i));else if((c=CFB.find(e,"NativeContent_MAIN"))&&c.content)o=WK_.to_workbook(c.content,(i.type=h,i));else throw(c=CFB.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(o.vbaraw=make_vba_xls(e))}var d={};return e.FullPaths&&parse_xls_props(e,d,i),o.Props=o.Custprops=d,i.bookFiles&&(o.cfb=e),o}function write_xlscfb(e,i){var a=i||{},s=CFB.utils.cfb_new({root:"R"}),o="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":o="/Workbook",a.biff=8;break;case"biff5":o="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return CFB.utils.cfb_add(s,o,write_biff_buf(e,a)),a.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,s),a.biff==8&&e.vbaraw&&fill_vba_xls(s,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,i,a,s){var o=i;if(!isNaN(o)){var c=s||(a||[]).length||0,h=e.next(4);h.write_shift(2,o),h.write_shift(2,c),c>0&&is_buf(a)&&e.push(a)}}function write_biff_continue(e,i,a,s){var o=(a||[]).length||0;if(o<=8224)return write_biff_rec(e,i,a,o);var c=i;if(!isNaN(c)){for(var h=a.parts||[],d=0,g=0,_=0;_+(h[d]||8224)<=8224;)_+=h[d]||8224,d++;var b=e.next(4);for(b.write_shift(2,c),b.write_shift(2,_),e.push(a.slice(g,g+_)),g+=_;g<o;){for(b=e.next(4),b.write_shift(2,60),_=0;_+(h[d]||8224)<=8224;)_+=h[d]||8224,d++;b.write_shift(2,_),e.push(a.slice(g,g+_)),g+=_}}}function write_BIFF2Cell(e,i,a){return e||(e=new_buf(7)),e.write_shift(2,i),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,i,a,s){var o=new_buf(9);return write_BIFF2Cell(o,e,i),write_Bes(a,s||"b",o),o}function write_BIFF2LABEL(e,i,a){var s=new_buf(8+2*a.length);return write_BIFF2Cell(s,e,i),s.write_shift(1,a.length),s.write_shift(a.length,a,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function write_ws_biff2_cell(e,i,a,s){if(i.v!=null)switch(i.t){case"d":case"n":var o=i.t=="d"?datenum(parseDate(i.v)):i.v;o==(o|0)&&o>=0&&o<65536?write_biff_rec(e,2,write_BIFF2INT(a,s,o)):write_biff_rec(e,3,write_BIFF2NUM(a,s,o));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(a,s,i.v,i.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(a,s,(i.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,a,s))}function write_ws_biff2(e,i,a,s){var o=Array.isArray(i),c=safe_decode_range(i["!ref"]||"A1"),h,d="",g=[];if(c.e.c>255||c.e.r>16383){if(s.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),h=encode_range(c)}for(var _=c.s.r;_<=c.e.r;++_){d=encode_row(_);for(var b=c.s.c;b<=c.e.c;++b){_===c.s.r&&(g[b]=encode_col(b)),h=g[b]+d;var j=o?(i[_]||[])[b]:i[h];j&&write_ws_biff2_cell(e,j,_,b)}}}function write_biff2_buf(e,i){for(var a=i||{},s=buf_array(),o=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==a.sheet&&(o=c);if(o==0&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return write_biff_rec(s,a.biff==4?1033:a.biff==3?521:9,write_BOF(e,16,a)),write_ws_biff2(s,e.Sheets[e.SheetNames[o]],o,a),write_biff_rec(s,10),s.end()}function write_FONTS_biff8(e,i,a){write_biff_rec(e,49,write_Font({sz:12,name:"Arial"},a))}function write_FMTS_biff8(e,i,a){i&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)i[o]!=null&&write_biff_rec(e,1054,write_Format(o,i[o],a))})}function write_FEAT(e,i){var a=new_buf(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),write_biff_rec(e,2151,a),a=new_buf(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),write_Ref8U(safe_decode_range(i["!ref"]||"A1"),a),a.write_shift(4,4),write_biff_rec(e,2152,a)}function write_CELLXFS_biff8(e,i){for(var a=0;a<16;++a)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,i));i.cellXfs.forEach(function(s){write_biff_rec(e,224,write_XF(s,0,i))})}function write_ws_biff8_hlinks(e,i){for(var a=0;a<i["!links"].length;++a){var s=i["!links"][a];write_biff_rec(e,440,write_HLink(s)),s[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(s))}delete i["!links"]}function write_ws_cols_biff8(e,i){if(i){var a=0;i.forEach(function(s,o){++a<=256&&s&&write_biff_rec(e,125,write_ColInfo(col_obj_w(o,s),o))})}}function write_ws_biff8_cell(e,i,a,s,o){var c=16+get_cell_style(o.cellXfs,i,o);if(i.v==null&&!i.bf){write_biff_rec(e,513,write_XLSCell(a,s,c));return}if(i.bf)write_biff_rec(e,6,write_Formula(i,a,s,o,c));else switch(i.t){case"d":case"n":var h=i.t=="d"?datenum(parseDate(i.v)):i.v;write_biff_rec(e,515,write_Number(a,s,h,c));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(a,s,i.v,c,o,i.t));break;case"s":case"str":if(o.bookSST){var d=get_sst_id(o.Strings,i.v,o.revStrings);write_biff_rec(e,253,write_LabelSst(a,s,d,c))}else write_biff_rec(e,516,write_Label(a,s,(i.v||"").slice(0,255),c,o));break;default:write_biff_rec(e,513,write_XLSCell(a,s,c))}}function write_ws_biff8(e,i,a){var s=buf_array(),o=a.SheetNames[e],c=a.Sheets[o]||{},h=(a||{}).Workbook||{},d=(h.Sheets||[])[e]||{},g=Array.isArray(c),_=i.biff==8,b,j="",_e=[],et=safe_decode_range(c["!ref"]||"A1"),rt=_?65536:16384;if(et.e.c>255||et.e.r>=rt){if(i.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");et.e.c=Math.min(et.e.c,255),et.e.r=Math.min(et.e.c,rt-1)}write_biff_rec(s,2057,write_BOF(a,16,i)),write_biff_rec(s,13,writeuint16(1)),write_biff_rec(s,12,writeuint16(100)),write_biff_rec(s,15,writebool(!0)),write_biff_rec(s,17,writebool(!1)),write_biff_rec(s,16,write_Xnum(.001)),write_biff_rec(s,95,writebool(!0)),write_biff_rec(s,42,writebool(!1)),write_biff_rec(s,43,writebool(!1)),write_biff_rec(s,130,writeuint16(1)),write_biff_rec(s,128,write_Guts()),write_biff_rec(s,131,writebool(!1)),write_biff_rec(s,132,writebool(!1)),_&&write_ws_cols_biff8(s,c["!cols"]),write_biff_rec(s,512,write_Dimensions(et,i)),_&&(c["!links"]=[]);for(var tt=et.s.r;tt<=et.e.r;++tt){j=encode_row(tt);for(var it=et.s.c;it<=et.e.c;++it){tt===et.s.r&&(_e[it]=encode_col(it)),b=_e[it]+j;var nt=g?(c[tt]||[])[it]:c[b];nt&&(write_ws_biff8_cell(s,nt,tt,it,i),_&&nt.l&&c["!links"].push([b,nt.l]))}}var at=d.CodeName||d.name||o;return _&&write_biff_rec(s,574,write_Window2((h.Views||[])[0])),_&&(c["!merges"]||[]).length&&write_biff_rec(s,229,write_MergeCells(c["!merges"])),_&&write_ws_biff8_hlinks(s,c),write_biff_rec(s,442,write_XLUnicodeString(at)),_&&write_FEAT(s,c),write_biff_rec(s,10),s.end()}function write_biff8_global(e,i,a){var s=buf_array(),o=(e||{}).Workbook||{},c=o.Sheets||[],h=o.WBProps||{},d=a.biff==8,g=a.biff==5;if(write_biff_rec(s,2057,write_BOF(e,5,a)),a.bookType=="xla"&&write_biff_rec(s,135),write_biff_rec(s,225,d?writeuint16(1200):null),write_biff_rec(s,193,writezeroes(2)),g&&write_biff_rec(s,191),g&&write_biff_rec(s,192),write_biff_rec(s,226),write_biff_rec(s,92,write_WriteAccess("SheetJS",a)),write_biff_rec(s,66,writeuint16(d?1200:1252)),d&&write_biff_rec(s,353,writeuint16(0)),d&&write_biff_rec(s,448),write_biff_rec(s,317,write_RRTabId(e.SheetNames.length)),d&&e.vbaraw&&write_biff_rec(s,211),d&&e.vbaraw){var _=h.CodeName||"ThisWorkbook";write_biff_rec(s,442,write_XLUnicodeString(_))}write_biff_rec(s,156,writeuint16(17)),write_biff_rec(s,25,writebool(!1)),write_biff_rec(s,18,writebool(!1)),write_biff_rec(s,19,writeuint16(0)),d&&write_biff_rec(s,431,writebool(!1)),d&&write_biff_rec(s,444,writeuint16(0)),write_biff_rec(s,61,write_Window1()),write_biff_rec(s,64,writebool(!1)),write_biff_rec(s,141,writeuint16(0)),write_biff_rec(s,34,writebool(safe1904(e)=="true")),write_biff_rec(s,14,writebool(!0)),d&&write_biff_rec(s,439,writebool(!1)),write_biff_rec(s,218,writeuint16(0)),write_FONTS_biff8(s,e,a),write_FMTS_biff8(s,e.SSF,a),write_CELLXFS_biff8(s,a),d&&write_biff_rec(s,352,writebool(!1));var b=s.end(),j=buf_array();d&&write_biff_rec(j,140,write_Country()),d&&a.Strings&&write_biff_continue(j,252,write_SST(a.Strings)),write_biff_rec(j,10);var _e=j.end(),et=buf_array(),rt=0,tt=0;for(tt=0;tt<e.SheetNames.length;++tt)rt+=(d?12:11)+(d?2:1)*e.SheetNames[tt].length;var it=b.length+rt+_e.length;for(tt=0;tt<e.SheetNames.length;++tt){var nt=c[tt]||{};write_biff_rec(et,133,write_BoundSheet8({pos:it,hs:nt.Hidden||0,dt:0,name:e.SheetNames[tt]},a)),it+=i[tt].length}var at=et.end();if(rt!=at.length)throw new Error("BS8 "+rt+" != "+at.length);var st=[];return b.length&&st.push(b),at.length&&st.push(at),_e.length&&st.push(_e),bconcat(st)}function write_biff8_buf(e,i){var a=i||{},s=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),a.revssf=evert_num(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,fix_write_opts(a),a.cellXfs=[],get_cell_style(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)s[s.length]=write_ws_biff8(o,a,e);return s.unshift(write_biff8_global(e,s,a)),bconcat(s)}function write_biff_buf(e,i){for(var a=0;a<=e.SheetNames.length;++a){var s=e.Sheets[e.SheetNames[a]];if(!(!s||!s["!ref"])){var o=decode_range(s["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var c=i||{};switch(c.biff||2){case 8:case 5:return write_biff8_buf(e,i);case 4:case 3:case 2:return write_biff2_buf(e,i)}throw new Error("invalid type "+c.bookType+" for BIFF")}function html_to_sheet(e,i){var a=i||{},s=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var o=e.match(/<table/i);if(!o)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),h=o.index,d=c&&c.index||e.length,g=split_regex(e.slice(h,d),/(:?<tr[^>]*>)/i,"<tr>"),_=-1,b=0,j=0,_e=0,et={s:{r:1e7,c:1e7},e:{r:0,c:0}},rt=[];for(h=0;h<g.length;++h){var tt=g[h].trim(),it=tt.slice(0,3).toLowerCase();if(it=="<tr"){if(++_,a.sheetRows&&a.sheetRows<=_){--_;break}b=0;continue}if(!(it!="<td"&&it!="<th")){var nt=tt.split(/<\/t[dh]>/i);for(d=0;d<nt.length;++d){var at=nt[d].trim();if(at.match(/<t[dh]/i)){for(var st=at,dt=0;st.charAt(0)=="<"&&(dt=st.indexOf(">"))>-1;)st=st.slice(dt+1);for(var lt=0;lt<rt.length;++lt){var ut=rt[lt];ut.s.c==b&&ut.s.r<_&&_<=ut.e.r&&(b=ut.e.c+1,lt=-1)}var ot=parsexmltag(at.slice(0,at.indexOf(">")));_e=ot.colspan?+ot.colspan:1,((j=+ot.rowspan)>1||_e>1)&&rt.push({s:{r:_,c:b},e:{r:_+(j||1)-1,c:b+_e-1}});var ft=ot.t||ot["data-t"]||"";if(!st.length){b+=_e;continue}if(st=htmldecode(st),et.s.r>_&&(et.s.r=_),et.e.r<_&&(et.e.r=_),et.s.c>b&&(et.s.c=b),et.e.c<b&&(et.e.c=b),!st.length){b+=_e;continue}var pt={t:"s",v:st};a.raw||!st.trim().length||ft=="s"||(st==="TRUE"?pt={t:"b",v:!0}:st==="FALSE"?pt={t:"b",v:!1}:isNaN(fuzzynum(st))?isNaN(fuzzydate(st).getDate())||(pt={t:"d",v:parseDate(st)},a.cellDates||(pt={t:"n",v:datenum(pt.v)}),pt.z=a.dateNF||table_fmt[14]):pt={t:"n",v:fuzzynum(st)}),a.dense?(s[_]||(s[_]=[]),s[_][b]=pt):s[encode_cell({r:_,c:b})]=pt,b+=_e}}}}return s["!ref"]=encode_range(et),rt.length&&(s["!merges"]=rt),s}function make_html_row(e,i,a,s){for(var o=e["!merges"]||[],c=[],h=i.s.c;h<=i.e.c;++h){for(var d=0,g=0,_=0;_<o.length;++_)if(!(o[_].s.r>a||o[_].s.c>h)&&!(o[_].e.r<a||o[_].e.c<h)){if(o[_].s.r<a||o[_].s.c<h){d=-1;break}d=o[_].e.r-o[_].s.r+1,g=o[_].e.c-o[_].s.c+1;break}if(!(d<0)){var b=encode_cell({r:a,c:h}),j=s.dense?(e[a]||[])[h]:e[b],_e=j&&j.v!=null&&(j.h||escapehtml(j.w||(format_cell(j),j.w)||""))||"",et={};d>1&&(et.rowspan=d),g>1&&(et.colspan=g),s.editable?_e='<span contenteditable="true">'+_e+"</span>":j&&(et["data-t"]=j&&j.t||"z",j.v!=null&&(et["data-v"]=j.v),j.z!=null&&(et["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(_e='<a href="'+j.l.Target+'">'+_e+"</a>")),et.id=(s.id||"sjs")+"-"+b,c.push(writextag("td",_e,et))}}var rt="<tr>";return rt+c.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,i){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return sheet_to_workbook(html_to_sheet(a[0],i),i);var s=book_new();return a.forEach(function(o,c){book_append_sheet(s,html_to_sheet(o,i),"Sheet"+(c+1))}),s}function make_html_preamble(e,i,a){var s=[];return s.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function sheet_to_html(e,i){var a=i||{},s=a.header!=null?a.header:HTML_BEGIN,o=a.footer!=null?a.footer:HTML_END,c=[s],h=decode_range(e["!ref"]);a.dense=Array.isArray(e),c.push(make_html_preamble(e,h,a));for(var d=h.s.r;d<=h.e.r;++d)c.push(make_html_row(e,h,d,a));return c.push("</table>"+o),c.join("")}function sheet_add_dom(e,i,a){var s=a||{},o=0,c=0;if(s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var h=typeof s.origin=="string"?decode_cell(s.origin):s.origin;o=h.r,c=h.c}var d=i.getElementsByTagName("tr"),g=Math.min(s.sheetRows||1e7,d.length),_={s:{r:0,c:0},e:{r:o,c}};if(e["!ref"]){var b=decode_range(e["!ref"]);_.s.r=Math.min(_.s.r,b.s.r),_.s.c=Math.min(_.s.c,b.s.c),_.e.r=Math.max(_.e.r,b.e.r),_.e.c=Math.max(_.e.c,b.e.c),o==-1&&(_.e.r=o=b.e.r+1)}var j=[],_e=0,et=e["!rows"]||(e["!rows"]=[]),rt=0,tt=0,it=0,nt=0,at=0,st=0;for(e["!cols"]||(e["!cols"]=[]);rt<d.length&&tt<g;++rt){var dt=d[rt];if(is_dom_element_hidden(dt)){if(s.display)continue;et[tt]={hidden:!0}}var lt=dt.children;for(it=nt=0;it<lt.length;++it){var ut=lt[it];if(!(s.display&&is_dom_element_hidden(ut))){var ot=ut.hasAttribute("data-v")?ut.getAttribute("data-v"):ut.hasAttribute("v")?ut.getAttribute("v"):htmldecode(ut.innerHTML),ft=ut.getAttribute("data-z")||ut.getAttribute("z");for(_e=0;_e<j.length;++_e){var pt=j[_e];pt.s.c==nt+c&&pt.s.r<tt+o&&tt+o<=pt.e.r&&(nt=pt.e.c+1-c,_e=-1)}st=+ut.getAttribute("colspan")||1,((at=+ut.getAttribute("rowspan")||1)>1||st>1)&&j.push({s:{r:tt+o,c:nt+c},e:{r:tt+o+(at||1)-1,c:nt+c+(st||1)-1}});var St={t:"s",v:ot},gt=ut.getAttribute("data-t")||ut.getAttribute("t")||"";ot!=null&&(ot.length==0?St.t=gt||"z":s.raw||ot.trim().length==0||gt=="s"||(ot==="TRUE"?St={t:"b",v:!0}:ot==="FALSE"?St={t:"b",v:!1}:isNaN(fuzzynum(ot))?isNaN(fuzzydate(ot).getDate())||(St={t:"d",v:parseDate(ot)},s.cellDates||(St={t:"n",v:datenum(St.v)}),St.z=s.dateNF||table_fmt[14]):St={t:"n",v:fuzzynum(ot)})),St.z===void 0&&ft!=null&&(St.z=ft);var vt="",At=ut.getElementsByTagName("A");if(At&&At.length)for(var Gt=0;Gt<At.length&&!(At[Gt].hasAttribute("href")&&(vt=At[Gt].getAttribute("href"),vt.charAt(0)!="#"));++Gt);vt&&vt.charAt(0)!="#"&&(St.l={Target:vt}),s.dense?(e[tt+o]||(e[tt+o]=[]),e[tt+o][nt+c]=St):e[encode_cell({c:nt+c,r:tt+o})]=St,_.e.c<nt+c&&(_.e.c=nt+c),nt+=st}}++tt}return j.length&&(e["!merges"]=(e["!merges"]||[]).concat(j)),_.e.r=Math.max(_.e.r,tt-1+o),e["!ref"]=encode_range(_),tt>=g&&(e["!fullref"]=encode_range((_.e.r=d.length-rt+tt-1+o,_))),e}function parse_dom_table(e,i){var a=i||{},s=a.dense?[]:{};return sheet_add_dom(s,e,i)}function table_to_book(e,i){return sheet_to_workbook(parse_dom_table(e,i),i)}function is_dom_element_hidden(e){var i="",a=get_get_computed_style_function(e);return a&&(i=a(e).getPropertyValue("display")),i||(i=e.style&&e.style.display),i==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var i=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,o){return Array(parseInt(o,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=unescapexml(i.replace(/<[^>]*>/g,""));return[a]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,i){var a=i||{},s=xlml_normalize(e),o=[],c,h,d={name:""},g="",_=0,b,j,_e={},et=[],rt=a.dense?[]:{},tt,it,nt={value:""},at="",st=0,dt=[],lt=-1,ut=-1,ot={s:{r:1e6,c:1e7},e:{r:0,c:0}},ft=0,pt={},St=[],gt={},vt=0,At=0,Gt=[],Nt=1,Ht=1,It=[],Wt={Names:[]},yt={},Dt=["",""],$t=[],_t={},ht="",ct=0,xt=!1,Et=!1,bt=0;for(xlmlregex.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");tt=xlmlregex.exec(s);)switch(tt[3]=tt[3].replace(/_.*$/,"")){case"table":case"":tt[1]==="/"?(ot.e.c>=ot.s.c&&ot.e.r>=ot.s.r?rt["!ref"]=encode_range(ot):rt["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=ot.e.r&&(rt["!fullref"]=rt["!ref"],ot.e.r=a.sheetRows-1,rt["!ref"]=encode_range(ot)),St.length&&(rt["!merges"]=St),Gt.length&&(rt["!rows"]=Gt),b.name=b.||b.name,typeof JSON<"u"&&JSON.stringify(b),et.push(b.name),_e[b.name]=rt,Et=!1):tt[0].charAt(tt[0].length-2)!=="/"&&(b=parsexmltag(tt[0],!1),lt=ut=-1,ot.s.r=ot.s.c=1e7,ot.e.r=ot.e.c=0,rt=a.dense?[]:{},St=[],Gt=[],Et=!0);break;case"table-row-group":tt[1]==="/"?--ft:++ft;break;case"table-row":case"":if(tt[1]==="/"){lt+=Nt,Nt=1;break}if(j=parsexmltag(tt[0],!1),j.?lt=j.-1:lt==-1&&(lt=0),Nt=+j["number-rows-repeated"]||1,Nt<10)for(bt=0;bt<Nt;++bt)ft>0&&(Gt[lt+bt]={level:ft});ut=-1;break;case"covered-table-cell":tt[1]!=="/"&&++ut,a.sheetStubs&&(a.dense?(rt[lt]||(rt[lt]=[]),rt[lt][ut]={t:"z"}):rt[encode_cell({r:lt,c:ut})]={t:"z"}),at="",dt=[];break;case"table-cell":case"":if(tt[0].charAt(tt[0].length-2)==="/")++ut,nt=parsexmltag(tt[0],!1),Ht=parseInt(nt["number-columns-repeated"]||"1",10),it={t:"z",v:null},nt.formula&&a.cellFormula!=!1&&(it.f=ods_to_csf_formula(unescapexml(nt.formula))),(nt.||nt["value-type"])=="string"&&(it.t="s",it.v=unescapexml(nt["string-value"]||""),a.dense?(rt[lt]||(rt[lt]=[]),rt[lt][ut]=it):rt[encode_cell({r:lt,c:ut})]=it),ut+=Ht-1;else if(tt[1]!=="/"){++ut,at="",st=0,dt=[],Ht=1;var Ct=Nt?lt+Nt-1:lt;if(ut>ot.e.c&&(ot.e.c=ut),ut<ot.s.c&&(ot.s.c=ut),lt<ot.s.r&&(ot.s.r=lt),Ct>ot.e.r&&(ot.e.r=Ct),nt=parsexmltag(tt[0],!1),$t=[],_t={},it={t:nt.||nt["value-type"],v:null},a.cellFormula)if(nt.formula&&(nt.formula=unescapexml(nt.formula)),nt["number-matrix-columns-spanned"]&&nt["number-matrix-rows-spanned"]&&(vt=parseInt(nt["number-matrix-rows-spanned"],10)||0,At=parseInt(nt["number-matrix-columns-spanned"],10)||0,gt={s:{r:lt,c:ut},e:{r:lt+vt-1,c:ut+At-1}},it.F=encode_range(gt),It.push([gt,it.F])),nt.formula)it.f=ods_to_csf_formula(nt.formula);else for(bt=0;bt<It.length;++bt)lt>=It[bt][0].s.r&&lt<=It[bt][0].e.r&&ut>=It[bt][0].s.c&&ut<=It[bt][0].e.c&&(it.F=It[bt][1]);switch((nt["number-columns-spanned"]||nt["number-rows-spanned"])&&(vt=parseInt(nt["number-rows-spanned"],10)||0,At=parseInt(nt["number-columns-spanned"],10)||0,gt={s:{r:lt,c:ut},e:{r:lt+vt-1,c:ut+At-1}},St.push(gt)),nt["number-columns-repeated"]&&(Ht=parseInt(nt["number-columns-repeated"],10)),it.t){case"boolean":it.t="b",it.v=parsexmlbool(nt["boolean-value"]);break;case"float":it.t="n",it.v=parseFloat(nt.value);break;case"percentage":it.t="n",it.v=parseFloat(nt.value);break;case"currency":it.t="n",it.v=parseFloat(nt.value);break;case"date":it.t="d",it.v=parseDate(nt["date-value"]),a.cellDates||(it.t="n",it.v=datenum(it.v)),it.z="m/d/yy";break;case"time":it.t="n",it.v=parse_isodur(nt["time-value"])/86400,a.cellDates&&(it.t="d",it.v=numdate(it.v)),it.z="HH:MM:SS";break;case"number":it.t="n",it.v=parseFloat(nt.);break;default:if(it.t==="string"||it.t==="text"||!it.t)it.t="s",nt["string-value"]!=null&&(at=unescapexml(nt["string-value"]),dt=[]);else throw new Error("Unsupported value type "+it.t)}}else{if(xt=!1,it.t==="s"&&(it.v=at||"",dt.length&&(it.R=dt),xt=st==0),yt.Target&&(it.l=yt),$t.length>0&&(it.c=$t,$t=[]),at&&a.cellText!==!1&&(it.w=at),xt&&(it.t="z",delete it.v),(!xt||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=lt))for(var Ot=0;Ot<Nt;++Ot){if(Ht=parseInt(nt["number-columns-repeated"]||"1",10),a.dense)for(rt[lt+Ot]||(rt[lt+Ot]=[]),rt[lt+Ot][ut]=Ot==0?it:dup(it);--Ht>0;)rt[lt+Ot][ut+Ht]=dup(it);else for(rt[encode_cell({r:lt+Ot,c:ut})]=it;--Ht>0;)rt[encode_cell({r:lt+Ot,c:ut+Ht})]=dup(it);ot.e.c<=ut&&(ot.e.c=ut)}Ht=parseInt(nt["number-columns-repeated"]||"1",10),ut+=Ht-1,Ht=0,it={},at="",dt=[]}yt={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(tt[1]==="/"){if((c=o.pop())[0]!==tt[3])throw"Bad state: "+c}else tt[0].charAt(tt[0].length-2)!=="/"&&o.push([tt[3],!0]);break;case"annotation":if(tt[1]==="/"){if((c=o.pop())[0]!==tt[3])throw"Bad state: "+c;_t.t=at,dt.length&&(_t.R=dt),_t.a=ht,$t.push(_t)}else tt[0].charAt(tt[0].length-2)!=="/"&&o.push([tt[3],!1]);ht="",ct=0,at="",st=0,dt=[];break;case"creator":tt[1]==="/"?ht=s.slice(ct,tt.index):ct=tt.index+tt[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(tt[1]==="/"){if((c=o.pop())[0]!==tt[3])throw"Bad state: "+c}else tt[0].charAt(tt[0].length-2)!=="/"&&o.push([tt[3],!1]);at="",st=0,dt=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(tt[1]==="/"){if(pt[d.name]=g,(c=o.pop())[0]!==tt[3])throw"Bad state: "+c}else tt[0].charAt(tt[0].length-2)!=="/"&&(g="",d=parsexmltag(tt[0],!1),o.push([tt[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(o[o.length-1][0]){case"time-style":case"date-style":h=parsexmltag(tt[0],!1),g+=number_formats_ods[tt[3]][h.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(o[o.length-1][0]){case"time-style":case"date-style":h=parsexmltag(tt[0],!1),g+=number_formats_ods[tt[3]][h.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(tt[0].slice(-2)==="/>")break;if(tt[1]==="/")switch(o[o.length-1][0]){case"number-style":case"date-style":case"time-style":g+=s.slice(_,tt.index);break}else _=tt.index+tt[0].length;break;case"named-range":h=parsexmltag(tt[0],!1),Dt=ods_to_csf_3D(h["cell-range-address"]);var jt={Name:h.name,Ref:Dt[0]+"!"+Dt[1]};Et&&(jt.Sheet=et.length),Wt.Names.push(jt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(o[o.length-1][0])>-1)break;if(tt[1]==="/"&&(!nt||!nt["string-value"])){var er=parse_text_p(s.slice(st,tt.index));at=(at.length>0?at+`
`:"")+er[0]}else parsexmltag(tt[0],!1),st=tt.index+tt[0].length;break;case"s":break;case"database-range":if(tt[1]==="/")break;try{Dt=ods_to_csf_3D(parsexmltag(tt[0])["target-range-address"]),_e[Dt[0]]["!autofilter"]={ref:Dt[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(tt[1]!=="/"){if(yt=parsexmltag(tt[0],!1),!yt.href)break;yt.Target=unescapexml(yt.href),delete yt.href,yt.Target.charAt(0)=="#"&&yt.Target.indexOf(".")>-1?(Dt=ods_to_csf_3D(yt.Target.slice(1)),yt.Target="#"+Dt[0]+"!"+Dt[1]):yt.Target.match(/^\.\.[\\\/]/)&&(yt.Target=yt.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(tt[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(tt)}}var Tt={Sheets:_e,SheetNames:et,Workbook:Wt};return a.bookSheets&&delete Tt.Sheets,Tt}function parse_ods(e,i){i=i||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),i);var a=getzipstr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=parse_content_xml(utf8read(a),i);return safegetzipfile(e,"meta.xml")&&(s.Props=parse_core_props(getzipdata(e,"meta.xml"))),s}function parse_fods(e,i){return parse_content_xml(e,i)}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),i="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+i}}(),write_content_ods=function(){var e=function(c){return escapexml(c).replace(/  +/g,function(h){return'<text:s text:c="'+h.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},i=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,s=function(c,h,d){var g=[];g.push('      <table:table table:name="'+escapexml(h.SheetNames[d])+`" table:style-name="ta1">
`);var _=0,b=0,j=decode_range(c["!ref"]||"A1"),_e=c["!merges"]||[],et=0,rt=Array.isArray(c);if(c["!cols"])for(b=0;b<=j.e.c;++b)g.push("        <table:table-column"+(c["!cols"][b]?' table:style-name="co'+c["!cols"][b].ods+'"':"")+`></table:table-column>
`);var tt="",it=c["!rows"]||[];for(_=0;_<j.s.r;++_)tt=it[_]?' table:style-name="ro'+it[_].ods+'"':"",g.push("        <table:table-row"+tt+`></table:table-row>
`);for(;_<=j.e.r;++_){for(tt=it[_]?' table:style-name="ro'+it[_].ods+'"':"",g.push("        <table:table-row"+tt+`>
`),b=0;b<j.s.c;++b)g.push(i);for(;b<=j.e.c;++b){var nt=!1,at={},st="";for(et=0;et!=_e.length;++et)if(!(_e[et].s.c>b)&&!(_e[et].s.r>_)&&!(_e[et].e.c<b)&&!(_e[et].e.r<_)){(_e[et].s.c!=b||_e[et].s.r!=_)&&(nt=!0),at["table:number-columns-spanned"]=_e[et].e.c-_e[et].s.c+1,at["table:number-rows-spanned"]=_e[et].e.r-_e[et].s.r+1;break}if(nt){g.push(a);continue}var dt=encode_cell({r:_,c:b}),lt=rt?(c[_]||[])[b]:c[dt];if(lt&&lt.f&&(at["table:formula"]=escapexml(csf_to_ods_formula(lt.f)),lt.F&&lt.F.slice(0,dt.length)==dt)){var ut=decode_range(lt.F);at["table:number-matrix-columns-spanned"]=ut.e.c-ut.s.c+1,at["table:number-matrix-rows-spanned"]=ut.e.r-ut.s.r+1}if(!lt){g.push(i);continue}switch(lt.t){case"b":st=lt.v?"TRUE":"FALSE",at["office:value-type"]="boolean",at["office:boolean-value"]=lt.v?"true":"false";break;case"n":st=lt.w||String(lt.v||0),at["office:value-type"]="float",at["office:value"]=lt.v||0;break;case"s":case"str":st=lt.v==null?"":lt.v,at["office:value-type"]="string";break;case"d":st=lt.w||parseDate(lt.v).toISOString(),at["office:value-type"]="date",at["office:date-value"]=parseDate(lt.v).toISOString(),at["table:style-name"]="ce1";break;default:g.push(i);continue}var ot=e(st);if(lt.l&&lt.l.Target){var ft=lt.l.Target;ft=ft.charAt(0)=="#"?"#"+csf_to_ods_3D(ft.slice(1)):ft,ft.charAt(0)!="#"&&!ft.match(/^\w+:/)&&(ft="../"+ft),ot=writextag("text:a",ot,{"xlink:href":ft.replace(/&/g,"&amp;")})}g.push("          "+writextag("table:table-cell",writextag("text:p",ot,{}),at)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},o=function(c,h){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var d=0;h.SheetNames.map(function(_){return h.Sheets[_]}).forEach(function(_){if(_&&_["!cols"]){for(var b=0;b<_["!cols"].length;++b)if(_["!cols"][b]){var j=_["!cols"][b];if(j.width==null&&j.wpx==null&&j.wch==null)continue;process_col(j),j.ods=d;var _e=_["!cols"][b].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_e+`"/>
`),c.push(`  </style:style>
`),++d}}});var g=0;h.SheetNames.map(function(_){return h.Sheets[_]}).forEach(function(_){if(_&&_["!rows"]){for(var b=0;b<_["!rows"].length;++b)if(_["!rows"][b]){_["!rows"][b].ods=g;var j=_["!rows"][b].hpx+"px";c.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+j+`"/>
`),c.push(`  </style:style>
`),++g}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(h,d){var g=[XML_HEADER],_=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),b=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(g.push("<office:document"+_+b+`>
`),g.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+_+`>
`),o(g,h),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var j=0;j!=h.SheetNames.length;++j)g.push(s(h.Sheets[h.SheetNames[j]],h,j));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),d.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}}();function write_ods(e,i){if(i.bookType=="fods")return write_content_ods(e,i);var a=zip_new(),s="",o=[],c=[];return s="mimetype",zip_add_file(a,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",zip_add_file(a,s,write_content_ods(e,i)),o.push([s,"text/xml"]),c.push([s,"ContentFile"]),s="styles.xml",zip_add_file(a,s,write_styles_ods(e,i)),o.push([s,"text/xml"]),c.push([s,"StylesFile"]),s="meta.xml",zip_add_file(a,s,XML_HEADER+write_meta_ods()),o.push([s,"text/xml"]),c.push([s,"MetadataFile"]),s="manifest.rdf",zip_add_file(a,s,write_rdf(c)),o.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",zip_add_file(a,s,write_manifest(o)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,i){e:for(var a=0;a<=e.length-i.length;++a){for(var s=0;s<i.length;++s)if(e[a+s]!=i[s])continue e;return!0}return!1}function u8concat(e){var i=e.reduce(function(o,c){return o+c.length},0),a=new Uint8Array(i),s=0;return e.forEach(function(o){a.set(o,s),s+=o.length}),a}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,i){for(var a=(e[i+15]&127)<<7|e[i+14]>>1,s=e[i+14]&1,o=i+13;o>=i;--o)s=s*256+e[o];return(e[i+15]&128?-s:s)*Math.pow(10,a-6176)}function writeDecimal128LE(e,i,a){var s=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,o=a/Math.pow(10,s-6176);e[i+15]|=s>>7,e[i+14]|=(s&127)<<1;for(var c=0;o>=1;++c,o/=256)e[i+c]=o&255;e[i+15]|=a>=0?0:128}function parse_varint49(e,i){var a=i?i[0]:0,s=e[a]&127;e:if(e[a++]>=128&&(s|=(e[a]&127)<<7,e[a++]<128||(s|=(e[a]&127)<<14,e[a++]<128)||(s|=(e[a]&127)<<21,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(s+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return i&&(i[0]=a),s}function write_varint49(e){var i=new Uint8Array(7);i[0]=e&127;var a=1;e:if(e>127){if(i[a-1]|=128,i[a]=e>>7&127,++a,e<=16383||(i[a-1]|=128,i[a]=e>>14&127,++a,e<=2097151)||(i[a-1]|=128,i[a]=e>>21&127,++a,e<=268435455)||(i[a-1]|=128,i[a]=e/256>>>21&127,++a,e<=34359738367)||(i[a-1]|=128,i[a]=e/65536>>>21&127,++a,e<=4398046511103))break e;i[a-1]|=128,i[a]=e/16777216>>>21&127,++a}return i.slice(0,a)}function varint_to_i32(e){var i=0,a=e[i]&127;e:if(e[i++]>=128){if(a|=(e[i]&127)<<7,e[i++]<128||(a|=(e[i]&127)<<14,e[i++]<128)||(a|=(e[i]&127)<<21,e[i++]<128))break e;a|=(e[i]&127)<<28}return a}function parse_shallow(e){for(var i=[],a=[0];a[0]<e.length;){var s=a[0],o=parse_varint49(e,a),c=o&7;o=Math.floor(o/8);var h=0,d;if(o==0)break;switch(c){case 0:{for(var g=a[0];e[a[0]++]>=128;);d=e.slice(g,a[0])}break;case 5:h=4,d=e.slice(a[0],a[0]+h),a[0]+=h;break;case 1:h=8,d=e.slice(a[0],a[0]+h),a[0]+=h;break;case 2:h=parse_varint49(e,a),d=e.slice(a[0],a[0]+h),a[0]+=h;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(o," at offset ").concat(s))}var _={data:d,type:c};i[o]==null?i[o]=[_]:i[o].push(_)}return i}function write_shallow(e){var i=[];return e.forEach(function(a,s){a.forEach(function(o){o.data&&(i.push(write_varint49(s*8+o.type)),o.type==2&&i.push(write_varint49(o.data.length)),i.push(o.data))})}),u8concat(i)}function mappa(e,i){return(e==null?void 0:e.map(function(a){return i(a.data)}))||[]}function parse_iwa_file(e){for(var i,a=[],s=[0];s[0]<e.length;){var o=parse_varint49(e,s),c=parse_shallow(e.slice(s[0],s[0]+o));s[0]+=o;var h={id:varint_to_i32(c[1][0].data),messages:[]};c[2].forEach(function(d){var g=parse_shallow(d.data),_=varint_to_i32(g[3][0].data);h.messages.push({meta:g,data:e.slice(s[0],s[0]+_)}),s[0]+=_}),(i=c[3])!=null&&i[0]&&(h.merge=varint_to_i32(c[3][0].data)>>>0>0),a.push(h)}return a}function write_iwa_file(e){var i=[];return e.forEach(function(a){var s=[];s[1]=[{data:write_varint49(a.id),type:0}],s[2]=[],a.merge!=null&&(s[3]=[{data:write_varint49(+!!a.merge),type:0}]);var o=[];a.messages.forEach(function(h){o.push(h.data),h.meta[3]=[{type:0,data:write_varint49(h.data.length)}],s[2].push({data:write_shallow(h.meta),type:2})});var c=write_shallow(s);i.push(write_varint49(c.length)),i.push(c),o.forEach(function(h){return i.push(h)})}),u8concat(i)}function parse_snappy_chunk(e,i){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],s=parse_varint49(i,a),o=[];a[0]<i.length;){var c=i[a[0]]&3;if(c==0){var h=i[a[0]++]>>2;if(h<60)++h;else{var d=h-59;h=i[a[0]],d>1&&(h|=i[a[0]+1]<<8),d>2&&(h|=i[a[0]+2]<<16),d>3&&(h|=i[a[0]+3]<<24),h>>>=0,h++,a[0]+=d}o.push(i.slice(a[0],a[0]+h)),a[0]+=h;continue}else{var g=0,_=0;if(c==1?(_=(i[a[0]]>>2&7)+4,g=(i[a[0]++]&224)<<3,g|=i[a[0]++]):(_=(i[a[0]++]>>2)+1,c==2?(g=i[a[0]]|i[a[0]+1]<<8,a[0]+=2):(g=(i[a[0]]|i[a[0]+1]<<8|i[a[0]+2]<<16|i[a[0]+3]<<24)>>>0,a[0]+=4)),o=[u8concat(o)],g==0)throw new Error("Invalid offset 0");if(g>o[0].length)throw new Error("Invalid offset beyond length");if(_>=g)for(o.push(o[0].slice(-g)),_-=g;_>=o[o.length-1].length;)o.push(o[o.length-1]),_-=o[o.length-1].length;o.push(o[0].slice(-g,-g+_))}}var b=u8concat(o);if(b.length!=s)throw new Error("Unexpected length: ".concat(b.length," != ").concat(s));return b}function decompress_iwa_file(e){for(var i=[],a=0;a<e.length;){var s=e[a++],o=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,i.push(parse_snappy_chunk(s,e.slice(a,a+o))),a+=o}if(a!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(i)}function compress_iwa_file(e){for(var i=[],a=0;a<e.length;){var s=Math.min(e.length-a,268435455),o=new Uint8Array(4);i.push(o);var c=write_varint49(s),h=c.length;i.push(c),s<=60?(h++,i.push(new Uint8Array([s-1<<2]))):s<=256?(h+=2,i.push(new Uint8Array([240,s-1&255]))):s<=65536?(h+=3,i.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(h+=4,i.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(h+=5,i.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),i.push(e.slice(a,a+s)),h+=s,o[0]=0,o[1]=h&255,o[2]=h>>8&255,o[3]=h>>16&255,a+=s}return u8concat(i)}function parse_old_storage(e,i,a,s){var o=u8_to_dataview(e),c=o.getUint32(4,!0),h=(s>1?12:8)+popcnt(c&(s>1?3470:398))*4,d=-1,g=-1,_=NaN,b=new Date(2001,0,1);c&512&&(d=o.getUint32(h,!0),h+=4),h+=popcnt(c&(s>1?12288:4096))*4,c&16&&(g=o.getUint32(h,!0),h+=4),c&32&&(_=o.getFloat64(h,!0),h+=8),c&64&&(b.setTime(b.getTime()+o.getFloat64(h,!0)*1e3),h+=8);var j;switch(e[2]){case 0:break;case 2:j={t:"n",v:_};break;case 3:j={t:"s",v:i[g]};break;case 5:j={t:"d",v:b};break;case 6:j={t:"b",v:_>0};break;case 7:j={t:"n",v:_/86400};break;case 8:j={t:"e",v:0};break;case 9:if(d>-1)j={t:"s",v:a[d]};else if(g>-1)j={t:"s",v:i[g]};else if(!isNaN(_))j={t:"n",v:_};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return j}function parse_new_storage(e,i,a){var s=u8_to_dataview(e),o=s.getUint32(8,!0),c=12,h=-1,d=-1,g=NaN,_=NaN,b=new Date(2001,0,1);o&1&&(g=readDecimal128LE(e,c),c+=16),o&2&&(_=s.getFloat64(c,!0),c+=8),o&4&&(b.setTime(b.getTime()+s.getFloat64(c,!0)*1e3),c+=8),o&8&&(d=s.getUint32(c,!0),c+=4),o&16&&(h=s.getUint32(c,!0),c+=4);var j;switch(e[1]){case 0:break;case 2:j={t:"n",v:g};break;case 3:j={t:"s",v:i[d]};break;case 5:j={t:"d",v:b};break;case 6:j={t:"b",v:_>0};break;case 7:j={t:"n",v:_/86400};break;case 8:j={t:"e",v:0};break;case 9:if(h>-1)j={t:"s",v:a[h]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(o&31," : ").concat(e.slice(0,4)));break;case 10:j={t:"n",v:g};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(o&31," : ").concat(e.slice(0,4)))}return j}function write_new_storage(e,i){var a=new Uint8Array(32),s=u8_to_dataview(a),o=12,c=0;switch(a[0]=5,e.t){case"n":a[1]=2,writeDecimal128LE(a,o,e.v),c|=1,o+=16;break;case"b":a[1]=6,s.setFloat64(o,e.v?1:0,!0),c|=2,o+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,s.setUint32(o,i.indexOf(e.v),!0),c|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,c,!0),a.slice(0,o)}function write_old_storage(e,i){var a=new Uint8Array(32),s=u8_to_dataview(a),o=12,c=0;switch(a[0]=3,e.t){case"n":a[2]=2,s.setFloat64(o,e.v,!0),c|=32,o+=8;break;case"b":a[2]=6,s.setFloat64(o,e.v?1:0,!0),c|=32,o+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,s.setUint32(o,i.indexOf(e.v),!0),c|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,c,!0),a.slice(0,o)}function parse_cell_storage(e,i,a){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,i,a,e[0]);case 5:return parse_new_storage(e,i,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var i=parse_shallow(e);return parse_varint49(i[1][0].data)}function parse_TST_TableDataList(e,i){var a=parse_shallow(i.data),s=varint_to_i32(a[1][0].data),o=a[3],c=[];return(o||[]).forEach(function(h){var d=parse_shallow(h.data),g=varint_to_i32(d[1][0].data)>>>0;switch(s){case 1:c[g]=u8str(d[3][0].data);break;case 8:{var _=e[parse_TSP_Reference(d[9][0].data)][0],b=parse_shallow(_.data),j=e[parse_TSP_Reference(b[1][0].data)][0],_e=varint_to_i32(j.meta[1][0].data);if(_e!=2001)throw new Error("2000 unexpected reference to ".concat(_e));var et=parse_shallow(j.data);c[g]=et[3].map(function(rt){return u8str(rt.data)}).join("")}break}}),c}function parse_TST_TileRowInfo(e,i){var a,s,o,c,h,d,g,_,b,j,_e,et,rt,tt,it=parse_shallow(e),nt=varint_to_i32(it[1][0].data)>>>0,at=varint_to_i32(it[2][0].data)>>>0,st=((s=(a=it[8])==null?void 0:a[0])==null?void 0:s.data)&&varint_to_i32(it[8][0].data)>0||!1,dt,lt;if((c=(o=it[7])==null?void 0:o[0])!=null&&c.data&&i!=0)dt=(d=(h=it[7])==null?void 0:h[0])==null?void 0:d.data,lt=(_=(g=it[6])==null?void 0:g[0])==null?void 0:_.data;else if((j=(b=it[4])==null?void 0:b[0])!=null&&j.data&&i!=1)dt=(et=(_e=it[4])==null?void 0:_e[0])==null?void 0:et.data,lt=(tt=(rt=it[3])==null?void 0:rt[0])==null?void 0:tt.data;else throw"NUMBERS Tile missing ".concat(i," cell storage");for(var ut=st?4:1,ot=u8_to_dataview(dt),ft=[],pt=0;pt<dt.length/2;++pt){var St=ot.getUint16(pt*2,!0);St<65535&&ft.push([pt,St])}if(ft.length!=at)throw"Expected ".concat(at," cells, found ").concat(ft.length);var gt=[];for(pt=0;pt<ft.length-1;++pt)gt[ft[pt][0]]=lt.subarray(ft[pt][1]*ut,ft[pt+1][1]*ut);return ft.length>=1&&(gt[ft[ft.length-1][0]]=lt.subarray(ft[ft.length-1][1]*ut)),{R:nt,cells:gt}}function parse_TST_Tile(e,i){var a,s=parse_shallow(i.data),o=(a=s==null?void 0:s[7])!=null&&a[0]?varint_to_i32(s[7][0].data)>>>0>0?1:0:-1,c=mappa(s[5],function(h){return parse_TST_TileRowInfo(h,o)});return{nrows:varint_to_i32(s[4][0].data)>>>0,data:c.reduce(function(h,d){return h[d.R]||(h[d.R]=[]),d.cells.forEach(function(g,_){if(h[d.R][_])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(_));h[d.R][_]=g}),h},[])}}function parse_TST_TableModelArchive(e,i,a){var s,o=parse_shallow(i.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(varint_to_i32(o[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(o[6][0].data));if(c.e.c=(varint_to_i32(o[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(o[7][0].data));a["!ref"]=encode_range(c);var h=parse_shallow(o[4][0].data),d=parse_TST_TableDataList(e,e[parse_TSP_Reference(h[4][0].data)][0]),g=(s=h[17])!=null&&s[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(h[17][0].data)][0]):[],_=parse_shallow(h[3][0].data),b=0;_[1].forEach(function(j){var _e=parse_shallow(j.data),et=e[parse_TSP_Reference(_e[2][0].data)][0],rt=varint_to_i32(et.meta[1][0].data);if(rt!=6002)throw new Error("6001 unexpected reference to ".concat(rt));var tt=parse_TST_Tile(e,et);tt.data.forEach(function(it,nt){it.forEach(function(at,st){var dt=encode_cell({r:b+nt,c:st}),lt=parse_cell_storage(at,d,g);lt&&(a[dt]=lt)})}),b+=tt.nrows})}function parse_TST_TableInfoArchive(e,i){var a=parse_shallow(i.data),s={"!ref":"A1"},o=e[parse_TSP_Reference(a[2][0].data)],c=varint_to_i32(o[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return parse_TST_TableModelArchive(e,o[0],s),s}function parse_TN_SheetArchive(e,i){var a,s=parse_shallow(i.data),o={name:(a=s[1])!=null&&a[0]?u8str(s[1][0].data):"",sheets:[]},c=mappa(s[2],parse_TSP_Reference);return c.forEach(function(h){e[h].forEach(function(d){var g=varint_to_i32(d.meta[1][0].data);g==6e3&&o.sheets.push(parse_TST_TableInfoArchive(e,d))})}),o}function parse_TN_DocumentArchive(e,i){var a=book_new(),s=parse_shallow(i.data),o=mappa(s[1],parse_TSP_Reference);if(o.forEach(function(c){e[c].forEach(function(h){var d=varint_to_i32(h.meta[1][0].data);if(d==2){var g=parse_TN_SheetArchive(e,h);g.sheets.forEach(function(_,b){book_append_sheet(a,_,b==0?g.name:g.name+"_"+b,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function parse_numbers_iwa(e){var i,a,s,o,c={},h=[];if(e.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var _;try{_=decompress_iwa_file(g.content)}catch(j){return console.log("?? "+g.content.length+" "+(j.message||j))}var b;try{b=parse_iwa_file(_)}catch(j){return console.log("## "+(j.message||j))}b.forEach(function(j){c[j.id]=j.messages,h.push(j.id)})}}),!h.length)throw new Error("File has no messages");var d=((o=(s=(a=(i=c==null?void 0:c[1])==null?void 0:i[0])==null?void 0:a.meta)==null?void 0:s[1])==null?void 0:o[0].data)&&varint_to_i32(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||h.forEach(function(g){c[g].forEach(function(_){var b=varint_to_i32(_.meta[1][0].data)>>>0;if(b==1)if(!d)d=_;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(c,d)}function write_tile_row(e,i,a){var s,o,c,h;if(!((s=e[6])!=null&&s[0])||!((o=e[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var d=((h=(c=e[8])==null?void 0:c[0])==null?void 0:h.data)&&varint_to_i32(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var g=0,_=u8_to_dataview(e[7][0].data),b=0,j=[],_e=u8_to_dataview(e[4][0].data),et=0,rt=[],tt=0;tt<i.length;++tt){if(i[tt]==null){_.setUint16(tt*2,65535,!0),_e.setUint16(tt*2,65535);continue}_.setUint16(tt*2,b,!0),_e.setUint16(tt*2,et,!0);var it,nt;switch(typeof i[tt]){case"string":it=write_new_storage({t:"s",v:i[tt]},a),nt=write_old_storage({t:"s",v:i[tt]},a);break;case"number":it=write_new_storage({t:"n",v:i[tt]},a),nt=write_old_storage({t:"n",v:i[tt]},a);break;case"boolean":it=write_new_storage({t:"b",v:i[tt]},a),nt=write_old_storage({t:"b",v:i[tt]},a);break;default:throw new Error("Unsupported value "+i[tt])}j.push(it),b+=it.length,rt.push(nt),et+=nt.length,++g}for(e[2][0].data=write_varint49(g);tt<e[7][0].data.length/2;++tt)_.setUint16(tt*2,65535,!0),_e.setUint16(tt*2,65535,!0);return e[6][0].data=u8concat(j),e[3][0].data=u8concat(rt),g}function write_numbers_iwa(e,i){if(!i||!i.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=decode_range(a["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>9&&(o=!0,s.e.c=9),s.e.r>49&&(o=!0,s.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(encode_range(s)));var c=sheet_to_json(a,{range:s,header:1}),h=["~Sh33tJ5~"];c.forEach(function(ht){return ht.forEach(function(ct){typeof ct=="string"&&h.push(ct)})});var d={},g=[],_=CFB.read(i.numbers,{type:"base64"});_.FileIndex.map(function(ht,ct){return[ht,_.FullPaths[ct]]}).forEach(function(ht){var ct=ht[0],xt=ht[1];if(ct.type==2&&ct.name.match(/\.iwa/)){var Et=ct.content,bt=decompress_iwa_file(Et),Ct=parse_iwa_file(bt);Ct.forEach(function(Ot){g.push(Ot.id),d[Ot.id]={deps:[],location:xt,type:varint_to_i32(Ot.messages[0].meta[1][0].data)}})}}),g.sort(function(ht,ct){return ht-ct});var b=g.filter(function(ht){return ht>1}).map(function(ht){return[ht,write_varint49(ht)]});_.FileIndex.map(function(ht,ct){return[ht,_.FullPaths[ct]]}).forEach(function(ht){var ct=ht[0];if(ht[1],!!ct.name.match(/\.iwa/)){var xt=parse_iwa_file(decompress_iwa_file(ct.content));xt.forEach(function(Et){Et.messages.forEach(function(bt){b.forEach(function(Ct){Et.messages.some(function(Ot){return varint_to_i32(Ot.meta[1][0].data)!=11006&&u8contains(Ot.data,Ct[1])})&&d[Ct[0]].deps.push(Et.id)})})})}});for(var j=CFB.find(_,d[1].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),et,rt=0;rt<_e.length;++rt){var tt=_e[rt];tt.id==1&&(et=tt)}var it=parse_TSP_Reference(parse_shallow(et.messages[0].data)[1][0].data);for(j=CFB.find(_,d[it].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),rt=0;rt<_e.length;++rt)tt=_e[rt],tt.id==it&&(et=tt);for(it=parse_TSP_Reference(parse_shallow(et.messages[0].data)[2][0].data),j=CFB.find(_,d[it].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),rt=0;rt<_e.length;++rt)tt=_e[rt],tt.id==it&&(et=tt);for(it=parse_TSP_Reference(parse_shallow(et.messages[0].data)[2][0].data),j=CFB.find(_,d[it].location),_e=parse_iwa_file(decompress_iwa_file(j.content)),rt=0;rt<_e.length;++rt)tt=_e[rt],tt.id==it&&(et=tt);var nt=parse_shallow(et.messages[0].data);{nt[6][0].data=write_varint49(s.e.r+1),nt[7][0].data=write_varint49(s.e.c+1);var at=parse_TSP_Reference(nt[46][0].data),st=CFB.find(_,d[at].location),dt=parse_iwa_file(decompress_iwa_file(st.content));{for(var lt=0;lt<dt.length&&dt[lt].id!=at;++lt);if(dt[lt].id!=at)throw"Bad ColumnRowUIDMapArchive";var ut=parse_shallow(dt[lt].messages[0].data);ut[1]=[],ut[2]=[],ut[3]=[];for(var ot=0;ot<=s.e.c;++ot){var ft=[];ft[1]=ft[2]=[{type:0,data:write_varint49(ot+420690)}],ut[1].push({type:2,data:write_shallow(ft)}),ut[2].push({type:0,data:write_varint49(ot)}),ut[3].push({type:0,data:write_varint49(ot)})}ut[4]=[],ut[5]=[],ut[6]=[];for(var pt=0;pt<=s.e.r;++pt)ft=[],ft[1]=ft[2]=[{type:0,data:write_varint49(pt+726270)}],ut[4].push({type:2,data:write_shallow(ft)}),ut[5].push({type:0,data:write_varint49(pt)}),ut[6].push({type:0,data:write_varint49(pt)});dt[lt].messages[0].data=write_shallow(ut)}st.content=compress_iwa_file(write_iwa_file(dt)),st.size=st.content.length,delete nt[46];var St=parse_shallow(nt[4][0].data);{St[7][0].data=write_varint49(s.e.r+1);var gt=parse_shallow(St[1][0].data),vt=parse_TSP_Reference(gt[2][0].data);st=CFB.find(_,d[vt].location),dt=parse_iwa_file(decompress_iwa_file(st.content));{if(dt[0].id!=vt)throw"Bad HeaderStorageBucket";var At=parse_shallow(dt[0].messages[0].data);for(pt=0;pt<c.length;++pt){var Gt=parse_shallow(At[2][0].data);Gt[1][0].data=write_varint49(pt),Gt[4][0].data=write_varint49(c[pt].length),At[2][pt]={type:At[2][0].type,data:write_shallow(Gt)}}dt[0].messages[0].data=write_shallow(At)}st.content=compress_iwa_file(write_iwa_file(dt)),st.size=st.content.length;var Nt=parse_TSP_Reference(St[2][0].data);st=CFB.find(_,d[Nt].location),dt=parse_iwa_file(decompress_iwa_file(st.content));{if(dt[0].id!=Nt)throw"Bad HeaderStorageBucket";for(At=parse_shallow(dt[0].messages[0].data),ot=0;ot<=s.e.c;++ot)Gt=parse_shallow(At[2][0].data),Gt[1][0].data=write_varint49(ot),Gt[4][0].data=write_varint49(s.e.r+1),At[2][ot]={type:At[2][0].type,data:write_shallow(Gt)};dt[0].messages[0].data=write_shallow(At)}st.content=compress_iwa_file(write_iwa_file(dt)),st.size=st.content.length;var Ht=parse_TSP_Reference(St[4][0].data);(function(){for(var ht=CFB.find(_,d[Ht].location),ct=parse_iwa_file(decompress_iwa_file(ht.content)),xt,Et=0;Et<ct.length;++Et){var bt=ct[Et];bt.id==Ht&&(xt=bt)}var Ct=parse_shallow(xt.messages[0].data);{Ct[3]=[];var Ot=[];h.forEach(function(Tt,ur){Ot[1]=[{type:0,data:write_varint49(ur)}],Ot[2]=[{type:0,data:write_varint49(1)}],Ot[3]=[{type:2,data:stru8(Tt)}],Ct[3].push({type:2,data:write_shallow(Ot)})})}xt.messages[0].data=write_shallow(Ct);var jt=write_iwa_file(ct),er=compress_iwa_file(jt);ht.content=er,ht.size=ht.content.length})();var It=parse_shallow(St[3][0].data);{var Wt=It[1][0];delete It[2];var yt=parse_shallow(Wt.data);{var Dt=parse_TSP_Reference(yt[2][0].data);(function(){for(var ht=CFB.find(_,d[Dt].location),ct=parse_iwa_file(decompress_iwa_file(ht.content)),xt,Et=0;Et<ct.length;++Et){var bt=ct[Et];bt.id==Dt&&(xt=bt)}var Ct=parse_shallow(xt.messages[0].data);{delete Ct[6],delete It[7];var Ot=new Uint8Array(Ct[5][0].data);Ct[5]=[];for(var jt=0,er=0;er<=s.e.r;++er){var Tt=parse_shallow(Ot);jt+=write_tile_row(Tt,c[er],h),Tt[1][0].data=write_varint49(er),Ct[5].push({data:write_shallow(Tt),type:2})}Ct[1]=[{type:0,data:write_varint49(s.e.c+1)}],Ct[2]=[{type:0,data:write_varint49(s.e.r+1)}],Ct[3]=[{type:0,data:write_varint49(jt)}],Ct[4]=[{type:0,data:write_varint49(s.e.r+1)}]}xt.messages[0].data=write_shallow(Ct);var ur=write_iwa_file(ct),cr=compress_iwa_file(ur);ht.content=cr,ht.size=ht.content.length})()}Wt.data=write_shallow(yt)}St[3][0].data=write_shallow(It)}nt[4][0].data=write_shallow(St)}et.messages[0].data=write_shallow(nt);var $t=write_iwa_file(_e),_t=compress_iwa_file($t);return j.content=_t,j.size=j.content.length,_}function fix_opts_func(e){return function(a){for(var s=0;s!=e.length;++s){var o=e[s];a[o[0]]===void 0&&(a[o[0]]=o[1]),o[2]==="n"&&(a[o[0]]=Number(a[o[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,i){if(!e)return 0;try{e=i.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,get_sheet_type(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,i,a,s,o,c,h,d,g,_,b,j){try{c[s]=parse_rels(getzipstr(e,a,!0),i);var _e=getzipdata(e,i),et;switch(d){case"sheet":et=parse_ws(_e,i,o,g,c[s],_,b,j);break;case"chart":if(et=parse_cs(_e,i,o,g,c[s],_,b,j),!et||!et["!drawel"])break;var rt=resolve_path(et["!drawel"].Target,i),tt=get_rels_path(rt),it=parse_drawing(getzipstr(e,rt,!0),parse_rels(getzipstr(e,tt,!0),rt)),nt=resolve_path(it,rt),at=get_rels_path(nt);et=parse_chart(getzipstr(e,nt,!0),nt,g,parse_rels(getzipstr(e,at,!0),nt),_,et);break;case"macro":et=parse_ms(_e,i,o,g,c[s],_,b,j);break;case"dialog":et=parse_ds(_e,i,o,g,c[s],_,b,j);break;default:throw new Error("Unrecognized sheet type "+d)}h[s]=et;var st=[];c&&c[s]&&keys(c[s]).forEach(function(dt){var lt="";if(c[s][dt].Type==RELS.CMNT){lt=resolve_path(c[s][dt].Target,i);var ut=parse_cmnt(getzipdata(e,lt,!0),lt,g);if(!ut||!ut.length)return;sheet_insert_comments(et,ut,!1)}c[s][dt].Type==RELS.TCMNT&&(lt=resolve_path(c[s][dt].Target,i),st=st.concat(parse_tcmnt_xml(getzipdata(e,lt,!0),g)))}),st&&st.length&&sheet_insert_comments(et,st,!0,g.people||[])}catch(dt){if(g.WTF)throw dt}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,i){if(make_ssf(),i=i||{},fix_read_opts(i),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,i);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var a=CFB.utils.cfb_new();return zipentries(e).forEach(function(Gt){zip_add_file(a,Gt,getzipbin(e,Gt))}),parse_numbers_iwa(a)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=zipentries(e),o=parse_ct(getzipstr(e,"[Content_Types].xml")),c=!1,h,d;if(o.workbooks.length===0&&(d="xl/workbook.xml",getzipdata(e,d,!0)&&o.workbooks.push(d)),o.workbooks.length===0){if(d="xl/workbook.bin",!getzipdata(e,d,!0))throw new Error("Could not find workbook");o.workbooks.push(d),c=!0}o.workbooks[0].slice(-3)=="bin"&&(c=!0);var g={},_={};if(!i.bookSheets&&!i.bookProps){if(strs=[],o.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(o.sst)),o.sst,i)}catch(Gt){if(i.WTF)throw Gt}i.cellStyles&&o.themes.length&&(g=parse_theme(getzipstr(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],i)),o.style&&(_=parse_sty(getzipdata(e,strip_front_slash(o.style)),o.style,g,i))}o.links.map(function(Gt){try{var Nt=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(Gt))),Gt);return parse_xlink(getzipdata(e,strip_front_slash(Gt)),Nt,Gt,i)}catch{}});var b=parse_wb(getzipdata(e,strip_front_slash(o.workbooks[0])),o.workbooks[0],i),j={},_e="";o.coreprops.length&&(_e=getzipdata(e,strip_front_slash(o.coreprops[0]),!0),_e&&(j=parse_core_props(_e)),o.extprops.length!==0&&(_e=getzipdata(e,strip_front_slash(o.extprops[0]),!0),_e&&parse_ext_props(_e,j,i)));var et={};(!i.bookSheets||i.bookProps)&&o.custprops.length!==0&&(_e=getzipstr(e,strip_front_slash(o.custprops[0]),!0),_e&&(et=parse_cust_props(_e,i)));var rt={};if((i.bookSheets||i.bookProps)&&(b.Sheets?h=b.Sheets.map(function(Nt){return Nt.name}):j.Worksheets&&j.SheetNames.length>0&&(h=j.SheetNames),i.bookProps&&(rt.Props=j,rt.Custprops=et),i.bookSheets&&typeof h<"u"&&(rt.SheetNames=h),i.bookSheets?rt.SheetNames:i.bookProps))return rt;h={};var tt={};i.bookDeps&&o.calcchain&&(tt=parse_cc(getzipdata(e,strip_front_slash(o.calcchain)),o.calcchain));var it=0,nt={},at,st;{var dt=b.Sheets;j.Worksheets=dt.length,j.SheetNames=[];for(var lt=0;lt!=dt.length;++lt)j.SheetNames[lt]=dt[lt].name}var ut=c?"bin":"xml",ot=o.workbooks[0].lastIndexOf("/"),ft=(o.workbooks[0].slice(0,ot+1)+"_rels/"+o.workbooks[0].slice(ot+1)+".rels").replace(/^\//,"");safegetzipfile(e,ft)||(ft="xl/_rels/workbook."+ut+".rels");var pt=parse_rels(getzipstr(e,ft,!0),ft.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(i.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(o.metadata[0])),o.metadata[0],i)),(o.people||[]).length>=1&&(i.people=parse_people_xml(getzipdata(e,strip_front_slash(o.people[0])),i)),pt&&(pt=safe_parse_wbrels(pt,b.Sheets));var St=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(it=0;it!=j.Worksheets;++it){var gt="sheet";if(pt&&pt[it]?(at="xl/"+pt[it][1].replace(/[\/]?xl\//,""),safegetzipfile(e,at)||(at=pt[it][1]),safegetzipfile(e,at)||(at=ft.replace(/_rels\/.*$/,"")+pt[it][1]),gt=pt[it][2]):(at="xl/worksheets/sheet"+(it+1-St)+"."+ut,at=at.replace(/sheet0\./,"sheet.")),st=at.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),i&&i.sheets!=null)switch(typeof i.sheets){case"number":if(it!=i.sheets)continue e;break;case"string":if(j.SheetNames[it].toLowerCase()!=i.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(i.sheets)){for(var vt=!1,At=0;At!=i.sheets.length;++At)typeof i.sheets[At]=="number"&&i.sheets[At]==it&&(vt=1),typeof i.sheets[At]=="string"&&i.sheets[At].toLowerCase()==j.SheetNames[it].toLowerCase()&&(vt=1);if(!vt)continue e}}safe_parse_sheet(e,at,st,j.SheetNames[it],it,nt,h,gt,i,b,g,_)}return rt={Directory:o,Workbook:b,Props:j,Custprops:et,Deps:tt,Sheets:h,SheetNames:j.SheetNames,Strings:strs,Styles:_,Themes:g,SSF:dup(table_fmt)},i&&i.bookFiles&&(e.files?(rt.keys=s,rt.files=e.files):(rt.keys=[],rt.files={},e.FullPaths.forEach(function(Gt,Nt){Gt=Gt.replace(/^Root Entry[\/]/,""),rt.keys.push(Gt),rt.files[Gt]=e.FileIndex[Nt]}))),i&&i.bookVBA&&(o.vba.length>0?rt.vbaraw=getzipdata(e,strip_front_slash(o.vba[0]),!0):o.defaults&&o.defaults.bin===CT_VBA&&(rt.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),rt}function parse_xlsxcfb(e,i){var a=i||{},s="Workbook",o=CFB.find(e,s);try{if(s="/!DataSpaces/Version",o=CFB.find(e,s),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(parse_DataSpaceVersionInfo(o.content),s="/!DataSpaces/DataSpaceMap",o=CFB.find(e,s),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=parse_DataSpaceMap(o.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",o=CFB.find(e,s),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);var h=parse_DataSpaceDefinition(o.content);if(h.length!=1||h[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",o=CFB.find(e,s),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);parse_Primary(o.content)}catch{}if(s="/EncryptionInfo",o=CFB.find(e,s),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);var d=parse_EncryptionInfo(o.content);if(s="/EncryptedPackage",o=CFB.find(e,s),!o||!o.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],o.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],o.content,a.password||"",a);throw new Error("File is password-protected")}function write_zip(e,i){return i.bookType=="ods"?write_ods(e,i):i.bookType=="numbers"?write_numbers_iwa(e,i):i.bookType=="xlsb"?write_zip_xlsxb(e,i):write_zip_xlsx(e,i)}function write_zip_xlsxb(e,i){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,browser_has_Map?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var a=i.bookType=="xlsb"?"bin":"xml",s=VBAFMTS.indexOf(i.bookType)>-1,o=new_ct();fix_write_opts(i=i||{});var c=zip_new(),h="",d=0;if(i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",zip_add_file(c,h,write_core_props(e.Props,i)),o.coreprops.push(h),add_rels(i.rels,2,h,RELS.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],_=0;_<e.SheetNames.length;++_)(e.Workbook.Sheets[_]||{}).Hidden!=2&&g.push(e.SheetNames[_]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(c,h,write_ext_props(e.Props)),o.extprops.push(h),add_rels(i.rels,3,h,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(h="docProps/custom.xml",zip_add_file(c,h,write_cust_props(e.Custprops)),o.custprops.push(h),add_rels(i.rels,4,h,RELS.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var b={"!id":{}},j=e.Sheets[e.SheetNames[d-1]],_e=(j||{})["!type"]||"sheet";switch(_e){case"chart":default:h="xl/worksheets/sheet"+d+"."+a,zip_add_file(c,h,write_ws(d-1,h,i,e,b)),o.sheets.push(h),add_rels(i.wbrels,-1,"worksheets/sheet"+d+"."+a,RELS.WS[0])}if(j){var et=j["!comments"],rt=!1,tt="";et&&et.length>0&&(tt="xl/comments"+d+"."+a,zip_add_file(c,tt,write_cmnt(et,tt)),o.comments.push(tt),add_rels(b,-1,"../comments"+d+"."+a,RELS.CMNT),rt=!0),j["!legacy"]&&rt&&zip_add_file(c,"xl/drawings/vmlDrawing"+d+".vml",write_comments_vml(d,j["!comments"])),delete j["!comments"],delete j["!legacy"]}b["!id"].rId1&&zip_add_file(c,get_rels_path(h),write_rels(b))}return i.Strings!=null&&i.Strings.length>0&&(h="xl/sharedStrings."+a,zip_add_file(c,h,write_sst(i.Strings,h,i)),o.strs.push(h),add_rels(i.wbrels,-1,"sharedStrings."+a,RELS.SST)),h="xl/workbook."+a,zip_add_file(c,h,write_wb(e,h)),o.workbooks.push(h),add_rels(i.rels,1,h,RELS.WB),h="xl/theme/theme1.xml",zip_add_file(c,h,write_theme(e.Themes,i)),o.themes.push(h),add_rels(i.wbrels,-1,"theme/theme1.xml",RELS.THEME),h="xl/styles."+a,zip_add_file(c,h,write_sty(e,h,i)),o.styles.push(h),add_rels(i.wbrels,-1,"styles."+a,RELS.STY),e.vbaraw&&s&&(h="xl/vbaProject.bin",zip_add_file(c,h,e.vbaraw),o.vba.push(h),add_rels(i.wbrels,-1,"vbaProject.bin",RELS.VBA)),h="xl/metadata."+a,zip_add_file(c,h,write_xlmeta(h)),o.metadata.push(h),add_rels(i.wbrels,-1,"metadata."+a,RELS.XLMETA),zip_add_file(c,"[Content_Types].xml",write_ct(o,i)),zip_add_file(c,"_rels/.rels",write_rels(i.rels)),zip_add_file(c,"xl/_rels/workbook."+a+".rels",write_rels(i.wbrels)),delete i.revssf,delete i.ssf,c}function write_zip_xlsx(e,i){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,browser_has_Map?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var a="xml",s=VBAFMTS.indexOf(i.bookType)>-1,o=new_ct();fix_write_opts(i=i||{});var c=zip_new(),h="",d=0;if(i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",zip_add_file(c,h,write_core_props(e.Props,i)),o.coreprops.push(h),add_rels(i.rels,2,h,RELS.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],_=0;_<e.SheetNames.length;++_)(e.Workbook.Sheets[_]||{}).Hidden!=2&&g.push(e.SheetNames[_]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(c,h,write_ext_props(e.Props)),o.extprops.push(h),add_rels(i.rels,3,h,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(h="docProps/custom.xml",zip_add_file(c,h,write_cust_props(e.Custprops)),o.custprops.push(h),add_rels(i.rels,4,h,RELS.CUST_PROPS));var b=["SheetJ5"];for(i.tcid=0,d=1;d<=e.SheetNames.length;++d){var j={"!id":{}},_e=e.Sheets[e.SheetNames[d-1]],et=(_e||{})["!type"]||"sheet";switch(et){case"chart":default:h="xl/worksheets/sheet"+d+"."+a,zip_add_file(c,h,write_ws_xml(d-1,i,e,j)),o.sheets.push(h),add_rels(i.wbrels,-1,"worksheets/sheet"+d+"."+a,RELS.WS[0])}if(_e){var rt=_e["!comments"],tt=!1,it="";if(rt&&rt.length>0){var nt=!1;rt.forEach(function(at){at[1].forEach(function(st){st.T==!0&&(nt=!0)})}),nt&&(it="xl/threadedComments/threadedComment"+d+"."+a,zip_add_file(c,it,write_tcmnt_xml(rt,b,i)),o.threadedcomments.push(it),add_rels(j,-1,"../threadedComments/threadedComment"+d+"."+a,RELS.TCMNT)),it="xl/comments"+d+"."+a,zip_add_file(c,it,write_comments_xml(rt)),o.comments.push(it),add_rels(j,-1,"../comments"+d+"."+a,RELS.CMNT),tt=!0}_e["!legacy"]&&tt&&zip_add_file(c,"xl/drawings/vmlDrawing"+d+".vml",write_comments_vml(d,_e["!comments"])),delete _e["!comments"],delete _e["!legacy"]}j["!id"].rId1&&zip_add_file(c,get_rels_path(h),write_rels(j))}return i.Strings!=null&&i.Strings.length>0&&(h="xl/sharedStrings."+a,zip_add_file(c,h,write_sst_xml(i.Strings,i)),o.strs.push(h),add_rels(i.wbrels,-1,"sharedStrings."+a,RELS.SST)),h="xl/workbook."+a,zip_add_file(c,h,write_wb_xml(e)),o.workbooks.push(h),add_rels(i.rels,1,h,RELS.WB),h="xl/theme/theme1.xml",zip_add_file(c,h,write_theme(e.Themes,i)),o.themes.push(h),add_rels(i.wbrels,-1,"theme/theme1.xml",RELS.THEME),h="xl/styles."+a,zip_add_file(c,h,write_sty_xml(e,i)),o.styles.push(h),add_rels(i.wbrels,-1,"styles."+a,RELS.STY),e.vbaraw&&s&&(h="xl/vbaProject.bin",zip_add_file(c,h,e.vbaraw),o.vba.push(h),add_rels(i.wbrels,-1,"vbaProject.bin",RELS.VBA)),h="xl/metadata."+a,zip_add_file(c,h,write_xlmeta_xml()),o.metadata.push(h),add_rels(i.wbrels,-1,"metadata."+a,RELS.XLMETA),b.length>1&&(h="xl/persons/person.xml",zip_add_file(c,h,write_people_xml(b)),o.people.push(h),add_rels(i.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(c,"[Content_Types].xml",write_ct(o,i)),zip_add_file(c,"_rels/.rels",write_rels(i.rels)),zip_add_file(c,"xl/_rels/workbook."+a+".rels",write_rels(i.wbrels)),delete i.revssf,delete i.ssf,c}function firstbyte(e,i){var a="";switch((i||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=Base64_decode(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(i&&i.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function read_cfb(e,i){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,i):parse_xlscfb(e,i)}function read_zip(e,i){var a,s=e,o=i||{};return o.type||(o.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),a=zip_read(s,o),parse_zip(a,o)}function read_plaintext(e,i){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return parse_xlml(e.slice(a),i);default:break e}return PRN.to_workbook(e,i)}function read_plaintext_raw(e,i){var a="",s=firstbyte(e,i);switch(i.type){case"base64":a=Base64_decode(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=cc2str(e);break;default:throw new Error("Unrecognized type "+i.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(a=utf8read(a)),i.type="binary",read_plaintext(a,i)}function read_utf16(e,i){var a=e;return i.type=="base64"&&(a=Base64_decode(a)),a=$cptable.utils.decode(1200,a.slice(2),"str"),i.type="binary",read_plaintext(a,i)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,i,a,s){return s?(a.type="string",PRN.to_workbook(e,a)):PRN.to_workbook(i,a)}function readSync(e,i){reset_cp();var a=i||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(a=dup(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var s=e,o=[0,0,0,0],c=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),_ssfopts={},a.dateNF&&(_ssfopts.dateNF=a.dateNF),a.type||(a.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=has_buf?"buffer":"binary",s=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(a.type="array")),a.type=="string"&&(c=!0,a.type="binary",a.codepage=65001,s=bstrify(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var h=new ArrayBuffer(3),d=new Uint8Array(h);if(d.foo="bar",!d.foo)return a=dup(a),a.type="array",readSync(ab2a(s),a)}switch((o=firstbyte(s,a))[0]){case 208:if(o[1]===207&&o[2]===17&&o[3]===224&&o[4]===161&&o[5]===177&&o[6]===26&&o[7]===225)return read_cfb(CFB.read(s,a),a);break;case 9:if(o[1]<=8)return parse_xlscfb(s,a);break;case 60:return parse_xlml(s,a);case 73:if(o[1]===73&&o[2]===42&&o[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(o[1]===68)return read_wb_ID(s,a);break;case 84:if(o[1]===65&&o[2]===66&&o[3]===76)return DIF.to_workbook(s,a);break;case 80:return o[1]===75&&o[2]<9&&o[3]<9?read_zip(s,a):read_prn(e,s,a,c);case 239:return o[3]===60?parse_xlml(s,a):read_prn(e,s,a,c);case 255:if(o[1]===254)return read_utf16(s,a);if(o[1]===0&&o[2]===2&&o[3]===0)return WK_.to_workbook(s,a);break;case 0:if(o[1]===0&&(o[2]>=2&&o[3]===0||o[2]===0&&(o[3]===8||o[3]===9)))return WK_.to_workbook(s,a);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(s,a);case 123:if(o[1]===92&&o[2]===114&&o[3]===116)return RTF.to_workbook(s,a);break;case 10:case 13:case 32:return read_plaintext_raw(s,a);case 137:if(o[1]===80&&o[2]===78&&o[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(o[0])>-1&&o[2]<=12&&o[3]<=31?DBF.to_workbook(s,a):read_prn(e,s,a,c)}function write_cfb_ctr(e,i){switch(i.type){case"base64":case"binary":break;case"buffer":case"array":i.type="";break;case"file":return write_dl(i.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");default:throw new Error("Unrecognized type "+i.type)}return CFB.write(e,i)}function write_zip_type(e,i){var a=dup(i||{}),s=write_zip(e,a);return write_zip_denouement(s,a)}function write_zip_denouement(e,i){var a={},s=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(i.compression&&(a.compression="DEFLATE"),i.password)a.type=s;else switch(i.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");case"buffer":case"file":a.type=s;break;default:throw new Error("Unrecognized type "+i.type)}var o=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!i.compression}):e.generate(a);if(typeof Deno<"u"&&typeof o=="string"){if(i.type=="binary"||i.type=="base64")return o;o=new Uint8Array(s2ab(o))}return i.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(o,i.password),i):i.type==="file"?write_dl(i.file,o):i.type=="string"?utf8read(o):o}function write_cfb_type(e,i){var a=i||{},s=write_xlscfb(e,a);return write_cfb_ctr(s,a)}function write_string_type(e,i,a){a||(a="");var s=a+e;switch(i.type){case"base64":return Base64_encode(utf8write(s));case"binary":return utf8write(s);case"string":return e;case"file":return write_dl(i.file,s,"utf8");case"buffer":return has_buf?Buffer_from(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):write_string_type(s,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function write_stxt_type(e,i){switch(i.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(i.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function write_binary_type(e,i){switch(i.type){case"string":case"base64":case"binary":for(var a="",s=0;s<e.length;++s)a+=String.fromCharCode(e[s]);return i.type=="base64"?Base64_encode(a):i.type=="string"?utf8read(a):a;case"file":return write_dl(i.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+i.type)}}function writeSync(e,i){reset_cp(),check_wb(e);var a=dup(i||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var s=writeSync(e,a);return a.type="array",s2ab(s)}var o=0;if(a.sheet&&(typeof a.sheet=="number"?o=a.sheet:o=e.SheetNames.indexOf(a.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,a),a);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[o]],a),a);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[o]],a),a);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[o]],a),a,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[o]],a),a);case"fods":return write_string_type(write_ods(e,a),a);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[o]],a),a);case"wk3":return write_binary_type(WK_.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),write_binary_type(write_biff_buf(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),write_cfb_type(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var i={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(e.bookType=a.slice(1)),e.bookType=i[e.bookType]||e.bookType}}function writeFileSync(e,i,a){var s={};return s.type="file",s.file=i,resolve_book_type(s),writeSync(e,s)}function make_json_row(e,i,a,s,o,c,h,d){var g=encode_row(a),_=d.defval,b=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),j=!0,_e=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(_e,"__rowNum__",{value:a,enumerable:!1})}catch{_e.__rowNum__=a}else _e.__rowNum__=a;if(!h||e[a])for(var et=i.s.c;et<=i.e.c;++et){var rt=h?e[a][et]:e[s[et]+g];if(rt===void 0||rt.t===void 0){if(_===void 0)continue;c[et]!=null&&(_e[c[et]]=_);continue}var tt=rt.v;switch(rt.t){case"z":if(tt==null)break;continue;case"e":tt=tt==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+rt.t)}if(c[et]!=null){if(tt==null)if(rt.t=="e"&&tt===null)_e[c[et]]=null;else if(_!==void 0)_e[c[et]]=_;else if(b&&tt===null)_e[c[et]]=null;else continue;else _e[c[et]]=b&&(rt.t!=="n"||rt.t==="n"&&d.rawNumbers!==!1)?tt:format_cell(rt,tt,d);tt!=null&&(j=!1)}}return{row:_e,isempty:j}}function sheet_to_json(e,i){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},s=0,o=1,c=[],h=0,d="",g={s:{r:0,c:0},e:{r:0,c:0}},_=i||{},b=_.range!=null?_.range:e["!ref"];switch(_.header===1?s=1:_.header==="A"?s=2:Array.isArray(_.header)?s=3:_.header==null&&(s=0),typeof b){case"string":g=safe_decode_range(b);break;case"number":g=safe_decode_range(e["!ref"]),g.s.r=b;break;default:g=b}s>0&&(o=0);var j=encode_row(g.s.r),_e=[],et=[],rt=0,tt=0,it=Array.isArray(e),nt=g.s.r,at=0,st={};it&&!e[nt]&&(e[nt]=[]);var dt=_.skipHidden&&e["!cols"]||[],lt=_.skipHidden&&e["!rows"]||[];for(at=g.s.c;at<=g.e.c;++at)if(!(dt[at]||{}).hidden)switch(_e[at]=encode_col(at),a=it?e[nt][at]:e[_e[at]+j],s){case 1:c[at]=at-g.s.c;break;case 2:c[at]=_e[at];break;case 3:c[at]=_.header[at-g.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=h=format_cell(a,null,_),tt=st[h]||0,!tt)st[h]=1;else{do d=h+"_"+tt++;while(st[d]);st[h]=tt,st[d]=1}c[at]=d}for(nt=g.s.r+o;nt<=g.e.r;++nt)if(!(lt[nt]||{}).hidden){var ut=make_json_row(e,g,nt,_e,s,c,it,_);(ut.isempty===!1||(s===1?_.blankrows!==!1:_.blankrows))&&(et[rt++]=ut.row)}return et.length=rt,et}var qreg=/"/g;function make_csv_row(e,i,a,s,o,c,h,d){for(var g=!0,_=[],b="",j=encode_row(a),_e=i.s.c;_e<=i.e.c;++_e)if(s[_e]){var et=d.dense?(e[a]||[])[_e]:e[s[_e]+j];if(et==null)b="";else if(et.v!=null){g=!1,b=""+(d.rawNumbers&&et.t=="n"?et.v:format_cell(et,null,d));for(var rt=0,tt=0;rt!==b.length;++rt)if((tt=b.charCodeAt(rt))===o||tt===c||tt===34||d.forceQuotes){b='"'+b.replace(qreg,'""')+'"';break}b=="ID"&&(b='"ID"')}else et.f!=null&&!et.F?(g=!1,b="="+et.f,b.indexOf(",")>=0&&(b='"'+b.replace(qreg,'""')+'"')):b="";_.push(b)}return d.blankrows===!1&&g?null:_.join(h)}function sheet_to_csv(e,i){var a=[],s=i??{};if(e==null||e["!ref"]==null)return"";var o=safe_decode_range(e["!ref"]),c=s.FS!==void 0?s.FS:",",h=c.charCodeAt(0),d=s.RS!==void 0?s.RS:`
`,g=d.charCodeAt(0),_=new RegExp((c=="|"?"\\|":c)+"+$"),b="",j=[];s.dense=Array.isArray(e);for(var _e=s.skipHidden&&e["!cols"]||[],et=s.skipHidden&&e["!rows"]||[],rt=o.s.c;rt<=o.e.c;++rt)(_e[rt]||{}).hidden||(j[rt]=encode_col(rt));for(var tt=0,it=o.s.r;it<=o.e.r;++it)(et[it]||{}).hidden||(b=make_csv_row(e,o,it,j,h,g,c,s),b!=null&&(s.strip&&(b=b.replace(_,"")),(b||s.blankrows!==!1)&&a.push((tt++?d:"")+b)));return delete s.dense,a.join("")}function sheet_to_txt(e,i){i||(i={}),i.FS="	",i.RS=`
`;var a=sheet_to_csv(e,i);return a}function sheet_to_formulae(e){var i="",a,s="";if(e==null||e["!ref"]==null)return[];var o=safe_decode_range(e["!ref"]),c="",h=[],d,g=[],_=Array.isArray(e);for(d=o.s.c;d<=o.e.c;++d)h[d]=encode_col(d);for(var b=o.s.r;b<=o.e.r;++b)for(c=encode_row(b),d=o.s.c;d<=o.e.c;++d)if(i=h[d]+c,a=_?(e[b]||[])[d]:e[i],s="",a!==void 0){if(a.F!=null){if(i=a.F,!a.f)continue;s=a.f,i.indexOf(":")==-1&&(i=i+":"+i)}if(a.f!=null)s=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)s=""+a.v;else if(a.t=="b")s=a.v?"TRUE":"FALSE";else if(a.w!==void 0)s="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?s="'"+a.v:s=""+a.v}}g[g.length]=i+"="+s}return g}function sheet_add_json(e,i,a){var s=a||{},o=+!s.skipHeader,c=e||{},h=0,d=0;if(c&&s.origin!=null)if(typeof s.origin=="number")h=s.origin;else{var g=typeof s.origin=="string"?decode_cell(s.origin):s.origin;h=g.r,d=g.c}var _,b={s:{c:0,r:0},e:{c:d,r:h+i.length-1+o}};if(c["!ref"]){var j=safe_decode_range(c["!ref"]);b.e.c=Math.max(b.e.c,j.e.c),b.e.r=Math.max(b.e.r,j.e.r),h==-1&&(h=j.e.r+1,b.e.r=h+i.length-1+o)}else h==-1&&(h=0,b.e.r=i.length-1+o);var _e=s.header||[],et=0;i.forEach(function(tt,it){keys(tt).forEach(function(nt){(et=_e.indexOf(nt))==-1&&(_e[et=_e.length]=nt);var at=tt[nt],st="z",dt="",lt=encode_cell({c:d+et,r:h+it+o});_=ws_get_cell_stub(c,lt),at&&typeof at=="object"&&!(at instanceof Date)?c[lt]=at:(typeof at=="number"?st="n":typeof at=="boolean"?st="b":typeof at=="string"?st="s":at instanceof Date?(st="d",s.cellDates||(st="n",at=datenum(at)),dt=s.dateNF||table_fmt[14]):at===null&&s.nullError&&(st="e",at=0),_?(_.t=st,_.v=at,delete _.w,delete _.R,dt&&(_.z=dt)):c[lt]=_={t:st,v:at},dt&&(_.z=dt))})}),b.e.c=Math.max(b.e.c,d+_e.length-1);var rt=encode_row(h);if(o)for(et=0;et<_e.length;++et)c[encode_col(et+d)+rt]={t:"s",v:_e[et]};return c["!ref"]=encode_range(b),c}function json_to_sheet(e,i){return sheet_add_json(null,e,i)}function ws_get_cell_stub(e,i,a){if(typeof i=="string"){if(Array.isArray(e)){var s=decode_cell(i);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[i]||(e[i]={t:"z"})}return typeof i!="number"?ws_get_cell_stub(e,encode_cell(i)):ws_get_cell_stub(e,encode_cell({r:i,c:a||0}))}function wb_sheet_idx(e,i){if(typeof i=="number"){if(i>=0&&e.SheetNames.length>i)return i;throw new Error("Cannot find sheet # "+i)}else if(typeof i=="string"){var a=e.SheetNames.indexOf(i);if(a>-1)return a;throw new Error("Cannot find sheet name |"+i+"|")}else throw new Error("Cannot find sheet |"+i+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,i,a,s){var o=1;if(!a)for(;o<=65535&&e.SheetNames.indexOf(a="Sheet"+o)!=-1;++o,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(a)>=0){var c=a.match(/(^.*?)(\d+)$/);o=c&&+c[2]||0;var h=c&&c[1]||a;for(++o;o<=65535&&e.SheetNames.indexOf(a=h+o)!=-1;++o);}if(check_ws_name(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=i,a}function book_set_sheet_visibility(e,i,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=wb_sheet_idx(e,i);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[s].Hidden=a}function cell_set_number_format(e,i){return e.z=i,e}function cell_set_hyperlink(e,i,a){return i?(e.l={Target:i},a&&(e.l.Tooltip=a)):delete e.l,e}function cell_set_internal_link(e,i,a){return cell_set_hyperlink(e,"#"+i,a)}function cell_add_comment(e,i,a){e.c||(e.c=[]),e.c.push({t:i,a:a||"SheetJS"})}function sheet_set_array_formula(e,i,a,s){for(var o=typeof i!="string"?i:safe_decode_range(i),c=typeof i=="string"?i:encode_range(i),h=o.s.r;h<=o.e.r;++h)for(var d=o.s.c;d<=o.e.c;++d){var g=ws_get_cell_stub(e,h,d);g.t="n",g.F=c,delete g.v,h==o.s.r&&d==o.s.c&&(g.f=a,s&&(g.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function exportToCSV(e){if(e.length===0){alert("Keine Daten zum Exportieren vorhanden");return}const i=["Datum","Mitarbeiter","Termin Nr.","Kunde","Start","Ende","Zeitfenster"],a=e.map(d=>[format(d.date,"dd.MM.yyyy"),d.employee,d.appointmentNumber.toString(),d.customer,format(d.startTime,"HH:mm"),format(d.endTime,"HH:mm"),d.timeWindow]),s=[i.join(","),...a.map(d=>d.map(g=>`"${g}"`).join(","))].join(`
`),o=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),h=URL.createObjectURL(o);c.setAttribute("href",h),c.setAttribute("download",`tour-report-${format(new Date,"yyyy-MM-dd-HHmm")}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}function exportToExcel(e){if(e.length===0){alert("Keine Daten zum Exportieren vorhanden");return}const i=[["Datum","Mitarbeiter","Termin Nr.","Kunde","Start","Ende","Zeitfenster"],...e.map(h=>[format(h.date,"dd.MM.yyyy"),h.employee,h.appointmentNumber,h.customer,format(h.startTime,"HH:mm"),format(h.endTime,"HH:mm"),h.timeWindow])],a=utils.book_new(),s=utils.aoa_to_sheet(i),o=[{wch:12},{wch:20},{wch:12},{wch:25},{wch:10},{wch:10},{wch:18}];s["!cols"]=o;const c=utils.decode_range(s["!ref"]||"A1");for(let h=c.s.c;h<=c.e.c;h++){const d=utils.encode_cell({r:0,c:h});s[d]&&(s[d].s={font:{bold:!0},fill:{fgColor:{rgb:"E0E0E0"}}})}utils.book_append_sheet(a,s,"Tour Reports"),writeFileSync(a,`tour-report-${format(new Date,"yyyy-MM-dd-HHmm")}.xlsx`)}function AppointmentTable({entries:e}){return e.length===0?jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsx(CardContent,{className:"p-12 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Keine Termine vorhanden. Laden Sie eine Datei hoch, um zu beginnen."})})}):jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs(CardTitle,{children:["Tour-Termine (",e.length,")"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>exportToCSV(e),className:"gap-2",children:[jsxRuntimeExports.jsx(Download,{size:16}),"CSV"]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",onClick:()=>exportToExcel(e),className:"gap-2",children:[jsxRuntimeExports.jsx(FileSpreadsheet,{size:16}),"Excel"]})]})]})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full border-collapse",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-border bg-muted/50",children:[jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Datum"}),jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Mitarbeiter"}),jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Termin Nr."}),jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Kunde"}),jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Start"}),jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Ende"}),jsxRuntimeExports.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Zeitfenster"})]})}),jsxRuntimeExports.jsx("tbody",{children:e.map((i,a)=>jsxRuntimeExports.jsxs(motion.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.02,duration:.3},className:"border-b border-border hover:bg-muted/30 transition-colors",children:[jsxRuntimeExports.jsx("td",{className:"p-3 text-sm",children:format(i.date,"dd.MM.yyyy",{locale:de})}),jsxRuntimeExports.jsx("td",{className:"p-3 text-sm font-medium",children:i.employee}),jsxRuntimeExports.jsx("td",{className:"p-3 text-sm text-center",children:i.appointmentNumber}),jsxRuntimeExports.jsx("td",{className:"p-3 text-sm",children:i.customer}),jsxRuntimeExports.jsx("td",{className:"p-3 text-sm font-mono",children:format(i.startTime,"HH:mm")}),jsxRuntimeExports.jsx("td",{className:"p-3 text-sm font-mono",children:format(i.endTime,"HH:mm")}),jsxRuntimeExports.jsx("td",{className:"p-3 text-sm font-mono text-muted-foreground",children:i.timeWindow})]},a))})]})})}),jsxRuntimeExports.jsxs(CardFooter,{className:"text-sm text-muted-foreground",children:["Gesamt: ",e.length," Termine"]})]})}function Input({label:e,error:i,className:a="",...s}){return jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[e&&jsxRuntimeExports.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e}),jsxRuntimeExports.jsx("input",{className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${i?"border-destructive":""} ${a}`,...s}),i&&jsxRuntimeExports.jsx("p",{className:"text-sm text-destructive",children:i})]})}function Label({children:e,htmlFor:i,className:a=""}){return jsxRuntimeExports.jsx("label",{htmlFor:i,className:`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${a}`,children:e})}const DEFAULT_SETTINGS={tourStartTime:"09:00",appointmentDuration:60,pauseMin:60,pauseMax:90,enableTimeWindow:!1};function SettingsPanel({settings:e,onSettingsChange:i}){const[a,s]=reactExports.useState(!1),[o,c]=reactExports.useState(e);reactExports.useEffect(()=>{c(e)},[e]);const h=()=>{i(o),s(!1)},d=()=>{c(DEFAULT_SETTINGS),i(DEFAULT_SETTINGS)};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"default",onClick:()=>s(!a),className:"gap-2",children:[jsxRuntimeExports.jsx(Settings,{size:18}),"Einstellungen"]}),jsxRuntimeExports.jsx(AnimatePresence,{children:a&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 top-full mt-2 z-50 w-96",children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Einstellungen"})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"tourStartTime",children:"Tourstart-Zeit"}),jsxRuntimeExports.jsx(Input,{id:"tourStartTime",type:"time",value:o.tourStartTime,onChange:g=>c({...o,tourStartTime:g.target.value})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"appointmentDuration",children:"Termindauer (Minuten)"}),jsxRuntimeExports.jsx(Input,{id:"appointmentDuration",type:"number",min:"15",max:"240",step:"15",value:o.appointmentDuration,onChange:g=>c({...o,appointmentDuration:parseInt(g.target.value,10)})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"pauseMin",children:"Minimale Pause (Minuten)"}),jsxRuntimeExports.jsx(Input,{id:"pauseMin",type:"number",min:"0",max:"180",step:"5",value:o.pauseMin,onChange:g=>c({...o,pauseMin:parseInt(g.target.value,10)})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"pauseMax",children:"Maximale Pause (Minuten)"}),jsxRuntimeExports.jsx(Input,{id:"pauseMax",type:"number",min:"0",max:"180",step:"5",value:o.pauseMax,onChange:g=>c({...o,pauseMax:parseInt(g.target.value,10)})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{id:"enableTimeWindow",type:"checkbox",checked:o.enableTimeWindow,onChange:g=>c({...o,enableTimeWindow:g.target.checked}),className:"h-4 w-4 rounded border-input text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2"}),jsxRuntimeExports.jsx(Label,{htmlFor:"enableTimeWindow",className:"cursor-pointer",children:"3-Stunden-Zeitfenster aktivieren"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 pt-4",children:[jsxRuntimeExports.jsx(Button,{onClick:h,className:"flex-1",children:"Speichern"}),jsxRuntimeExports.jsx(Button,{onClick:d,variant:"outline",className:"flex-1",children:"Zurcksetzen"})]})]})]})})}),a&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)})]})}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(i,a){module.exports=i.pdfjsLib=a()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,i)=>{var Hr;Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PromiseCapability=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationReplyType=i.AnnotationPrefix=i.AnnotationMode=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=yt,i.bytesToString=er,i.createValidAbsoluteUrl=$t,i.getModificationDate=Sr,i.getUuid=Dr,i.getVerbosityLevel=Nt,i.info=Ht,i.isArrayBuffer=Zt,i.isArrayEqual=Er,i.isNodeJS=void 0,i.normalizeUnicode=kr,i.objectFromMap=hr,i.objectSize=cr,i.setVerbosityLevel=Gt,i.shadow=_t,i.string32=ur,i.stringToBytes=Tt,i.stringToPDFString=dr,i.stringToUTF8String=vr,i.unreachable=Wt,i.utf8StringToString=_r,i.warn=It;const a=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=a;const s=[1,0,0,1,0,0];i.IDENTITY_MATRIX=s;const o=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=o;const c=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=c;const h=1.35;i.LINE_FACTOR=h;const d=.35;i.LINE_DESCENT_FACTOR=d;const g=d/h;i.BASELINE_FACTOR=g;const _={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=_;const b={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=b;const j="pdfjs_internal_editor_";i.AnnotationEditorPrefix=j;const _e={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};i.AnnotationEditorType=_e;const et={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};i.AnnotationEditorParamsType=et;const rt={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=rt;const tt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=tt;const it={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=it;const nt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=nt;const at={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=at;const st={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=st;const dt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=dt;const lt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=lt;const ut={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=ut;const ot={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=ot;const ft={O:"PageOpen",C:"PageClose"};i.PageActionEventType=ft;const pt={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=pt;const St={NONE:0,BINARY:1};i.CMapCompressionType=St;const gt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=gt;const vt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=vt;let At=pt.WARNINGS;function Gt(yr){Number.isInteger(yr)&&(At=yr)}function Nt(){return At}function Ht(yr){At>=pt.INFOS&&console.log(`Info: ${yr}`)}function It(yr){At>=pt.WARNINGS&&console.log(`Warning: ${yr}`)}function Wt(yr){throw new Error(yr)}function yt(yr,rr){yr||Wt(rr)}function Dt(yr){switch(yr==null?void 0:yr.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $t(yr,rr=null,ar=null){if(!yr)return null;try{if(ar&&typeof yr=="string"){if(ar.addDefaultProtocol&&yr.startsWith("www.")){const zr=yr.match(/\./g);(zr==null?void 0:zr.length)>=2&&(yr=`http://${yr}`)}if(ar.tryConvertEncoding)try{yr=vr(yr)}catch{}}const Rr=rr?new URL(yr,rr):new URL(yr);if(Dt(Rr))return Rr}catch{}return null}function _t(yr,rr,ar,Rr=!1){return Object.defineProperty(yr,rr,{value:ar,enumerable:!Rr,configurable:!0,writable:!1}),ar}const ht=function(){function rr(ar,Rr){this.constructor===rr&&Wt("Cannot initialize BaseException."),this.message=ar,this.name=Rr}return rr.prototype=new Error,rr.constructor=rr,rr}();i.BaseException=ht;class ct extends ht{constructor(rr,ar){super(rr,"PasswordException"),this.code=ar}}i.PasswordException=ct;class xt extends ht{constructor(rr,ar){super(rr,"UnknownErrorException"),this.details=ar}}i.UnknownErrorException=xt;class Et extends ht{constructor(rr){super(rr,"InvalidPDFException")}}i.InvalidPDFException=Et;class bt extends ht{constructor(rr){super(rr,"MissingPDFException")}}i.MissingPDFException=bt;class Ct extends ht{constructor(rr,ar){super(rr,"UnexpectedResponseException"),this.status=ar}}i.UnexpectedResponseException=Ct;class Ot extends ht{constructor(rr){super(rr,"FormatError")}}i.FormatError=Ot;class jt extends ht{constructor(rr){super(rr,"AbortException")}}i.AbortException=jt;function er(yr){(typeof yr!="object"||(yr==null?void 0:yr.length)===void 0)&&Wt("Invalid argument for bytesToString");const rr=yr.length,ar=8192;if(rr<ar)return String.fromCharCode.apply(null,yr);const Rr=[];for(let zr=0;zr<rr;zr+=ar){const Wr=Math.min(zr+ar,rr),zt=yr.subarray(zr,Wr);Rr.push(String.fromCharCode.apply(null,zt))}return Rr.join("")}function Tt(yr){typeof yr!="string"&&Wt("Invalid argument for stringToBytes");const rr=yr.length,ar=new Uint8Array(rr);for(let Rr=0;Rr<rr;++Rr)ar[Rr]=yr.charCodeAt(Rr)&255;return ar}function ur(yr){return String.fromCharCode(yr>>24&255,yr>>16&255,yr>>8&255,yr&255)}function cr(yr){return Object.keys(yr).length}function hr(yr){const rr=Object.create(null);for(const[ar,Rr]of yr)rr[ar]=Rr;return rr}function Yt(){const yr=new Uint8Array(4);return yr[0]=1,new Uint32Array(yr.buffer,0,1)[0]===1}function Xt(){try{return new Function(""),!0}catch{return!1}}class Ft{static get isLittleEndian(){return _t(this,"isLittleEndian",Yt())}static get isEvalSupported(){return _t(this,"isEvalSupported",Xt())}static get isOffscreenCanvasSupported(){return _t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?_t(this,"platform",{isWin:!1,isMac:!1}):_t(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var rr,ar;return _t(this,"isCSSRoundSupported",(ar=(rr=globalThis.CSS)==null?void 0:rr.supports)==null?void 0:ar.call(rr,"width: round(1.5px, 1px)"))}}i.FeatureTest=Ft;const Ut=[...Array(256).keys()].map(yr=>yr.toString(16).padStart(2,"0"));class qt{static makeHexColor(rr,ar,Rr){return`#${Ut[rr]}${Ut[ar]}${Ut[Rr]}`}static scaleMinMax(rr,ar){let Rr;rr[0]?(rr[0]<0&&(Rr=ar[0],ar[0]=ar[1],ar[1]=Rr),ar[0]*=rr[0],ar[1]*=rr[0],rr[3]<0&&(Rr=ar[2],ar[2]=ar[3],ar[3]=Rr),ar[2]*=rr[3],ar[3]*=rr[3]):(Rr=ar[0],ar[0]=ar[2],ar[2]=Rr,Rr=ar[1],ar[1]=ar[3],ar[3]=Rr,rr[1]<0&&(Rr=ar[2],ar[2]=ar[3],ar[3]=Rr),ar[2]*=rr[1],ar[3]*=rr[1],rr[2]<0&&(Rr=ar[0],ar[0]=ar[1],ar[1]=Rr),ar[0]*=rr[2],ar[1]*=rr[2]),ar[0]+=rr[4],ar[1]+=rr[4],ar[2]+=rr[5],ar[3]+=rr[5]}static transform(rr,ar){return[rr[0]*ar[0]+rr[2]*ar[1],rr[1]*ar[0]+rr[3]*ar[1],rr[0]*ar[2]+rr[2]*ar[3],rr[1]*ar[2]+rr[3]*ar[3],rr[0]*ar[4]+rr[2]*ar[5]+rr[4],rr[1]*ar[4]+rr[3]*ar[5]+rr[5]]}static applyTransform(rr,ar){const Rr=rr[0]*ar[0]+rr[1]*ar[2]+ar[4],zr=rr[0]*ar[1]+rr[1]*ar[3]+ar[5];return[Rr,zr]}static applyInverseTransform(rr,ar){const Rr=ar[0]*ar[3]-ar[1]*ar[2],zr=(rr[0]*ar[3]-rr[1]*ar[2]+ar[2]*ar[5]-ar[4]*ar[3])/Rr,Wr=(-rr[0]*ar[1]+rr[1]*ar[0]+ar[4]*ar[1]-ar[5]*ar[0])/Rr;return[zr,Wr]}static getAxialAlignedBoundingBox(rr,ar){const Rr=this.applyTransform(rr,ar),zr=this.applyTransform(rr.slice(2,4),ar),Wr=this.applyTransform([rr[0],rr[3]],ar),zt=this.applyTransform([rr[2],rr[1]],ar);return[Math.min(Rr[0],zr[0],Wr[0],zt[0]),Math.min(Rr[1],zr[1],Wr[1],zt[1]),Math.max(Rr[0],zr[0],Wr[0],zt[0]),Math.max(Rr[1],zr[1],Wr[1],zt[1])]}static inverseTransform(rr){const ar=rr[0]*rr[3]-rr[1]*rr[2];return[rr[3]/ar,-rr[1]/ar,-rr[2]/ar,rr[0]/ar,(rr[2]*rr[5]-rr[4]*rr[3])/ar,(rr[4]*rr[1]-rr[5]*rr[0])/ar]}static singularValueDecompose2dScale(rr){const ar=[rr[0],rr[2],rr[1],rr[3]],Rr=rr[0]*ar[0]+rr[1]*ar[2],zr=rr[0]*ar[1]+rr[1]*ar[3],Wr=rr[2]*ar[0]+rr[3]*ar[2],zt=rr[2]*ar[1]+rr[3]*ar[3],gr=(Rr+zt)/2,Tr=Math.sqrt((Rr+zt)**2-4*(Rr*zt-Wr*zr))/2,Lr=gr+Tr||1,Or=gr-Tr||1;return[Math.sqrt(Lr),Math.sqrt(Or)]}static normalizeRect(rr){const ar=rr.slice(0);return rr[0]>rr[2]&&(ar[0]=rr[2],ar[2]=rr[0]),rr[1]>rr[3]&&(ar[1]=rr[3],ar[3]=rr[1]),ar}static intersect(rr,ar){const Rr=Math.max(Math.min(rr[0],rr[2]),Math.min(ar[0],ar[2])),zr=Math.min(Math.max(rr[0],rr[2]),Math.max(ar[0],ar[2]));if(Rr>zr)return null;const Wr=Math.max(Math.min(rr[1],rr[3]),Math.min(ar[1],ar[3])),zt=Math.min(Math.max(rr[1],rr[3]),Math.max(ar[1],ar[3]));return Wr>zt?null:[Rr,Wr,zr,zt]}static bezierBoundingBox(rr,ar,Rr,zr,Wr,zt,gr,Tr){const Lr=[],Or=[[],[]];let Fr,Vt,Mt,Kt,lr,fr,xr,wr;for(let Lt=0;Lt<2;++Lt){if(Lt===0?(Vt=6*rr-12*Rr+6*Wr,Fr=-3*rr+9*Rr-9*Wr+3*gr,Mt=3*Rr-3*rr):(Vt=6*ar-12*zr+6*zt,Fr=-3*ar+9*zr-9*zt+3*Tr,Mt=3*zr-3*ar),Math.abs(Fr)<1e-12){if(Math.abs(Vt)<1e-12)continue;Kt=-Mt/Vt,0<Kt&&Kt<1&&Lr.push(Kt);continue}xr=Vt*Vt-4*Mt*Fr,wr=Math.sqrt(xr),!(xr<0)&&(lr=(-Vt+wr)/(2*Fr),0<lr&&lr<1&&Lr.push(lr),fr=(-Vt-wr)/(2*Fr),0<fr&&fr<1&&Lr.push(fr))}let Ir=Lr.length,Mr;const wt=Ir;for(;Ir--;)Kt=Lr[Ir],Mr=1-Kt,Or[0][Ir]=Mr*Mr*Mr*rr+3*Mr*Mr*Kt*Rr+3*Mr*Kt*Kt*Wr+Kt*Kt*Kt*gr,Or[1][Ir]=Mr*Mr*Mr*ar+3*Mr*Mr*Kt*zr+3*Mr*Kt*Kt*zt+Kt*Kt*Kt*Tr;return Or[0][wt]=rr,Or[1][wt]=ar,Or[0][wt+1]=gr,Or[1][wt+1]=Tr,Or[0].length=Or[1].length=wt+2,[Math.min(...Or[0]),Math.min(...Or[1]),Math.max(...Or[0]),Math.max(...Or[1])]}}i.Util=qt;const Jt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function dr(yr){if(yr[0]>=""){let ar;if(yr[0]===""&&yr[1]===""?ar="utf-16be":yr[0]===""&&yr[1]===""?ar="utf-16le":yr[0]===""&&yr[1]===""&&yr[2]===""&&(ar="utf-8"),ar)try{const Rr=new TextDecoder(ar,{fatal:!0}),zr=Tt(yr);return Rr.decode(zr)}catch(Rr){It(`stringToPDFString: "${Rr}".`)}}const rr=[];for(let ar=0,Rr=yr.length;ar<Rr;ar++){const zr=Jt[yr.charCodeAt(ar)];rr.push(zr?String.fromCharCode(zr):yr.charAt(ar))}return rr.join("")}function vr(yr){return decodeURIComponent(escape(yr))}function _r(yr){return unescape(encodeURIComponent(yr))}function Zt(yr){return typeof yr=="object"&&(yr==null?void 0:yr.byteLength)!==void 0}function Er(yr,rr){if(yr.length!==rr.length)return!1;for(let ar=0,Rr=yr.length;ar<Rr;ar++)if(yr[ar]!==rr[ar])return!1;return!0}function Sr(yr=new Date){return[yr.getUTCFullYear().toString(),(yr.getUTCMonth()+1).toString().padStart(2,"0"),yr.getUTCDate().toString().padStart(2,"0"),yr.getUTCHours().toString().padStart(2,"0"),yr.getUTCMinutes().toString().padStart(2,"0"),yr.getUTCSeconds().toString().padStart(2,"0")].join("")}class Vr{constructor(){nr(this,Hr,!1);this.promise=new Promise((rr,ar)=>{this.resolve=Rr=>{ir(this,Hr,!0),rr(Rr)},this.reject=Rr=>{ir(this,Hr,!0),ar(Rr)}})}get settled(){return mt(this,Hr)}}Hr=new WeakMap,i.PromiseCapability=Vr;let Nr=null,Pr=null;function kr(yr){return Nr||(Nr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Pr=new Map([["","t"]])),yr.replaceAll(Nr,(rr,ar,Rr)=>ar?ar.normalize("NFKC"):Pr.get(Rr))}function Dr(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const yr=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(yr);else for(let rr=0;rr<32;rr++)yr[rr]=Math.floor(Math.random()*255);return er(yr)}const jr="pdfjs_internal_id_";i.AnnotationPrefix=jr},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var e,a,s,o,tn,xn,d,g,_,b,j,_e,et,rt,tt,vn,nt,at,Ln,dt,lt;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(ot){if(typeof ot=="string"||ot instanceof URL?ot={url:ot}:(0,_util.isArrayBuffer)(ot)&&(ot={data:ot}),typeof ot!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!ot.url&&!ot.data&&!ot.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const ft=new PDFDocumentLoadingTask,{docId:pt}=ft,St=ot.url?getUrlProp(ot.url):null,gt=ot.data?getDataProp(ot.data):null,vt=ot.httpHeaders||null,At=ot.withCredentials===!0,Gt=ot.password??null,Nt=ot.range instanceof PDFDataRangeTransport?ot.range:null,Ht=Number.isInteger(ot.rangeChunkSize)&&ot.rangeChunkSize>0?ot.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let It=ot.worker instanceof PDFWorker?ot.worker:null;const Wt=ot.verbosity,yt=typeof ot.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(ot.docBaseUrl)?ot.docBaseUrl:null,Dt=typeof ot.cMapUrl=="string"?ot.cMapUrl:null,$t=ot.cMapPacked!==!1,_t=ot.CMapReaderFactory||DefaultCMapReaderFactory,ht=typeof ot.standardFontDataUrl=="string"?ot.standardFontDataUrl:null,ct=ot.StandardFontDataFactory||DefaultStandardFontDataFactory,xt=ot.stopAtErrors!==!0,Et=Number.isInteger(ot.maxImageSize)&&ot.maxImageSize>-1?ot.maxImageSize:-1,bt=ot.isEvalSupported!==!1,Ct=typeof ot.isOffscreenCanvasSupported=="boolean"?ot.isOffscreenCanvasSupported:!_util.isNodeJS,Ot=Number.isInteger(ot.canvasMaxAreaInBytes)?ot.canvasMaxAreaInBytes:-1,jt=typeof ot.disableFontFace=="boolean"?ot.disableFontFace:_util.isNodeJS,er=ot.fontExtraProperties===!0,Tt=ot.enableXfa===!0,ur=ot.ownerDocument||globalThis.document,cr=ot.disableRange===!0,hr=ot.disableStream===!0,Yt=ot.disableAutoFetch===!0,Xt=ot.pdfBug===!0,Ft=Nt?Nt.length:ot.length??NaN,Ut=typeof ot.useSystemFonts=="boolean"?ot.useSystemFonts:!_util.isNodeJS&&!jt,qt=typeof ot.useWorkerFetch=="boolean"?ot.useWorkerFetch:_t===_display_utils.DOMCMapReaderFactory&&ct===_display_utils.DOMStandardFontDataFactory&&Dt&&ht&&(0,_display_utils.isValidFetchUrl)(Dt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ht,document.baseURI),Jt=ot.canvasFactory||new DefaultCanvasFactory({ownerDocument:ur}),dr=ot.filterFactory||new DefaultFilterFactory({docId:pt,ownerDocument:ur}),vr=null;(0,_util.setVerbosityLevel)(Wt);const _r={canvasFactory:Jt,filterFactory:dr};if(qt||(_r.cMapReaderFactory=new _t({baseUrl:Dt,isCompressed:$t}),_r.standardFontDataFactory=new ct({baseUrl:ht})),!It){const Sr={verbosity:Wt,port:_worker_options.GlobalWorkerOptions.workerPort};It=Sr.port?PDFWorker.fromPort(Sr):new PDFWorker(Sr),ft._worker=It}const Zt={docId:pt,apiVersion:"3.11.174",data:gt,password:Gt,disableAutoFetch:Yt,rangeChunkSize:Ht,length:Ft,docBaseUrl:yt,enableXfa:Tt,evaluatorOptions:{maxImageSize:Et,disableFontFace:jt,ignoreErrors:xt,isEvalSupported:bt,isOffscreenCanvasSupported:Ct,canvasMaxAreaInBytes:Ot,fontExtraProperties:er,useSystemFonts:Ut,cMapUrl:qt?Dt:null,standardFontDataUrl:qt?ht:null}},Er={ignoreErrors:xt,isEvalSupported:bt,disableFontFace:jt,fontExtraProperties:er,enableXfa:Tt,ownerDocument:ur,disableAutoFetch:Yt,pdfBug:Xt,styleElement:vr};return It.promise.then(function(){if(ft.destroyed)throw new Error("Loading aborted");const Sr=_fetchDocument(It,Zt),Vr=new Promise(function(Nr){let Pr;Nt?Pr=new _transport_stream.PDFDataTransportStream({length:Ft,initialData:Nt.initialData,progressiveDone:Nt.progressiveDone,contentDispositionFilename:Nt.contentDispositionFilename,disableRange:cr,disableStream:hr},Nt):gt||(Pr=(Dr=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Dr):(0,_display_utils.isValidFetchUrl)(Dr.url)?new _displayFetch_stream.PDFFetchStream(Dr):new _displayNetwork.PDFNetworkStream(Dr))({url:St,length:Ft,httpHeaders:vt,withCredentials:At,rangeChunkSize:Ht,disableRange:cr,disableStream:hr})),Nr(Pr)});return Promise.all([Sr,Vr]).then(function([Nr,Pr]){if(ft.destroyed)throw new Error("Loading aborted");const kr=new _message_handler.MessageHandler(pt,Nr,It.port),Dr=new WorkerTransport(kr,ft,Pr,Er,_r);ft._transport=Dr,kr.send("Ready",null)})}).catch(ft._capability.reject),ft}async function _fetchDocument(ot,ft){if(ot.destroyed)throw new Error("Worker was destroyed");const pt=await ot.messageHandler.sendWithPromise("GetDocRequest",ft,ft.data?[ft.data.buffer]:null);if(ot.destroyed)throw new Error("Worker was destroyed");return pt}function getUrlProp(ot){if(ot instanceof URL)return ot.href;try{return new URL(ot,window.location).href}catch{if(_util.isNodeJS&&typeof ot=="string")return ot}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(ot){if(_util.isNodeJS&&typeof Buffer<"u"&&ot instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(ot instanceof Uint8Array&&ot.byteLength===ot.buffer.byteLength)return ot;if(typeof ot=="string")return(0,_util.stringToBytes)(ot);if(typeof ot=="object"&&!isNaN(ot==null?void 0:ot.length)||(0,_util.isArrayBuffer)(ot))return new Uint8Array(ot);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class i{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${un(i,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var ft,pt,St;this.destroyed=!0;try{(ft=this._worker)!=null&&ft.port&&(this._worker._pendingDestroy=!0),await((pt=this._transport)==null?void 0:pt.destroy())}catch(gt){throw(St=this._worker)!=null&&St.port&&delete this._worker._pendingDestroy,gt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,nr(i,e,0);let PDFDocumentLoadingTask=i;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(ft,pt,St=!1,gt=null){this.length=ft,this.initialData=pt,this.progressiveDone=St,this.contentDispositionFilename=gt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(ft){this._rangeListeners.push(ft)}addProgressListener(ft){this._progressListeners.push(ft)}addProgressiveReadListener(ft){this._progressiveReadListeners.push(ft)}addProgressiveDoneListener(ft){this._progressiveDoneListeners.push(ft)}onDataRange(ft,pt){for(const St of this._rangeListeners)St(ft,pt)}onDataProgress(ft,pt){this._readyCapability.promise.then(()=>{for(const St of this._progressListeners)St(ft,pt)})}onDataProgressiveRead(ft){this._readyCapability.promise.then(()=>{for(const pt of this._progressiveReadListeners)pt(ft)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const ft of this._progressiveDoneListeners)ft()})}transportReady(){this._readyCapability.resolve()}requestDataRange(ft,pt){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(ft,pt){this._pdfInfo=ft,this._transport=pt,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(St=>{if(!St)return St;const gt=[];for(const vt in St)gt.push(...St[vt]);return gt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(ft){return this._transport.getPage(ft)}getPageIndex(ft){return this._transport.getPageIndex(ft)}getDestinations(){return this._transport.getDestinations()}getDestination(ft){return this._transport.getDestination(ft)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(ft=!1){return this._transport.startCleanup(ft||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(ft,pt,St,gt=!1){nr(this,o);nr(this,a,null);nr(this,s,!1);this._pageIndex=ft,this._pageInfo=pt,this._transport=St,this._stats=gt?new _display_utils.StatTimer:null,this._pdfBug=gt,this.commonObjs=St.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:ft,rotation:pt=this.rotate,offsetX:St=0,offsetY:gt=0,dontFlip:vt=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:ft,rotation:pt,offsetX:St,offsetY:gt,dontFlip:vt})}getAnnotations({intent:ft="display"}={}){const pt=this._transport.getRenderingIntent(ft);return this._transport.getAnnotations(this._pageIndex,pt.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var ft;return((ft=this._transport._htmlForXfa)==null?void 0:ft.children[this._pageIndex])||null}render({canvasContext:ft,viewport:pt,intent:St="display",annotationMode:gt=_util.AnnotationMode.ENABLE,transform:vt=null,background:At=null,optionalContentConfigPromise:Gt=null,annotationCanvasMap:Nt=null,pageColors:Ht=null,printAnnotationStorage:It=null}){var ct,xt;(ct=this._stats)==null||ct.time("Overall");const Wt=this._transport.getRenderingIntent(St,gt,It);ir(this,s,!1),Qt(this,o,xn).call(this),Gt||(Gt=this._transport.getOptionalContentConfig());let yt=this._intentStates.get(Wt.cacheKey);yt||(yt=Object.create(null),this._intentStates.set(Wt.cacheKey,yt)),yt.streamReaderCancelTimeout&&(clearTimeout(yt.streamReaderCancelTimeout),yt.streamReaderCancelTimeout=null);const Dt=!!(Wt.renderingIntent&_util.RenderingIntentFlag.PRINT);yt.displayReadyCapability||(yt.displayReadyCapability=new _util.PromiseCapability,yt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(xt=this._stats)==null||xt.time("Page Request"),this._pumpOperatorList(Wt));const $t=Et=>{var bt,Ct;yt.renderTasks.delete(_t),(this._maybeCleanupAfterRender||Dt)&&ir(this,s,!0),Qt(this,o,tn).call(this,!Dt),Et?(_t.capability.reject(Et),this._abortOperatorList({intentState:yt,reason:Et instanceof Error?Et:new Error(Et)})):_t.capability.resolve(),(bt=this._stats)==null||bt.timeEnd("Rendering"),(Ct=this._stats)==null||Ct.timeEnd("Overall")},_t=new InternalRenderTask({callback:$t,params:{canvasContext:ft,viewport:pt,transform:vt,background:At},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Nt,operatorList:yt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Dt,pdfBug:this._pdfBug,pageColors:Ht});(yt.renderTasks||(yt.renderTasks=new Set)).add(_t);const ht=_t.task;return Promise.all([yt.displayReadyCapability.promise,Gt]).then(([Et,bt])=>{var Ct;if(this.destroyed){$t();return}(Ct=this._stats)==null||Ct.time("Rendering"),_t.initializeGraphics({transparency:Et,optionalContentConfig:bt}),_t.operatorListChanged()}).catch($t),ht}getOperatorList({intent:ft="display",annotationMode:pt=_util.AnnotationMode.ENABLE,printAnnotationStorage:St=null}={}){var Nt;function gt(){At.operatorList.lastChunk&&(At.opListReadCapability.resolve(At.operatorList),At.renderTasks.delete(Gt))}const vt=this._transport.getRenderingIntent(ft,pt,St,!0);let At=this._intentStates.get(vt.cacheKey);At||(At=Object.create(null),this._intentStates.set(vt.cacheKey,At));let Gt;return At.opListReadCapability||(Gt=Object.create(null),Gt.operatorListChanged=gt,At.opListReadCapability=new _util.PromiseCapability,(At.renderTasks||(At.renderTasks=new Set)).add(Gt),At.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Nt=this._stats)==null||Nt.time("Page Request"),this._pumpOperatorList(vt)),At.opListReadCapability.promise}streamTextContent({includeMarkedContent:ft=!1,disableNormalization:pt=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:ft===!0,disableNormalization:pt===!0},{highWaterMark:100,size(gt){return gt.items.length}})}getTextContent(ft={}){if(this._transport._htmlForXfa)return this.getXfa().then(St=>_xfa_text.XfaText.textContent(St));const pt=this.streamTextContent(ft);return new Promise(function(St,gt){function vt(){At.read().then(function({value:Nt,done:Ht}){if(Ht){St(Gt);return}Object.assign(Gt.styles,Nt.styles),Gt.items.push(...Nt.items),vt()},gt)}const At=pt.getReader(),Gt={items:[],styles:Object.create(null)};vt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const ft=[];for(const pt of this._intentStates.values())if(this._abortOperatorList({intentState:pt,reason:new Error("Page was destroyed."),force:!0}),!pt.opListReadCapability)for(const St of pt.renderTasks)ft.push(St.completed),St.cancel();return this.objs.clear(),ir(this,s,!1),Qt(this,o,xn).call(this),Promise.all(ft)}cleanup(ft=!1){ir(this,s,!0);const pt=Qt(this,o,tn).call(this,!1);return ft&&pt&&this._stats&&(this._stats=new _display_utils.StatTimer),pt}_startRenderPage(ft,pt){var gt,vt;const St=this._intentStates.get(pt);St&&((gt=this._stats)==null||gt.timeEnd("Page Request"),(vt=St.displayReadyCapability)==null||vt.resolve(ft))}_renderPageChunk(ft,pt){for(let St=0,gt=ft.length;St<gt;St++)pt.operatorList.fnArray.push(ft.fnArray[St]),pt.operatorList.argsArray.push(ft.argsArray[St]);pt.operatorList.lastChunk=ft.lastChunk,pt.operatorList.separateAnnots=ft.separateAnnots;for(const St of pt.renderTasks)St.operatorListChanged();ft.lastChunk&&Qt(this,o,tn).call(this,!0)}_pumpOperatorList({renderingIntent:ft,cacheKey:pt,annotationStorageSerializable:St}){const{map:gt,transfers:vt}=St,Gt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:ft,cacheKey:pt,annotationStorage:gt},vt).getReader(),Nt=this._intentStates.get(pt);Nt.streamReader=Gt;const Ht=()=>{Gt.read().then(({value:It,done:Wt})=>{if(Wt){Nt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(It,Nt),Ht())},It=>{if(Nt.streamReader=null,!this._transport.destroyed){if(Nt.operatorList){Nt.operatorList.lastChunk=!0;for(const Wt of Nt.renderTasks)Wt.operatorListChanged();Qt(this,o,tn).call(this,!0)}if(Nt.displayReadyCapability)Nt.displayReadyCapability.reject(It);else if(Nt.opListReadCapability)Nt.opListReadCapability.reject(It);else throw It}})};Ht()}_abortOperatorList({intentState:ft,reason:pt,force:St=!1}){if(ft.streamReader){if(ft.streamReaderCancelTimeout&&(clearTimeout(ft.streamReaderCancelTimeout),ft.streamReaderCancelTimeout=null),!St){if(ft.renderTasks.size>0)return;if(pt instanceof _display_utils.RenderingCancelledException){let gt=RENDERING_CANCELLED_TIMEOUT;pt.extraDelay>0&&pt.extraDelay<1e3&&(gt+=pt.extraDelay),ft.streamReaderCancelTimeout=setTimeout(()=>{ft.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:ft,reason:pt,force:!0})},gt);return}}if(ft.streamReader.cancel(new _util.AbortException(pt.message)).catch(()=>{}),ft.streamReader=null,!this._transport.destroyed){for(const[gt,vt]of this._intentStates)if(vt===ft){this._intentStates.delete(gt);break}this.cleanup()}}}get stats(){return this._stats}}a=new WeakMap,s=new WeakMap,o=new WeakSet,tn=function(ft=!1){if(Qt(this,o,xn).call(this),!mt(this,s)||this.destroyed)return!1;if(ft)return ir(this,a,setTimeout(()=>{ir(this,a,null),Qt(this,o,tn).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:pt,operatorList:St}of this._intentStates.values())if(pt.size>0||!St.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ir(this,s,!1),!0},xn=function(){mt(this,a)&&(clearTimeout(mt(this,a)),ir(this,a,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){nr(this,d,new Set);nr(this,g,Promise.resolve())}postMessage(ft,pt){const St={data:structuredClone(ft,pt?{transfer:pt}:null)};mt(this,g).then(()=>{for(const gt of mt(this,d))gt.call(this,St)})}addEventListener(ft,pt){mt(this,d).add(pt)}removeEventListener(ft,pt){mt(this,d).delete(pt)}terminate(){mt(this,d).clear()}}d=new WeakMap,g=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const ot=(_=document==null?void 0:document.currentScript)==null?void 0:_.src;ot&&(PDFWorkerUtil.fallbackWorkerSrc=ot.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(ot,ft){let pt;try{if(pt=new URL(ot),!pt.origin||pt.origin==="null")return!1}catch{return!1}const St=new URL(ft,pt);return pt.origin===St.origin},PDFWorkerUtil.createCDNWrapper=function(ot){const ft=`importScripts("${ot}");`;return URL.createObjectURL(new Blob([ft]))}}const _PDFWorker=class _PDFWorker{constructor({name:ot=null,port:ft=null,verbosity:pt=(0,_util.getVerbosityLevel)()}={}){var St;if(this.name=ot,this.destroyed=!1,this.verbosity=pt,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,ft){if((St=mt(_PDFWorker,b))!=null&&St.has(ft))throw new Error("Cannot use more than one PDFWorker per port.");(mt(_PDFWorker,b)||ir(_PDFWorker,b,new WeakMap)).set(ft,this),this._initializeFromPort(ft);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(ot){this._port=ot,this._messageHandler=new _message_handler.MessageHandler("main","worker",ot),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:ot}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,ot)||(ot=PDFWorkerUtil.createCDNWrapper(new URL(ot,window.location).href));const ft=new Worker(ot),pt=new _message_handler.MessageHandler("main","worker",ft),St=()=>{ft.removeEventListener("error",gt),pt.destroy(),ft.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},gt=()=>{this._webWorker||St()};ft.addEventListener("error",gt),pt.on("test",At=>{if(ft.removeEventListener("error",gt),this.destroyed){St();return}At?(this._messageHandler=pt,this._port=ft,this._webWorker=ft,this._readyCapability.resolve(),pt.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),pt.destroy(),ft.terminate())}),pt.on("ready",At=>{if(ft.removeEventListener("error",gt),this.destroyed){St();return}try{vt()}catch{this._setupFakeWorker()}});const vt=()=>{const At=new Uint8Array;pt.send("test",At,[At.buffer])};vt();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(ot=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const ft=new LoopbackPort;this._port=ft;const pt=`fake${PDFWorkerUtil.fakeWorkerId++}`,St=new _message_handler.MessageHandler(pt+"_worker",pt,ft);ot.setup(St,ft);const gt=new _message_handler.MessageHandler(pt,pt+"_worker",ft);this._messageHandler=gt,this._readyCapability.resolve(),gt.send("configure",{verbosity:this.verbosity})}).catch(ot=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${ot.message}".`))})}destroy(){var ot;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(ot=mt(_PDFWorker,b))==null||ot.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(ot){var pt;if(!(ot!=null&&ot.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const ft=(pt=mt(this,b))==null?void 0:pt.get(ot.port);if(ft){if(ft._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return ft}return new _PDFWorker(ot)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var ot;try{return((ot=globalThis.pdfjsWorker)==null?void 0:ot.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};b=new WeakMap,nr(_PDFWorker,b);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(ft,pt,St,gt,vt){nr(this,tt);nr(this,j,new Map);nr(this,_e,new Map);nr(this,et,new Map);nr(this,rt,null);this.messageHandler=ft,this.loadingTask=pt,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:gt.ownerDocument,styleElement:gt.styleElement}),this._params=gt,this.canvasFactory=vt.canvasFactory,this.filterFactory=vt.filterFactory,this.cMapReaderFactory=vt.cMapReaderFactory,this.standardFontDataFactory=vt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=St,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(ft,pt=_util.AnnotationMode.ENABLE,St=null,gt=!1){let vt=_util.RenderingIntentFlag.DISPLAY,At=_annotation_storage.SerializableEmpty;switch(ft){case"any":vt=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":vt=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${ft}`)}switch(pt){case _util.AnnotationMode.DISABLE:vt+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:vt+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:vt+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,At=(vt&_util.RenderingIntentFlag.PRINT&&St instanceof _annotation_storage.PrintAnnotationStorage?St:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${pt}`)}return gt&&(vt+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:vt,cacheKey:`${vt}_${At.hash}`,annotationStorageSerializable:At}}destroy(){var St;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(St=mt(this,rt))==null||St.reject(new Error("Worker was destroyed during onPassword callback"));const ft=[];for(const gt of mt(this,_e).values())ft.push(gt._destroy());mt(this,_e).clear(),mt(this,et).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const pt=this.messageHandler.sendWithPromise("Terminate",null);return ft.push(pt),Promise.all(ft).then(()=>{var gt;this.commonObjs.clear(),this.fontLoader.clear(),mt(this,j).clear(),this.filterFactory.destroy(),(gt=this._networkStream)==null||gt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:ft,loadingTask:pt}=this;ft.on("GetReader",(St,gt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=vt=>{this._lastProgress={loaded:vt.loaded,total:vt.total}},gt.onPull=()=>{this._fullReader.read().then(function({value:vt,done:At}){if(At){gt.close();return}(0,_util.assert)(vt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),gt.enqueue(new Uint8Array(vt),1,[vt])}).catch(vt=>{gt.error(vt)})},gt.onCancel=vt=>{this._fullReader.cancel(vt),gt.ready.catch(At=>{if(!this.destroyed)throw At})}}),ft.on("ReaderHeadersReady",St=>{const gt=new _util.PromiseCapability,vt=this._fullReader;return vt.headersReady.then(()=>{var At;(!vt.isStreamingSupported||!vt.isRangeSupported)&&(this._lastProgress&&((At=pt.onProgress)==null||At.call(pt,this._lastProgress)),vt.onProgress=Gt=>{var Nt;(Nt=pt.onProgress)==null||Nt.call(pt,{loaded:Gt.loaded,total:Gt.total})}),gt.resolve({isStreamingSupported:vt.isStreamingSupported,isRangeSupported:vt.isRangeSupported,contentLength:vt.contentLength})},gt.reject),gt.promise}),ft.on("GetRangeReader",(St,gt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const vt=this._networkStream.getRangeReader(St.begin,St.end);if(!vt){gt.close();return}gt.onPull=()=>{vt.read().then(function({value:At,done:Gt}){if(Gt){gt.close();return}(0,_util.assert)(At instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),gt.enqueue(new Uint8Array(At),1,[At])}).catch(At=>{gt.error(At)})},gt.onCancel=At=>{vt.cancel(At),gt.ready.catch(Gt=>{if(!this.destroyed)throw Gt})}}),ft.on("GetDoc",({pdfInfo:St})=>{this._numPages=St.numPages,this._htmlForXfa=St.htmlForXfa,delete St.htmlForXfa,pt._capability.resolve(new PDFDocumentProxy(St,this))}),ft.on("DocException",function(St){let gt;switch(St.name){case"PasswordException":gt=new _util.PasswordException(St.message,St.code);break;case"InvalidPDFException":gt=new _util.InvalidPDFException(St.message);break;case"MissingPDFException":gt=new _util.MissingPDFException(St.message);break;case"UnexpectedResponseException":gt=new _util.UnexpectedResponseException(St.message,St.status);break;case"UnknownErrorException":gt=new _util.UnknownErrorException(St.message,St.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}pt._capability.reject(gt)}),ft.on("PasswordRequest",St=>{if(ir(this,rt,new _util.PromiseCapability),pt.onPassword){const gt=vt=>{vt instanceof Error?mt(this,rt).reject(vt):mt(this,rt).resolve({password:vt})};try{pt.onPassword(gt,St.code)}catch(vt){mt(this,rt).reject(vt)}}else mt(this,rt).reject(new _util.PasswordException(St.message,St.code));return mt(this,rt).promise}),ft.on("DataLoaded",St=>{var gt;(gt=pt.onProgress)==null||gt.call(pt,{loaded:St.length,total:St.length}),this.downloadInfoCapability.resolve(St)}),ft.on("StartRenderPage",St=>{if(this.destroyed)return;mt(this,_e).get(St.pageIndex)._startRenderPage(St.transparency,St.cacheKey)}),ft.on("commonobj",([St,gt,vt])=>{var At;if(!this.destroyed&&!this.commonObjs.has(St))switch(gt){case"Font":const Gt=this._params;if("error"in vt){const It=vt.error;(0,_util.warn)(`Error during font loading: ${It}`),this.commonObjs.resolve(St,It);break}const Nt=Gt.pdfBug&&((At=globalThis.FontInspector)!=null&&At.enabled)?(It,Wt)=>globalThis.FontInspector.fontAdded(It,Wt):null,Ht=new _font_loader.FontFaceObject(vt,{isEvalSupported:Gt.isEvalSupported,disableFontFace:Gt.disableFontFace,ignoreErrors:Gt.ignoreErrors,inspectFont:Nt});this.fontLoader.bind(Ht).catch(It=>ft.sendWithPromise("FontFallback",{id:St})).finally(()=>{!Gt.fontExtraProperties&&Ht.data&&(Ht.data=null),this.commonObjs.resolve(St,Ht)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(St,vt);break;default:throw new Error(`Got unknown common object type ${gt}`)}}),ft.on("obj",([St,gt,vt,At])=>{var Nt;if(this.destroyed)return;const Gt=mt(this,_e).get(gt);if(!Gt.objs.has(St))switch(vt){case"Image":if(Gt.objs.resolve(St,At),At){let Ht;if(At.bitmap){const{width:It,height:Wt}=At;Ht=It*Wt*4}else Ht=((Nt=At.data)==null?void 0:Nt.length)||0;Ht>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Gt._maybeCleanupAfterRender=!0)}break;case"Pattern":Gt.objs.resolve(St,At);break;default:throw new Error(`Got unknown object type ${vt}`)}}),ft.on("DocProgress",St=>{var gt;this.destroyed||(gt=pt.onProgress)==null||gt.call(pt,{loaded:St.loaded,total:St.total})}),ft.on("FetchBuiltInCMap",St=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(St):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),ft.on("FetchStandardFontData",St=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(St):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var St;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:ft,transfers:pt}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:ft,filename:((St=this._fullReader)==null?void 0:St.filename)??null},pt).finally(()=>{this.annotationStorage.resetModified()})}getPage(ft){if(!Number.isInteger(ft)||ft<=0||ft>this._numPages)return Promise.reject(new Error("Invalid page request."));const pt=ft-1,St=mt(this,et).get(pt);if(St)return St;const gt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:pt}).then(vt=>{if(this.destroyed)throw new Error("Transport destroyed");const At=new PDFPageProxy(pt,vt,this,this._params.pdfBug);return mt(this,_e).set(pt,At),At});return mt(this,et).set(pt,gt),gt}getPageIndex(ft){return typeof ft!="object"||ft===null||!Number.isInteger(ft.num)||ft.num<0||!Number.isInteger(ft.gen)||ft.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:ft.num,gen:ft.gen})}getAnnotations(ft,pt){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:ft,intent:pt})}getFieldObjects(){return Qt(this,tt,vn).call(this,"GetFieldObjects")}hasJSActions(){return Qt(this,tt,vn).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(ft){return typeof ft!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:ft})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Qt(this,tt,vn).call(this,"GetDocJSActions")}getPageJSActions(ft){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:ft})}getStructTree(ft){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:ft})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(ft=>new _optional_content_config.OptionalContentConfig(ft))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const ft="GetMetadata",pt=mt(this,j).get(ft);if(pt)return pt;const St=this.messageHandler.sendWithPromise(ft,null).then(gt=>{var vt,At;return{info:gt[0],metadata:gt[1]?new _metadata.Metadata(gt[1]):null,contentDispositionFilename:((vt=this._fullReader)==null?void 0:vt.filename)??null,contentLength:((At=this._fullReader)==null?void 0:At.contentLength)??null}});return mt(this,j).set(ft,St),St}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(ft=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const pt of mt(this,_e).values())if(!pt.cleanup())throw new Error(`startCleanup: Page ${pt.pageNumber} is currently rendering.`);this.commonObjs.clear(),ft||this.fontLoader.clear(),mt(this,j).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:ft,enableXfa:pt}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:ft,enableXfa:pt})}}j=new WeakMap,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,tt=new WeakSet,vn=function(ft,pt=null){const St=mt(this,j).get(ft);if(St)return St;const gt=this.messageHandler.sendWithPromise(ft,pt);return mt(this,j).set(ft,gt),gt};class PDFObjects{constructor(){nr(this,at);nr(this,nt,Object.create(null))}get(ft,pt=null){if(pt){const gt=Qt(this,at,Ln).call(this,ft);return gt.capability.promise.then(()=>pt(gt.data)),null}const St=mt(this,nt)[ft];if(!(St!=null&&St.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${ft}.`);return St.data}has(ft){const pt=mt(this,nt)[ft];return(pt==null?void 0:pt.capability.settled)||!1}resolve(ft,pt=null){const St=Qt(this,at,Ln).call(this,ft);St.data=pt,St.capability.resolve()}clear(){var ft;for(const pt in mt(this,nt)){const{data:St}=mt(this,nt)[pt];(ft=St==null?void 0:St.bitmap)==null||ft.close()}ir(this,nt,Object.create(null))}}nt=new WeakMap,at=new WeakSet,Ln=function(ft){var pt;return(pt=mt(this,nt))[ft]||(pt[ft]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(ft){nr(this,dt,null);ir(this,dt,ft),this.onContinue=null}get promise(){return mt(this,dt).capability.promise}cancel(ft=0){mt(this,dt).cancel(null,ft)}get separateAnnots(){const{separateAnnots:ft}=mt(this,dt).operatorList;if(!ft)return!1;const{annotationCanvasMap:pt}=mt(this,dt);return ft.form||ft.canvas&&(pt==null?void 0:pt.size)>0}}dt=new WeakMap,exports.RenderTask=RenderTask;const ut=class ut{constructor({callback:ft,params:pt,objs:St,commonObjs:gt,annotationCanvasMap:vt,operatorList:At,pageIndex:Gt,canvasFactory:Nt,filterFactory:Ht,useRequestAnimationFrame:It=!1,pdfBug:Wt=!1,pageColors:yt=null}){this.callback=ft,this.params=pt,this.objs=St,this.commonObjs=gt,this.annotationCanvasMap=vt,this.operatorListIdx=null,this.operatorList=At,this._pageIndex=Gt,this.canvasFactory=Nt,this.filterFactory=Ht,this._pdfBug=Wt,this.pageColors=yt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=It===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=pt.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:ft=!1,optionalContentConfig:pt}){var Gt,Nt;if(this.cancelled)return;if(this._canvas){if(mt(ut,lt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");mt(ut,lt).add(this._canvas)}this._pdfBug&&((Gt=globalThis.StepperManager)!=null&&Gt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:St,viewport:gt,transform:vt,background:At}=this.params;this.gfx=new _canvas.CanvasGraphics(St,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:pt},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:vt,viewport:gt,transparency:ft,background:At}),this.operatorListIdx=0,this.graphicsReady=!0,(Nt=this.graphicsReadyCallback)==null||Nt.call(this)}cancel(ft=null,pt=0){var St;this.running=!1,this.cancelled=!0,(St=this.gfx)==null||St.endDrawing(),mt(ut,lt).delete(this._canvas),this.callback(ft||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,pt))}operatorListChanged(){var ft;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(ft=this.stepper)==null||ft.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),mt(ut,lt).delete(this._canvas),this.callback())))}};lt=new WeakMap,nr(ut,lt,new WeakSet);let InternalRenderTask=ut;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(e,i,a)=>{var _,b,j,ls,et;Object.defineProperty(i,"__esModule",{value:!0}),i.SerializableEmpty=i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var s=a(1),o=a(4),c=a(8);const h=Object.freeze({map:null,hash:"",transfers:void 0});i.SerializableEmpty=h;class d{constructor(){nr(this,j);nr(this,_,!1);nr(this,b,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(tt,it){const nt=mt(this,b).get(tt);return nt===void 0?it:Object.assign(it,nt)}getRawValue(tt){return mt(this,b).get(tt)}remove(tt){if(mt(this,b).delete(tt),mt(this,b).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const it of mt(this,b).values())if(it instanceof o.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(tt,it){const nt=mt(this,b).get(tt);let at=!1;if(nt!==void 0)for(const[st,dt]of Object.entries(it))nt[st]!==dt&&(at=!0,nt[st]=dt);else at=!0,mt(this,b).set(tt,it);at&&Qt(this,j,ls).call(this),it instanceof o.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(it.constructor._type)}has(tt){return mt(this,b).has(tt)}getAll(){return mt(this,b).size>0?(0,s.objectFromMap)(mt(this,b)):null}setAll(tt){for(const[it,nt]of Object.entries(tt))this.setValue(it,nt)}get size(){return mt(this,b).size}resetModified(){mt(this,_)&&(ir(this,_,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new g(this)}get serializable(){if(mt(this,b).size===0)return h;const tt=new Map,it=new c.MurmurHash3_64,nt=[],at=Object.create(null);let st=!1;for(const[dt,lt]of mt(this,b)){const ut=lt instanceof o.AnnotationEditor?lt.serialize(!1,at):lt;ut&&(tt.set(dt,ut),it.update(`${dt}:${JSON.stringify(ut)}`),st||(st=!!ut.bitmap))}if(st)for(const dt of tt.values())dt.bitmap&&nt.push(dt.bitmap);return tt.size>0?{map:tt,hash:it.hexdigest(),transfers:nt}:h}}_=new WeakMap,b=new WeakMap,j=new WeakSet,ls=function(){mt(this,_)||(ir(this,_,!0),typeof this.onSetModified=="function"&&this.onSetModified())},i.AnnotationStorage=d;class g extends d{constructor(it){super();nr(this,et);const{map:nt,hash:at,transfers:st}=it.serializable,dt=structuredClone(nt,st?{transfer:st}:null);ir(this,et,{map:dt,hash:at,transfers:st})}get print(){(0,s.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return mt(this,et)}}et=new WeakMap,i.PrintAnnotationStorage=g},(e,i,a)=>{var g,_,b,j,_e,et,rt,tt,it,nt,at,st,dt,lt,ut,In,On,pt,Nn,Bn,cs,us,fs,Vn,hs;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var s=a(5),o=a(1),c=a(6);const It=class It{constructor(yt){nr(this,ut);nr(this,g,"");nr(this,_,!1);nr(this,b,null);nr(this,j,null);nr(this,_e,null);nr(this,et,!1);nr(this,rt,null);nr(this,tt,this.focusin.bind(this));nr(this,it,this.focusout.bind(this));nr(this,nt,!1);nr(this,at,!1);nr(this,st,!1);$r(this,"_initialOptions",Object.create(null));$r(this,"_uiManager",null);$r(this,"_focusEventsAllowed",!0);$r(this,"_l10nPromise",null);nr(this,dt,!1);nr(this,lt,It._zIndex++);this.constructor===It&&(0,o.unreachable)("Cannot initialize AnnotationEditor."),this.parent=yt.parent,this.id=yt.id,this.width=this.height=null,this.pageIndex=yt.parent.pageIndex,this.name=yt.name,this.div=null,this._uiManager=yt.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=yt.isCentered,this._structTreeParentId=null;const{rotation:Dt,rawDims:{pageWidth:$t,pageHeight:_t,pageX:ht,pageY:ct}}=this.parent.viewport;this.rotation=Dt,this.pageRotation=(360+Dt-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[$t,_t],this.pageTranslation=[ht,ct];const[xt,Et]=this.parentDimensions;this.x=yt.x/xt,this.y=yt.y/Et,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,o.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(yt){const Dt=new d({id:yt.parent.getNextId(),parent:yt.parent,uiManager:yt._uiManager});Dt.annotationElementId=yt.annotationElementId,Dt.deleted=!0,Dt._uiManager.addToAnnotationStorage(Dt)}static initialize(yt,Dt=null){if(It._l10nPromise||(It._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(_t=>[_t,yt.get(_t)]))),Dt!=null&&Dt.strings)for(const _t of Dt.strings)It._l10nPromise.set(_t,yt.get(_t));if(It._borderLineWidth!==-1)return;const $t=getComputedStyle(document.documentElement);It._borderLineWidth=parseFloat($t.getPropertyValue("--outline-width"))||0}static updateDefaultParams(yt,Dt){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(yt){return!1}static paste(yt,Dt){(0,o.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return mt(this,dt)}set _isDraggable(yt){var Dt;ir(this,dt,yt),(Dt=this.div)==null||Dt.classList.toggle("draggable",yt)}center(){const[yt,Dt]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Dt/(yt*2),this.y+=this.width*yt/(Dt*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Dt/(yt*2),this.y-=this.width*yt/(Dt*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(yt){this._uiManager.addCommands(yt)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=mt(this,lt)}setParent(yt){yt!==null&&(this.pageIndex=yt.pageIndex,this.pageDimensions=yt.pageDimensions),this.parent=yt}focusin(yt){this._focusEventsAllowed&&(mt(this,nt)?ir(this,nt,!1):this.parent.setSelected(this))}focusout(yt){var $t;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Dt=yt.relatedTarget;Dt!=null&&Dt.closest(`#${this.id}`)||(yt.preventDefault(),($t=this.parent)!=null&&$t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(yt,Dt,$t,_t){const[ht,ct]=this.parentDimensions;[$t,_t]=this.screenToPageTranslation($t,_t),this.x=(yt+$t)/ht,this.y=(Dt+_t)/ct,this.fixAndSetPosition()}translate(yt,Dt){Qt(this,ut,In).call(this,this.parentDimensions,yt,Dt)}translateInPage(yt,Dt){Qt(this,ut,In).call(this,this.pageDimensions,yt,Dt),this.div.scrollIntoView({block:"nearest"})}drag(yt,Dt){const[$t,_t]=this.parentDimensions;if(this.x+=yt/$t,this.y+=Dt/_t,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:bt,y:Ct}=this.div.getBoundingClientRect();this.parent.findNewParent(this,bt,Ct)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:ht,y:ct}=this;const[xt,Et]=Qt(this,ut,On).call(this);ht+=xt,ct+=Et,this.div.style.left=`${(100*ht).toFixed(2)}%`,this.div.style.top=`${(100*ct).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[yt,Dt]=this.pageDimensions;let{x:$t,y:_t,width:ht,height:ct}=this;switch(ht*=yt,ct*=Dt,$t*=yt,_t*=Dt,this.rotation){case 0:$t=Math.max(0,Math.min(yt-ht,$t)),_t=Math.max(0,Math.min(Dt-ct,_t));break;case 90:$t=Math.max(0,Math.min(yt-ct,$t)),_t=Math.min(Dt,Math.max(ht,_t));break;case 180:$t=Math.min(yt,Math.max(ht,$t)),_t=Math.min(Dt,Math.max(ct,_t));break;case 270:$t=Math.min(yt,Math.max(ct,$t)),_t=Math.max(0,Math.min(Dt-ht,_t));break}this.x=$t/=yt,this.y=_t/=Dt;const[xt,Et]=Qt(this,ut,On).call(this);$t+=xt,_t+=Et;const{style:bt}=this.div;bt.left=`${(100*$t).toFixed(2)}%`,bt.top=`${(100*_t).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(yt,Dt){var $t;return Qt($t=It,pt,Nn).call($t,yt,Dt,this.parentRotation)}pageTranslationToScreen(yt,Dt){var $t;return Qt($t=It,pt,Nn).call($t,yt,Dt,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:yt,pageDimensions:[Dt,$t]}=this,_t=Dt*yt,ht=$t*yt;return o.FeatureTest.isCSSRoundSupported?[Math.round(_t),Math.round(ht)]:[_t,ht]}setDims(yt,Dt){var ht;const[$t,_t]=this.parentDimensions;this.div.style.width=`${(100*yt/$t).toFixed(2)}%`,mt(this,et)||(this.div.style.height=`${(100*Dt/_t).toFixed(2)}%`),(ht=mt(this,b))==null||ht.classList.toggle("small",yt<It.SMALL_EDITOR_SIZE||Dt<It.SMALL_EDITOR_SIZE)}fixDims(){const{style:yt}=this.div,{height:Dt,width:$t}=yt,_t=$t.endsWith("%"),ht=!mt(this,et)&&Dt.endsWith("%");if(_t&&ht)return;const[ct,xt]=this.parentDimensions;_t||(yt.width=`${(100*parseFloat($t)/ct).toFixed(2)}%`),!mt(this,et)&&!ht&&(yt.height=`${(100*parseFloat(Dt)/xt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(mt(this,b))return;const yt=ir(this,b,document.createElement("button"));yt.className="altText";const Dt=await It._l10nPromise.get("editor_alt_text_button_label");yt.textContent=Dt,yt.setAttribute("aria-label",Dt),yt.tabIndex="0",yt.addEventListener("contextmenu",c.noContextMenu),yt.addEventListener("pointerdown",$t=>$t.stopPropagation()),yt.addEventListener("click",$t=>{$t.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),yt.addEventListener("keydown",$t=>{$t.target===yt&&$t.key==="Enter"&&($t.preventDefault(),this._uiManager.editAltText(this))}),Qt(this,ut,Vn).call(this),this.div.append(yt),It.SMALL_EDITOR_SIZE||(It.SMALL_EDITOR_SIZE=Math.min(128,Math.round(yt.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:mt(this,g),decorative:mt(this,_)}}set altTextData({altText:yt,decorative:Dt}){mt(this,g)===yt&&mt(this,_)===Dt||(ir(this,g,yt),ir(this,_,Dt),Qt(this,ut,Vn).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",mt(this,tt)),this.div.addEventListener("focusout",mt(this,it));const[yt,Dt]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Dt/yt).toFixed(2)}%`,this.div.style.maxHeight=`${(100*yt/Dt).toFixed(2)}%`);const[$t,_t]=this.getInitialTranslation();return this.translate($t,_t),(0,s.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(yt){const{isMac:Dt}=o.FeatureTest.platform;if(yt.button!==0||yt.ctrlKey&&Dt){yt.preventDefault();return}ir(this,nt,!0),Qt(this,ut,hs).call(this,yt)}moveInDOM(){var yt;(yt=this.parent)==null||yt.moveEditorInDOM(this)}_setParentAndPosition(yt,Dt,$t){yt.changeParent(this),this.x=Dt,this.y=$t,this.fixAndSetPosition()}getRect(yt,Dt){const $t=this.parentScale,[_t,ht]=this.pageDimensions,[ct,xt]=this.pageTranslation,Et=yt/$t,bt=Dt/$t,Ct=this.x*_t,Ot=this.y*ht,jt=this.width*_t,er=this.height*ht;switch(this.rotation){case 0:return[Ct+Et+ct,ht-Ot-bt-er+xt,Ct+Et+jt+ct,ht-Ot-bt+xt];case 90:return[Ct+bt+ct,ht-Ot+Et+xt,Ct+bt+er+ct,ht-Ot+Et+jt+xt];case 180:return[Ct-Et-jt+ct,ht-Ot+bt+xt,Ct-Et+ct,ht-Ot+bt+er+xt];case 270:return[Ct-bt-er+ct,ht-Ot-Et-jt+xt,Ct-bt+ct,ht-Ot-Et+xt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(yt,Dt){const[$t,_t,ht,ct]=yt,xt=ht-$t,Et=ct-_t;switch(this.rotation){case 0:return[$t,Dt-ct,xt,Et];case 90:return[$t,Dt-_t,Et,xt];case 180:return[ht,Dt-_t,xt,Et];case 270:return[ht,Dt-ct,Et,xt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ir(this,st,!0)}disableEditMode(){ir(this,st,!1)}isInEditMode(){return mt(this,st)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var yt,Dt;(yt=this.div)==null||yt.addEventListener("focusin",mt(this,tt)),(Dt=this.div)==null||Dt.addEventListener("focusout",mt(this,it))}serialize(yt=!1,Dt=null){(0,o.unreachable)("An editor must be serializable")}static deserialize(yt,Dt,$t){const _t=new this.prototype.constructor({parent:Dt,id:Dt.getNextId(),uiManager:$t});_t.rotation=yt.rotation;const[ht,ct]=_t.pageDimensions,[xt,Et,bt,Ct]=_t.getRectInCurrentCoords(yt.rect,ct);return _t.x=xt/ht,_t.y=Et/ct,_t.width=bt/ht,_t.height=Ct/ct,_t}remove(){var yt;this.div.removeEventListener("focusin",mt(this,tt)),this.div.removeEventListener("focusout",mt(this,it)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(yt=mt(this,b))==null||yt.remove(),ir(this,b,null),ir(this,j,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Qt(this,ut,cs).call(this),mt(this,rt).classList.remove("hidden"))}select(){var yt;this.makeResizable(),(yt=this.div)==null||yt.classList.add("selectedEditor")}unselect(){var yt,Dt,$t;(yt=mt(this,rt))==null||yt.classList.add("hidden"),(Dt=this.div)==null||Dt.classList.remove("selectedEditor"),($t=this.div)!=null&&$t.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(yt,Dt){}disableEditing(){mt(this,b)&&(mt(this,b).hidden=!0)}enableEditing(){mt(this,b)&&(mt(this,b).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return mt(this,at)}set isEditing(yt){ir(this,at,yt),this.parent&&(yt?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(yt,Dt){ir(this,et,!0);const $t=yt/Dt,{style:_t}=this.div;_t.aspectRatio=$t,_t.height="auto"}static get MIN_SIZE(){return 16}};g=new WeakMap,_=new WeakMap,b=new WeakMap,j=new WeakMap,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,tt=new WeakMap,it=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakMap,dt=new WeakMap,lt=new WeakMap,ut=new WeakSet,In=function([yt,Dt],$t,_t){[$t,_t]=this.screenToPageTranslation($t,_t),this.x+=$t/yt,this.y+=_t/Dt,this.fixAndSetPosition()},On=function(){const[yt,Dt]=this.parentDimensions,{_borderLineWidth:$t}=It,_t=$t/yt,ht=$t/Dt;switch(this.rotation){case 90:return[-_t,ht];case 180:return[_t,ht];case 270:return[_t,-ht];default:return[-_t,-ht]}},pt=new WeakSet,Nn=function(yt,Dt,$t){switch($t){case 90:return[Dt,-yt];case 180:return[-yt,-Dt];case 270:return[-Dt,yt];default:return[yt,Dt]}},Bn=function(yt){switch(yt){case 90:{const[Dt,$t]=this.pageDimensions;return[0,-Dt/$t,$t/Dt,0]}case 180:return[-1,0,0,-1];case 270:{const[Dt,$t]=this.pageDimensions;return[0,Dt/$t,-$t/Dt,0]}default:return[1,0,0,1]}},cs=function(){if(mt(this,rt))return;ir(this,rt,document.createElement("div")),mt(this,rt).classList.add("resizers");const yt=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||yt.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Dt of yt){const $t=document.createElement("div");mt(this,rt).append($t),$t.classList.add("resizer",Dt),$t.addEventListener("pointerdown",Qt(this,ut,us).bind(this,Dt)),$t.addEventListener("contextmenu",c.noContextMenu)}this.div.prepend(mt(this,rt))},us=function(yt,Dt){Dt.preventDefault();const{isMac:$t}=o.FeatureTest.platform;if(Dt.button!==0||Dt.ctrlKey&&$t)return;const _t=Qt(this,ut,fs).bind(this,yt),ht=this._isDraggable;this._isDraggable=!1;const ct={passive:!0,capture:!0};window.addEventListener("pointermove",_t,ct);const xt=this.x,Et=this.y,bt=this.width,Ct=this.height,Ot=this.parent.div.style.cursor,jt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Dt.target).cursor;const er=()=>{this._isDraggable=ht,window.removeEventListener("pointerup",er),window.removeEventListener("blur",er),window.removeEventListener("pointermove",_t,ct),this.parent.div.style.cursor=Ot,this.div.style.cursor=jt;const Tt=this.x,ur=this.y,cr=this.width,hr=this.height;Tt===xt&&ur===Et&&cr===bt&&hr===Ct||this.addCommands({cmd:()=>{this.width=cr,this.height=hr,this.x=Tt,this.y=ur;const[Yt,Xt]=this.parentDimensions;this.setDims(Yt*cr,Xt*hr),this.fixAndSetPosition()},undo:()=>{this.width=bt,this.height=Ct,this.x=xt,this.y=Et;const[Yt,Xt]=this.parentDimensions;this.setDims(Yt*bt,Xt*Ct),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",er),window.addEventListener("blur",er)},fs=function(yt,Dt){const[$t,_t]=this.parentDimensions,ht=this.x,ct=this.y,xt=this.width,Et=this.height,bt=It.MIN_SIZE/$t,Ct=It.MIN_SIZE/_t,Ot=kr=>Math.round(kr*1e4)/1e4,jt=Qt(this,ut,Bn).call(this,this.rotation),er=(kr,Dr)=>[jt[0]*kr+jt[2]*Dr,jt[1]*kr+jt[3]*Dr],Tt=Qt(this,ut,Bn).call(this,360-this.rotation),ur=(kr,Dr)=>[Tt[0]*kr+Tt[2]*Dr,Tt[1]*kr+Tt[3]*Dr];let cr,hr,Yt=!1,Xt=!1;switch(yt){case"topLeft":Yt=!0,cr=(kr,Dr)=>[0,0],hr=(kr,Dr)=>[kr,Dr];break;case"topMiddle":cr=(kr,Dr)=>[kr/2,0],hr=(kr,Dr)=>[kr/2,Dr];break;case"topRight":Yt=!0,cr=(kr,Dr)=>[kr,0],hr=(kr,Dr)=>[0,Dr];break;case"middleRight":Xt=!0,cr=(kr,Dr)=>[kr,Dr/2],hr=(kr,Dr)=>[0,Dr/2];break;case"bottomRight":Yt=!0,cr=(kr,Dr)=>[kr,Dr],hr=(kr,Dr)=>[0,0];break;case"bottomMiddle":cr=(kr,Dr)=>[kr/2,Dr],hr=(kr,Dr)=>[kr/2,0];break;case"bottomLeft":Yt=!0,cr=(kr,Dr)=>[0,Dr],hr=(kr,Dr)=>[kr,0];break;case"middleLeft":Xt=!0,cr=(kr,Dr)=>[0,Dr/2],hr=(kr,Dr)=>[kr,Dr/2];break}const Ft=cr(xt,Et),Ut=hr(xt,Et);let qt=er(...Ut);const Jt=Ot(ht+qt[0]),dr=Ot(ct+qt[1]);let vr=1,_r=1,[Zt,Er]=this.screenToPageTranslation(Dt.movementX,Dt.movementY);if([Zt,Er]=ur(Zt/$t,Er/_t),Yt){const kr=Math.hypot(xt,Et);vr=_r=Math.max(Math.min(Math.hypot(Ut[0]-Ft[0]-Zt,Ut[1]-Ft[1]-Er)/kr,1/xt,1/Et),bt/xt,Ct/Et)}else Xt?vr=Math.max(bt,Math.min(1,Math.abs(Ut[0]-Ft[0]-Zt)))/xt:_r=Math.max(Ct,Math.min(1,Math.abs(Ut[1]-Ft[1]-Er)))/Et;const Sr=Ot(xt*vr),Vr=Ot(Et*_r);qt=er(...hr(Sr,Vr));const Nr=Jt-qt[0],Pr=dr-qt[1];this.width=Sr,this.height=Vr,this.x=Nr,this.y=Pr,this.setDims($t*Sr,_t*Vr),this.fixAndSetPosition()},Vn=async function(){var $t;const yt=mt(this,b);if(!yt)return;if(!mt(this,g)&&!mt(this,_)){yt.classList.remove("done"),($t=mt(this,j))==null||$t.remove();return}It._l10nPromise.get("editor_alt_text_edit_button_label").then(_t=>{yt.setAttribute("aria-label",_t)});let Dt=mt(this,j);if(!Dt){ir(this,j,Dt=document.createElement("span")),Dt.className="tooltip",Dt.setAttribute("role","tooltip");const _t=Dt.id=`alt-text-tooltip-${this.id}`;yt.setAttribute("aria-describedby",_t);const ht=100;yt.addEventListener("mouseenter",()=>{ir(this,_e,setTimeout(()=>{ir(this,_e,null),mt(this,j).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},ht))}),yt.addEventListener("mouseleave",()=>{var ct;clearTimeout(mt(this,_e)),ir(this,_e,null),(ct=mt(this,j))==null||ct.classList.remove("show")})}yt.classList.add("done"),Dt.innerText=mt(this,_)?await It._l10nPromise.get("editor_alt_text_decorative_tooltip"):mt(this,g),Dt.parentNode||yt.append(Dt)},hs=function(yt){if(!this._isDraggable)return;const Dt=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let $t,_t;Dt&&($t={passive:!0,capture:!0},_t=ct=>{const[xt,Et]=this.screenToPageTranslation(ct.movementX,ct.movementY);this._uiManager.dragSelectedEditors(xt,Et)},window.addEventListener("pointermove",_t,$t));const ht=()=>{if(window.removeEventListener("pointerup",ht),window.removeEventListener("blur",ht),Dt&&window.removeEventListener("pointermove",_t,$t),ir(this,nt,!1),!this._uiManager.endDragSession()){const{isMac:ct}=o.FeatureTest.platform;yt.ctrlKey&&!ct||yt.shiftKey||yt.metaKey&&ct?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",ht),window.addEventListener("blur",ht)},nr(It,pt),$r(It,"_borderLineWidth",-1),$r(It,"_colorManager",new s.ColorManager),$r(It,"_zIndex",1),$r(It,"SMALL_EDITOR_SIZE",0);let h=It;i.AnnotationEditor=h;class d extends h{constructor(yt){super(yt),this.annotationElementId=yt.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,i,a)=>{var et,rt,tt,it,nt,Un,dt,lt,ut,ot,ft,ds,gt,vt,At,Gt,Nt,Ht,It,Wt,yt,Dt,$t,_t,ht,ct,xt,Et,bt,Ct,Ot,jt,er,Tt,ur,cr,hr,Yt,Xt,Ft,Ut,qt,Jt,dr,vr,_r,Zt,ps,jn,Wn,yn,zn,Hn,qr,fn,ms,gs,Xn,hn,$n;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=c,i.opacityToHex=h;var s=a(1),o=a(6);function c(Wr,zt,gr){for(const Tr of gr)zt.addEventListener(Tr,Wr[Tr].bind(Wr))}function h(Wr){return Math.round(Math.min(255,Math.max(1,255*Wr))).toString(16).padStart(2,"0")}class d{constructor(){nr(this,et,0)}getId(){return`${s.AnnotationEditorPrefix}${un(this,et)._++}`}}et=new WeakMap;const st=class st{constructor(){nr(this,nt);nr(this,rt,(0,s.getUuid)());nr(this,tt,0);nr(this,it,null)}static get _isSVGFittingCanvas(){const zt='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Tr=new OffscreenCanvas(1,3).getContext("2d"),Lr=new Image;Lr.src=zt;const Or=Lr.decode().then(()=>(Tr.drawImage(Lr,0,0,1,1,0,0,1,3),new Uint32Array(Tr.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,s.shadow)(this,"_isSVGFittingCanvas",Or)}async getFromFile(zt){const{lastModified:gr,name:Tr,size:Lr,type:Or}=zt;return Qt(this,nt,Un).call(this,`${gr}_${Tr}_${Lr}_${Or}`,zt)}async getFromUrl(zt){return Qt(this,nt,Un).call(this,zt,zt)}async getFromId(zt){mt(this,it)||ir(this,it,new Map);const gr=mt(this,it).get(zt);return gr?gr.bitmap?(gr.refCounter+=1,gr):gr.file?this.getFromFile(gr.file):this.getFromUrl(gr.url):null}getSvgUrl(zt){const gr=mt(this,it).get(zt);return gr!=null&&gr.isSvg?gr.svgUrl:null}deleteId(zt){mt(this,it)||ir(this,it,new Map);const gr=mt(this,it).get(zt);gr&&(gr.refCounter-=1,gr.refCounter===0&&(gr.bitmap=null))}isValidId(zt){return zt.startsWith(`image_${mt(this,rt)}_`)}};rt=new WeakMap,tt=new WeakMap,it=new WeakMap,nt=new WeakSet,Un=async function(zt,gr){mt(this,it)||ir(this,it,new Map);let Tr=mt(this,it).get(zt);if(Tr===null)return null;if(Tr!=null&&Tr.bitmap)return Tr.refCounter+=1,Tr;try{Tr||(Tr={bitmap:null,id:`image_${mt(this,rt)}_${un(this,tt)._++}`,refCounter:0,isSvg:!1});let Lr;if(typeof gr=="string"){Tr.url=gr;const Or=await fetch(gr);if(!Or.ok)throw new Error(Or.statusText);Lr=await Or.blob()}else Lr=Tr.file=gr;if(Lr.type==="image/svg+xml"){const Or=st._isSVGFittingCanvas,Fr=new FileReader,Vt=new Image,Mt=new Promise((Kt,lr)=>{Vt.onload=()=>{Tr.bitmap=Vt,Tr.isSvg=!0,Kt()},Fr.onload=async()=>{const fr=Tr.svgUrl=Fr.result;Vt.src=await Or?`${fr}#svgView(preserveAspectRatio(none))`:fr},Vt.onerror=Fr.onerror=lr});Fr.readAsDataURL(Lr),await Mt}else Tr.bitmap=await createImageBitmap(Lr);Tr.refCounter=1}catch(Lr){console.error(Lr),Tr=null}return mt(this,it).set(zt,Tr),Tr&&mt(this,it).set(Tr.id,Tr),Tr};let g=st;class _{constructor(zt=128){nr(this,dt,[]);nr(this,lt,!1);nr(this,ut);nr(this,ot,-1);ir(this,ut,zt)}add({cmd:zt,undo:gr,mustExec:Tr,type:Lr=NaN,overwriteIfSameType:Or=!1,keepUndo:Fr=!1}){if(Tr&&zt(),mt(this,lt))return;const Vt={cmd:zt,undo:gr,type:Lr};if(mt(this,ot)===-1){mt(this,dt).length>0&&(mt(this,dt).length=0),ir(this,ot,0),mt(this,dt).push(Vt);return}if(Or&&mt(this,dt)[mt(this,ot)].type===Lr){Fr&&(Vt.undo=mt(this,dt)[mt(this,ot)].undo),mt(this,dt)[mt(this,ot)]=Vt;return}const Mt=mt(this,ot)+1;Mt===mt(this,ut)?mt(this,dt).splice(0,1):(ir(this,ot,Mt),Mt<mt(this,dt).length&&mt(this,dt).splice(Mt)),mt(this,dt).push(Vt)}undo(){mt(this,ot)!==-1&&(ir(this,lt,!0),mt(this,dt)[mt(this,ot)].undo(),ir(this,lt,!1),ir(this,ot,mt(this,ot)-1))}redo(){mt(this,ot)<mt(this,dt).length-1&&(ir(this,ot,mt(this,ot)+1),ir(this,lt,!0),mt(this,dt)[mt(this,ot)].cmd(),ir(this,lt,!1))}hasSomethingToUndo(){return mt(this,ot)!==-1}hasSomethingToRedo(){return mt(this,ot)<mt(this,dt).length-1}destroy(){ir(this,dt,null)}}dt=new WeakMap,lt=new WeakMap,ut=new WeakMap,ot=new WeakMap,i.CommandManager=_;class b{constructor(zt){nr(this,ft);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:gr}=s.FeatureTest.platform;for(const[Tr,Lr,Or={}]of zt)for(const Fr of Tr){const Vt=Fr.startsWith("mac+");gr&&Vt?(this.callbacks.set(Fr.slice(4),{callback:Lr,options:Or}),this.allKeys.add(Fr.split("+").at(-1))):!gr&&!Vt&&(this.callbacks.set(Fr,{callback:Lr,options:Or}),this.allKeys.add(Fr.split("+").at(-1)))}}exec(zt,gr){if(!this.allKeys.has(gr.key))return;const Tr=this.callbacks.get(Qt(this,ft,ds).call(this,gr));if(!Tr)return;const{callback:Lr,options:{bubbles:Or=!1,args:Fr=[],checker:Vt=null}}=Tr;Vt&&!Vt(zt,gr)||(Lr.bind(zt,...Fr)(),Or||(gr.stopPropagation(),gr.preventDefault()))}}ft=new WeakSet,ds=function(zt){zt.altKey&&this.buffer.push("alt"),zt.ctrlKey&&this.buffer.push("ctrl"),zt.metaKey&&this.buffer.push("meta"),zt.shiftKey&&this.buffer.push("shift"),this.buffer.push(zt.key);const gr=this.buffer.join("+");return this.buffer.length=0,gr},i.KeyboardManager=b;const St=class St{get _colors(){const zt=new Map([["CanvasText",null],["Canvas",null]]);return(0,o.getColorValues)(zt),(0,s.shadow)(this,"_colors",zt)}convert(zt){const gr=(0,o.getRGB)(zt);if(!window.matchMedia("(forced-colors: active)").matches)return gr;for(const[Tr,Lr]of this._colors)if(Lr.every((Or,Fr)=>Or===gr[Fr]))return St._colorsMapping.get(Tr);return gr}getHexCode(zt){const gr=this._colors.get(zt);return gr?s.Util.makeHexColor(...gr):zt}};$r(St,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let j=St;i.ColorManager=j;const zr=class zr{constructor(zt,gr,Tr,Lr,Or,Fr){nr(this,Zt);nr(this,gt,null);nr(this,vt,new Map);nr(this,At,new Map);nr(this,Gt,null);nr(this,Nt,null);nr(this,Ht,new _);nr(this,It,0);nr(this,Wt,new Set);nr(this,yt,null);nr(this,Dt,null);nr(this,$t,new Set);nr(this,_t,null);nr(this,ht,new d);nr(this,ct,!1);nr(this,xt,!1);nr(this,Et,null);nr(this,bt,s.AnnotationEditorType.NONE);nr(this,Ct,new Set);nr(this,Ot,null);nr(this,jt,this.blur.bind(this));nr(this,er,this.focus.bind(this));nr(this,Tt,this.copy.bind(this));nr(this,ur,this.cut.bind(this));nr(this,cr,this.paste.bind(this));nr(this,hr,this.keydown.bind(this));nr(this,Yt,this.onEditingAction.bind(this));nr(this,Xt,this.onPageChanging.bind(this));nr(this,Ft,this.onScaleChanging.bind(this));nr(this,Ut,this.onRotationChanging.bind(this));nr(this,qt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});nr(this,Jt,[0,0]);nr(this,dr,null);nr(this,vr,null);nr(this,_r,null);ir(this,vr,zt),ir(this,_r,gr),ir(this,Gt,Tr),this._eventBus=Lr,this._eventBus._on("editingaction",mt(this,Yt)),this._eventBus._on("pagechanging",mt(this,Xt)),this._eventBus._on("scalechanging",mt(this,Ft)),this._eventBus._on("rotationchanging",mt(this,Ut)),ir(this,Nt,Or.annotationStorage),ir(this,_t,Or.filterFactory),ir(this,Ot,Fr),this.viewParameters={realScale:o.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const zt=zr.prototype,gr=Or=>{const{activeElement:Fr}=document;return Fr&&mt(Or,vr).contains(Fr)&&Or.hasSomethingToControl()},Tr=this.TRANSLATE_SMALL,Lr=this.TRANSLATE_BIG;return(0,s.shadow)(this,"_keyboardManager",new b([[["ctrl+a","mac+meta+a"],zt.selectAll],[["ctrl+z","mac+meta+z"],zt.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],zt.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],zt.delete],[["Escape","mac+Escape"],zt.unselectAll],[["ArrowLeft","mac+ArrowLeft"],zt.translateSelectedEditors,{args:[-Tr,0],checker:gr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],zt.translateSelectedEditors,{args:[-Lr,0],checker:gr}],[["ArrowRight","mac+ArrowRight"],zt.translateSelectedEditors,{args:[Tr,0],checker:gr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],zt.translateSelectedEditors,{args:[Lr,0],checker:gr}],[["ArrowUp","mac+ArrowUp"],zt.translateSelectedEditors,{args:[0,-Tr],checker:gr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],zt.translateSelectedEditors,{args:[0,-Lr],checker:gr}],[["ArrowDown","mac+ArrowDown"],zt.translateSelectedEditors,{args:[0,Tr],checker:gr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],zt.translateSelectedEditors,{args:[0,Lr],checker:gr}]]))}destroy(){Qt(this,Zt,yn).call(this),Qt(this,Zt,jn).call(this),this._eventBus._off("editingaction",mt(this,Yt)),this._eventBus._off("pagechanging",mt(this,Xt)),this._eventBus._off("scalechanging",mt(this,Ft)),this._eventBus._off("rotationchanging",mt(this,Ut));for(const zt of mt(this,At).values())zt.destroy();mt(this,At).clear(),mt(this,vt).clear(),mt(this,$t).clear(),ir(this,gt,null),mt(this,Ct).clear(),mt(this,Ht).destroy(),mt(this,Gt).destroy()}get hcmFilter(){return(0,s.shadow)(this,"hcmFilter",mt(this,Ot)?mt(this,_t).addHCMFilter(mt(this,Ot).foreground,mt(this,Ot).background):"none")}get direction(){return(0,s.shadow)(this,"direction",getComputedStyle(mt(this,vr)).direction)}editAltText(zt){var gr;(gr=mt(this,Gt))==null||gr.editAltText(this,zt)}onPageChanging({pageNumber:zt}){ir(this,It,zt-1)}focusMainContainer(){mt(this,vr).focus()}findParent(zt,gr){for(const Tr of mt(this,At).values()){const{x:Lr,y:Or,width:Fr,height:Vt}=Tr.div.getBoundingClientRect();if(zt>=Lr&&zt<=Lr+Fr&&gr>=Or&&gr<=Or+Vt)return Tr}return null}disableUserSelect(zt=!1){mt(this,_r).classList.toggle("noUserSelect",zt)}addShouldRescale(zt){mt(this,$t).add(zt)}removeShouldRescale(zt){mt(this,$t).delete(zt)}onScaleChanging({scale:zt}){this.commitOrRemove(),this.viewParameters.realScale=zt*o.PixelsPerInch.PDF_TO_CSS_UNITS;for(const gr of mt(this,$t))gr.onScaleChanging()}onRotationChanging({pagesRotation:zt}){this.commitOrRemove(),this.viewParameters.rotation=zt}addToAnnotationStorage(zt){!zt.isEmpty()&&mt(this,Nt)&&!mt(this,Nt).has(zt.id)&&mt(this,Nt).setValue(zt.id,zt)}blur(){if(!this.hasSelection)return;const{activeElement:zt}=document;for(const gr of mt(this,Ct))if(gr.div.contains(zt)){ir(this,Et,[gr,zt]),gr._focusEventsAllowed=!1;break}}focus(){if(!mt(this,Et))return;const[zt,gr]=mt(this,Et);ir(this,Et,null),gr.addEventListener("focusin",()=>{zt._focusEventsAllowed=!0},{once:!0}),gr.focus()}addEditListeners(){Qt(this,Zt,Wn).call(this),Qt(this,Zt,zn).call(this)}removeEditListeners(){Qt(this,Zt,yn).call(this),Qt(this,Zt,Hn).call(this)}copy(zt){var Tr;if(zt.preventDefault(),(Tr=mt(this,gt))==null||Tr.commitOrRemove(),!this.hasSelection)return;const gr=[];for(const Lr of mt(this,Ct)){const Or=Lr.serialize(!0);Or&&gr.push(Or)}gr.length!==0&&zt.clipboardData.setData("application/pdfjs",JSON.stringify(gr))}cut(zt){this.copy(zt),this.delete()}paste(zt){zt.preventDefault();const{clipboardData:gr}=zt;for(const Or of gr.items)for(const Fr of mt(this,Dt))if(Fr.isHandlingMimeForPasting(Or.type)){Fr.paste(Or,this.currentLayer);return}let Tr=gr.getData("application/pdfjs");if(!Tr)return;try{Tr=JSON.parse(Tr)}catch(Or){(0,s.warn)(`paste: "${Or.message}".`);return}if(!Array.isArray(Tr))return;this.unselectAll();const Lr=this.currentLayer;try{const Or=[];for(const Mt of Tr){const Kt=Lr.deserialize(Mt);if(!Kt)return;Or.push(Kt)}const Fr=()=>{for(const Mt of Or)Qt(this,Zt,Xn).call(this,Mt);Qt(this,Zt,$n).call(this,Or)},Vt=()=>{for(const Mt of Or)Mt.remove()};this.addCommands({cmd:Fr,undo:Vt,mustExec:!0})}catch(Or){(0,s.warn)(`paste: "${Or.message}".`)}}keydown(zt){var gr;(gr=this.getActive())!=null&&gr.shouldGetKeyboardEvents()||zr._keyboardManager.exec(this,zt)}onEditingAction(zt){["undo","redo","delete","selectAll"].includes(zt.name)&&this[zt.name]()}setEditingState(zt){zt?(Qt(this,Zt,ps).call(this),Qt(this,Zt,Wn).call(this),Qt(this,Zt,zn).call(this),Qt(this,Zt,qr).call(this,{isEditing:mt(this,bt)!==s.AnnotationEditorType.NONE,isEmpty:Qt(this,Zt,hn).call(this),hasSomethingToUndo:mt(this,Ht).hasSomethingToUndo(),hasSomethingToRedo:mt(this,Ht).hasSomethingToRedo(),hasSelectedEditor:!1})):(Qt(this,Zt,jn).call(this),Qt(this,Zt,yn).call(this),Qt(this,Zt,Hn).call(this),Qt(this,Zt,qr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(zt){if(!mt(this,Dt)){ir(this,Dt,zt);for(const gr of mt(this,Dt))Qt(this,Zt,fn).call(this,gr.defaultPropertiesToUpdate)}}getId(){return mt(this,ht).getId()}get currentLayer(){return mt(this,At).get(mt(this,It))}getLayer(zt){return mt(this,At).get(zt)}get currentPageIndex(){return mt(this,It)}addLayer(zt){mt(this,At).set(zt.pageIndex,zt),mt(this,ct)?zt.enable():zt.disable()}removeLayer(zt){mt(this,At).delete(zt.pageIndex)}updateMode(zt,gr=null){if(mt(this,bt)!==zt){if(ir(this,bt,zt),zt===s.AnnotationEditorType.NONE){this.setEditingState(!1),Qt(this,Zt,gs).call(this);return}this.setEditingState(!0),Qt(this,Zt,ms).call(this),this.unselectAll();for(const Tr of mt(this,At).values())Tr.updateMode(zt);if(gr){for(const Tr of mt(this,vt).values())if(Tr.annotationElementId===gr){this.setSelected(Tr),Tr.enterInEditMode();break}}}}updateToolbar(zt){zt!==mt(this,bt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:zt})}updateParams(zt,gr){if(mt(this,Dt)){if(zt===s.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(zt);return}for(const Tr of mt(this,Ct))Tr.updateParams(zt,gr);for(const Tr of mt(this,Dt))Tr.updateDefaultParams(zt,gr)}}enableWaiting(zt=!1){if(mt(this,xt)!==zt){ir(this,xt,zt);for(const gr of mt(this,At).values())zt?gr.disableClick():gr.enableClick(),gr.div.classList.toggle("waiting",zt)}}getEditors(zt){const gr=[];for(const Tr of mt(this,vt).values())Tr.pageIndex===zt&&gr.push(Tr);return gr}getEditor(zt){return mt(this,vt).get(zt)}addEditor(zt){mt(this,vt).set(zt.id,zt)}removeEditor(zt){var gr;mt(this,vt).delete(zt.id),this.unselect(zt),(!zt.annotationElementId||!mt(this,Wt).has(zt.annotationElementId))&&((gr=mt(this,Nt))==null||gr.remove(zt.id))}addDeletedAnnotationElement(zt){mt(this,Wt).add(zt.annotationElementId),zt.deleted=!0}isDeletedAnnotationElement(zt){return mt(this,Wt).has(zt)}removeDeletedAnnotationElement(zt){mt(this,Wt).delete(zt.annotationElementId),zt.deleted=!1}setActiveEditor(zt){mt(this,gt)!==zt&&(ir(this,gt,zt),zt&&Qt(this,Zt,fn).call(this,zt.propertiesToUpdate))}toggleSelected(zt){if(mt(this,Ct).has(zt)){mt(this,Ct).delete(zt),zt.unselect(),Qt(this,Zt,qr).call(this,{hasSelectedEditor:this.hasSelection});return}mt(this,Ct).add(zt),zt.select(),Qt(this,Zt,fn).call(this,zt.propertiesToUpdate),Qt(this,Zt,qr).call(this,{hasSelectedEditor:!0})}setSelected(zt){for(const gr of mt(this,Ct))gr!==zt&&gr.unselect();mt(this,Ct).clear(),mt(this,Ct).add(zt),zt.select(),Qt(this,Zt,fn).call(this,zt.propertiesToUpdate),Qt(this,Zt,qr).call(this,{hasSelectedEditor:!0})}isSelected(zt){return mt(this,Ct).has(zt)}unselect(zt){zt.unselect(),mt(this,Ct).delete(zt),Qt(this,Zt,qr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return mt(this,Ct).size!==0}undo(){mt(this,Ht).undo(),Qt(this,Zt,qr).call(this,{hasSomethingToUndo:mt(this,Ht).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Qt(this,Zt,hn).call(this)})}redo(){mt(this,Ht).redo(),Qt(this,Zt,qr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:mt(this,Ht).hasSomethingToRedo(),isEmpty:Qt(this,Zt,hn).call(this)})}addCommands(zt){mt(this,Ht).add(zt),Qt(this,Zt,qr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Qt(this,Zt,hn).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const zt=[...mt(this,Ct)],gr=()=>{for(const Lr of zt)Lr.remove()},Tr=()=>{for(const Lr of zt)Qt(this,Zt,Xn).call(this,Lr)};this.addCommands({cmd:gr,undo:Tr,mustExec:!0})}commitOrRemove(){var zt;(zt=mt(this,gt))==null||zt.commitOrRemove()}hasSomethingToControl(){return mt(this,gt)||this.hasSelection}selectAll(){for(const zt of mt(this,Ct))zt.commit();Qt(this,Zt,$n).call(this,mt(this,vt).values())}unselectAll(){if(mt(this,gt)){mt(this,gt).commitOrRemove();return}if(this.hasSelection){for(const zt of mt(this,Ct))zt.unselect();mt(this,Ct).clear(),Qt(this,Zt,qr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(zt,gr,Tr=!1){if(Tr||this.commitOrRemove(),!this.hasSelection)return;mt(this,Jt)[0]+=zt,mt(this,Jt)[1]+=gr;const[Lr,Or]=mt(this,Jt),Fr=[...mt(this,Ct)],Vt=1e3;mt(this,dr)&&clearTimeout(mt(this,dr)),ir(this,dr,setTimeout(()=>{ir(this,dr,null),mt(this,Jt)[0]=mt(this,Jt)[1]=0,this.addCommands({cmd:()=>{for(const Mt of Fr)mt(this,vt).has(Mt.id)&&Mt.translateInPage(Lr,Or)},undo:()=>{for(const Mt of Fr)mt(this,vt).has(Mt.id)&&Mt.translateInPage(-Lr,-Or)},mustExec:!1})},Vt));for(const Mt of Fr)Mt.translateInPage(zt,gr)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ir(this,yt,new Map);for(const zt of mt(this,Ct))mt(this,yt).set(zt,{savedX:zt.x,savedY:zt.y,savedPageIndex:zt.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!mt(this,yt))return!1;this.disableUserSelect(!1);const zt=mt(this,yt);ir(this,yt,null);let gr=!1;for(const[{x:Lr,y:Or,pageIndex:Fr},Vt]of zt)Vt.newX=Lr,Vt.newY=Or,Vt.newPageIndex=Fr,gr||(gr=Lr!==Vt.savedX||Or!==Vt.savedY||Fr!==Vt.savedPageIndex);if(!gr)return!1;const Tr=(Lr,Or,Fr,Vt)=>{if(mt(this,vt).has(Lr.id)){const Mt=mt(this,At).get(Vt);Mt?Lr._setParentAndPosition(Mt,Or,Fr):(Lr.pageIndex=Vt,Lr.x=Or,Lr.y=Fr)}};return this.addCommands({cmd:()=>{for(const[Lr,{newX:Or,newY:Fr,newPageIndex:Vt}]of zt)Tr(Lr,Or,Fr,Vt)},undo:()=>{for(const[Lr,{savedX:Or,savedY:Fr,savedPageIndex:Vt}]of zt)Tr(Lr,Or,Fr,Vt)},mustExec:!0}),!0}dragSelectedEditors(zt,gr){if(mt(this,yt))for(const Tr of mt(this,yt).keys())Tr.drag(zt,gr)}rebuild(zt){if(zt.parent===null){const gr=this.getLayer(zt.pageIndex);gr?(gr.changeParent(zt),gr.addOrRebuild(zt)):(this.addEditor(zt),this.addToAnnotationStorage(zt),zt.rebuild())}else zt.parent.addOrRebuild(zt)}isActive(zt){return mt(this,gt)===zt}getActive(){return mt(this,gt)}getMode(){return mt(this,bt)}get imageManager(){return(0,s.shadow)(this,"imageManager",new g)}};gt=new WeakMap,vt=new WeakMap,At=new WeakMap,Gt=new WeakMap,Nt=new WeakMap,Ht=new WeakMap,It=new WeakMap,Wt=new WeakMap,yt=new WeakMap,Dt=new WeakMap,$t=new WeakMap,_t=new WeakMap,ht=new WeakMap,ct=new WeakMap,xt=new WeakMap,Et=new WeakMap,bt=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,jt=new WeakMap,er=new WeakMap,Tt=new WeakMap,ur=new WeakMap,cr=new WeakMap,hr=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,Ft=new WeakMap,Ut=new WeakMap,qt=new WeakMap,Jt=new WeakMap,dr=new WeakMap,vr=new WeakMap,_r=new WeakMap,Zt=new WeakSet,ps=function(){window.addEventListener("focus",mt(this,er)),window.addEventListener("blur",mt(this,jt))},jn=function(){window.removeEventListener("focus",mt(this,er)),window.removeEventListener("blur",mt(this,jt))},Wn=function(){window.addEventListener("keydown",mt(this,hr),{capture:!0})},yn=function(){window.removeEventListener("keydown",mt(this,hr),{capture:!0})},zn=function(){document.addEventListener("copy",mt(this,Tt)),document.addEventListener("cut",mt(this,ur)),document.addEventListener("paste",mt(this,cr))},Hn=function(){document.removeEventListener("copy",mt(this,Tt)),document.removeEventListener("cut",mt(this,ur)),document.removeEventListener("paste",mt(this,cr))},qr=function(zt){Object.entries(zt).some(([Tr,Lr])=>mt(this,qt)[Tr]!==Lr)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(mt(this,qt),zt)})},fn=function(zt){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:zt})},ms=function(){if(!mt(this,ct)){ir(this,ct,!0);for(const zt of mt(this,At).values())zt.enable()}},gs=function(){if(this.unselectAll(),mt(this,ct)){ir(this,ct,!1);for(const zt of mt(this,At).values())zt.disable()}},Xn=function(zt){const gr=mt(this,At).get(zt.pageIndex);gr?gr.addOrRebuild(zt):this.addEditor(zt)},hn=function(){if(mt(this,vt).size===0)return!0;if(mt(this,vt).size===1)for(const zt of mt(this,vt).values())return zt.isEmpty();return!1},$n=function(zt){mt(this,Ct).clear();for(const gr of zt)gr.isEmpty()||(mt(this,Ct).add(gr),gr.select());Qt(this,Zt,qr).call(this,{hasSelectedEditor:!0})},$r(zr,"TRANSLATE_SMALL",1),$r(zr,"TRANSLATE_BIG",10);let _e=zr;i.AnnotationEditorUIManager=_e},(e,i,a)=>{var It,Wt,yt,Dt,$t,_t,ht,ct,xt,Et,bt,Ct,rn,nn,Gn,wn,Sn,dn,pn;Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=void 0,i.deprecated=ot,i.getColorValues=vt,i.getCurrentTransform=At,i.getCurrentTransformInverse=Gt,i.getFilenameFromUrl=nt,i.getPdfFilenameFromUrl=at,i.getRGB=gt,i.getXfaPageViewport=St,i.isDataScheme=tt,i.isPdfFile=it,i.isValidFetchUrl=dt,i.loadScript=ut,i.noContextMenu=lt,i.setLayerDimensions=Nt;var s=a(7),o=a(1);const c="http://www.w3.org/2000/svg",Ht=class Ht{};$r(Ht,"CSS",96),$r(Ht,"PDF",72),$r(Ht,"PDF_TO_CSS_UNITS",Ht.CSS/Ht.PDF);let h=Ht;i.PixelsPerInch=h;class d extends s.BaseFilterFactory{constructor({docId:Ft,ownerDocument:Ut=globalThis.document}={}){super();nr(this,Ct);nr(this,It);nr(this,Wt);nr(this,yt);nr(this,Dt);nr(this,$t);nr(this,_t);nr(this,ht);nr(this,ct);nr(this,xt);nr(this,Et);nr(this,bt,0);ir(this,yt,Ft),ir(this,Dt,Ut)}addFilter(Ft){if(!Ft)return"none";let Ut=mt(this,Ct,rn).get(Ft);if(Ut)return Ut;let qt,Jt,dr,vr;if(Ft.length===1){const Sr=Ft[0],Vr=new Array(256);for(let Nr=0;Nr<256;Nr++)Vr[Nr]=Sr[Nr]/255;vr=qt=Jt=dr=Vr.join(",")}else{const[Sr,Vr,Nr]=Ft,Pr=new Array(256),kr=new Array(256),Dr=new Array(256);for(let jr=0;jr<256;jr++)Pr[jr]=Sr[jr]/255,kr[jr]=Vr[jr]/255,Dr[jr]=Nr[jr]/255;qt=Pr.join(","),Jt=kr.join(","),dr=Dr.join(","),vr=`${qt}${Jt}${dr}`}if(Ut=mt(this,Ct,rn).get(vr),Ut)return mt(this,Ct,rn).set(Ft,Ut),Ut;const _r=`g_${mt(this,yt)}_transfer_map_${un(this,bt)._++}`,Zt=`url(#${_r})`;mt(this,Ct,rn).set(Ft,Zt),mt(this,Ct,rn).set(vr,Zt);const Er=Qt(this,Ct,wn).call(this,_r);return Qt(this,Ct,dn).call(this,qt,Jt,dr,Er),Zt}addHCMFilter(Ft,Ut){var Vr;const qt=`${Ft}-${Ut}`;if(mt(this,_t)===qt)return mt(this,ht);if(ir(this,_t,qt),ir(this,ht,"none"),(Vr=mt(this,$t))==null||Vr.remove(),!Ft||!Ut)return mt(this,ht);const Jt=Qt(this,Ct,pn).call(this,Ft);Ft=o.Util.makeHexColor(...Jt);const dr=Qt(this,Ct,pn).call(this,Ut);if(Ut=o.Util.makeHexColor(...dr),mt(this,Ct,nn).style.color="",Ft==="#000000"&&Ut==="#ffffff"||Ft===Ut)return mt(this,ht);const vr=new Array(256);for(let Nr=0;Nr<=255;Nr++){const Pr=Nr/255;vr[Nr]=Pr<=.03928?Pr/12.92:((Pr+.055)/1.055)**2.4}const _r=vr.join(","),Zt=`g_${mt(this,yt)}_hcm_filter`,Er=ir(this,ct,Qt(this,Ct,wn).call(this,Zt));Qt(this,Ct,dn).call(this,_r,_r,_r,Er),Qt(this,Ct,Gn).call(this,Er);const Sr=(Nr,Pr)=>{const kr=Jt[Nr]/255,Dr=dr[Nr]/255,jr=new Array(Pr+1);for(let Hr=0;Hr<=Pr;Hr++)jr[Hr]=kr+Hr/Pr*(Dr-kr);return jr.join(",")};return Qt(this,Ct,dn).call(this,Sr(0,5),Sr(1,5),Sr(2,5),Er),ir(this,ht,`url(#${Zt})`),mt(this,ht)}addHighlightHCMFilter(Ft,Ut,qt,Jt){var Dr;const dr=`${Ft}-${Ut}-${qt}-${Jt}`;if(mt(this,xt)===dr)return mt(this,Et);if(ir(this,xt,dr),ir(this,Et,"none"),(Dr=mt(this,ct))==null||Dr.remove(),!Ft||!Ut)return mt(this,Et);const[vr,_r]=[Ft,Ut].map(Qt(this,Ct,pn).bind(this));let Zt=Math.round(.2126*vr[0]+.7152*vr[1]+.0722*vr[2]),Er=Math.round(.2126*_r[0]+.7152*_r[1]+.0722*_r[2]),[Sr,Vr]=[qt,Jt].map(Qt(this,Ct,pn).bind(this));Er<Zt&&([Zt,Er,Sr,Vr]=[Er,Zt,Vr,Sr]),mt(this,Ct,nn).style.color="";const Nr=(jr,Hr,yr)=>{const rr=new Array(256),ar=(Er-Zt)/yr,Rr=jr/255,zr=(Hr-jr)/(255*yr);let Wr=0;for(let zt=0;zt<=yr;zt++){const gr=Math.round(Zt+zt*ar),Tr=Rr+zt*zr;for(let Lr=Wr;Lr<=gr;Lr++)rr[Lr]=Tr;Wr=gr+1}for(let zt=Wr;zt<256;zt++)rr[zt]=rr[Wr-1];return rr.join(",")},Pr=`g_${mt(this,yt)}_hcm_highlight_filter`,kr=ir(this,ct,Qt(this,Ct,wn).call(this,Pr));return Qt(this,Ct,Gn).call(this,kr),Qt(this,Ct,dn).call(this,Nr(Sr[0],Vr[0],5),Nr(Sr[1],Vr[1],5),Nr(Sr[2],Vr[2],5),kr),ir(this,Et,`url(#${Pr})`),mt(this,Et)}destroy(Ft=!1){Ft&&(mt(this,ht)||mt(this,Et))||(mt(this,Wt)&&(mt(this,Wt).parentNode.parentNode.remove(),ir(this,Wt,null)),mt(this,It)&&(mt(this,It).clear(),ir(this,It,null)),ir(this,bt,0))}}It=new WeakMap,Wt=new WeakMap,yt=new WeakMap,Dt=new WeakMap,$t=new WeakMap,_t=new WeakMap,ht=new WeakMap,ct=new WeakMap,xt=new WeakMap,Et=new WeakMap,bt=new WeakMap,Ct=new WeakSet,rn=function(){return mt(this,It)||ir(this,It,new Map)},nn=function(){if(!mt(this,Wt)){const Ft=mt(this,Dt).createElement("div"),{style:Ut}=Ft;Ut.visibility="hidden",Ut.contain="strict",Ut.width=Ut.height=0,Ut.position="absolute",Ut.top=Ut.left=0,Ut.zIndex=-1;const qt=mt(this,Dt).createElementNS(c,"svg");qt.setAttribute("width",0),qt.setAttribute("height",0),ir(this,Wt,mt(this,Dt).createElementNS(c,"defs")),Ft.append(qt),qt.append(mt(this,Wt)),mt(this,Dt).body.append(Ft)}return mt(this,Wt)},Gn=function(Ft){const Ut=mt(this,Dt).createElementNS(c,"feColorMatrix");Ut.setAttribute("type","matrix"),Ut.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Ft.append(Ut)},wn=function(Ft){const Ut=mt(this,Dt).createElementNS(c,"filter");return Ut.setAttribute("color-interpolation-filters","sRGB"),Ut.setAttribute("id",Ft),mt(this,Ct,nn).append(Ut),Ut},Sn=function(Ft,Ut,qt){const Jt=mt(this,Dt).createElementNS(c,Ut);Jt.setAttribute("type","discrete"),Jt.setAttribute("tableValues",qt),Ft.append(Jt)},dn=function(Ft,Ut,qt,Jt){const dr=mt(this,Dt).createElementNS(c,"feComponentTransfer");Jt.append(dr),Qt(this,Ct,Sn).call(this,dr,"feFuncR",Ft),Qt(this,Ct,Sn).call(this,dr,"feFuncG",Ut),Qt(this,Ct,Sn).call(this,dr,"feFuncB",qt)},pn=function(Ft){return mt(this,Ct,nn).style.color=Ft,gt(getComputedStyle(mt(this,Ct,nn)).getPropertyValue("color"))},i.DOMFilterFactory=d;class g extends s.BaseCanvasFactory{constructor({ownerDocument:Xt=globalThis.document}={}){super(),this._document=Xt}_createCanvas(Xt,Ft){const Ut=this._document.createElement("canvas");return Ut.width=Xt,Ut.height=Ft,Ut}}i.DOMCanvasFactory=g;async function _(Yt,Xt=!1){if(dt(Yt,document.baseURI)){const Ft=await fetch(Yt);if(!Ft.ok)throw new Error(Ft.statusText);return Xt?new Uint8Array(await Ft.arrayBuffer()):(0,o.stringToBytes)(await Ft.text())}return new Promise((Ft,Ut)=>{const qt=new XMLHttpRequest;qt.open("GET",Yt,!0),Xt&&(qt.responseType="arraybuffer"),qt.onreadystatechange=()=>{if(qt.readyState===XMLHttpRequest.DONE){if(qt.status===200||qt.status===0){let Jt;if(Xt&&qt.response?Jt=new Uint8Array(qt.response):!Xt&&qt.responseText&&(Jt=(0,o.stringToBytes)(qt.responseText)),Jt){Ft(Jt);return}}Ut(new Error(qt.statusText))}},qt.send(null)})}class b extends s.BaseCMapReaderFactory{_fetchData(Xt,Ft){return _(Xt,this.isCompressed).then(Ut=>({cMapData:Ut,compressionType:Ft}))}}i.DOMCMapReaderFactory=b;class j extends s.BaseStandardFontDataFactory{_fetchData(Xt){return _(Xt,!0)}}i.DOMStandardFontDataFactory=j;class _e extends s.BaseSVGFactory{_createSVG(Xt){return document.createElementNS(c,Xt)}}i.DOMSVGFactory=_e;class et{constructor({viewBox:Xt,scale:Ft,rotation:Ut,offsetX:qt=0,offsetY:Jt=0,dontFlip:dr=!1}){this.viewBox=Xt,this.scale=Ft,this.rotation=Ut,this.offsetX=qt,this.offsetY=Jt;const vr=(Xt[2]+Xt[0])/2,_r=(Xt[3]+Xt[1])/2;let Zt,Er,Sr,Vr;switch(Ut%=360,Ut<0&&(Ut+=360),Ut){case 180:Zt=-1,Er=0,Sr=0,Vr=1;break;case 90:Zt=0,Er=1,Sr=1,Vr=0;break;case 270:Zt=0,Er=-1,Sr=-1,Vr=0;break;case 0:Zt=1,Er=0,Sr=0,Vr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}dr&&(Sr=-Sr,Vr=-Vr);let Nr,Pr,kr,Dr;Zt===0?(Nr=Math.abs(_r-Xt[1])*Ft+qt,Pr=Math.abs(vr-Xt[0])*Ft+Jt,kr=(Xt[3]-Xt[1])*Ft,Dr=(Xt[2]-Xt[0])*Ft):(Nr=Math.abs(vr-Xt[0])*Ft+qt,Pr=Math.abs(_r-Xt[1])*Ft+Jt,kr=(Xt[2]-Xt[0])*Ft,Dr=(Xt[3]-Xt[1])*Ft),this.transform=[Zt*Ft,Er*Ft,Sr*Ft,Vr*Ft,Nr-Zt*Ft*vr-Sr*Ft*_r,Pr-Er*Ft*vr-Vr*Ft*_r],this.width=kr,this.height=Dr}get rawDims(){const{viewBox:Xt}=this;return(0,o.shadow)(this,"rawDims",{pageWidth:Xt[2]-Xt[0],pageHeight:Xt[3]-Xt[1],pageX:Xt[0],pageY:Xt[1]})}clone({scale:Xt=this.scale,rotation:Ft=this.rotation,offsetX:Ut=this.offsetX,offsetY:qt=this.offsetY,dontFlip:Jt=!1}={}){return new et({viewBox:this.viewBox.slice(),scale:Xt,rotation:Ft,offsetX:Ut,offsetY:qt,dontFlip:Jt})}convertToViewportPoint(Xt,Ft){return o.Util.applyTransform([Xt,Ft],this.transform)}convertToViewportRectangle(Xt){const Ft=o.Util.applyTransform([Xt[0],Xt[1]],this.transform),Ut=o.Util.applyTransform([Xt[2],Xt[3]],this.transform);return[Ft[0],Ft[1],Ut[0],Ut[1]]}convertToPdfPoint(Xt,Ft){return o.Util.applyInverseTransform([Xt,Ft],this.transform)}}i.PageViewport=et;class rt extends o.BaseException{constructor(Xt,Ft=0){super(Xt,"RenderingCancelledException"),this.extraDelay=Ft}}i.RenderingCancelledException=rt;function tt(Yt){const Xt=Yt.length;let Ft=0;for(;Ft<Xt&&Yt[Ft].trim()==="";)Ft++;return Yt.substring(Ft,Ft+5).toLowerCase()==="data:"}function it(Yt){return typeof Yt=="string"&&/\.pdf$/i.test(Yt)}function nt(Yt,Xt=!1){return Xt||([Yt]=Yt.split(/[#?]/,1)),Yt.substring(Yt.lastIndexOf("/")+1)}function at(Yt,Xt="document.pdf"){if(typeof Yt!="string")return Xt;if(tt(Yt))return(0,o.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Xt;const Ft=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Ut=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,qt=Ft.exec(Yt);let Jt=Ut.exec(qt[1])||Ut.exec(qt[2])||Ut.exec(qt[3]);if(Jt&&(Jt=Jt[0],Jt.includes("%")))try{Jt=Ut.exec(decodeURIComponent(Jt))[0]}catch{}return Jt||Xt}class st{constructor(){$r(this,"started",Object.create(null));$r(this,"times",[])}time(Xt){Xt in this.started&&(0,o.warn)(`Timer is already running for ${Xt}`),this.started[Xt]=Date.now()}timeEnd(Xt){Xt in this.started||(0,o.warn)(`Timer has not been started for ${Xt}`),this.times.push({name:Xt,start:this.started[Xt],end:Date.now()}),delete this.started[Xt]}toString(){const Xt=[];let Ft=0;for(const{name:Ut}of this.times)Ft=Math.max(Ut.length,Ft);for(const{name:Ut,start:qt,end:Jt}of this.times)Xt.push(`${Ut.padEnd(Ft)} ${Jt-qt}ms
`);return Xt.join("")}}i.StatTimer=st;function dt(Yt,Xt){try{const{protocol:Ft}=Xt?new URL(Yt,Xt):new URL(Yt);return Ft==="http:"||Ft==="https:"}catch{return!1}}function lt(Yt){Yt.preventDefault()}function ut(Yt,Xt=!1){return new Promise((Ft,Ut)=>{const qt=document.createElement("script");qt.src=Yt,qt.onload=function(Jt){Xt&&qt.remove(),Ft(Jt)},qt.onerror=function(){Ut(new Error(`Cannot load script at: ${qt.src}`))},(document.head||document.documentElement).append(qt)})}function ot(Yt){console.log("Deprecated API usage: "+Yt)}let ft;class pt{static toDateObject(Xt){if(!Xt||typeof Xt!="string")return null;ft||(ft=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Ft=ft.exec(Xt);if(!Ft)return null;const Ut=parseInt(Ft[1],10);let qt=parseInt(Ft[2],10);qt=qt>=1&&qt<=12?qt-1:0;let Jt=parseInt(Ft[3],10);Jt=Jt>=1&&Jt<=31?Jt:1;let dr=parseInt(Ft[4],10);dr=dr>=0&&dr<=23?dr:0;let vr=parseInt(Ft[5],10);vr=vr>=0&&vr<=59?vr:0;let _r=parseInt(Ft[6],10);_r=_r>=0&&_r<=59?_r:0;const Zt=Ft[7]||"Z";let Er=parseInt(Ft[8],10);Er=Er>=0&&Er<=23?Er:0;let Sr=parseInt(Ft[9],10)||0;return Sr=Sr>=0&&Sr<=59?Sr:0,Zt==="-"?(dr+=Er,vr+=Sr):Zt==="+"&&(dr-=Er,vr-=Sr),new Date(Date.UTC(Ut,qt,Jt,dr,vr,_r))}}i.PDFDateString=pt;function St(Yt,{scale:Xt=1,rotation:Ft=0}){const{width:Ut,height:qt}=Yt.attributes.style,Jt=[0,0,parseInt(Ut),parseInt(qt)];return new et({viewBox:Jt,scale:Xt,rotation:Ft})}function gt(Yt){if(Yt.startsWith("#")){const Xt=parseInt(Yt.slice(1),16);return[(Xt&16711680)>>16,(Xt&65280)>>8,Xt&255]}return Yt.startsWith("rgb(")?Yt.slice(4,-1).split(",").map(Xt=>parseInt(Xt)):Yt.startsWith("rgba(")?Yt.slice(5,-1).split(",").map(Xt=>parseInt(Xt)).slice(0,3):((0,o.warn)(`Not a valid color format: "${Yt}"`),[0,0,0])}function vt(Yt){const Xt=document.createElement("span");Xt.style.visibility="hidden",document.body.append(Xt);for(const Ft of Yt.keys()){Xt.style.color=Ft;const Ut=window.getComputedStyle(Xt).color;Yt.set(Ft,gt(Ut))}Xt.remove()}function At(Yt){const{a:Xt,b:Ft,c:Ut,d:qt,e:Jt,f:dr}=Yt.getTransform();return[Xt,Ft,Ut,qt,Jt,dr]}function Gt(Yt){const{a:Xt,b:Ft,c:Ut,d:qt,e:Jt,f:dr}=Yt.getTransform().invertSelf();return[Xt,Ft,Ut,qt,Jt,dr]}function Nt(Yt,Xt,Ft=!1,Ut=!0){if(Xt instanceof et){const{pageWidth:qt,pageHeight:Jt}=Xt.rawDims,{style:dr}=Yt,vr=o.FeatureTest.isCSSRoundSupported,_r=`var(--scale-factor) * ${qt}px`,Zt=`var(--scale-factor) * ${Jt}px`,Er=vr?`round(${_r}, 1px)`:`calc(${_r})`,Sr=vr?`round(${Zt}, 1px)`:`calc(${Zt})`;!Ft||Xt.rotation%180===0?(dr.width=Er,dr.height=Sr):(dr.width=Sr,dr.height=Er)}Ut&&Yt.setAttribute("data-main-rotation",Xt.rotation)}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var s=a(1);class o{constructor(){this.constructor===o&&(0,s.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(b){return"none"}addHCMFilter(b,j){return"none"}addHighlightHCMFilter(b,j,_e,et){return"none"}destroy(b=!1){}}i.BaseFilterFactory=o;class c{constructor(){this.constructor===c&&(0,s.unreachable)("Cannot initialize BaseCanvasFactory.")}create(b,j){if(b<=0||j<=0)throw new Error("Invalid canvas size");const _e=this._createCanvas(b,j);return{canvas:_e,context:_e.getContext("2d")}}reset(b,j,_e){if(!b.canvas)throw new Error("Canvas is not specified");if(j<=0||_e<=0)throw new Error("Invalid canvas size");b.canvas.width=j,b.canvas.height=_e}destroy(b){if(!b.canvas)throw new Error("Canvas is not specified");b.canvas.width=0,b.canvas.height=0,b.canvas=null,b.context=null}_createCanvas(b,j){(0,s.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=c;class h{constructor({baseUrl:b=null,isCompressed:j=!0}){this.constructor===h&&(0,s.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=b,this.isCompressed=j}async fetch({name:b}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!b)throw new Error("CMap name must be specified.");const j=this.baseUrl+b+(this.isCompressed?".bcmap":""),_e=this.isCompressed?s.CMapCompressionType.BINARY:s.CMapCompressionType.NONE;return this._fetchData(j,_e).catch(et=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(b,j){(0,s.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=h;class d{constructor({baseUrl:b=null}){this.constructor===d&&(0,s.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=b}async fetch({filename:b}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!b)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${b}`;return this._fetchData(j).catch(_e=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(b){(0,s.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=d;class g{constructor(){this.constructor===g&&(0,s.unreachable)("Cannot initialize BaseSVGFactory.")}create(b,j,_e=!1){if(b<=0||j<=0)throw new Error("Invalid SVG dimensions");const et=this._createSVG("svg:svg");return et.setAttribute("version","1.1"),_e||(et.setAttribute("width",`${b}px`),et.setAttribute("height",`${j}px`)),et.setAttribute("preserveAspectRatio","none"),et.setAttribute("viewBox",`0 0 ${b} ${j}`),et}createElement(b){if(typeof b!="string")throw new Error("Invalid SVG element type");return this._createSVG(b)}_createSVG(b){(0,s.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=g},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var s=a(1);const o=3285377520,c=4294901760,h=65535;class d{constructor(_){this.h1=_?_&4294967295:o,this.h2=_?_&4294967295:o}update(_){let b,j;if(typeof _=="string"){b=new Uint8Array(_.length*2),j=0;for(let ot=0,ft=_.length;ot<ft;ot++){const pt=_.charCodeAt(ot);pt<=255?b[j++]=pt:(b[j++]=pt>>>8,b[j++]=pt&255)}}else if((0,s.isArrayBuffer)(_))b=_.slice(),j=b.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const _e=j>>2,et=j-_e*4,rt=new Uint32Array(b.buffer,0,_e);let tt=0,it=0,nt=this.h1,at=this.h2;const st=3432918353,dt=461845907,lt=st&h,ut=dt&h;for(let ot=0;ot<_e;ot++)ot&1?(tt=rt[ot],tt=tt*st&c|tt*lt&h,tt=tt<<15|tt>>>17,tt=tt*dt&c|tt*ut&h,nt^=tt,nt=nt<<13|nt>>>19,nt=nt*5+3864292196):(it=rt[ot],it=it*st&c|it*lt&h,it=it<<15|it>>>17,it=it*dt&c|it*ut&h,at^=it,at=at<<13|at>>>19,at=at*5+3864292196);switch(tt=0,et){case 3:tt^=b[_e*4+2]<<16;case 2:tt^=b[_e*4+1]<<8;case 1:tt^=b[_e*4],tt=tt*st&c|tt*lt&h,tt=tt<<15|tt>>>17,tt=tt*dt&c|tt*ut&h,_e&1?nt^=tt:at^=tt}this.h1=nt,this.h2=at}hexdigest(){let _=this.h1,b=this.h2;return _^=b>>>1,_=_*3981806797&c|_*36045&h,b=b*4283543511&c|((b<<16|_>>>16)*2950163797&c)>>>16,_^=b>>>1,_=_*444984403&c|_*60499&h,b=b*3301882366&c|((b<<16|_>>>16)*3120437893&c)>>>16,_^=b>>>1,(_>>>0).toString(16).padStart(8,"0")+(b>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=d},(e,i,a)=>{var h;Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var s=a(1);class o{constructor({ownerDocument:g=globalThis.document,styleElement:_=null}){nr(this,h,new Set);this._document=g,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(g){this.nativeFontFaces.add(g),this._document.fonts.add(g)}removeNativeFontFace(g){this.nativeFontFaces.delete(g),this._document.fonts.delete(g)}insertRule(g){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const _=this.styleElement.sheet;_.insertRule(g,_.cssRules.length)}clear(){for(const g of this.nativeFontFaces)this._document.fonts.delete(g);this.nativeFontFaces.clear(),mt(this,h).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(g){if(!(!g||mt(this,h).has(g.loadedName))){if((0,s.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:_,src:b,style:j}=g,_e=new FontFace(_,b,j);this.addNativeFontFace(_e);try{await _e.load(),mt(this,h).add(_)}catch{(0,s.warn)(`Cannot load system font: ${g.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(_e)}return}(0,s.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(g){if(g.attached||g.missingFile&&!g.systemFontInfo)return;if(g.attached=!0,g.systemFontInfo){await this.loadSystemFont(g.systemFontInfo);return}if(this.isFontLoadingAPISupported){const b=g.createNativeFontFace();if(b){this.addNativeFontFace(b);try{await b.loaded}catch(j){throw(0,s.warn)(`Failed to load font '${b.family}': '${j}'.`),g.disableFontFace=!0,j}}return}const _=g.createFontFaceRule();if(_){if(this.insertRule(_),this.isSyncFontLoadingSupported)return;await new Promise(b=>{const j=this._queueLoadingCallback(b);this._prepareFontLoadEvent(g,j)})}}get isFontLoadingAPISupported(){var _;const g=!!((_=this._document)!=null&&_.fonts);return(0,s.shadow)(this,"isFontLoadingAPISupported",g)}get isSyncFontLoadingSupported(){let g=!1;return(s.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(g=!0),(0,s.shadow)(this,"isSyncFontLoadingSupported",g)}_queueLoadingCallback(g){function _(){for((0,s.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;b.length>0&&b[0].done;){const _e=b.shift();setTimeout(_e.callback,0)}}const{loadingRequests:b}=this,j={done:!1,complete:_,callback:g};return b.push(j),j}get _loadTestFont(){const g=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,s.shadow)(this,"_loadTestFont",g)}_prepareFontLoadEvent(g,_){function b(gt,vt){return gt.charCodeAt(vt)<<24|gt.charCodeAt(vt+1)<<16|gt.charCodeAt(vt+2)<<8|gt.charCodeAt(vt+3)&255}function j(gt,vt,At,Gt){const Nt=gt.substring(0,vt),Ht=gt.substring(vt+At);return Nt+Gt+Ht}let _e,et;const rt=this._document.createElement("canvas");rt.width=1,rt.height=1;const tt=rt.getContext("2d");let it=0;function nt(gt,vt){if(++it>30){(0,s.warn)("Load test font never loaded."),vt();return}if(tt.font="30px "+gt,tt.fillText(".",0,20),tt.getImageData(0,0,1,1).data[3]>0){vt();return}setTimeout(nt.bind(null,gt,vt))}const at=`lt${Date.now()}${this.loadTestFontId++}`;let st=this._loadTestFont;st=j(st,976,at.length,at);const lt=16,ut=1482184792;let ot=b(st,lt);for(_e=0,et=at.length-3;_e<et;_e+=4)ot=ot-ut+b(at,_e)|0;_e<at.length&&(ot=ot-ut+b(at+"XXX",_e)|0),st=j(st,lt,4,(0,s.string32)(ot));const ft=`url(data:font/opentype;base64,${btoa(st)});`,pt=`@font-face {font-family:"${at}";src:${ft}}`;this.insertRule(pt);const St=this._document.createElement("div");St.style.visibility="hidden",St.style.width=St.style.height="10px",St.style.position="absolute",St.style.top=St.style.left="0px";for(const gt of[g.loadedName,at]){const vt=this._document.createElement("span");vt.textContent="Hi",vt.style.fontFamily=gt,St.append(vt)}this._document.body.append(St),nt(at,()=>{St.remove(),_.complete()})}}h=new WeakMap,i.FontLoader=o;class c{constructor(g,{isEvalSupported:_=!0,disableFontFace:b=!1,ignoreErrors:j=!1,inspectFont:_e=null}){this.compiledGlyphs=Object.create(null);for(const et in g)this[et]=g[et];this.isEvalSupported=_!==!1,this.disableFontFace=b===!0,this.ignoreErrors=j===!0,this._inspectFont=_e}createNativeFontFace(){var _;if(!this.data||this.disableFontFace)return null;let g;if(!this.cssFontInfo)g=new FontFace(this.loadedName,this.data,{});else{const b={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(b.style=`oblique ${this.cssFontInfo.italicAngle}deg`),g=new FontFace(this.cssFontInfo.fontFamily,this.data,b)}return(_=this._inspectFont)==null||_.call(this,this),g}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const g=(0,s.bytesToString)(this.data),_=`url(data:${this.mimetype};base64,${btoa(g)});`;let b;if(!this.cssFontInfo)b=`@font-face {font-family:"${this.loadedName}";src:${_}}`;else{let _e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),b=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_e}src:${_}}`}return(j=this._inspectFont)==null||j.call(this,this,_),b}getPathGenerator(g,_){if(this.compiledGlyphs[_]!==void 0)return this.compiledGlyphs[_];let b;try{b=g.get(this.loadedName+"_path_"+_)}catch(j){if(!this.ignoreErrors)throw j;return(0,s.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[_]=function(_e,et){}}if(this.isEvalSupported&&s.FeatureTest.isEvalSupported){const j=[];for(const _e of b){const et=_e.args!==void 0?_e.args.join(","):"";j.push("c.",_e.cmd,"(",et,`);
`)}return this.compiledGlyphs[_]=new Function("c","size",j.join(""))}return this.compiledGlyphs[_]=function(j,_e){for(const et of b)et.cmd==="scale"&&(et.args=[_e,-_e]),j[et.cmd].apply(j,et.args)}}}i.FontFaceObject=c},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var s=a(7);a(1);const o=function(_){return new Promise((b,j)=>{require$$5.readFile(_,(et,rt)=>{if(et||!rt){j(new Error(et));return}b(new Uint8Array(rt))})})};class c extends s.BaseFilterFactory{}i.NodeFilterFactory=c;class h extends s.BaseCanvasFactory{_createCanvas(b,j){return require$$5.createCanvas(b,j)}}i.NodeCanvasFactory=h;class d extends s.BaseCMapReaderFactory{_fetchData(b,j){return o(b).then(_e=>({cMapData:_e,compressionType:j}))}}i.NodeCMapReaderFactory=d;class g extends s.BaseStandardFontDataFactory{_fetchData(b){return o(b)}}i.NodeStandardFontDataFactory=g},(e,i,a)=>{var Wt,Kn,Yn;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var s=a(1),o=a(6),c=a(12),h=a(13);const d=16,g=100,_=4096,b=15,j=10,_e=1e3,et=16;function rt(_t,ht){if(_t._removeMirroring)throw new Error("Context is already forwarding operations.");_t.__originalSave=_t.save,_t.__originalRestore=_t.restore,_t.__originalRotate=_t.rotate,_t.__originalScale=_t.scale,_t.__originalTranslate=_t.translate,_t.__originalTransform=_t.transform,_t.__originalSetTransform=_t.setTransform,_t.__originalResetTransform=_t.resetTransform,_t.__originalClip=_t.clip,_t.__originalMoveTo=_t.moveTo,_t.__originalLineTo=_t.lineTo,_t.__originalBezierCurveTo=_t.bezierCurveTo,_t.__originalRect=_t.rect,_t.__originalClosePath=_t.closePath,_t.__originalBeginPath=_t.beginPath,_t._removeMirroring=()=>{_t.save=_t.__originalSave,_t.restore=_t.__originalRestore,_t.rotate=_t.__originalRotate,_t.scale=_t.__originalScale,_t.translate=_t.__originalTranslate,_t.transform=_t.__originalTransform,_t.setTransform=_t.__originalSetTransform,_t.resetTransform=_t.__originalResetTransform,_t.clip=_t.__originalClip,_t.moveTo=_t.__originalMoveTo,_t.lineTo=_t.__originalLineTo,_t.bezierCurveTo=_t.__originalBezierCurveTo,_t.rect=_t.__originalRect,_t.closePath=_t.__originalClosePath,_t.beginPath=_t.__originalBeginPath,delete _t._removeMirroring},_t.save=function(){ht.save(),this.__originalSave()},_t.restore=function(){ht.restore(),this.__originalRestore()},_t.translate=function(xt,Et){ht.translate(xt,Et),this.__originalTranslate(xt,Et)},_t.scale=function(xt,Et){ht.scale(xt,Et),this.__originalScale(xt,Et)},_t.transform=function(xt,Et,bt,Ct,Ot,jt){ht.transform(xt,Et,bt,Ct,Ot,jt),this.__originalTransform(xt,Et,bt,Ct,Ot,jt)},_t.setTransform=function(xt,Et,bt,Ct,Ot,jt){ht.setTransform(xt,Et,bt,Ct,Ot,jt),this.__originalSetTransform(xt,Et,bt,Ct,Ot,jt)},_t.resetTransform=function(){ht.resetTransform(),this.__originalResetTransform()},_t.rotate=function(xt){ht.rotate(xt),this.__originalRotate(xt)},_t.clip=function(xt){ht.clip(xt),this.__originalClip(xt)},_t.moveTo=function(ct,xt){ht.moveTo(ct,xt),this.__originalMoveTo(ct,xt)},_t.lineTo=function(ct,xt){ht.lineTo(ct,xt),this.__originalLineTo(ct,xt)},_t.bezierCurveTo=function(ct,xt,Et,bt,Ct,Ot){ht.bezierCurveTo(ct,xt,Et,bt,Ct,Ot),this.__originalBezierCurveTo(ct,xt,Et,bt,Ct,Ot)},_t.rect=function(ct,xt,Et,bt){ht.rect(ct,xt,Et,bt),this.__originalRect(ct,xt,Et,bt)},_t.closePath=function(){ht.closePath(),this.__originalClosePath()},_t.beginPath=function(){ht.beginPath(),this.__originalBeginPath()}}class tt{constructor(ht){this.canvasFactory=ht,this.cache=Object.create(null)}getCanvas(ht,ct,xt){let Et;return this.cache[ht]!==void 0?(Et=this.cache[ht],this.canvasFactory.reset(Et,ct,xt)):(Et=this.canvasFactory.create(ct,xt),this.cache[ht]=Et),Et}delete(ht){delete this.cache[ht]}clear(){for(const ht in this.cache){const ct=this.cache[ht];this.canvasFactory.destroy(ct),delete this.cache[ht]}}}function it(_t,ht,ct,xt,Et,bt,Ct,Ot,jt,er){const[Tt,ur,cr,hr,Yt,Xt]=(0,o.getCurrentTransform)(_t);if(ur===0&&cr===0){const qt=Ct*Tt+Yt,Jt=Math.round(qt),dr=Ot*hr+Xt,vr=Math.round(dr),_r=(Ct+jt)*Tt+Yt,Zt=Math.abs(Math.round(_r)-Jt)||1,Er=(Ot+er)*hr+Xt,Sr=Math.abs(Math.round(Er)-vr)||1;return _t.setTransform(Math.sign(Tt),0,0,Math.sign(hr),Jt,vr),_t.drawImage(ht,ct,xt,Et,bt,0,0,Zt,Sr),_t.setTransform(Tt,ur,cr,hr,Yt,Xt),[Zt,Sr]}if(Tt===0&&hr===0){const qt=Ot*cr+Yt,Jt=Math.round(qt),dr=Ct*ur+Xt,vr=Math.round(dr),_r=(Ot+er)*cr+Yt,Zt=Math.abs(Math.round(_r)-Jt)||1,Er=(Ct+jt)*ur+Xt,Sr=Math.abs(Math.round(Er)-vr)||1;return _t.setTransform(0,Math.sign(ur),Math.sign(cr),0,Jt,vr),_t.drawImage(ht,ct,xt,Et,bt,0,0,Sr,Zt),_t.setTransform(Tt,ur,cr,hr,Yt,Xt),[Sr,Zt]}_t.drawImage(ht,ct,xt,Et,bt,Ct,Ot,jt,er);const Ft=Math.hypot(Tt,ur),Ut=Math.hypot(cr,hr);return[Ft*jt,Ut*er]}function nt(_t){const{width:ht,height:ct}=_t;if(ht>_e||ct>_e)return null;const xt=1e3,Et=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),bt=ht+1;let Ct=new Uint8Array(bt*(ct+1)),Ot,jt,er;const Tt=ht+7&-8;let ur=new Uint8Array(Tt*ct),cr=0;for(const Ut of _t.data){let qt=128;for(;qt>0;)ur[cr++]=Ut&qt?0:255,qt>>=1}let hr=0;for(cr=0,ur[cr]!==0&&(Ct[0]=1,++hr),jt=1;jt<ht;jt++)ur[cr]!==ur[cr+1]&&(Ct[jt]=ur[cr]?2:1,++hr),cr++;for(ur[cr]!==0&&(Ct[jt]=2,++hr),Ot=1;Ot<ct;Ot++){cr=Ot*Tt,er=Ot*bt,ur[cr-Tt]!==ur[cr]&&(Ct[er]=ur[cr]?1:8,++hr);let Ut=(ur[cr]?4:0)+(ur[cr-Tt]?8:0);for(jt=1;jt<ht;jt++)Ut=(Ut>>2)+(ur[cr+1]?4:0)+(ur[cr-Tt+1]?8:0),Et[Ut]&&(Ct[er+jt]=Et[Ut],++hr),cr++;if(ur[cr-Tt]!==ur[cr]&&(Ct[er+jt]=ur[cr]?2:4,++hr),hr>xt)return null}for(cr=Tt*(ct-1),er=Ot*bt,ur[cr]!==0&&(Ct[er]=8,++hr),jt=1;jt<ht;jt++)ur[cr]!==ur[cr+1]&&(Ct[er+jt]=ur[cr]?4:8,++hr),cr++;if(ur[cr]!==0&&(Ct[er+jt]=4,++hr),hr>xt)return null;const Yt=new Int32Array([0,bt,-1,0,-bt,0,0,0,1]),Xt=new Path2D;for(Ot=0;hr&&Ot<=ct;Ot++){let Ut=Ot*bt;const qt=Ut+ht;for(;Ut<qt&&!Ct[Ut];)Ut++;if(Ut===qt)continue;Xt.moveTo(Ut%bt,Ot);const Jt=Ut;let dr=Ct[Ut];do{const vr=Yt[dr];do Ut+=vr;while(!Ct[Ut]);const _r=Ct[Ut];_r!==5&&_r!==10?(dr=_r,Ct[Ut]=0):(dr=_r&51*dr>>4,Ct[Ut]&=dr>>2|dr<<2),Xt.lineTo(Ut%bt,Ut/bt|0),Ct[Ut]||--hr}while(Jt!==Ut);--Ot}return ur=null,Ct=null,function(Ut){Ut.save(),Ut.scale(1/ht,-1/ct),Ut.translate(0,-ct),Ut.fill(Xt),Ut.beginPath(),Ut.restore()}}class at{constructor(ht,ct){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=s.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=s.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ht,ct])}clone(){const ht=Object.create(this);return ht.clipBox=this.clipBox.slice(),ht}setCurrentPoint(ht,ct){this.x=ht,this.y=ct}updatePathMinMax(ht,ct,xt){[ct,xt]=s.Util.applyTransform([ct,xt],ht),this.minX=Math.min(this.minX,ct),this.minY=Math.min(this.minY,xt),this.maxX=Math.max(this.maxX,ct),this.maxY=Math.max(this.maxY,xt)}updateRectMinMax(ht,ct){const xt=s.Util.applyTransform(ct,ht),Et=s.Util.applyTransform(ct.slice(2),ht);this.minX=Math.min(this.minX,xt[0],Et[0]),this.minY=Math.min(this.minY,xt[1],Et[1]),this.maxX=Math.max(this.maxX,xt[0],Et[0]),this.maxY=Math.max(this.maxY,xt[1],Et[1])}updateScalingPathMinMax(ht,ct){s.Util.scaleMinMax(ht,ct),this.minX=Math.min(this.minX,ct[0]),this.maxX=Math.max(this.maxX,ct[1]),this.minY=Math.min(this.minY,ct[2]),this.maxY=Math.max(this.maxY,ct[3])}updateCurvePathMinMax(ht,ct,xt,Et,bt,Ct,Ot,jt,er,Tt){const ur=s.Util.bezierBoundingBox(ct,xt,Et,bt,Ct,Ot,jt,er);if(Tt){Tt[0]=Math.min(Tt[0],ur[0],ur[2]),Tt[1]=Math.max(Tt[1],ur[0],ur[2]),Tt[2]=Math.min(Tt[2],ur[1],ur[3]),Tt[3]=Math.max(Tt[3],ur[1],ur[3]);return}this.updateRectMinMax(ht,ur)}getPathBoundingBox(ht=c.PathType.FILL,ct=null){const xt=[this.minX,this.minY,this.maxX,this.maxY];if(ht===c.PathType.STROKE){ct||(0,s.unreachable)("Stroke bounding box must include transform.");const Et=s.Util.singularValueDecompose2dScale(ct),bt=Et[0]*this.lineWidth/2,Ct=Et[1]*this.lineWidth/2;xt[0]-=bt,xt[1]-=Ct,xt[2]+=bt,xt[3]+=Ct}return xt}updateClipFromPath(){const ht=s.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ht||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ht){this.clipBox=ht,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ht=c.PathType.FILL,ct=null){return s.Util.intersect(this.clipBox,this.getPathBoundingBox(ht,ct))}}function st(_t,ht){if(typeof ImageData<"u"&&ht instanceof ImageData){_t.putImageData(ht,0,0);return}const ct=ht.height,xt=ht.width,Et=ct%et,bt=(ct-Et)/et,Ct=Et===0?bt:bt+1,Ot=_t.createImageData(xt,et);let jt=0,er;const Tt=ht.data,ur=Ot.data;let cr,hr,Yt,Xt;if(ht.kind===s.ImageKind.GRAYSCALE_1BPP){const Ft=Tt.byteLength,Ut=new Uint32Array(ur.buffer,0,ur.byteLength>>2),qt=Ut.length,Jt=xt+7>>3,dr=4294967295,vr=s.FeatureTest.isLittleEndian?4278190080:255;for(cr=0;cr<Ct;cr++){for(Yt=cr<bt?et:Et,er=0,hr=0;hr<Yt;hr++){const _r=Ft-jt;let Zt=0;const Er=_r>Jt?xt:_r*8-7,Sr=Er&-8;let Vr=0,Nr=0;for(;Zt<Sr;Zt+=8)Nr=Tt[jt++],Ut[er++]=Nr&128?dr:vr,Ut[er++]=Nr&64?dr:vr,Ut[er++]=Nr&32?dr:vr,Ut[er++]=Nr&16?dr:vr,Ut[er++]=Nr&8?dr:vr,Ut[er++]=Nr&4?dr:vr,Ut[er++]=Nr&2?dr:vr,Ut[er++]=Nr&1?dr:vr;for(;Zt<Er;Zt++)Vr===0&&(Nr=Tt[jt++],Vr=128),Ut[er++]=Nr&Vr?dr:vr,Vr>>=1}for(;er<qt;)Ut[er++]=0;_t.putImageData(Ot,0,cr*et)}}else if(ht.kind===s.ImageKind.RGBA_32BPP){for(hr=0,Xt=xt*et*4,cr=0;cr<bt;cr++)ur.set(Tt.subarray(jt,jt+Xt)),jt+=Xt,_t.putImageData(Ot,0,hr),hr+=et;cr<Ct&&(Xt=xt*Et*4,ur.set(Tt.subarray(jt,jt+Xt)),_t.putImageData(Ot,0,hr))}else if(ht.kind===s.ImageKind.RGB_24BPP)for(Yt=et,Xt=xt*Yt,cr=0;cr<Ct;cr++){for(cr>=bt&&(Yt=Et,Xt=xt*Yt),er=0,hr=Xt;hr--;)ur[er++]=Tt[jt++],ur[er++]=Tt[jt++],ur[er++]=Tt[jt++],ur[er++]=255;_t.putImageData(Ot,0,cr*et)}else throw new Error(`bad image kind: ${ht.kind}`)}function dt(_t,ht){if(ht.bitmap){_t.drawImage(ht.bitmap,0,0);return}const ct=ht.height,xt=ht.width,Et=ct%et,bt=(ct-Et)/et,Ct=Et===0?bt:bt+1,Ot=_t.createImageData(xt,et);let jt=0;const er=ht.data,Tt=Ot.data;for(let ur=0;ur<Ct;ur++){const cr=ur<bt?et:Et;({srcPos:jt}=(0,h.convertBlackAndWhiteToRGBA)({src:er,srcPos:jt,dest:Tt,width:xt,height:cr,nonBlackColor:0})),_t.putImageData(Ot,0,ur*et)}}function lt(_t,ht){const ct=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const xt of ct)_t[xt]!==void 0&&(ht[xt]=_t[xt]);_t.setLineDash!==void 0&&(ht.setLineDash(_t.getLineDash()),ht.lineDashOffset=_t.lineDashOffset)}function ut(_t){if(_t.strokeStyle=_t.fillStyle="#000000",_t.fillRule="nonzero",_t.globalAlpha=1,_t.lineWidth=1,_t.lineCap="butt",_t.lineJoin="miter",_t.miterLimit=10,_t.globalCompositeOperation="source-over",_t.font="10px sans-serif",_t.setLineDash!==void 0&&(_t.setLineDash([]),_t.lineDashOffset=0),!s.isNodeJS){const{filter:ht}=_t;ht!=="none"&&ht!==""&&(_t.filter="none")}}function ot(_t,ht,ct,xt){const Et=_t.length;for(let bt=3;bt<Et;bt+=4){const Ct=_t[bt];if(Ct===0)_t[bt-3]=ht,_t[bt-2]=ct,_t[bt-1]=xt;else if(Ct<255){const Ot=255-Ct;_t[bt-3]=_t[bt-3]*Ct+ht*Ot>>8,_t[bt-2]=_t[bt-2]*Ct+ct*Ot>>8,_t[bt-1]=_t[bt-1]*Ct+xt*Ot>>8}}}function ft(_t,ht,ct){const xt=_t.length,Et=1/255;for(let bt=3;bt<xt;bt+=4){const Ct=ct?ct[_t[bt]]:_t[bt];ht[bt]=ht[bt]*Ct*Et|0}}function pt(_t,ht,ct){const xt=_t.length;for(let Et=3;Et<xt;Et+=4){const bt=_t[Et-3]*77+_t[Et-2]*152+_t[Et-1]*28;ht[Et]=ct?ht[Et]*ct[bt>>8]>>8:ht[Et]*bt>>16}}function St(_t,ht,ct,xt,Et,bt,Ct,Ot,jt,er,Tt){const ur=!!bt,cr=ur?bt[0]:0,hr=ur?bt[1]:0,Yt=ur?bt[2]:0,Xt=Et==="Luminosity"?pt:ft,Ut=Math.min(xt,Math.ceil(1048576/ct));for(let qt=0;qt<xt;qt+=Ut){const Jt=Math.min(Ut,xt-qt),dr=_t.getImageData(Ot-er,qt+(jt-Tt),ct,Jt),vr=ht.getImageData(Ot,qt+jt,ct,Jt);ur&&ot(dr.data,cr,hr,Yt),Xt(dr.data,vr.data,Ct),ht.putImageData(vr,Ot,qt+jt)}}function gt(_t,ht,ct,xt){const Et=xt[0],bt=xt[1],Ct=xt[2]-Et,Ot=xt[3]-bt;Ct===0||Ot===0||(St(ht.context,ct,Ct,Ot,ht.subtype,ht.backdrop,ht.transferMap,Et,bt,ht.offsetX,ht.offsetY),_t.save(),_t.globalAlpha=1,_t.globalCompositeOperation="source-over",_t.setTransform(1,0,0,1,0,0),_t.drawImage(ct.canvas,0,0),_t.restore())}function vt(_t,ht){const ct=s.Util.singularValueDecompose2dScale(_t);ct[0]=Math.fround(ct[0]),ct[1]=Math.fround(ct[1]);const xt=Math.fround((globalThis.devicePixelRatio||1)*o.PixelsPerInch.PDF_TO_CSS_UNITS);return ht!==void 0?ht:ct[0]<=xt||ct[1]<=xt}const At=["butt","round","square"],Gt=["miter","round","bevel"],Nt={},Ht={},$t=class $t{constructor(ht,ct,xt,Et,bt,{optionalContentConfig:Ct,markedContentStack:Ot=null},jt,er){nr(this,Wt);this.ctx=ht,this.current=new at(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=ct,this.objs=xt,this.canvasFactory=Et,this.filterFactory=bt,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Ot||[],this.optionalContentConfig=Ct,this.cachedCanvases=new tt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=jt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=er,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ht,ct=null){return typeof ht=="string"?ht.startsWith("g_")?this.commonObjs.get(ht):this.objs.get(ht):ct}beginDrawing({transform:ht,viewport:ct,transparency:xt=!1,background:Et=null}){const bt=this.ctx.canvas.width,Ct=this.ctx.canvas.height,Ot=this.ctx.fillStyle;if(this.ctx.fillStyle=Et||"#ffffff",this.ctx.fillRect(0,0,bt,Ct),this.ctx.fillStyle=Ot,xt){const jt=this.cachedCanvases.getCanvas("transparent",bt,Ct);this.compositeCtx=this.ctx,this.transparentCanvas=jt.canvas,this.ctx=jt.context,this.ctx.save(),this.ctx.transform(...(0,o.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),ut(this.ctx),ht&&(this.ctx.transform(...ht),this.outputScaleX=ht[0],this.outputScaleY=ht[0]),this.ctx.transform(...ct.transform),this.viewportScale=ct.scale,this.baseTransform=(0,o.getCurrentTransform)(this.ctx)}executeOperatorList(ht,ct,xt,Et){const bt=ht.argsArray,Ct=ht.fnArray;let Ot=ct||0;const jt=bt.length;if(jt===Ot)return Ot;const er=jt-Ot>j&&typeof xt=="function",Tt=er?Date.now()+b:0;let ur=0;const cr=this.commonObjs,hr=this.objs;let Yt;for(;;){if(Et!==void 0&&Ot===Et.nextBreakPoint)return Et.breakIt(Ot,xt),Ot;if(Yt=Ct[Ot],Yt!==s.OPS.dependency)this[Yt].apply(this,bt[Ot]);else for(const Xt of bt[Ot]){const Ft=Xt.startsWith("g_")?cr:hr;if(!Ft.has(Xt))return Ft.get(Xt,xt),Ot}if(Ot++,Ot===jt)return Ot;if(er&&++ur>j){if(Date.now()>Tt)return xt(),Ot;ur=0}}}endDrawing(){Qt(this,Wt,Kn).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ht of this._cachedBitmapsMap.values()){for(const ct of ht.values())typeof HTMLCanvasElement<"u"&&ct instanceof HTMLCanvasElement&&(ct.width=ct.height=0);ht.clear()}this._cachedBitmapsMap.clear(),Qt(this,Wt,Yn).call(this)}_scaleImage(ht,ct){const xt=ht.width,Et=ht.height;let bt=Math.max(Math.hypot(ct[0],ct[1]),1),Ct=Math.max(Math.hypot(ct[2],ct[3]),1),Ot=xt,jt=Et,er="prescale1",Tt,ur;for(;bt>2&&Ot>1||Ct>2&&jt>1;){let cr=Ot,hr=jt;bt>2&&Ot>1&&(cr=Ot>=16384?Math.floor(Ot/2)-1||1:Math.ceil(Ot/2),bt/=Ot/cr),Ct>2&&jt>1&&(hr=jt>=16384?Math.floor(jt/2)-1||1:Math.ceil(jt)/2,Ct/=jt/hr),Tt=this.cachedCanvases.getCanvas(er,cr,hr),ur=Tt.context,ur.clearRect(0,0,cr,hr),ur.drawImage(ht,0,0,Ot,jt,0,0,cr,hr),ht=Tt.canvas,Ot=cr,jt=hr,er=er==="prescale1"?"prescale2":"prescale1"}return{img:ht,paintWidth:Ot,paintHeight:jt}}_createMaskCanvas(ht){const ct=this.ctx,{width:xt,height:Et}=ht,bt=this.current.fillColor,Ct=this.current.patternFill,Ot=(0,o.getCurrentTransform)(ct);let jt,er,Tt,ur;if((ht.bitmap||ht.data)&&ht.count>1){const Zt=ht.bitmap||ht.data.buffer;er=JSON.stringify(Ct?Ot:[Ot.slice(0,4),bt]),jt=this._cachedBitmapsMap.get(Zt),jt||(jt=new Map,this._cachedBitmapsMap.set(Zt,jt));const Er=jt.get(er);if(Er&&!Ct){const Sr=Math.round(Math.min(Ot[0],Ot[2])+Ot[4]),Vr=Math.round(Math.min(Ot[1],Ot[3])+Ot[5]);return{canvas:Er,offsetX:Sr,offsetY:Vr}}Tt=Er}Tt||(ur=this.cachedCanvases.getCanvas("maskCanvas",xt,Et),dt(ur.context,ht));let cr=s.Util.transform(Ot,[1/xt,0,0,-1/Et,0,0]);cr=s.Util.transform(cr,[1,0,0,1,0,-Et]);const hr=s.Util.applyTransform([0,0],cr),Yt=s.Util.applyTransform([xt,Et],cr),Xt=s.Util.normalizeRect([hr[0],hr[1],Yt[0],Yt[1]]),Ft=Math.round(Xt[2]-Xt[0])||1,Ut=Math.round(Xt[3]-Xt[1])||1,qt=this.cachedCanvases.getCanvas("fillCanvas",Ft,Ut),Jt=qt.context,dr=Math.min(hr[0],Yt[0]),vr=Math.min(hr[1],Yt[1]);Jt.translate(-dr,-vr),Jt.transform(...cr),Tt||(Tt=this._scaleImage(ur.canvas,(0,o.getCurrentTransformInverse)(Jt)),Tt=Tt.img,jt&&Ct&&jt.set(er,Tt)),Jt.imageSmoothingEnabled=vt((0,o.getCurrentTransform)(Jt),ht.interpolate),it(Jt,Tt,0,0,Tt.width,Tt.height,0,0,xt,Et),Jt.globalCompositeOperation="source-in";const _r=s.Util.transform((0,o.getCurrentTransformInverse)(Jt),[1,0,0,1,-dr,-vr]);return Jt.fillStyle=Ct?bt.getPattern(ct,this,_r,c.PathType.FILL):bt,Jt.fillRect(0,0,xt,Et),jt&&!Ct&&(this.cachedCanvases.delete("fillCanvas"),jt.set(er,qt.canvas)),{canvas:qt.canvas,offsetX:Math.round(dr),offsetY:Math.round(vr)}}setLineWidth(ht){ht!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ht,this.ctx.lineWidth=ht}setLineCap(ht){this.ctx.lineCap=At[ht]}setLineJoin(ht){this.ctx.lineJoin=Gt[ht]}setMiterLimit(ht){this.ctx.miterLimit=ht}setDash(ht,ct){const xt=this.ctx;xt.setLineDash!==void 0&&(xt.setLineDash(ht),xt.lineDashOffset=ct)}setRenderingIntent(ht){}setFlatness(ht){}setGState(ht){for(const[ct,xt]of ht)switch(ct){case"LW":this.setLineWidth(xt);break;case"LC":this.setLineCap(xt);break;case"LJ":this.setLineJoin(xt);break;case"ML":this.setMiterLimit(xt);break;case"D":this.setDash(xt[0],xt[1]);break;case"RI":this.setRenderingIntent(xt);break;case"FL":this.setFlatness(xt);break;case"Font":this.setFont(xt[0],xt[1]);break;case"CA":this.current.strokeAlpha=xt;break;case"ca":this.current.fillAlpha=xt,this.ctx.globalAlpha=xt;break;case"BM":this.ctx.globalCompositeOperation=xt;break;case"SMask":this.current.activeSMask=xt?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(xt);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ht=this.inSMaskMode;this.current.activeSMask&&!ht?this.beginSMaskMode():!this.current.activeSMask&&ht&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ht=this.ctx.canvas.width,ct=this.ctx.canvas.height,xt="smaskGroupAt"+this.groupLevel,Et=this.cachedCanvases.getCanvas(xt,ht,ct);this.suspendedCtx=this.ctx,this.ctx=Et.context;const bt=this.ctx;bt.setTransform(...(0,o.getCurrentTransform)(this.suspendedCtx)),lt(this.suspendedCtx,bt),rt(bt,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),lt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ht){if(!this.current.activeSMask)return;ht?(ht[0]=Math.floor(ht[0]),ht[1]=Math.floor(ht[1]),ht[2]=Math.ceil(ht[2]),ht[3]=Math.ceil(ht[3])):ht=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const ct=this.current.activeSMask,xt=this.suspendedCtx;gt(xt,ct,this.ctx,ht),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(lt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ht=this.current;this.stateStack.push(ht),this.current=ht.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),lt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ht,ct,xt,Et,bt,Ct){this.ctx.transform(ht,ct,xt,Et,bt,Ct),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ht,ct,xt){const Et=this.ctx,bt=this.current;let Ct=bt.x,Ot=bt.y,jt,er;const Tt=(0,o.getCurrentTransform)(Et),ur=Tt[0]===0&&Tt[3]===0||Tt[1]===0&&Tt[2]===0,cr=ur?xt.slice(0):null;for(let hr=0,Yt=0,Xt=ht.length;hr<Xt;hr++)switch(ht[hr]|0){case s.OPS.rectangle:Ct=ct[Yt++],Ot=ct[Yt++];const Ft=ct[Yt++],Ut=ct[Yt++],qt=Ct+Ft,Jt=Ot+Ut;Et.moveTo(Ct,Ot),Ft===0||Ut===0?Et.lineTo(qt,Jt):(Et.lineTo(qt,Ot),Et.lineTo(qt,Jt),Et.lineTo(Ct,Jt)),ur||bt.updateRectMinMax(Tt,[Ct,Ot,qt,Jt]),Et.closePath();break;case s.OPS.moveTo:Ct=ct[Yt++],Ot=ct[Yt++],Et.moveTo(Ct,Ot),ur||bt.updatePathMinMax(Tt,Ct,Ot);break;case s.OPS.lineTo:Ct=ct[Yt++],Ot=ct[Yt++],Et.lineTo(Ct,Ot),ur||bt.updatePathMinMax(Tt,Ct,Ot);break;case s.OPS.curveTo:jt=Ct,er=Ot,Ct=ct[Yt+4],Ot=ct[Yt+5],Et.bezierCurveTo(ct[Yt],ct[Yt+1],ct[Yt+2],ct[Yt+3],Ct,Ot),bt.updateCurvePathMinMax(Tt,jt,er,ct[Yt],ct[Yt+1],ct[Yt+2],ct[Yt+3],Ct,Ot,cr),Yt+=6;break;case s.OPS.curveTo2:jt=Ct,er=Ot,Et.bezierCurveTo(Ct,Ot,ct[Yt],ct[Yt+1],ct[Yt+2],ct[Yt+3]),bt.updateCurvePathMinMax(Tt,jt,er,Ct,Ot,ct[Yt],ct[Yt+1],ct[Yt+2],ct[Yt+3],cr),Ct=ct[Yt+2],Ot=ct[Yt+3],Yt+=4;break;case s.OPS.curveTo3:jt=Ct,er=Ot,Ct=ct[Yt+2],Ot=ct[Yt+3],Et.bezierCurveTo(ct[Yt],ct[Yt+1],Ct,Ot,Ct,Ot),bt.updateCurvePathMinMax(Tt,jt,er,ct[Yt],ct[Yt+1],Ct,Ot,Ct,Ot,cr),Yt+=4;break;case s.OPS.closePath:Et.closePath();break}ur&&bt.updateScalingPathMinMax(Tt,cr),bt.setCurrentPoint(Ct,Ot)}closePath(){this.ctx.closePath()}stroke(ht=!0){const ct=this.ctx,xt=this.current.strokeColor;ct.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof xt=="object"&&(xt!=null&&xt.getPattern)?(ct.save(),ct.strokeStyle=xt.getPattern(ct,this,(0,o.getCurrentTransformInverse)(ct),c.PathType.STROKE),this.rescaleAndStroke(!1),ct.restore()):this.rescaleAndStroke(!0)),ht&&this.consumePath(this.current.getClippedPathBoundingBox()),ct.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ht=!0){const ct=this.ctx,xt=this.current.fillColor,Et=this.current.patternFill;let bt=!1;Et&&(ct.save(),ct.fillStyle=xt.getPattern(ct,this,(0,o.getCurrentTransformInverse)(ct),c.PathType.FILL),bt=!0);const Ct=this.current.getClippedPathBoundingBox();this.contentVisible&&Ct!==null&&(this.pendingEOFill?(ct.fill("evenodd"),this.pendingEOFill=!1):ct.fill()),bt&&ct.restore(),ht&&this.consumePath(Ct)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Nt}eoClip(){this.pendingClip=Ht}beginText(){this.current.textMatrix=s.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ht=this.pendingTextPaths,ct=this.ctx;if(ht===void 0){ct.beginPath();return}ct.save(),ct.beginPath();for(const xt of ht)ct.setTransform(...xt.transform),ct.translate(xt.x,xt.y),xt.addToPath(ct,xt.fontSize);ct.restore(),ct.clip(),ct.beginPath(),delete this.pendingTextPaths}setCharSpacing(ht){this.current.charSpacing=ht}setWordSpacing(ht){this.current.wordSpacing=ht}setHScale(ht){this.current.textHScale=ht/100}setLeading(ht){this.current.leading=-ht}setFont(ht,ct){var Tt;const xt=this.commonObjs.get(ht),Et=this.current;if(!xt)throw new Error(`Can't find font for ${ht}`);if(Et.fontMatrix=xt.fontMatrix||s.FONT_IDENTITY_MATRIX,(Et.fontMatrix[0]===0||Et.fontMatrix[3]===0)&&(0,s.warn)("Invalid font matrix for font "+ht),ct<0?(ct=-ct,Et.fontDirection=-1):Et.fontDirection=1,this.current.font=xt,this.current.fontSize=ct,xt.isType3Font)return;const bt=xt.loadedName||"sans-serif",Ct=((Tt=xt.systemFontInfo)==null?void 0:Tt.css)||`"${bt}", ${xt.fallbackName}`;let Ot="normal";xt.black?Ot="900":xt.bold&&(Ot="bold");const jt=xt.italic?"italic":"normal";let er=ct;ct<d?er=d:ct>g&&(er=g),this.current.fontSizeScale=ct/er,this.ctx.font=`${jt} ${Ot} ${er}px ${Ct}`}setTextRenderingMode(ht){this.current.textRenderingMode=ht}setTextRise(ht){this.current.textRise=ht}moveText(ht,ct){this.current.x=this.current.lineX+=ht,this.current.y=this.current.lineY+=ct}setLeadingMoveText(ht,ct){this.setLeading(-ct),this.moveText(ht,ct)}setTextMatrix(ht,ct,xt,Et,bt,Ct){this.current.textMatrix=[ht,ct,xt,Et,bt,Ct],this.current.textMatrixScale=Math.hypot(ht,ct),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ht,ct,xt,Et){const bt=this.ctx,Ct=this.current,Ot=Ct.font,jt=Ct.textRenderingMode,er=Ct.fontSize/Ct.fontSizeScale,Tt=jt&s.TextRenderingMode.FILL_STROKE_MASK,ur=!!(jt&s.TextRenderingMode.ADD_TO_PATH_FLAG),cr=Ct.patternFill&&!Ot.missingFile;let hr;(Ot.disableFontFace||ur||cr)&&(hr=Ot.getPathGenerator(this.commonObjs,ht)),Ot.disableFontFace||cr?(bt.save(),bt.translate(ct,xt),bt.beginPath(),hr(bt,er),Et&&bt.setTransform(...Et),(Tt===s.TextRenderingMode.FILL||Tt===s.TextRenderingMode.FILL_STROKE)&&bt.fill(),(Tt===s.TextRenderingMode.STROKE||Tt===s.TextRenderingMode.FILL_STROKE)&&bt.stroke(),bt.restore()):((Tt===s.TextRenderingMode.FILL||Tt===s.TextRenderingMode.FILL_STROKE)&&bt.fillText(ht,ct,xt),(Tt===s.TextRenderingMode.STROKE||Tt===s.TextRenderingMode.FILL_STROKE)&&bt.strokeText(ht,ct,xt)),ur&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,o.getCurrentTransform)(bt),x:ct,y:xt,fontSize:er,addToPath:hr})}get isFontSubpixelAAEnabled(){const{context:ht}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ht.scale(1.5,1),ht.fillText("I",0,10);const ct=ht.getImageData(0,0,10,10).data;let xt=!1;for(let Et=3;Et<ct.length;Et+=4)if(ct[Et]>0&&ct[Et]<255){xt=!0;break}return(0,s.shadow)(this,"isFontSubpixelAAEnabled",xt)}showText(ht){const ct=this.current,xt=ct.font;if(xt.isType3Font)return this.showType3Text(ht);const Et=ct.fontSize;if(Et===0)return;const bt=this.ctx,Ct=ct.fontSizeScale,Ot=ct.charSpacing,jt=ct.wordSpacing,er=ct.fontDirection,Tt=ct.textHScale*er,ur=ht.length,cr=xt.vertical,hr=cr?1:-1,Yt=xt.defaultVMetrics,Xt=Et*ct.fontMatrix[0],Ft=ct.textRenderingMode===s.TextRenderingMode.FILL&&!xt.disableFontFace&&!ct.patternFill;bt.save(),bt.transform(...ct.textMatrix),bt.translate(ct.x,ct.y+ct.textRise),er>0?bt.scale(Tt,-1):bt.scale(Tt,1);let Ut;if(ct.patternFill){bt.save();const _r=ct.fillColor.getPattern(bt,this,(0,o.getCurrentTransformInverse)(bt),c.PathType.FILL);Ut=(0,o.getCurrentTransform)(bt),bt.restore(),bt.fillStyle=_r}let qt=ct.lineWidth;const Jt=ct.textMatrixScale;if(Jt===0||qt===0){const _r=ct.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;(_r===s.TextRenderingMode.STROKE||_r===s.TextRenderingMode.FILL_STROKE)&&(qt=this.getSinglePixelWidth())}else qt/=Jt;if(Ct!==1&&(bt.scale(Ct,Ct),qt/=Ct),bt.lineWidth=qt,xt.isInvalidPDFjsFont){const _r=[];let Zt=0;for(const Er of ht)_r.push(Er.unicode),Zt+=Er.width;bt.fillText(_r.join(""),0,0),ct.x+=Zt*Xt*Tt,bt.restore(),this.compose();return}let dr=0,vr;for(vr=0;vr<ur;++vr){const _r=ht[vr];if(typeof _r=="number"){dr+=hr*_r*Et/1e3;continue}let Zt=!1;const Er=(_r.isSpace?jt:0)+Ot,Sr=_r.fontChar,Vr=_r.accent;let Nr,Pr,kr=_r.width;if(cr){const jr=_r.vmetric||Yt,Hr=-(_r.vmetric?jr[1]:kr*.5)*Xt,yr=jr[2]*Xt;kr=jr?-jr[0]:kr,Nr=Hr/Ct,Pr=(dr+yr)/Ct}else Nr=dr/Ct,Pr=0;if(xt.remeasure&&kr>0){const jr=bt.measureText(Sr).width*1e3/Et*Ct;if(kr<jr&&this.isFontSubpixelAAEnabled){const Hr=kr/jr;Zt=!0,bt.save(),bt.scale(Hr,1),Nr/=Hr}else kr!==jr&&(Nr+=(kr-jr)/2e3*Et/Ct)}if(this.contentVisible&&(_r.isInFont||xt.missingFile)){if(Ft&&!Vr)bt.fillText(Sr,Nr,Pr);else if(this.paintChar(Sr,Nr,Pr,Ut),Vr){const jr=Nr+Et*Vr.offset.x/Ct,Hr=Pr-Et*Vr.offset.y/Ct;this.paintChar(Vr.fontChar,jr,Hr,Ut)}}const Dr=cr?kr*Xt-Er*er:kr*Xt+Er*er;dr+=Dr,Zt&&bt.restore()}cr?ct.y-=dr:ct.x+=dr*Tt,bt.restore(),this.compose()}showType3Text(ht){const ct=this.ctx,xt=this.current,Et=xt.font,bt=xt.fontSize,Ct=xt.fontDirection,Ot=Et.vertical?1:-1,jt=xt.charSpacing,er=xt.wordSpacing,Tt=xt.textHScale*Ct,ur=xt.fontMatrix||s.FONT_IDENTITY_MATRIX,cr=ht.length,hr=xt.textRenderingMode===s.TextRenderingMode.INVISIBLE;let Yt,Xt,Ft,Ut;if(!(hr||bt===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,ct.save(),ct.transform(...xt.textMatrix),ct.translate(xt.x,xt.y),ct.scale(Tt,Ct),Yt=0;Yt<cr;++Yt){if(Xt=ht[Yt],typeof Xt=="number"){Ut=Ot*Xt*bt/1e3,this.ctx.translate(Ut,0),xt.x+=Ut*Tt;continue}const qt=(Xt.isSpace?er:0)+jt,Jt=Et.charProcOperatorList[Xt.operatorListId];if(!Jt){(0,s.warn)(`Type3 character "${Xt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Xt,this.save(),ct.scale(bt,bt),ct.transform(...ur),this.executeOperatorList(Jt),this.restore()),Ft=s.Util.applyTransform([Xt.width,0],ur)[0]*bt+qt,ct.translate(Ft,0),xt.x+=Ft*Tt}ct.restore(),this.processingType3=null}}setCharWidth(ht,ct){}setCharWidthAndBounds(ht,ct,xt,Et,bt,Ct){this.ctx.rect(xt,Et,bt-xt,Ct-Et),this.ctx.clip(),this.endPath()}getColorN_Pattern(ht){let ct;if(ht[0]==="TilingPattern"){const xt=ht[1],Et=this.baseTransform||(0,o.getCurrentTransform)(this.ctx),bt={createCanvasGraphics:Ct=>new $t(Ct,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};ct=new c.TilingPattern(ht,xt,this.ctx,bt,Et)}else ct=this._getPattern(ht[1],ht[2]);return ct}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ht,ct,xt){const Et=s.Util.makeHexColor(ht,ct,xt);this.ctx.strokeStyle=Et,this.current.strokeColor=Et}setFillRGBColor(ht,ct,xt){const Et=s.Util.makeHexColor(ht,ct,xt);this.ctx.fillStyle=Et,this.current.fillColor=Et,this.current.patternFill=!1}_getPattern(ht,ct=null){let xt;return this.cachedPatterns.has(ht)?xt=this.cachedPatterns.get(ht):(xt=(0,c.getShadingPattern)(this.getObject(ht)),this.cachedPatterns.set(ht,xt)),ct&&(xt.matrix=ct),xt}shadingFill(ht){if(!this.contentVisible)return;const ct=this.ctx;this.save();const xt=this._getPattern(ht);ct.fillStyle=xt.getPattern(ct,this,(0,o.getCurrentTransformInverse)(ct),c.PathType.SHADING);const Et=(0,o.getCurrentTransformInverse)(ct);if(Et){const{width:bt,height:Ct}=ct.canvas,[Ot,jt,er,Tt]=s.Util.getAxialAlignedBoundingBox([0,0,bt,Ct],Et);this.ctx.fillRect(Ot,jt,er-Ot,Tt-jt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,s.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,s.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ht,ct){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ht)&&ht.length===6&&this.transform(...ht),this.baseTransform=(0,o.getCurrentTransform)(this.ctx),ct)){const xt=ct[2]-ct[0],Et=ct[3]-ct[1];this.ctx.rect(ct[0],ct[1],xt,Et),this.current.updateRectMinMax((0,o.getCurrentTransform)(this.ctx),ct),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ht){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const ct=this.ctx;ht.isolated||(0,s.info)("TODO: Support non-isolated groups."),ht.knockout&&(0,s.warn)("Knockout groups not supported.");const xt=(0,o.getCurrentTransform)(ct);if(ht.matrix&&ct.transform(...ht.matrix),!ht.bbox)throw new Error("Bounding box is required.");let Et=s.Util.getAxialAlignedBoundingBox(ht.bbox,(0,o.getCurrentTransform)(ct));const bt=[0,0,ct.canvas.width,ct.canvas.height];Et=s.Util.intersect(Et,bt)||[0,0,0,0];const Ct=Math.floor(Et[0]),Ot=Math.floor(Et[1]);let jt=Math.max(Math.ceil(Et[2])-Ct,1),er=Math.max(Math.ceil(Et[3])-Ot,1),Tt=1,ur=1;jt>_&&(Tt=jt/_,jt=_),er>_&&(ur=er/_,er=_),this.current.startNewPathAndClipBox([0,0,jt,er]);let cr="groupAt"+this.groupLevel;ht.smask&&(cr+="_smask_"+this.smaskCounter++%2);const hr=this.cachedCanvases.getCanvas(cr,jt,er),Yt=hr.context;Yt.scale(1/Tt,1/ur),Yt.translate(-Ct,-Ot),Yt.transform(...xt),ht.smask?this.smaskStack.push({canvas:hr.canvas,context:Yt,offsetX:Ct,offsetY:Ot,scaleX:Tt,scaleY:ur,subtype:ht.smask.subtype,backdrop:ht.smask.backdrop,transferMap:ht.smask.transferMap||null,startTransformInverse:null}):(ct.setTransform(1,0,0,1,0,0),ct.translate(Ct,Ot),ct.scale(Tt,ur),ct.save()),lt(ct,Yt),this.ctx=Yt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(ct),this.groupLevel++}endGroup(ht){if(!this.contentVisible)return;this.groupLevel--;const ct=this.ctx,xt=this.groupStack.pop();if(this.ctx=xt,this.ctx.imageSmoothingEnabled=!1,ht.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Et=(0,o.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Et);const bt=s.Util.getAxialAlignedBoundingBox([0,0,ct.canvas.width,ct.canvas.height],Et);this.ctx.drawImage(ct.canvas,0,0),this.ctx.restore(),this.compose(bt)}}beginAnnotation(ht,ct,xt,Et,bt){if(Qt(this,Wt,Kn).call(this),ut(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(ct)&&ct.length===4){const Ct=ct[2]-ct[0],Ot=ct[3]-ct[1];if(bt&&this.annotationCanvasMap){xt=xt.slice(),xt[4]-=ct[0],xt[5]-=ct[1],ct=ct.slice(),ct[0]=ct[1]=0,ct[2]=Ct,ct[3]=Ot;const[jt,er]=s.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(this.ctx)),{viewportScale:Tt}=this,ur=Math.ceil(Ct*this.outputScaleX*Tt),cr=Math.ceil(Ot*this.outputScaleY*Tt);this.annotationCanvas=this.canvasFactory.create(ur,cr);const{canvas:hr,context:Yt}=this.annotationCanvas;this.annotationCanvasMap.set(ht,hr),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Yt,this.ctx.save(),this.ctx.setTransform(jt,0,0,-er,0,Ot*er),ut(this.ctx)}else ut(this.ctx),this.ctx.rect(ct[0],ct[1],Ct,Ot),this.ctx.clip(),this.endPath()}this.current=new at(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...xt),this.transform(...Et)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Qt(this,Wt,Yn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ht){if(!this.contentVisible)return;const ct=ht.count;ht=this.getObject(ht.data,ht),ht.count=ct;const xt=this.ctx,Et=this.processingType3;if(Et&&(Et.compiled===void 0&&(Et.compiled=nt(ht)),Et.compiled)){Et.compiled(xt);return}const bt=this._createMaskCanvas(ht),Ct=bt.canvas;xt.save(),xt.setTransform(1,0,0,1,0,0),xt.drawImage(Ct,bt.offsetX,bt.offsetY),xt.restore(),this.compose()}paintImageMaskXObjectRepeat(ht,ct,xt=0,Et=0,bt,Ct){if(!this.contentVisible)return;ht=this.getObject(ht.data,ht);const Ot=this.ctx;Ot.save();const jt=(0,o.getCurrentTransform)(Ot);Ot.transform(ct,xt,Et,bt,0,0);const er=this._createMaskCanvas(ht);Ot.setTransform(1,0,0,1,er.offsetX-jt[4],er.offsetY-jt[5]);for(let Tt=0,ur=Ct.length;Tt<ur;Tt+=2){const cr=s.Util.transform(jt,[ct,xt,Et,bt,Ct[Tt],Ct[Tt+1]]),[hr,Yt]=s.Util.applyTransform([0,0],cr);Ot.drawImage(er.canvas,hr,Yt)}Ot.restore(),this.compose()}paintImageMaskXObjectGroup(ht){if(!this.contentVisible)return;const ct=this.ctx,xt=this.current.fillColor,Et=this.current.patternFill;for(const bt of ht){const{data:Ct,width:Ot,height:jt,transform:er}=bt,Tt=this.cachedCanvases.getCanvas("maskCanvas",Ot,jt),ur=Tt.context;ur.save();const cr=this.getObject(Ct,bt);dt(ur,cr),ur.globalCompositeOperation="source-in",ur.fillStyle=Et?xt.getPattern(ur,this,(0,o.getCurrentTransformInverse)(ct),c.PathType.FILL):xt,ur.fillRect(0,0,Ot,jt),ur.restore(),ct.save(),ct.transform(...er),ct.scale(1,-1),it(ct,Tt.canvas,0,0,Ot,jt,0,-1,1,1),ct.restore()}this.compose()}paintImageXObject(ht){if(!this.contentVisible)return;const ct=this.getObject(ht);if(!ct){(0,s.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(ct)}paintImageXObjectRepeat(ht,ct,xt,Et){if(!this.contentVisible)return;const bt=this.getObject(ht);if(!bt){(0,s.warn)("Dependent image isn't ready yet");return}const Ct=bt.width,Ot=bt.height,jt=[];for(let er=0,Tt=Et.length;er<Tt;er+=2)jt.push({transform:[ct,0,0,xt,Et[er],Et[er+1]],x:0,y:0,w:Ct,h:Ot});this.paintInlineImageXObjectGroup(bt,jt)}applyTransferMapsToCanvas(ht){return this.current.transferMaps!=="none"&&(ht.filter=this.current.transferMaps,ht.drawImage(ht.canvas,0,0),ht.filter="none"),ht.canvas}applyTransferMapsToBitmap(ht){if(this.current.transferMaps==="none")return ht.bitmap;const{bitmap:ct,width:xt,height:Et}=ht,bt=this.cachedCanvases.getCanvas("inlineImage",xt,Et),Ct=bt.context;return Ct.filter=this.current.transferMaps,Ct.drawImage(ct,0,0),Ct.filter="none",bt.canvas}paintInlineImageXObject(ht){if(!this.contentVisible)return;const ct=ht.width,xt=ht.height,Et=this.ctx;if(this.save(),!s.isNodeJS){const{filter:Ot}=Et;Ot!=="none"&&Ot!==""&&(Et.filter="none")}Et.scale(1/ct,-1/xt);let bt;if(ht.bitmap)bt=this.applyTransferMapsToBitmap(ht);else if(typeof HTMLElement=="function"&&ht instanceof HTMLElement||!ht.data)bt=ht;else{const jt=this.cachedCanvases.getCanvas("inlineImage",ct,xt).context;st(jt,ht),bt=this.applyTransferMapsToCanvas(jt)}const Ct=this._scaleImage(bt,(0,o.getCurrentTransformInverse)(Et));Et.imageSmoothingEnabled=vt((0,o.getCurrentTransform)(Et),ht.interpolate),it(Et,Ct.img,0,0,Ct.paintWidth,Ct.paintHeight,0,-xt,ct,xt),this.compose(),this.restore()}paintInlineImageXObjectGroup(ht,ct){if(!this.contentVisible)return;const xt=this.ctx;let Et;if(ht.bitmap)Et=ht.bitmap;else{const bt=ht.width,Ct=ht.height,jt=this.cachedCanvases.getCanvas("inlineImage",bt,Ct).context;st(jt,ht),Et=this.applyTransferMapsToCanvas(jt)}for(const bt of ct)xt.save(),xt.transform(...bt.transform),xt.scale(1,-1),it(xt,Et,bt.x,bt.y,bt.w,bt.h,0,-1,1,1),xt.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ht){}markPointProps(ht,ct){}beginMarkedContent(ht){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ht,ct){ht==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(ct)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ht){const ct=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ht);const xt=this.ctx;this.pendingClip&&(ct||(this.pendingClip===Ht?xt.clip("evenodd"):xt.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),xt.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ht=(0,o.getCurrentTransform)(this.ctx);if(ht[1]===0&&ht[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ht[0]),Math.abs(ht[3]));else{const ct=Math.abs(ht[0]*ht[3]-ht[2]*ht[1]),xt=Math.hypot(ht[0],ht[2]),Et=Math.hypot(ht[1],ht[3]);this._cachedGetSinglePixelWidth=Math.max(xt,Et)/ct}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ht}=this.current,{a:ct,b:xt,c:Et,d:bt}=this.ctx.getTransform();let Ct,Ot;if(xt===0&&Et===0){const jt=Math.abs(ct),er=Math.abs(bt);if(jt===er)if(ht===0)Ct=Ot=1/jt;else{const Tt=jt*ht;Ct=Ot=Tt<1?1/Tt:1}else if(ht===0)Ct=1/jt,Ot=1/er;else{const Tt=jt*ht,ur=er*ht;Ct=Tt<1?1/Tt:1,Ot=ur<1?1/ur:1}}else{const jt=Math.abs(ct*bt-xt*Et),er=Math.hypot(ct,xt),Tt=Math.hypot(Et,bt);if(ht===0)Ct=Tt/jt,Ot=er/jt;else{const ur=ht*jt;Ct=Tt>ur?Tt/ur:1,Ot=er>ur?er/ur:1}}this._cachedScaleForStroking[0]=Ct,this._cachedScaleForStroking[1]=Ot}return this._cachedScaleForStroking}rescaleAndStroke(ht){const{ctx:ct}=this,{lineWidth:xt}=this.current,[Et,bt]=this.getScaleForStroking();if(ct.lineWidth=xt||1,Et===1&&bt===1){ct.stroke();return}const Ct=ct.getLineDash();if(ht&&ct.save(),ct.scale(Et,bt),Ct.length>0){const Ot=Math.max(Et,bt);ct.setLineDash(Ct.map(jt=>jt/Ot)),ct.lineDashOffset/=Ot}ct.stroke(),ht&&ct.restore()}isContentVisible(){for(let ht=this.markedContentStack.length-1;ht>=0;ht--)if(!this.markedContentStack[ht].visible)return!1;return!0}};Wt=new WeakSet,Kn=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Yn=function(){if(this.pageColors){const ht=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ht!=="none"){const ct=this.ctx.filter;this.ctx.filter=ht,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=ct}}};let It=$t;i.CanvasGraphics=It;for(const _t in s.OPS)It.prototype[_t]!==void 0&&(It.prototype[s.OPS[_t]]=It.prototype[_t])},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=et;var s=a(1),o=a(6);const c={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=c;function h(nt,at){if(!at)return;const st=at[2]-at[0],dt=at[3]-at[1],lt=new Path2D;lt.rect(at[0],at[1],st,dt),nt.clip(lt)}class d{constructor(){this.constructor===d&&(0,s.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,s.unreachable)("Abstract method `getPattern` called.")}}class g extends d{constructor(at){super(),this._type=at[1],this._bbox=at[2],this._colorStops=at[3],this._p0=at[4],this._p1=at[5],this._r0=at[6],this._r1=at[7],this.matrix=null}_createGradient(at){let st;this._type==="axial"?st=at.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(st=at.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const dt of this._colorStops)st.addColorStop(dt[0],dt[1]);return st}getPattern(at,st,dt,lt){let ut;if(lt===c.STROKE||lt===c.FILL){const ot=st.current.getClippedPathBoundingBox(lt,(0,o.getCurrentTransform)(at))||[0,0,0,0],ft=Math.ceil(ot[2]-ot[0])||1,pt=Math.ceil(ot[3]-ot[1])||1,St=st.cachedCanvases.getCanvas("pattern",ft,pt,!0),gt=St.context;gt.clearRect(0,0,gt.canvas.width,gt.canvas.height),gt.beginPath(),gt.rect(0,0,gt.canvas.width,gt.canvas.height),gt.translate(-ot[0],-ot[1]),dt=s.Util.transform(dt,[1,0,0,1,ot[0],ot[1]]),gt.transform(...st.baseTransform),this.matrix&&gt.transform(...this.matrix),h(gt,this._bbox),gt.fillStyle=this._createGradient(gt),gt.fill(),ut=at.createPattern(St.canvas,"no-repeat");const vt=new DOMMatrix(dt);ut.setTransform(vt)}else h(at,this._bbox),ut=this._createGradient(at);return ut}}function _(nt,at,st,dt,lt,ut,ot,ft){const pt=at.coords,St=at.colors,gt=nt.data,vt=nt.width*4;let At;pt[st+1]>pt[dt+1]&&(At=st,st=dt,dt=At,At=ut,ut=ot,ot=At),pt[dt+1]>pt[lt+1]&&(At=dt,dt=lt,lt=At,At=ot,ot=ft,ft=At),pt[st+1]>pt[dt+1]&&(At=st,st=dt,dt=At,At=ut,ut=ot,ot=At);const Gt=(pt[st]+at.offsetX)*at.scaleX,Nt=(pt[st+1]+at.offsetY)*at.scaleY,Ht=(pt[dt]+at.offsetX)*at.scaleX,It=(pt[dt+1]+at.offsetY)*at.scaleY,Wt=(pt[lt]+at.offsetX)*at.scaleX,yt=(pt[lt+1]+at.offsetY)*at.scaleY;if(Nt>=yt)return;const Dt=St[ut],$t=St[ut+1],_t=St[ut+2],ht=St[ot],ct=St[ot+1],xt=St[ot+2],Et=St[ft],bt=St[ft+1],Ct=St[ft+2],Ot=Math.round(Nt),jt=Math.round(yt);let er,Tt,ur,cr,hr,Yt,Xt,Ft;for(let Ut=Ot;Ut<=jt;Ut++){if(Ut<It){const _r=Ut<Nt?0:(Nt-Ut)/(Nt-It);er=Gt-(Gt-Ht)*_r,Tt=Dt-(Dt-ht)*_r,ur=$t-($t-ct)*_r,cr=_t-(_t-xt)*_r}else{let _r;Ut>yt?_r=1:It===yt?_r=0:_r=(It-Ut)/(It-yt),er=Ht-(Ht-Wt)*_r,Tt=ht-(ht-Et)*_r,ur=ct-(ct-bt)*_r,cr=xt-(xt-Ct)*_r}let qt;Ut<Nt?qt=0:Ut>yt?qt=1:qt=(Nt-Ut)/(Nt-yt),hr=Gt-(Gt-Wt)*qt,Yt=Dt-(Dt-Et)*qt,Xt=$t-($t-bt)*qt,Ft=_t-(_t-Ct)*qt;const Jt=Math.round(Math.min(er,hr)),dr=Math.round(Math.max(er,hr));let vr=vt*Ut+Jt*4;for(let _r=Jt;_r<=dr;_r++)qt=(er-_r)/(er-hr),qt<0?qt=0:qt>1&&(qt=1),gt[vr++]=Tt-(Tt-Yt)*qt|0,gt[vr++]=ur-(ur-Xt)*qt|0,gt[vr++]=cr-(cr-Ft)*qt|0,gt[vr++]=255}}function b(nt,at,st){const dt=at.coords,lt=at.colors;let ut,ot;switch(at.type){case"lattice":const ft=at.verticesPerRow,pt=Math.floor(dt.length/ft)-1,St=ft-1;for(ut=0;ut<pt;ut++){let gt=ut*ft;for(let vt=0;vt<St;vt++,gt++)_(nt,st,dt[gt],dt[gt+1],dt[gt+ft],lt[gt],lt[gt+1],lt[gt+ft]),_(nt,st,dt[gt+ft+1],dt[gt+1],dt[gt+ft],lt[gt+ft+1],lt[gt+1],lt[gt+ft])}break;case"triangles":for(ut=0,ot=dt.length;ut<ot;ut+=3)_(nt,st,dt[ut],dt[ut+1],dt[ut+2],lt[ut],lt[ut+1],lt[ut+2]);break;default:throw new Error("illegal figure")}}class j extends d{constructor(at){super(),this._coords=at[2],this._colors=at[3],this._figures=at[4],this._bounds=at[5],this._bbox=at[7],this._background=at[8],this.matrix=null}_createMeshCanvas(at,st,dt){const ft=Math.floor(this._bounds[0]),pt=Math.floor(this._bounds[1]),St=Math.ceil(this._bounds[2])-ft,gt=Math.ceil(this._bounds[3])-pt,vt=Math.min(Math.ceil(Math.abs(St*at[0]*1.1)),3e3),At=Math.min(Math.ceil(Math.abs(gt*at[1]*1.1)),3e3),Gt=St/vt,Nt=gt/At,Ht={coords:this._coords,colors:this._colors,offsetX:-ft,offsetY:-pt,scaleX:1/Gt,scaleY:1/Nt},It=vt+2*2,Wt=At+2*2,yt=dt.getCanvas("mesh",It,Wt,!1),Dt=yt.context,$t=Dt.createImageData(vt,At);if(st){const ht=$t.data;for(let ct=0,xt=ht.length;ct<xt;ct+=4)ht[ct]=st[0],ht[ct+1]=st[1],ht[ct+2]=st[2],ht[ct+3]=255}for(const ht of this._figures)b($t,ht,Ht);return Dt.putImageData($t,2,2),{canvas:yt.canvas,offsetX:ft-2*Gt,offsetY:pt-2*Nt,scaleX:Gt,scaleY:Nt}}getPattern(at,st,dt,lt){h(at,this._bbox);let ut;if(lt===c.SHADING)ut=s.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(at));else if(ut=s.Util.singularValueDecompose2dScale(st.baseTransform),this.matrix){const ft=s.Util.singularValueDecompose2dScale(this.matrix);ut=[ut[0]*ft[0],ut[1]*ft[1]]}const ot=this._createMeshCanvas(ut,lt===c.SHADING?null:this._background,st.cachedCanvases);return lt!==c.SHADING&&(at.setTransform(...st.baseTransform),this.matrix&&at.transform(...this.matrix)),at.translate(ot.offsetX,ot.offsetY),at.scale(ot.scaleX,ot.scaleY),at.createPattern(ot.canvas,"no-repeat")}}class _e extends d{getPattern(){return"hotpink"}}function et(nt){switch(nt[0]){case"RadialAxial":return new g(nt);case"Mesh":return new j(nt);case"Dummy":return new _e}throw new Error(`Unknown IR type: ${nt[0]}`)}const rt={COLORED:1,UNCOLORED:2},it=class it{constructor(at,st,dt,lt,ut){this.operatorList=at[2],this.matrix=at[3]||[1,0,0,1,0,0],this.bbox=at[4],this.xstep=at[5],this.ystep=at[6],this.paintType=at[7],this.tilingType=at[8],this.color=st,this.ctx=dt,this.canvasGraphicsFactory=lt,this.baseTransform=ut}createPatternCanvas(at){const st=this.operatorList,dt=this.bbox,lt=this.xstep,ut=this.ystep,ot=this.paintType,ft=this.tilingType,pt=this.color,St=this.canvasGraphicsFactory;(0,s.info)("TilingType: "+ft);const gt=dt[0],vt=dt[1],At=dt[2],Gt=dt[3],Nt=s.Util.singularValueDecompose2dScale(this.matrix),Ht=s.Util.singularValueDecompose2dScale(this.baseTransform),It=[Nt[0]*Ht[0],Nt[1]*Ht[1]],Wt=this.getSizeAndScale(lt,this.ctx.canvas.width,It[0]),yt=this.getSizeAndScale(ut,this.ctx.canvas.height,It[1]),Dt=at.cachedCanvases.getCanvas("pattern",Wt.size,yt.size,!0),$t=Dt.context,_t=St.createCanvasGraphics($t);_t.groupLevel=at.groupLevel,this.setFillAndStrokeStyleToContext(_t,ot,pt);let ht=gt,ct=vt,xt=At,Et=Gt;return gt<0&&(ht=0,xt+=Math.abs(gt)),vt<0&&(ct=0,Et+=Math.abs(vt)),$t.translate(-(Wt.scale*ht),-(yt.scale*ct)),_t.transform(Wt.scale,0,0,yt.scale,0,0),$t.save(),this.clipBbox(_t,ht,ct,xt,Et),_t.baseTransform=(0,o.getCurrentTransform)(_t.ctx),_t.executeOperatorList(st),_t.endDrawing(),{canvas:Dt.canvas,scaleX:Wt.scale,scaleY:yt.scale,offsetX:ht,offsetY:ct}}getSizeAndScale(at,st,dt){at=Math.abs(at);const lt=Math.max(it.MAX_PATTERN_SIZE,st);let ut=Math.ceil(at*dt);return ut>=lt?ut=lt:dt=ut/at,{scale:dt,size:ut}}clipBbox(at,st,dt,lt,ut){const ot=lt-st,ft=ut-dt;at.ctx.rect(st,dt,ot,ft),at.current.updateRectMinMax((0,o.getCurrentTransform)(at.ctx),[st,dt,lt,ut]),at.clip(),at.endPath()}setFillAndStrokeStyleToContext(at,st,dt){const lt=at.ctx,ut=at.current;switch(st){case rt.COLORED:const ot=this.ctx;lt.fillStyle=ot.fillStyle,lt.strokeStyle=ot.strokeStyle,ut.fillColor=ot.fillStyle,ut.strokeColor=ot.strokeStyle;break;case rt.UNCOLORED:const ft=s.Util.makeHexColor(dt[0],dt[1],dt[2]);lt.fillStyle=ft,lt.strokeStyle=ft,ut.fillColor=ft,ut.strokeColor=ft;break;default:throw new s.FormatError(`Unsupported paint type: ${st}`)}}getPattern(at,st,dt,lt){let ut=dt;lt!==c.SHADING&&(ut=s.Util.transform(ut,st.baseTransform),this.matrix&&(ut=s.Util.transform(ut,this.matrix)));const ot=this.createPatternCanvas(st);let ft=new DOMMatrix(ut);ft=ft.translate(ot.offsetX,ot.offsetY),ft=ft.scale(1/ot.scaleX,1/ot.scaleY);const pt=at.createPattern(ot.canvas,"repeat");return pt.setTransform(ft),pt}};$r(it,"MAX_PATTERN_SIZE",3e3);let tt=it;i.TilingPattern=tt},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=c,i.convertToRGBA=o,i.grayToRGBA=d;var s=a(1);function o(g){switch(g.kind){case s.ImageKind.GRAYSCALE_1BPP:return c(g);case s.ImageKind.RGB_24BPP:return h(g)}return null}function c({src:g,srcPos:_=0,dest:b,width:j,height:_e,nonBlackColor:et=4294967295,inverseDecode:rt=!1}){const tt=s.FeatureTest.isLittleEndian?4278190080:255,[it,nt]=rt?[et,tt]:[tt,et],at=j>>3,st=j&7,dt=g.length;b=new Uint32Array(b.buffer);let lt=0;for(let ut=0;ut<_e;ut++){for(const ft=_+at;_<ft;_++){const pt=_<dt?g[_]:255;b[lt++]=pt&128?nt:it,b[lt++]=pt&64?nt:it,b[lt++]=pt&32?nt:it,b[lt++]=pt&16?nt:it,b[lt++]=pt&8?nt:it,b[lt++]=pt&4?nt:it,b[lt++]=pt&2?nt:it,b[lt++]=pt&1?nt:it}if(st===0)continue;const ot=_<dt?g[_++]:255;for(let ft=0;ft<st;ft++)b[lt++]=ot&1<<7-ft?nt:it}return{srcPos:_,destPos:lt}}function h({src:g,srcPos:_=0,dest:b,destPos:j=0,width:_e,height:et}){let rt=0;const tt=g.length>>2,it=new Uint32Array(g.buffer,_,tt);if(s.FeatureTest.isLittleEndian){for(;rt<tt-2;rt+=3,j+=4){const nt=it[rt],at=it[rt+1],st=it[rt+2];b[j]=nt|4278190080,b[j+1]=nt>>>24|at<<8|4278190080,b[j+2]=at>>>16|st<<16|4278190080,b[j+3]=st>>>8|4278190080}for(let nt=rt*4,at=g.length;nt<at;nt+=3)b[j++]=g[nt]|g[nt+1]<<8|g[nt+2]<<16|4278190080}else{for(;rt<tt-2;rt+=3,j+=4){const nt=it[rt],at=it[rt+1],st=it[rt+2];b[j]=nt|255,b[j+1]=nt<<24|at>>>8|255,b[j+2]=at<<16|st>>>16|255,b[j+3]=st<<8|255}for(let nt=rt*4,at=g.length;nt<at;nt+=3)b[j++]=g[nt]<<24|g[nt+1]<<16|g[nt+2]<<8|255}return{srcPos:_,destPos:j}}function d(g,_){if(s.FeatureTest.isLittleEndian)for(let b=0,j=g.length;b<j;b++)_[b]=g[b]*65793|4278190080;else for(let b=0,j=g.length;b<j;b++)_[b]=g[b]*16843008|255}},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const a=Object.create(null);i.GlobalWorkerOptions=a,a.workerPort=null,a.workerSrc=""},(e,i,a)=>{var g,_s,xs,En;Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var s=a(1);const o={DATA:1,ERROR:2},c={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function h(_e){switch(_e instanceof Error||typeof _e=="object"&&_e!==null||(0,s.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),_e.name){case"AbortException":return new s.AbortException(_e.message);case"MissingPDFException":return new s.MissingPDFException(_e.message);case"PasswordException":return new s.PasswordException(_e.message,_e.code);case"UnexpectedResponseException":return new s.UnexpectedResponseException(_e.message,_e.status);case"UnknownErrorException":return new s.UnknownErrorException(_e.message,_e.details);default:return new s.UnknownErrorException(_e.message,_e.toString())}}class d{constructor(et,rt,tt){nr(this,g);this.sourceName=et,this.targetName=rt,this.comObj=tt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=it=>{const nt=it.data;if(nt.targetName!==this.sourceName)return;if(nt.stream){Qt(this,g,xs).call(this,nt);return}if(nt.callback){const st=nt.callbackId,dt=this.callbackCapabilities[st];if(!dt)throw new Error(`Cannot resolve callback ${st}`);if(delete this.callbackCapabilities[st],nt.callback===o.DATA)dt.resolve(nt.data);else if(nt.callback===o.ERROR)dt.reject(h(nt.reason));else throw new Error("Unexpected callback case");return}const at=this.actionHandler[nt.action];if(!at)throw new Error(`Unknown action from worker: ${nt.action}`);if(nt.callbackId){const st=this.sourceName,dt=nt.sourceName;new Promise(function(lt){lt(at(nt.data))}).then(function(lt){tt.postMessage({sourceName:st,targetName:dt,callback:o.DATA,callbackId:nt.callbackId,data:lt})},function(lt){tt.postMessage({sourceName:st,targetName:dt,callback:o.ERROR,callbackId:nt.callbackId,reason:h(lt)})});return}if(nt.streamId){Qt(this,g,_s).call(this,nt);return}at(nt.data)},tt.addEventListener("message",this._onComObjOnMessage)}on(et,rt){const tt=this.actionHandler;if(tt[et])throw new Error(`There is already an actionName called "${et}"`);tt[et]=rt}send(et,rt,tt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:et,data:rt},tt)}sendWithPromise(et,rt,tt){const it=this.callbackId++,nt=new s.PromiseCapability;this.callbackCapabilities[it]=nt;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:et,callbackId:it,data:rt},tt)}catch(at){nt.reject(at)}return nt.promise}sendWithStream(et,rt,tt,it){const nt=this.streamId++,at=this.sourceName,st=this.targetName,dt=this.comObj;return new ReadableStream({start:lt=>{const ut=new s.PromiseCapability;return this.streamControllers[nt]={controller:lt,startCall:ut,pullCall:null,cancelCall:null,isClosed:!1},dt.postMessage({sourceName:at,targetName:st,action:et,streamId:nt,data:rt,desiredSize:lt.desiredSize},it),ut.promise},pull:lt=>{const ut=new s.PromiseCapability;return this.streamControllers[nt].pullCall=ut,dt.postMessage({sourceName:at,targetName:st,stream:c.PULL,streamId:nt,desiredSize:lt.desiredSize}),ut.promise},cancel:lt=>{(0,s.assert)(lt instanceof Error,"cancel must have a valid reason");const ut=new s.PromiseCapability;return this.streamControllers[nt].cancelCall=ut,this.streamControllers[nt].isClosed=!0,dt.postMessage({sourceName:at,targetName:st,stream:c.CANCEL,streamId:nt,reason:h(lt)}),ut.promise}},tt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}g=new WeakSet,_s=function(et){const rt=et.streamId,tt=this.sourceName,it=et.sourceName,nt=this.comObj,at=this,st=this.actionHandler[et.action],dt={enqueue(lt,ut=1,ot){if(this.isCancelled)return;const ft=this.desiredSize;this.desiredSize-=ut,ft>0&&this.desiredSize<=0&&(this.sinkCapability=new s.PromiseCapability,this.ready=this.sinkCapability.promise),nt.postMessage({sourceName:tt,targetName:it,stream:c.ENQUEUE,streamId:rt,chunk:lt},ot)},close(){this.isCancelled||(this.isCancelled=!0,nt.postMessage({sourceName:tt,targetName:it,stream:c.CLOSE,streamId:rt}),delete at.streamSinks[rt])},error(lt){(0,s.assert)(lt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,nt.postMessage({sourceName:tt,targetName:it,stream:c.ERROR,streamId:rt,reason:h(lt)}))},sinkCapability:new s.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:et.desiredSize,ready:null};dt.sinkCapability.resolve(),dt.ready=dt.sinkCapability.promise,this.streamSinks[rt]=dt,new Promise(function(lt){lt(st(et.data,dt))}).then(function(){nt.postMessage({sourceName:tt,targetName:it,stream:c.START_COMPLETE,streamId:rt,success:!0})},function(lt){nt.postMessage({sourceName:tt,targetName:it,stream:c.START_COMPLETE,streamId:rt,reason:h(lt)})})},xs=function(et){const rt=et.streamId,tt=this.sourceName,it=et.sourceName,nt=this.comObj,at=this.streamControllers[rt],st=this.streamSinks[rt];switch(et.stream){case c.START_COMPLETE:et.success?at.startCall.resolve():at.startCall.reject(h(et.reason));break;case c.PULL_COMPLETE:et.success?at.pullCall.resolve():at.pullCall.reject(h(et.reason));break;case c.PULL:if(!st){nt.postMessage({sourceName:tt,targetName:it,stream:c.PULL_COMPLETE,streamId:rt,success:!0});break}st.desiredSize<=0&&et.desiredSize>0&&st.sinkCapability.resolve(),st.desiredSize=et.desiredSize,new Promise(function(dt){var lt;dt((lt=st.onPull)==null?void 0:lt.call(st))}).then(function(){nt.postMessage({sourceName:tt,targetName:it,stream:c.PULL_COMPLETE,streamId:rt,success:!0})},function(dt){nt.postMessage({sourceName:tt,targetName:it,stream:c.PULL_COMPLETE,streamId:rt,reason:h(dt)})});break;case c.ENQUEUE:if((0,s.assert)(at,"enqueue should have stream controller"),at.isClosed)break;at.controller.enqueue(et.chunk);break;case c.CLOSE:if((0,s.assert)(at,"close should have stream controller"),at.isClosed)break;at.isClosed=!0,at.controller.close(),Qt(this,g,En).call(this,at,rt);break;case c.ERROR:(0,s.assert)(at,"error should have stream controller"),at.controller.error(h(et.reason)),Qt(this,g,En).call(this,at,rt);break;case c.CANCEL_COMPLETE:et.success?at.cancelCall.resolve():at.cancelCall.reject(h(et.reason)),Qt(this,g,En).call(this,at,rt);break;case c.CANCEL:if(!st)break;new Promise(function(dt){var lt;dt((lt=st.onCancel)==null?void 0:lt.call(st,h(et.reason)))}).then(function(){nt.postMessage({sourceName:tt,targetName:it,stream:c.CANCEL_COMPLETE,streamId:rt,success:!0})},function(dt){nt.postMessage({sourceName:tt,targetName:it,stream:c.CANCEL_COMPLETE,streamId:rt,reason:h(dt)})}),st.sinkCapability.reject(h(et.reason)),st.isCancelled=!0,delete this.streamSinks[rt];break;default:throw new Error("Unexpected stream case")}},En=async function(et,rt){var tt,it,nt;await Promise.allSettled([(tt=et.startCall)==null?void 0:tt.promise,(it=et.pullCall)==null?void 0:it.promise,(nt=et.cancelCall)==null?void 0:nt.promise]),delete this.streamControllers[rt]},i.MessageHandler=d},(e,i,a)=>{var c,h;Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var s=a(1);class o{constructor({parsedData:g,rawData:_}){nr(this,c);nr(this,h);ir(this,c,g),ir(this,h,_)}getRaw(){return mt(this,h)}get(g){return mt(this,c).get(g)??null}getAll(){return(0,s.objectFromMap)(mt(this,c))}has(g){return mt(this,c).has(g)}}c=new WeakMap,h=new WeakMap,i.Metadata=o},(e,i,a)=>{var g,_,b,j,_e,et,qn;Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var s=a(1),o=a(8);const c=Symbol("INTERNAL");class h{constructor(it,nt){nr(this,g,!0);this.name=it,this.intent=nt}get visible(){return mt(this,g)}_setVisible(it,nt){it!==c&&(0,s.unreachable)("Internal method `_setVisible` called."),ir(this,g,nt)}}g=new WeakMap;class d{constructor(it){nr(this,et);nr(this,_,null);nr(this,b,new Map);nr(this,j,null);nr(this,_e,null);if(this.name=null,this.creator=null,it!==null){this.name=it.name,this.creator=it.creator,ir(this,_e,it.order);for(const nt of it.groups)mt(this,b).set(nt.id,new h(nt.name,nt.intent));if(it.baseState==="OFF")for(const nt of mt(this,b).values())nt._setVisible(c,!1);for(const nt of it.on)mt(this,b).get(nt)._setVisible(c,!0);for(const nt of it.off)mt(this,b).get(nt)._setVisible(c,!1);ir(this,j,this.getHash())}}isVisible(it){if(mt(this,b).size===0)return!0;if(!it)return(0,s.warn)("Optional content group not defined."),!0;if(it.type==="OCG")return mt(this,b).has(it.id)?mt(this,b).get(it.id).visible:((0,s.warn)(`Optional content group not found: ${it.id}`),!0);if(it.type==="OCMD"){if(it.expression)return Qt(this,et,qn).call(this,it.expression);if(!it.policy||it.policy==="AnyOn"){for(const nt of it.ids){if(!mt(this,b).has(nt))return(0,s.warn)(`Optional content group not found: ${nt}`),!0;if(mt(this,b).get(nt).visible)return!0}return!1}else if(it.policy==="AllOn"){for(const nt of it.ids){if(!mt(this,b).has(nt))return(0,s.warn)(`Optional content group not found: ${nt}`),!0;if(!mt(this,b).get(nt).visible)return!1}return!0}else if(it.policy==="AnyOff"){for(const nt of it.ids){if(!mt(this,b).has(nt))return(0,s.warn)(`Optional content group not found: ${nt}`),!0;if(!mt(this,b).get(nt).visible)return!0}return!1}else if(it.policy==="AllOff"){for(const nt of it.ids){if(!mt(this,b).has(nt))return(0,s.warn)(`Optional content group not found: ${nt}`),!0;if(mt(this,b).get(nt).visible)return!1}return!0}return(0,s.warn)(`Unknown optional content policy ${it.policy}.`),!0}return(0,s.warn)(`Unknown group type ${it.type}.`),!0}setVisibility(it,nt=!0){if(!mt(this,b).has(it)){(0,s.warn)(`Optional content group not found: ${it}`);return}mt(this,b).get(it)._setVisible(c,!!nt),ir(this,_,null)}get hasInitialVisibility(){return mt(this,j)===null||this.getHash()===mt(this,j)}getOrder(){return mt(this,b).size?mt(this,_e)?mt(this,_e).slice():[...mt(this,b).keys()]:null}getGroups(){return mt(this,b).size>0?(0,s.objectFromMap)(mt(this,b)):null}getGroup(it){return mt(this,b).get(it)||null}getHash(){if(mt(this,_)!==null)return mt(this,_);const it=new o.MurmurHash3_64;for(const[nt,at]of mt(this,b))it.update(`${nt}:${at.visible}`);return ir(this,_,it.hexdigest())}}_=new WeakMap,b=new WeakMap,j=new WeakMap,_e=new WeakMap,et=new WeakSet,qn=function(it){const nt=it.length;if(nt<2)return!0;const at=it[0];for(let st=1;st<nt;st++){const dt=it[st];let lt;if(Array.isArray(dt))lt=Qt(this,et,qn).call(this,dt);else if(mt(this,b).has(dt))lt=mt(this,b).get(dt).visible;else return(0,s.warn)(`Optional content group not found: ${dt}`),!0;switch(at){case"And":if(!lt)return!1;break;case"Or":if(lt)return!0;break;case"Not":return!lt;default:return!0}}return at==="And"},i.OptionalContentConfig=d},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var s=a(1),o=a(6);class c{constructor({length:_,initialData:b,progressiveDone:j=!1,contentDispositionFilename:_e=null,disableRange:et=!1,disableStream:rt=!1},tt){if((0,s.assert)(tt,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=j,this._contentDispositionFilename=_e,(b==null?void 0:b.length)>0){const it=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;this._queuedChunks.push(it)}this._pdfDataRangeTransport=tt,this._isStreamingSupported=!rt,this._isRangeSupported=!et,this._contentLength=_,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((it,nt)=>{this._onReceiveData({begin:it,chunk:nt})}),this._pdfDataRangeTransport.addProgressListener((it,nt)=>{this._onProgress({loaded:it,total:nt})}),this._pdfDataRangeTransport.addProgressiveReadListener(it=>{this._onReceiveData({chunk:it})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:_,chunk:b}){const j=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;if(_===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const _e=this._rangeReaders.some(function(et){return et._begin!==_?!1:(et._enqueue(j),!0)});(0,s.assert)(_e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}_onProgress(_){var b,j,_e,et;_.total===void 0?(j=(b=this._rangeReaders[0])==null?void 0:b.onProgress)==null||j.call(b,{loaded:_.loaded}):(et=(_e=this._fullRequestReader)==null?void 0:_e.onProgress)==null||et.call(_e,{loaded:_.loaded,total:_.total})}_onProgressiveDone(){var _;(_=this._fullRequestReader)==null||_.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(_){const b=this._rangeReaders.indexOf(_);b>=0&&this._rangeReaders.splice(b,1)}getFullReader(){(0,s.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const _=this._queuedChunks;return this._queuedChunks=null,new h(this,_,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(_,b){if(b<=this._progressiveDataLength)return null;const j=new d(this,_,b);return this._pdfDataRangeTransport.requestDataRange(_,b),this._rangeReaders.push(j),j}cancelAllRequests(_){var b;(b=this._fullRequestReader)==null||b.cancel(_);for(const j of this._rangeReaders.slice(0))j.cancel(_);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=c;class h{constructor(_,b,j=!1,_e=null){this._stream=_,this._done=j||!1,this._filename=(0,o.isPdfFile)(_e)?_e:null,this._queuedChunks=b||[],this._loaded=0;for(const et of this._queuedChunks)this._loaded+=et.byteLength;this._requests=[],this._headersReady=Promise.resolve(),_._fullRequestReader=this,this.onProgress=null}_enqueue(_){this._done||(this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunks.push(_),this._loaded+=_.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=new s.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class d{constructor(_,b,j){this._stream=_,this._begin=b,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(_){if(!this._done){if(this._requests.length===0)this._queuedChunk=_;else{this._requests.shift().resolve({value:_,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const _=new s.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var s=a(1),o=a(20);function c(j,_e,et){return{method:"GET",headers:j,signal:et.signal,mode:"cors",credentials:_e?"include":"same-origin",redirect:"follow"}}function h(j){const _e=new Headers;for(const et in j){const rt=j[et];rt!==void 0&&_e.append(et,rt)}return _e}function d(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,s.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class g{constructor(_e){this.source=_e,this.isHttp=/^https?:/i.test(_e.url),this.httpHeaders=this.isHttp&&_e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _e;return((_e=this._fullRequestReader)==null?void 0:_e._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new _(this),this._fullRequestReader}getRangeReader(_e,et){if(et<=this._progressiveDataLength)return null;const rt=new b(this,_e,et);return this._rangeRequestReaders.push(rt),rt}cancelAllRequests(_e){var et;(et=this._fullRequestReader)==null||et.cancel(_e);for(const rt of this._rangeRequestReaders.slice(0))rt.cancel(_e)}}i.PDFFetchStream=g;class _{constructor(_e){this._stream=_e,this._reader=null,this._loaded=0,this._filename=null;const et=_e.source;this._withCredentials=et.withCredentials||!1,this._contentLength=et.length,this._headersCapability=new s.PromiseCapability,this._disableRange=et.disableRange||!1,this._rangeChunkSize=et.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!et.disableStream,this._isRangeSupported=!et.disableRange,this._headers=h(this._stream.httpHeaders);const rt=et.url;fetch(rt,c(this._headers,this._withCredentials,this._abortController)).then(tt=>{if(!(0,o.validateResponseStatus)(tt.status))throw(0,o.createResponseStatusError)(tt.status,rt);this._reader=tt.body.getReader(),this._headersCapability.resolve();const it=st=>tt.headers.get(st),{allowRangeRequests:nt,suggestedLength:at}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:it,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=nt,this._contentLength=at||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(it),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new s.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var rt;await this._headersCapability.promise;const{value:_e,done:et}=await this._reader.read();return et?{value:_e,done:et}:(this._loaded+=_e.byteLength,(rt=this.onProgress)==null||rt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:d(_e),done:!1})}cancel(_e){var et;(et=this._reader)==null||et.cancel(_e),this._abortController.abort()}}class b{constructor(_e,et,rt){this._stream=_e,this._reader=null,this._loaded=0;const tt=_e.source;this._withCredentials=tt.withCredentials||!1,this._readCapability=new s.PromiseCapability,this._isStreamingSupported=!tt.disableStream,this._abortController=new AbortController,this._headers=h(this._stream.httpHeaders),this._headers.append("Range",`bytes=${et}-${rt-1}`);const it=tt.url;fetch(it,c(this._headers,this._withCredentials,this._abortController)).then(nt=>{if(!(0,o.validateResponseStatus)(nt.status))throw(0,o.createResponseStatusError)(nt.status,it);this._readCapability.resolve(),this._reader=nt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var rt;await this._readCapability.promise;const{value:_e,done:et}=await this._reader.read();return et?{value:_e,done:et}:(this._loaded+=_e.byteLength,(rt=this.onProgress)==null||rt.call(this,{loaded:this._loaded}),{value:d(_e),done:!1})}cancel(_e){var et;(et=this._reader)==null||et.cancel(_e),this._abortController.abort()}}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=g,i.extractFilenameFromHeader=d,i.validateRangeRequestCapabilities=h,i.validateResponseStatus=_;var s=a(1),o=a(21),c=a(6);function h({getResponseHeader:b,isHttp:j,rangeChunkSize:_e,disableRange:et}){const rt={allowRangeRequests:!1,suggestedLength:void 0},tt=parseInt(b("Content-Length"),10);return!Number.isInteger(tt)||(rt.suggestedLength=tt,tt<=2*_e)||et||!j||b("Accept-Ranges")!=="bytes"||(b("Content-Encoding")||"identity")!=="identity"||(rt.allowRangeRequests=!0),rt}function d(b){const j=b("Content-Disposition");if(j){let _e=(0,o.getFilenameFromContentDispositionHeader)(j);if(_e.includes("%"))try{_e=decodeURIComponent(_e)}catch{}if((0,c.isPdfFile)(_e))return _e}return null}function g(b,j){return b===404||b===0&&j.startsWith("file:")?new s.MissingPDFException('Missing PDF "'+j+'".'):new s.UnexpectedResponseException(`Unexpected server response (${b}) while retrieving PDF "${j}".`,b)}function _(b){return b===200||b===206}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=o;var s=a(1);function o(c){let h=!0,d=g("filename\\*","i").exec(c);if(d){d=d[1];let tt=_e(d);return tt=unescape(tt),tt=et(tt),tt=rt(tt),b(tt)}if(d=j(c),d){const tt=rt(d);return b(tt)}if(d=g("filename","i").exec(c),d){d=d[1];let tt=_e(d);return tt=rt(tt),b(tt)}function g(tt,it){return new RegExp("(?:^|;)\\s*"+tt+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',it)}function _(tt,it){if(tt){if(!/^[\x00-\xFF]+$/.test(it))return it;try{const nt=new TextDecoder(tt,{fatal:!0}),at=(0,s.stringToBytes)(it);it=nt.decode(at),h=!1}catch{}}return it}function b(tt){return h&&/[\x80-\xff]/.test(tt)&&(tt=_("utf-8",tt),h&&(tt=_("iso-8859-1",tt))),tt}function j(tt){const it=[];let nt;const at=g("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(nt=at.exec(tt))!==null;){let[,dt,lt,ut]=nt;if(dt=parseInt(dt,10),dt in it){if(dt===0)break;continue}it[dt]=[lt,ut]}const st=[];for(let dt=0;dt<it.length&&dt in it;++dt){let[lt,ut]=it[dt];ut=_e(ut),lt&&(ut=unescape(ut),dt===0&&(ut=et(ut))),st.push(ut)}return st.join("")}function _e(tt){if(tt.startsWith('"')){const it=tt.slice(1).split('\\"');for(let nt=0;nt<it.length;++nt){const at=it[nt].indexOf('"');at!==-1&&(it[nt]=it[nt].slice(0,at),it.length=nt+1),it[nt]=it[nt].replaceAll(/\\(.)/g,"$1")}tt=it.join('"')}return tt}function et(tt){const it=tt.indexOf("'");if(it===-1)return tt;const nt=tt.slice(0,it),st=tt.slice(it+1).replace(/^[^']*'/,"");return _(nt,st)}function rt(tt){return!tt.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(tt)?tt:tt.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(it,nt,at,st){if(at==="q"||at==="Q")return st=st.replaceAll("_"," "),st=st.replaceAll(/=([0-9a-fA-F]{2})/g,function(dt,lt){return String.fromCharCode(parseInt(lt,16))}),_(nt,st);try{st=atob(st)}catch{}return _(nt,st)})}return""}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var s=a(1),o=a(20);const c=200,h=206;function d(_e){const et=_e.response;return typeof et!="string"?et:(0,s.stringToBytes)(et).buffer}class g{constructor(et,rt={}){this.url=et,this.isHttp=/^https?:/i.test(et),this.httpHeaders=this.isHttp&&rt.httpHeaders||Object.create(null),this.withCredentials=rt.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(et,rt,tt){const it={begin:et,end:rt};for(const nt in tt)it[nt]=tt[nt];return this.request(it)}requestFull(et){return this.request(et)}request(et){const rt=new XMLHttpRequest,tt=this.currXhrId++,it=this.pendingRequests[tt]={xhr:rt};rt.open("GET",this.url),rt.withCredentials=this.withCredentials;for(const nt in this.httpHeaders){const at=this.httpHeaders[nt];at!==void 0&&rt.setRequestHeader(nt,at)}return this.isHttp&&"begin"in et&&"end"in et?(rt.setRequestHeader("Range",`bytes=${et.begin}-${et.end-1}`),it.expectedStatus=h):it.expectedStatus=c,rt.responseType="arraybuffer",et.onError&&(rt.onerror=function(nt){et.onError(rt.status)}),rt.onreadystatechange=this.onStateChange.bind(this,tt),rt.onprogress=this.onProgress.bind(this,tt),it.onHeadersReceived=et.onHeadersReceived,it.onDone=et.onDone,it.onError=et.onError,it.onProgress=et.onProgress,rt.send(null),tt}onProgress(et,rt){var it;const tt=this.pendingRequests[et];tt&&((it=tt.onProgress)==null||it.call(tt,rt))}onStateChange(et,rt){var dt,lt,ut;const tt=this.pendingRequests[et];if(!tt)return;const it=tt.xhr;if(it.readyState>=2&&tt.onHeadersReceived&&(tt.onHeadersReceived(),delete tt.onHeadersReceived),it.readyState!==4||!(et in this.pendingRequests))return;if(delete this.pendingRequests[et],it.status===0&&this.isHttp){(dt=tt.onError)==null||dt.call(tt,it.status);return}const nt=it.status||c;if(!(nt===c&&tt.expectedStatus===h)&&nt!==tt.expectedStatus){(lt=tt.onError)==null||lt.call(tt,it.status);return}const st=d(it);if(nt===h){const ot=it.getResponseHeader("Content-Range"),ft=/bytes (\d+)-(\d+)\/(\d+)/.exec(ot);tt.onDone({begin:parseInt(ft[1],10),chunk:st})}else st?tt.onDone({begin:0,chunk:st}):(ut=tt.onError)==null||ut.call(tt,it.status)}getRequestXhr(et){return this.pendingRequests[et].xhr}isPendingRequest(et){return et in this.pendingRequests}abortRequest(et){const rt=this.pendingRequests[et].xhr;delete this.pendingRequests[et],rt.abort()}}class _{constructor(et){this._source=et,this._manager=new g(et.url,{httpHeaders:et.httpHeaders,withCredentials:et.withCredentials}),this._rangeChunkSize=et.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(et){const rt=this._rangeRequestReaders.indexOf(et);rt>=0&&this._rangeRequestReaders.splice(rt,1)}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new b(this._manager,this._source),this._fullRequestReader}getRangeReader(et,rt){const tt=new j(this._manager,et,rt);return tt.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(tt),tt}cancelAllRequests(et){var rt;(rt=this._fullRequestReader)==null||rt.cancel(et);for(const tt of this._rangeRequestReaders.slice(0))tt.cancel(et)}}i.PDFNetworkStream=_;class b{constructor(et,rt){this._manager=et;const tt={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=rt.url,this._fullRequestId=et.requestFull(tt),this._headersReceivedCapability=new s.PromiseCapability,this._disableRange=rt.disableRange||!1,this._contentLength=rt.length,this._rangeChunkSize=rt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const et=this._fullRequestId,rt=this._manager.getRequestXhr(et),tt=at=>rt.getResponseHeader(at),{allowRangeRequests:it,suggestedLength:nt}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:tt,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});it&&(this._isRangeSupported=!0),this._contentLength=nt||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(tt),this._isRangeSupported&&this._manager.abortRequest(et),this._headersReceivedCapability.resolve()}_onDone(et){if(et&&(this._requests.length>0?this._requests.shift().resolve({value:et.chunk,done:!1}):this._cachedChunks.push(et.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const rt of this._requests)rt.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(et){this._storedError=(0,o.createResponseStatusError)(et,this._url),this._headersReceivedCapability.reject(this._storedError);for(const rt of this._requests)rt.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(et){var rt;(rt=this.onProgress)==null||rt.call(this,{loaded:et.loaded,total:et.lengthComputable?et.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const et=new s.PromiseCapability;return this._requests.push(et),et.promise}cancel(et){this._done=!0,this._headersReceivedCapability.reject(et);for(const rt of this._requests)rt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(et,rt,tt){this._manager=et;const it={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=et.url,this._requestId=et.requestRange(rt,tt,it),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var et;(et=this.onClosed)==null||et.call(this,this)}_onDone(et){const rt=et.chunk;this._requests.length>0?this._requests.shift().resolve({value:rt,done:!1}):this._queuedChunk=rt,this._done=!0;for(const tt of this._requests)tt.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(et){this._storedError=(0,o.createResponseStatusError)(et,this._url);for(const rt of this._requests)rt.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(et){var rt;this.isStreamingSupported||(rt=this.onProgress)==null||rt.call(this,{loaded:et.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const rt=this._queuedChunk;return this._queuedChunk=null,{value:rt,done:!1}}if(this._done)return{value:void 0,done:!0};const et=new s.PromiseCapability;return this._requests.push(et),et.promise}cancel(et){this._done=!0;for(const rt of this._requests)rt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var s=a(1),o=a(20);const c=/^file:\/\/\/[a-zA-Z]:\//;function h(tt){const it=require$$5,nt=it.parse(tt);return nt.protocol==="file:"||nt.host?nt:/^[a-z]:[/\\]/i.test(tt)?it.parse(`file:///${tt}`):(nt.host||(nt.protocol="file:"),nt)}class d{constructor(it){this.source=it,this.url=h(it.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&it.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var it;return((it=this._fullRequestReader)==null?void 0:it._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new et(this):new j(this),this._fullRequestReader}getRangeReader(it,nt){if(nt<=this._progressiveDataLength)return null;const at=this.isFsUrl?new rt(this,it,nt):new _e(this,it,nt);return this._rangeRequestReaders.push(at),at}cancelAllRequests(it){var nt;(nt=this._fullRequestReader)==null||nt.cancel(it);for(const at of this._rangeRequestReaders.slice(0))at.cancel(it)}}i.PDFNodeStream=d;class g{constructor(it){this._url=it.url,this._done=!1,this._storedError=null,this.onProgress=null;const nt=it.source;this._contentLength=nt.length,this._loaded=0,this._filename=null,this._disableRange=nt.disableRange||!1,this._rangeChunkSize=nt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!nt.disableStream,this._isRangeSupported=!nt.disableRange,this._readableStream=null,this._readCapability=new s.PromiseCapability,this._headersCapability=new s.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var at;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const it=this._readableStream.read();return it===null?(this._readCapability=new s.PromiseCapability,this.read()):(this._loaded+=it.length,(at=this.onProgress)==null||at.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(it).buffer,done:!1})}cancel(it){if(!this._readableStream){this._error(it);return}this._readableStream.destroy(it)}_error(it){this._storedError=it,this._readCapability.resolve()}_setReadableStream(it){this._readableStream=it,it.on("readable",()=>{this._readCapability.resolve()}),it.on("end",()=>{it.destroy(),this._done=!0,this._readCapability.resolve()}),it.on("error",nt=>{this._error(nt)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new s.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _{constructor(it){this._url=it.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new s.PromiseCapability;const nt=it.source;this._isStreamingSupported=!nt.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var at;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const it=this._readableStream.read();return it===null?(this._readCapability=new s.PromiseCapability,this.read()):(this._loaded+=it.length,(at=this.onProgress)==null||at.call(this,{loaded:this._loaded}),{value:new Uint8Array(it).buffer,done:!1})}cancel(it){if(!this._readableStream){this._error(it);return}this._readableStream.destroy(it)}_error(it){this._storedError=it,this._readCapability.resolve()}_setReadableStream(it){this._readableStream=it,it.on("readable",()=>{this._readCapability.resolve()}),it.on("end",()=>{it.destroy(),this._done=!0,this._readCapability.resolve()}),it.on("error",nt=>{this._error(nt)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function b(tt,it){return{protocol:tt.protocol,auth:tt.auth,host:tt.hostname,port:tt.port,path:tt.path,method:"GET",headers:it}}class j extends g{constructor(it){super(it);const nt=at=>{if(at.statusCode===404){const ut=new s.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ut,this._headersCapability.reject(ut);return}this._headersCapability.resolve(),this._setReadableStream(at);const st=ut=>this._readableStream.headers[ut.toLowerCase()],{allowRangeRequests:dt,suggestedLength:lt}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:st,isHttp:it.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=dt,this._contentLength=lt||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(st)};if(this._request=null,this._url.protocol==="http:"){const at=require$$5;this._request=at.request(b(this._url,it.httpHeaders),nt)}else{const at=require$$5;this._request=at.request(b(this._url,it.httpHeaders),nt)}this._request.on("error",at=>{this._storedError=at,this._headersCapability.reject(at)}),this._request.end()}}class _e extends _{constructor(it,nt,at){super(it),this._httpHeaders={};for(const dt in it.httpHeaders){const lt=it.httpHeaders[dt];lt!==void 0&&(this._httpHeaders[dt]=lt)}this._httpHeaders.Range=`bytes=${nt}-${at-1}`;const st=dt=>{if(dt.statusCode===404){const lt=new s.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=lt;return}this._setReadableStream(dt)};if(this._request=null,this._url.protocol==="http:"){const dt=require$$5;this._request=dt.request(b(this._url,this._httpHeaders),st)}else{const dt=require$$5;this._request=dt.request(b(this._url,this._httpHeaders),st)}this._request.on("error",dt=>{this._storedError=dt}),this._request.end()}}class et extends g{constructor(it){super(it);let nt=decodeURIComponent(this._url.path);c.test(this._url.href)&&(nt=nt.replace(/^\//,""));const at=require$$5;at.lstat(nt,(st,dt)=>{if(st){st.code==="ENOENT"&&(st=new s.MissingPDFException(`Missing PDF "${nt}".`)),this._storedError=st,this._headersCapability.reject(st);return}this._contentLength=dt.size,this._setReadableStream(at.createReadStream(nt)),this._headersCapability.resolve()})}}class rt extends _{constructor(it,nt,at){super(it);let st=decodeURIComponent(this._url.path);c.test(this._url.href)&&(st=st.replace(/^\//,""));const dt=require$$5;this._setReadableStream(dt.createReadStream(st,{start:nt,end:at-1}))}}},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var s=a(6),o=a(1);const c={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/1999/xlink",g=["butt","round","square"],_=["miter","round","bevel"],b=function(dt,lt="",ut=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!ut)return URL.createObjectURL(new Blob([dt],{type:lt}));const ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let ft=`data:${lt};base64,`;for(let pt=0,St=dt.length;pt<St;pt+=3){const gt=dt[pt]&255,vt=dt[pt+1]&255,At=dt[pt+2]&255,Gt=gt>>2,Nt=(gt&3)<<4|vt>>4,Ht=pt+1<St?(vt&15)<<2|At>>6:64,It=pt+2<St?At&63:64;ft+=ot[Gt]+ot[Nt]+ot[Ht]+ot[It]}return ft},j=function(){const dt=new Uint8Array([137,80,78,71,13,10,26,10]),lt=12,ut=new Int32Array(256);for(let At=0;At<256;At++){let Gt=At;for(let Nt=0;Nt<8;Nt++)Gt=Gt&1?3988292384^Gt>>1&2147483647:Gt>>1&2147483647;ut[At]=Gt}function ot(At,Gt,Nt){let Ht=-1;for(let It=Gt;It<Nt;It++){const Wt=(Ht^At[It])&255,yt=ut[Wt];Ht=Ht>>>8^yt}return Ht^-1}function ft(At,Gt,Nt,Ht){let It=Ht;const Wt=Gt.length;Nt[It]=Wt>>24&255,Nt[It+1]=Wt>>16&255,Nt[It+2]=Wt>>8&255,Nt[It+3]=Wt&255,It+=4,Nt[It]=At.charCodeAt(0)&255,Nt[It+1]=At.charCodeAt(1)&255,Nt[It+2]=At.charCodeAt(2)&255,Nt[It+3]=At.charCodeAt(3)&255,It+=4,Nt.set(Gt,It),It+=Gt.length;const yt=ot(Nt,Ht+4,It);Nt[It]=yt>>24&255,Nt[It+1]=yt>>16&255,Nt[It+2]=yt>>8&255,Nt[It+3]=yt&255}function pt(At,Gt,Nt){let Ht=1,It=0;for(let Wt=Gt;Wt<Nt;++Wt)Ht=(Ht+(At[Wt]&255))%65521,It=(It+Ht)%65521;return It<<16|Ht}function St(At){if(!o.isNodeJS)return gt(At);try{const Gt=parseInt(process.versions.node)>=8?At:Buffer.from(At),Nt=require$$5.deflateSync(Gt,{level:9});return Nt instanceof Uint8Array?Nt:new Uint8Array(Nt)}catch(Gt){(0,o.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Gt)}return gt(At)}function gt(At){let Gt=At.length;const Nt=65535,Ht=Math.ceil(Gt/Nt),It=new Uint8Array(2+Gt+Ht*5+4);let Wt=0;It[Wt++]=120,It[Wt++]=156;let yt=0;for(;Gt>Nt;)It[Wt++]=0,It[Wt++]=255,It[Wt++]=255,It[Wt++]=0,It[Wt++]=0,It.set(At.subarray(yt,yt+Nt),Wt),Wt+=Nt,yt+=Nt,Gt-=Nt;It[Wt++]=1,It[Wt++]=Gt&255,It[Wt++]=Gt>>8&255,It[Wt++]=~Gt&65535&255,It[Wt++]=(~Gt&65535)>>8&255,It.set(At.subarray(yt),Wt),Wt+=At.length-yt;const Dt=pt(At,0,At.length);return It[Wt++]=Dt>>24&255,It[Wt++]=Dt>>16&255,It[Wt++]=Dt>>8&255,It[Wt++]=Dt&255,It}function vt(At,Gt,Nt,Ht){const It=At.width,Wt=At.height;let yt,Dt,$t;const _t=At.data;switch(Gt){case o.ImageKind.GRAYSCALE_1BPP:Dt=0,yt=1,$t=It+7>>3;break;case o.ImageKind.RGB_24BPP:Dt=2,yt=8,$t=It*3;break;case o.ImageKind.RGBA_32BPP:Dt=6,yt=8,$t=It*4;break;default:throw new Error("invalid format")}const ht=new Uint8Array((1+$t)*Wt);let ct=0,xt=0;for(let er=0;er<Wt;++er)ht[ct++]=0,ht.set(_t.subarray(xt,xt+$t),ct),xt+=$t,ct+=$t;if(Gt===o.ImageKind.GRAYSCALE_1BPP&&Ht){ct=0;for(let er=0;er<Wt;er++){ct++;for(let Tt=0;Tt<$t;Tt++)ht[ct++]^=255}}const Et=new Uint8Array([It>>24&255,It>>16&255,It>>8&255,It&255,Wt>>24&255,Wt>>16&255,Wt>>8&255,Wt&255,yt,Dt,0,0,0]),bt=St(ht),Ct=dt.length+lt*3+Et.length+bt.length,Ot=new Uint8Array(Ct);let jt=0;return Ot.set(dt,jt),jt+=dt.length,ft("IHDR",Et,Ot,jt),jt+=lt+Et.length,ft("IDATA",bt,Ot,jt),jt+=lt+bt.length,ft("IEND",new Uint8Array(0),Ot,jt),b(Ot,"image/png",Nt)}return function(Gt,Nt,Ht){const It=Gt.kind===void 0?o.ImageKind.GRAYSCALE_1BPP:Gt.kind;return vt(Gt,It,Nt,Ht)}}();class _e{constructor(){this.fontSizeScale=1,this.fontWeight=c.fontWeight,this.fontSize=0,this.textMatrix=o.IDENTITY_MATRIX,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=o.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=c.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(lt,ut){this.x=lt,this.y=ut}}function et(dt){let lt=[];const ut=[];for(const ot of dt){if(ot.fn==="save"){lt.push({fnId:92,fn:"group",items:[]}),ut.push(lt),lt=lt.at(-1).items;continue}ot.fn==="restore"?lt=ut.pop():lt.push(ot)}return lt}function rt(dt){if(Number.isInteger(dt))return dt.toString();const lt=dt.toFixed(10);let ut=lt.length-1;if(lt[ut]!=="0")return lt;do ut--;while(lt[ut]==="0");return lt.substring(0,lt[ut]==="."?ut:ut+1)}function tt(dt){if(dt[4]===0&&dt[5]===0){if(dt[1]===0&&dt[2]===0)return dt[0]===1&&dt[3]===1?"":`scale(${rt(dt[0])} ${rt(dt[3])})`;if(dt[0]===dt[3]&&dt[1]===-dt[2]){const lt=Math.acos(dt[0])*180/Math.PI;return`rotate(${rt(lt)})`}}else if(dt[0]===1&&dt[1]===0&&dt[2]===0&&dt[3]===1)return`translate(${rt(dt[4])} ${rt(dt[5])})`;return`matrix(${rt(dt[0])} ${rt(dt[1])} ${rt(dt[2])} ${rt(dt[3])} ${rt(dt[4])} ${rt(dt[5])})`}let it=0,nt=0,at=0;class st{constructor(lt,ut,ot=!1){(0,s.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new s.DOMSVGFactory,this.current=new _e,this.transformMatrix=o.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=lt,this.objs=ut,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!ot,this._operatorIdMapping=[];for(const ft in o.OPS)this._operatorIdMapping[o.OPS[ft]]=ft}getObject(lt,ut=null){return typeof lt=="string"?lt.startsWith("g_")?this.commonObjs.get(lt):this.objs.get(lt):ut}save(){this.transformStack.push(this.transformMatrix);const lt=this.current;this.extraStack.push(lt),this.current=lt.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(lt){this.save(),this.executeOpTree(lt),this.restore()}loadDependencies(lt){const ut=lt.fnArray,ot=lt.argsArray;for(let ft=0,pt=ut.length;ft<pt;ft++)if(ut[ft]===o.OPS.dependency)for(const St of ot[ft]){const gt=St.startsWith("g_")?this.commonObjs:this.objs,vt=new Promise(At=>{gt.get(St,At)});this.current.dependencies.push(vt)}return Promise.all(this.current.dependencies)}transform(lt,ut,ot,ft,pt,St){const gt=[lt,ut,ot,ft,pt,St];this.transformMatrix=o.Util.transform(this.transformMatrix,gt),this.tgrp=null}getSVG(lt,ut){this.viewport=ut;const ot=this._initialize(ut);return this.loadDependencies(lt).then(()=>(this.transformMatrix=o.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(lt)),ot))}convertOpList(lt){const ut=this._operatorIdMapping,ot=lt.argsArray,ft=lt.fnArray,pt=[];for(let St=0,gt=ft.length;St<gt;St++){const vt=ft[St];pt.push({fnId:vt,fn:ut[vt],args:ot[St]})}return et(pt)}executeOpTree(lt){for(const ut of lt){const ot=ut.fn,ft=ut.fnId,pt=ut.args;switch(ft|0){case o.OPS.beginText:this.beginText();break;case o.OPS.dependency:break;case o.OPS.setLeading:this.setLeading(pt);break;case o.OPS.setLeadingMoveText:this.setLeadingMoveText(pt[0],pt[1]);break;case o.OPS.setFont:this.setFont(pt);break;case o.OPS.showText:this.showText(pt[0]);break;case o.OPS.showSpacedText:this.showText(pt[0]);break;case o.OPS.endText:this.endText();break;case o.OPS.moveText:this.moveText(pt[0],pt[1]);break;case o.OPS.setCharSpacing:this.setCharSpacing(pt[0]);break;case o.OPS.setWordSpacing:this.setWordSpacing(pt[0]);break;case o.OPS.setHScale:this.setHScale(pt[0]);break;case o.OPS.setTextMatrix:this.setTextMatrix(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]);break;case o.OPS.setTextRise:this.setTextRise(pt[0]);break;case o.OPS.setTextRenderingMode:this.setTextRenderingMode(pt[0]);break;case o.OPS.setLineWidth:this.setLineWidth(pt[0]);break;case o.OPS.setLineJoin:this.setLineJoin(pt[0]);break;case o.OPS.setLineCap:this.setLineCap(pt[0]);break;case o.OPS.setMiterLimit:this.setMiterLimit(pt[0]);break;case o.OPS.setFillRGBColor:this.setFillRGBColor(pt[0],pt[1],pt[2]);break;case o.OPS.setStrokeRGBColor:this.setStrokeRGBColor(pt[0],pt[1],pt[2]);break;case o.OPS.setStrokeColorN:this.setStrokeColorN(pt);break;case o.OPS.setFillColorN:this.setFillColorN(pt);break;case o.OPS.shadingFill:this.shadingFill(pt[0]);break;case o.OPS.setDash:this.setDash(pt[0],pt[1]);break;case o.OPS.setRenderingIntent:this.setRenderingIntent(pt[0]);break;case o.OPS.setFlatness:this.setFlatness(pt[0]);break;case o.OPS.setGState:this.setGState(pt[0]);break;case o.OPS.fill:this.fill();break;case o.OPS.eoFill:this.eoFill();break;case o.OPS.stroke:this.stroke();break;case o.OPS.fillStroke:this.fillStroke();break;case o.OPS.eoFillStroke:this.eoFillStroke();break;case o.OPS.clip:this.clip("nonzero");break;case o.OPS.eoClip:this.clip("evenodd");break;case o.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.OPS.paintImageXObject:this.paintImageXObject(pt[0]);break;case o.OPS.paintInlineImageXObject:this.paintInlineImageXObject(pt[0]);break;case o.OPS.paintImageMaskXObject:this.paintImageMaskXObject(pt[0]);break;case o.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(pt[0],pt[1]);break;case o.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.OPS.closePath:this.closePath();break;case o.OPS.closeStroke:this.closeStroke();break;case o.OPS.closeFillStroke:this.closeFillStroke();break;case o.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case o.OPS.nextLine:this.nextLine();break;case o.OPS.transform:this.transform(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]);break;case o.OPS.constructPath:this.constructPath(pt[0],pt[1]);break;case o.OPS.endPath:this.endPath();break;case 92:this.group(ut.items);break;default:(0,o.warn)(`Unimplemented operator ${ot}`);break}}}setWordSpacing(lt){this.current.wordSpacing=lt}setCharSpacing(lt){this.current.charSpacing=lt}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(lt,ut,ot,ft,pt,St){const gt=this.current;gt.textMatrix=gt.lineMatrix=[lt,ut,ot,ft,pt,St],gt.textMatrixScale=Math.hypot(lt,ut),gt.x=gt.lineX=0,gt.y=gt.lineY=0,gt.xcoords=[],gt.ycoords=[],gt.tspan=this.svgFactory.createElement("svg:tspan"),gt.tspan.setAttributeNS(null,"font-family",gt.fontFamily),gt.tspan.setAttributeNS(null,"font-size",`${rt(gt.fontSize)}px`),gt.tspan.setAttributeNS(null,"y",rt(-gt.y)),gt.txtElement=this.svgFactory.createElement("svg:text"),gt.txtElement.append(gt.tspan)}beginText(){const lt=this.current;lt.x=lt.lineX=0,lt.y=lt.lineY=0,lt.textMatrix=o.IDENTITY_MATRIX,lt.lineMatrix=o.IDENTITY_MATRIX,lt.textMatrixScale=1,lt.tspan=this.svgFactory.createElement("svg:tspan"),lt.txtElement=this.svgFactory.createElement("svg:text"),lt.txtgrp=this.svgFactory.createElement("svg:g"),lt.xcoords=[],lt.ycoords=[]}moveText(lt,ut){const ot=this.current;ot.x=ot.lineX+=lt,ot.y=ot.lineY+=ut,ot.xcoords=[],ot.ycoords=[],ot.tspan=this.svgFactory.createElement("svg:tspan"),ot.tspan.setAttributeNS(null,"font-family",ot.fontFamily),ot.tspan.setAttributeNS(null,"font-size",`${rt(ot.fontSize)}px`),ot.tspan.setAttributeNS(null,"y",rt(-ot.y))}showText(lt){const ut=this.current,ot=ut.font,ft=ut.fontSize;if(ft===0)return;const pt=ut.fontSizeScale,St=ut.charSpacing,gt=ut.wordSpacing,vt=ut.fontDirection,At=ut.textHScale*vt,Gt=ot.vertical,Nt=Gt?1:-1,Ht=ot.defaultVMetrics,It=ft*ut.fontMatrix[0];let Wt=0;for(const $t of lt){if($t===null){Wt+=vt*gt;continue}else if(typeof $t=="number"){Wt+=Nt*$t*ft/1e3;continue}const _t=($t.isSpace?gt:0)+St,ht=$t.fontChar;let ct,xt,Et=$t.width;if(Gt){let Ct;const Ot=$t.vmetric||Ht;Ct=$t.vmetric?Ot[1]:Et*.5,Ct=-Ct*It;const jt=Ot[2]*It;Et=Ot?-Ot[0]:Et,ct=Ct/pt,xt=(Wt+jt)/pt}else ct=Wt/pt,xt=0;($t.isInFont||ot.missingFile)&&(ut.xcoords.push(ut.x+ct),Gt&&ut.ycoords.push(-ut.y+xt),ut.tspan.textContent+=ht);const bt=Gt?Et*It-_t*vt:Et*It+_t*vt;Wt+=bt}ut.tspan.setAttributeNS(null,"x",ut.xcoords.map(rt).join(" ")),Gt?ut.tspan.setAttributeNS(null,"y",ut.ycoords.map(rt).join(" ")):ut.tspan.setAttributeNS(null,"y",rt(-ut.y)),Gt?ut.y-=Wt:ut.x+=Wt*At,ut.tspan.setAttributeNS(null,"font-family",ut.fontFamily),ut.tspan.setAttributeNS(null,"font-size",`${rt(ut.fontSize)}px`),ut.fontStyle!==c.fontStyle&&ut.tspan.setAttributeNS(null,"font-style",ut.fontStyle),ut.fontWeight!==c.fontWeight&&ut.tspan.setAttributeNS(null,"font-weight",ut.fontWeight);const yt=ut.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;if(yt===o.TextRenderingMode.FILL||yt===o.TextRenderingMode.FILL_STROKE?(ut.fillColor!==c.fillColor&&ut.tspan.setAttributeNS(null,"fill",ut.fillColor),ut.fillAlpha<1&&ut.tspan.setAttributeNS(null,"fill-opacity",ut.fillAlpha)):ut.textRenderingMode===o.TextRenderingMode.ADD_TO_PATH?ut.tspan.setAttributeNS(null,"fill","transparent"):ut.tspan.setAttributeNS(null,"fill","none"),yt===o.TextRenderingMode.STROKE||yt===o.TextRenderingMode.FILL_STROKE){const $t=1/(ut.textMatrixScale||1);this._setStrokeAttributes(ut.tspan,$t)}let Dt=ut.textMatrix;ut.textRise!==0&&(Dt=Dt.slice(),Dt[5]+=ut.textRise),ut.txtElement.setAttributeNS(null,"transform",`${tt(Dt)} scale(${rt(At)}, -1)`),ut.txtElement.setAttributeNS(h,"xml:space","preserve"),ut.txtElement.append(ut.tspan),ut.txtgrp.append(ut.txtElement),this._ensureTransformGroup().append(ut.txtElement)}setLeadingMoveText(lt,ut){this.setLeading(-ut),this.moveText(lt,ut)}addFontStyle(lt){if(!lt.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const ut=b(lt.data,lt.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${lt.loadedName}"; src: url(${ut}); }
`}setFont(lt){const ut=this.current,ot=this.commonObjs.get(lt[0]);let ft=lt[1];ut.font=ot,this.embedFonts&&!ot.missingFile&&!this.embeddedFonts[ot.loadedName]&&(this.addFontStyle(ot),this.embeddedFonts[ot.loadedName]=ot),ut.fontMatrix=ot.fontMatrix||o.FONT_IDENTITY_MATRIX;let pt="normal";ot.black?pt="900":ot.bold&&(pt="bold");const St=ot.italic?"italic":"normal";ft<0?(ft=-ft,ut.fontDirection=-1):ut.fontDirection=1,ut.fontSize=ft,ut.fontFamily=ot.loadedName,ut.fontWeight=pt,ut.fontStyle=St,ut.tspan=this.svgFactory.createElement("svg:tspan"),ut.tspan.setAttributeNS(null,"y",rt(-ut.y)),ut.xcoords=[],ut.ycoords=[]}endText(){var ut;const lt=this.current;lt.textRenderingMode&o.TextRenderingMode.ADD_TO_PATH_FLAG&&((ut=lt.txtElement)!=null&&ut.hasChildNodes())&&(lt.element=lt.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(lt){lt>0&&(this.current.lineWidth=lt)}setLineCap(lt){this.current.lineCap=g[lt]}setLineJoin(lt){this.current.lineJoin=_[lt]}setMiterLimit(lt){this.current.miterLimit=lt}setStrokeAlpha(lt){this.current.strokeAlpha=lt}setStrokeRGBColor(lt,ut,ot){this.current.strokeColor=o.Util.makeHexColor(lt,ut,ot)}setFillAlpha(lt){this.current.fillAlpha=lt}setFillRGBColor(lt,ut,ot){this.current.fillColor=o.Util.makeHexColor(lt,ut,ot),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(lt){this.current.strokeColor=this._makeColorN_Pattern(lt)}setFillColorN(lt){this.current.fillColor=this._makeColorN_Pattern(lt)}shadingFill(lt){const{width:ut,height:ot}=this.viewport,ft=o.Util.inverseTransform(this.transformMatrix),[pt,St,gt,vt]=o.Util.getAxialAlignedBoundingBox([0,0,ut,ot],ft),At=this.svgFactory.createElement("svg:rect");At.setAttributeNS(null,"x",pt),At.setAttributeNS(null,"y",St),At.setAttributeNS(null,"width",gt-pt),At.setAttributeNS(null,"height",vt-St),At.setAttributeNS(null,"fill",this._makeShadingPattern(lt)),this.current.fillAlpha<1&&At.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(At)}_makeColorN_Pattern(lt){return lt[0]==="TilingPattern"?this._makeTilingPattern(lt):this._makeShadingPattern(lt)}_makeTilingPattern(lt){const ut=lt[1],ot=lt[2],ft=lt[3]||o.IDENTITY_MATRIX,[pt,St,gt,vt]=lt[4],At=lt[5],Gt=lt[6],Nt=lt[7],Ht=`shading${at++}`,[It,Wt,yt,Dt]=o.Util.normalizeRect([...o.Util.applyTransform([pt,St],ft),...o.Util.applyTransform([gt,vt],ft)]),[$t,_t]=o.Util.singularValueDecompose2dScale(ft),ht=At*$t,ct=Gt*_t,xt=this.svgFactory.createElement("svg:pattern");xt.setAttributeNS(null,"id",Ht),xt.setAttributeNS(null,"patternUnits","userSpaceOnUse"),xt.setAttributeNS(null,"width",ht),xt.setAttributeNS(null,"height",ct),xt.setAttributeNS(null,"x",`${It}`),xt.setAttributeNS(null,"y",`${Wt}`);const Et=this.svg,bt=this.transformMatrix,Ct=this.current.fillColor,Ot=this.current.strokeColor,jt=this.svgFactory.create(yt-It,Dt-Wt);if(this.svg=jt,this.transformMatrix=ft,Nt===2){const er=o.Util.makeHexColor(...ut);this.current.fillColor=er,this.current.strokeColor=er}return this.executeOpTree(this.convertOpList(ot)),this.svg=Et,this.transformMatrix=bt,this.current.fillColor=Ct,this.current.strokeColor=Ot,xt.append(jt.childNodes[0]),this.defs.append(xt),`url(#${Ht})`}_makeShadingPattern(lt){switch(typeof lt=="string"&&(lt=this.objs.get(lt)),lt[0]){case"RadialAxial":const ut=`shading${at++}`,ot=lt[3];let ft;switch(lt[1]){case"axial":const pt=lt[4],St=lt[5];ft=this.svgFactory.createElement("svg:linearGradient"),ft.setAttributeNS(null,"id",ut),ft.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),ft.setAttributeNS(null,"x1",pt[0]),ft.setAttributeNS(null,"y1",pt[1]),ft.setAttributeNS(null,"x2",St[0]),ft.setAttributeNS(null,"y2",St[1]);break;case"radial":const gt=lt[4],vt=lt[5],At=lt[6],Gt=lt[7];ft=this.svgFactory.createElement("svg:radialGradient"),ft.setAttributeNS(null,"id",ut),ft.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),ft.setAttributeNS(null,"cx",vt[0]),ft.setAttributeNS(null,"cy",vt[1]),ft.setAttributeNS(null,"r",Gt),ft.setAttributeNS(null,"fx",gt[0]),ft.setAttributeNS(null,"fy",gt[1]),ft.setAttributeNS(null,"fr",At);break;default:throw new Error(`Unknown RadialAxial type: ${lt[1]}`)}for(const pt of ot){const St=this.svgFactory.createElement("svg:stop");St.setAttributeNS(null,"offset",pt[0]),St.setAttributeNS(null,"stop-color",pt[1]),ft.append(St)}return this.defs.append(ft),`url(#${ut})`;case"Mesh":return(0,o.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${lt[0]}`)}}setDash(lt,ut){this.current.dashArray=lt,this.current.dashPhase=ut}constructPath(lt,ut){const ot=this.current;let ft=ot.x,pt=ot.y,St=[],gt=0;for(const vt of lt)switch(vt|0){case o.OPS.rectangle:ft=ut[gt++],pt=ut[gt++];const At=ut[gt++],Gt=ut[gt++],Nt=ft+At,Ht=pt+Gt;St.push("M",rt(ft),rt(pt),"L",rt(Nt),rt(pt),"L",rt(Nt),rt(Ht),"L",rt(ft),rt(Ht),"Z");break;case o.OPS.moveTo:ft=ut[gt++],pt=ut[gt++],St.push("M",rt(ft),rt(pt));break;case o.OPS.lineTo:ft=ut[gt++],pt=ut[gt++],St.push("L",rt(ft),rt(pt));break;case o.OPS.curveTo:ft=ut[gt+4],pt=ut[gt+5],St.push("C",rt(ut[gt]),rt(ut[gt+1]),rt(ut[gt+2]),rt(ut[gt+3]),rt(ft),rt(pt)),gt+=6;break;case o.OPS.curveTo2:St.push("C",rt(ft),rt(pt),rt(ut[gt]),rt(ut[gt+1]),rt(ut[gt+2]),rt(ut[gt+3])),ft=ut[gt+2],pt=ut[gt+3],gt+=4;break;case o.OPS.curveTo3:ft=ut[gt+2],pt=ut[gt+3],St.push("C",rt(ut[gt]),rt(ut[gt+1]),rt(ft),rt(pt),rt(ft),rt(pt)),gt+=4;break;case o.OPS.closePath:St.push("Z");break}St=St.join(" "),ot.path&&lt.length>0&&lt[0]!==o.OPS.rectangle&&lt[0]!==o.OPS.moveTo?St=ot.path.getAttributeNS(null,"d")+St:(ot.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(ot.path)),ot.path.setAttributeNS(null,"d",St),ot.path.setAttributeNS(null,"fill","none"),ot.element=ot.path,ot.setCurrentPoint(ft,pt)}endPath(){const lt=this.current;if(lt.path=null,!this.pendingClip)return;if(!lt.element){this.pendingClip=null;return}const ut=`clippath${it++}`,ot=this.svgFactory.createElement("svg:clipPath");ot.setAttributeNS(null,"id",ut),ot.setAttributeNS(null,"transform",tt(this.transformMatrix));const ft=lt.element.cloneNode(!0);if(this.pendingClip==="evenodd"?ft.setAttributeNS(null,"clip-rule","evenodd"):ft.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,ot.append(ft),this.defs.append(ot),lt.activeClipUrl){lt.clipGroup=null;for(const pt of this.extraStack)pt.clipGroup=null;ot.setAttributeNS(null,"clip-path",lt.activeClipUrl)}lt.activeClipUrl=`url(#${ut})`,this.tgrp=null}clip(lt){this.pendingClip=lt}closePath(){const lt=this.current;if(lt.path){const ut=`${lt.path.getAttributeNS(null,"d")}Z`;lt.path.setAttributeNS(null,"d",ut)}}setLeading(lt){this.current.leading=-lt}setTextRise(lt){this.current.textRise=lt}setTextRenderingMode(lt){this.current.textRenderingMode=lt}setHScale(lt){this.current.textHScale=lt/100}setRenderingIntent(lt){}setFlatness(lt){}setGState(lt){for(const[ut,ot]of lt)switch(ut){case"LW":this.setLineWidth(ot);break;case"LC":this.setLineCap(ot);break;case"LJ":this.setLineJoin(ot);break;case"ML":this.setMiterLimit(ot);break;case"D":this.setDash(ot[0],ot[1]);break;case"RI":this.setRenderingIntent(ot);break;case"FL":this.setFlatness(ot);break;case"Font":this.setFont(ot);break;case"CA":this.setStrokeAlpha(ot);break;case"ca":this.setFillAlpha(ot);break;default:(0,o.warn)(`Unimplemented graphic state operator ${ut}`);break}}fill(){const lt=this.current;lt.element&&(lt.element.setAttributeNS(null,"fill",lt.fillColor),lt.element.setAttributeNS(null,"fill-opacity",lt.fillAlpha),this.endPath())}stroke(){const lt=this.current;lt.element&&(this._setStrokeAttributes(lt.element),lt.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(lt,ut=1){const ot=this.current;let ft=ot.dashArray;ut!==1&&ft.length>0&&(ft=ft.map(function(pt){return ut*pt})),lt.setAttributeNS(null,"stroke",ot.strokeColor),lt.setAttributeNS(null,"stroke-opacity",ot.strokeAlpha),lt.setAttributeNS(null,"stroke-miterlimit",rt(ot.miterLimit)),lt.setAttributeNS(null,"stroke-linecap",ot.lineCap),lt.setAttributeNS(null,"stroke-linejoin",ot.lineJoin),lt.setAttributeNS(null,"stroke-width",rt(ut*ot.lineWidth)+"px"),lt.setAttributeNS(null,"stroke-dasharray",ft.map(rt).join(" ")),lt.setAttributeNS(null,"stroke-dashoffset",rt(ut*ot.dashPhase)+"px")}eoFill(){var lt;(lt=this.current.element)==null||lt.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var lt;(lt=this.current.element)==null||lt.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const lt=this.svgFactory.createElement("svg:rect");lt.setAttributeNS(null,"x","0"),lt.setAttributeNS(null,"y","0"),lt.setAttributeNS(null,"width","1px"),lt.setAttributeNS(null,"height","1px"),lt.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(lt)}paintImageXObject(lt){const ut=this.getObject(lt);if(!ut){(0,o.warn)(`Dependent image with object ID ${lt} is not ready yet`);return}this.paintInlineImageXObject(ut)}paintInlineImageXObject(lt,ut){const ot=lt.width,ft=lt.height,pt=j(lt,this.forceDataSchema,!!ut),St=this.svgFactory.createElement("svg:rect");St.setAttributeNS(null,"x","0"),St.setAttributeNS(null,"y","0"),St.setAttributeNS(null,"width",rt(ot)),St.setAttributeNS(null,"height",rt(ft)),this.current.element=St,this.clip("nonzero");const gt=this.svgFactory.createElement("svg:image");gt.setAttributeNS(d,"xlink:href",pt),gt.setAttributeNS(null,"x","0"),gt.setAttributeNS(null,"y",rt(-ft)),gt.setAttributeNS(null,"width",rt(ot)+"px"),gt.setAttributeNS(null,"height",rt(ft)+"px"),gt.setAttributeNS(null,"transform",`scale(${rt(1/ot)} ${rt(-1/ft)})`),ut?ut.append(gt):this._ensureTransformGroup().append(gt)}paintImageMaskXObject(lt){const ut=this.getObject(lt.data,lt);if(ut.bitmap){(0,o.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const ot=this.current,ft=ut.width,pt=ut.height,St=ot.fillColor;ot.maskId=`mask${nt++}`;const gt=this.svgFactory.createElement("svg:mask");gt.setAttributeNS(null,"id",ot.maskId);const vt=this.svgFactory.createElement("svg:rect");vt.setAttributeNS(null,"x","0"),vt.setAttributeNS(null,"y","0"),vt.setAttributeNS(null,"width",rt(ft)),vt.setAttributeNS(null,"height",rt(pt)),vt.setAttributeNS(null,"fill",St),vt.setAttributeNS(null,"mask",`url(#${ot.maskId})`),this.defs.append(gt),this._ensureTransformGroup().append(vt),this.paintInlineImageXObject(ut,gt)}paintFormXObjectBegin(lt,ut){if(Array.isArray(lt)&&lt.length===6&&this.transform(lt[0],lt[1],lt[2],lt[3],lt[4],lt[5]),ut){const ot=ut[2]-ut[0],ft=ut[3]-ut[1],pt=this.svgFactory.createElement("svg:rect");pt.setAttributeNS(null,"x",ut[0]),pt.setAttributeNS(null,"y",ut[1]),pt.setAttributeNS(null,"width",rt(ot)),pt.setAttributeNS(null,"height",rt(ft)),this.current.element=pt,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(lt){const ut=this.svgFactory.create(lt.width,lt.height),ot=this.svgFactory.createElement("svg:defs");ut.append(ot),this.defs=ot;const ft=this.svgFactory.createElement("svg:g");return ft.setAttributeNS(null,"transform",tt(lt.transform)),ut.append(ft),this.svg=ft,ut}_ensureClipGroup(){if(!this.current.clipGroup){const lt=this.svgFactory.createElement("svg:g");lt.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(lt),this.current.clipGroup=lt}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",tt(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}i.SVGGraphics=st},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class a{static textContent(o){const c=[],h={items:c,styles:Object.create(null)};function d(g){var j;if(!g)return;let _=null;const b=g.name;if(b==="#text")_=g.value;else if(a.shouldBuildText(b))(j=g==null?void 0:g.attributes)!=null&&j.textContent?_=g.attributes.textContent:g.value&&(_=g.value);else return;if(_!==null&&c.push({str:_}),!!g.children)for(const _e of g.children)d(_e)}return d(o),h}static shouldBuildText(o){return!(o==="textarea"||o==="input"||o==="option"||o==="select")}}i.XfaText=a},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=tt,i.updateTextLayer=it;var s=a(1),o=a(6);const c=1e5,h=30,d=.8,g=new Map;function _(nt,at){let st;if(at&&s.FeatureTest.isOffscreenCanvasSupported)st=new OffscreenCanvas(nt,nt).getContext("2d",{alpha:!1});else{const dt=document.createElement("canvas");dt.width=dt.height=nt,st=dt.getContext("2d",{alpha:!1})}return st}function b(nt,at){const st=g.get(nt);if(st)return st;const dt=_(h,at);dt.font=`${h}px ${nt}`;const lt=dt.measureText("");let ut=lt.fontBoundingBoxAscent,ot=Math.abs(lt.fontBoundingBoxDescent);if(ut){const pt=ut/(ut+ot);return g.set(nt,pt),dt.canvas.width=dt.canvas.height=0,pt}dt.strokeStyle="red",dt.clearRect(0,0,h,h),dt.strokeText("g",0,0);let ft=dt.getImageData(0,0,h,h).data;ot=0;for(let pt=ft.length-1-3;pt>=0;pt-=4)if(ft[pt]>0){ot=Math.ceil(pt/4/h);break}dt.clearRect(0,0,h,h),dt.strokeText("A",0,h),ft=dt.getImageData(0,0,h,h).data,ut=0;for(let pt=0,St=ft.length;pt<St;pt+=4)if(ft[pt]>0){ut=h-Math.floor(pt/4/h);break}if(dt.canvas.width=dt.canvas.height=0,ut){const pt=ut/(ut+ot);return g.set(nt,pt),pt}return g.set(nt,d),d}function j(nt,at,st){const dt=document.createElement("span"),lt={angle:0,canvasWidth:0,hasText:at.str!=="",hasEOL:at.hasEOL,fontSize:0};nt._textDivs.push(dt);const ut=s.Util.transform(nt._transform,at.transform);let ot=Math.atan2(ut[1],ut[0]);const ft=st[at.fontName];ft.vertical&&(ot+=Math.PI/2);const pt=Math.hypot(ut[2],ut[3]),St=pt*b(ft.fontFamily,nt._isOffscreenCanvasSupported);let gt,vt;ot===0?(gt=ut[4],vt=ut[5]-St):(gt=ut[4]+St*Math.sin(ot),vt=ut[5]-St*Math.cos(ot));const At="calc(var(--scale-factor)*",Gt=dt.style;nt._container===nt._rootContainer?(Gt.left=`${(100*gt/nt._pageWidth).toFixed(2)}%`,Gt.top=`${(100*vt/nt._pageHeight).toFixed(2)}%`):(Gt.left=`${At}${gt.toFixed(2)}px)`,Gt.top=`${At}${vt.toFixed(2)}px)`),Gt.fontSize=`${At}${pt.toFixed(2)}px)`,Gt.fontFamily=ft.fontFamily,lt.fontSize=pt,dt.setAttribute("role","presentation"),dt.textContent=at.str,dt.dir=at.dir,nt._fontInspectorEnabled&&(dt.dataset.fontName=at.fontName),ot!==0&&(lt.angle=ot*(180/Math.PI));let Nt=!1;if(at.str.length>1)Nt=!0;else if(at.str!==" "&&at.transform[0]!==at.transform[3]){const Ht=Math.abs(at.transform[0]),It=Math.abs(at.transform[3]);Ht!==It&&Math.max(Ht,It)/Math.min(Ht,It)>1.5&&(Nt=!0)}Nt&&(lt.canvasWidth=ft.vertical?at.height:at.width),nt._textDivProperties.set(dt,lt),nt._isReadableStream&&nt._layoutText(dt)}function _e(nt){const{div:at,scale:st,properties:dt,ctx:lt,prevFontSize:ut,prevFontFamily:ot}=nt,{style:ft}=at;let pt="";if(dt.canvasWidth!==0&&dt.hasText){const{fontFamily:St}=ft,{canvasWidth:gt,fontSize:vt}=dt;(ut!==vt||ot!==St)&&(lt.font=`${vt*st}px ${St}`,nt.prevFontSize=vt,nt.prevFontFamily=St);const{width:At}=lt.measureText(at.textContent);At>0&&(pt=`scaleX(${gt*st/At})`)}dt.angle!==0&&(pt=`rotate(${dt.angle}deg) ${pt}`),pt.length>0&&(ft.transform=pt)}function et(nt){if(nt._canceled)return;const at=nt._textDivs,st=nt._capability;if(at.length>c){st.resolve();return}if(!nt._isReadableStream)for(const lt of at)nt._layoutText(lt);st.resolve()}class rt{constructor({textContentSource:at,container:st,viewport:dt,textDivs:lt,textDivProperties:ut,textContentItemsStr:ot,isOffscreenCanvasSupported:ft}){var At;this._textContentSource=at,this._isReadableStream=at instanceof ReadableStream,this._container=this._rootContainer=st,this._textDivs=lt||[],this._textContentItemsStr=ot||[],this._isOffscreenCanvasSupported=ft,this._fontInspectorEnabled=!!((At=globalThis.FontInspector)!=null&&At.enabled),this._reader=null,this._textDivProperties=ut||new WeakMap,this._canceled=!1,this._capability=new s.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:dt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:_(0,ft)};const{pageWidth:pt,pageHeight:St,pageX:gt,pageY:vt}=dt.rawDims;this._transform=[1,0,0,-1,-gt,vt+St],this._pageWidth=pt,this._pageHeight=St,(0,o.setLayerDimensions)(st,dt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new s.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new s.AbortException("TextLayer task cancelled."))}_processItems(at,st){for(const dt of at){if(dt.str===void 0){if(dt.type==="beginMarkedContentProps"||dt.type==="beginMarkedContent"){const lt=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),dt.id!==null&&this._container.setAttribute("id",`${dt.id}`),lt.append(this._container)}else dt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(dt.str),j(this,dt,st)}}_layoutText(at){const st=this._layoutTextParams.properties=this._textDivProperties.get(at);if(this._layoutTextParams.div=at,_e(this._layoutTextParams),st.hasText&&this._container.append(at),st.hasEOL){const dt=document.createElement("br");dt.setAttribute("role","presentation"),this._container.append(dt)}}_render(){const at=new s.PromiseCapability;let st=Object.create(null);if(this._isReadableStream){const dt=()=>{this._reader.read().then(({value:lt,done:ut})=>{if(ut){at.resolve();return}Object.assign(st,lt.styles),this._processItems(lt.items,st),dt()},at.reject)};this._reader=this._textContentSource.getReader(),dt()}else if(this._textContentSource){const{items:dt,styles:lt}=this._textContentSource;this._processItems(dt,lt),at.resolve()}else throw new Error('No "textContentSource" parameter specified.');at.promise.then(()=>{st=null,et(this)},this._capability.reject)}}i.TextLayerRenderTask=rt;function tt(nt){!nt.textContentSource&&(nt.textContent||nt.textContentStream)&&((0,o.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),nt.textContentSource=nt.textContent||nt.textContentStream);const{container:at,viewport:st}=nt,dt=getComputedStyle(at),lt=dt.getPropertyValue("visibility"),ut=parseFloat(dt.getPropertyValue("--scale-factor"));lt==="visible"&&(!ut||Math.abs(ut-st.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const ot=new rt(nt);return ot._render(),ot}function it({container:nt,viewport:at,textDivs:st,textDivProperties:dt,isOffscreenCanvasSupported:lt,mustRotate:ut=!0,mustRescale:ot=!0}){if(ut&&(0,o.setLayerDimensions)(nt,{rotation:at.rotation}),ot){const ft=_(0,lt),St={prevFontSize:null,prevFontFamily:null,div:null,scale:at.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:ft};for(const gt of st)St.properties=dt.get(gt),St.div=gt,_e(St)}}},(e,i,a)=>{var b,j,_e,et,rt,tt,it,nt,at,st,dt,Qn,Tn,Zn,Jn;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var s=a(1),o=a(4),c=a(28),h=a(33),d=a(6),g=a(34);const pt=class pt{constructor({uiManager:gt,pageIndex:vt,div:At,accessibilityManager:Gt,annotationLayer:Nt,viewport:Ht,l10n:It}){nr(this,dt);nr(this,b);nr(this,j,!1);nr(this,_e,null);nr(this,et,this.pointerup.bind(this));nr(this,rt,this.pointerdown.bind(this));nr(this,tt,new Map);nr(this,it,!1);nr(this,nt,!1);nr(this,at,!1);nr(this,st);const Wt=[c.FreeTextEditor,h.InkEditor,g.StampEditor];if(!pt._initialized){pt._initialized=!0;for(const yt of Wt)yt.initialize(It)}gt.registerEditorTypes(Wt),ir(this,st,gt),this.pageIndex=vt,this.div=At,ir(this,b,Gt),ir(this,_e,Nt),this.viewport=Ht,mt(this,st).addLayer(this)}get isEmpty(){return mt(this,tt).size===0}updateToolbar(gt){mt(this,st).updateToolbar(gt)}updateMode(gt=mt(this,st).getMode()){Qt(this,dt,Jn).call(this),gt===s.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),gt!==s.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",gt===s.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",gt===s.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",gt===s.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(gt){if(!gt&&mt(this,st).getMode()!==s.AnnotationEditorType.INK)return;if(!gt){for(const At of mt(this,tt).values())if(At.isEmpty()){At.setInBackground();return}}Qt(this,dt,Tn).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(gt){mt(this,st).setEditingState(gt)}addCommands(gt){mt(this,st).addCommands(gt)}enable(){this.div.style.pointerEvents="auto";const gt=new Set;for(const At of mt(this,tt).values())At.enableEditing(),At.annotationElementId&&gt.add(At.annotationElementId);if(!mt(this,_e))return;const vt=mt(this,_e).getEditableAnnotations();for(const At of vt){if(At.hide(),mt(this,st).isDeletedAnnotationElement(At.data.id)||gt.has(At.data.id))continue;const Gt=this.deserialize(At);Gt&&(this.addOrRebuild(Gt),Gt.enableEditing())}}disable(){var vt;ir(this,at,!0),this.div.style.pointerEvents="none";const gt=new Set;for(const At of mt(this,tt).values()){if(At.disableEditing(),!At.annotationElementId||At.serialize()!==null){gt.add(At.annotationElementId);continue}(vt=this.getEditableAnnotation(At.annotationElementId))==null||vt.show(),At.remove()}if(mt(this,_e)){const At=mt(this,_e).getEditableAnnotations();for(const Gt of At){const{id:Nt}=Gt.data;gt.has(Nt)||mt(this,st).isDeletedAnnotationElement(Nt)||Gt.show()}}Qt(this,dt,Jn).call(this),this.isEmpty&&(this.div.hidden=!0),ir(this,at,!1)}getEditableAnnotation(gt){var vt;return((vt=mt(this,_e))==null?void 0:vt.getEditableAnnotation(gt))||null}setActiveEditor(gt){mt(this,st).getActive()!==gt&&mt(this,st).setActiveEditor(gt)}enableClick(){this.div.addEventListener("pointerdown",mt(this,rt)),this.div.addEventListener("pointerup",mt(this,et))}disableClick(){this.div.removeEventListener("pointerdown",mt(this,rt)),this.div.removeEventListener("pointerup",mt(this,et))}attach(gt){mt(this,tt).set(gt.id,gt);const{annotationElementId:vt}=gt;vt&&mt(this,st).isDeletedAnnotationElement(vt)&&mt(this,st).removeDeletedAnnotationElement(gt)}detach(gt){var vt;mt(this,tt).delete(gt.id),(vt=mt(this,b))==null||vt.removePointerInTextLayer(gt.contentDiv),!mt(this,at)&&gt.annotationElementId&&mt(this,st).addDeletedAnnotationElement(gt)}remove(gt){this.detach(gt),mt(this,st).removeEditor(gt),gt.div.contains(document.activeElement)&&setTimeout(()=>{mt(this,st).focusMainContainer()},0),gt.div.remove(),gt.isAttachedToDOM=!1,mt(this,nt)||this.addInkEditorIfNeeded(!1)}changeParent(gt){var vt;gt.parent!==this&&(gt.annotationElementId&&(mt(this,st).addDeletedAnnotationElement(gt.annotationElementId),o.AnnotationEditor.deleteAnnotationElement(gt),gt.annotationElementId=null),this.attach(gt),(vt=gt.parent)==null||vt.detach(gt),gt.setParent(this),gt.div&&gt.isAttachedToDOM&&(gt.div.remove(),this.div.append(gt.div)))}add(gt){if(this.changeParent(gt),mt(this,st).addEditor(gt),this.attach(gt),!gt.isAttachedToDOM){const vt=gt.render();this.div.append(vt),gt.isAttachedToDOM=!0}gt.fixAndSetPosition(),gt.onceAdded(),mt(this,st).addToAnnotationStorage(gt)}moveEditorInDOM(gt){var At;if(!gt.isAttachedToDOM)return;const{activeElement:vt}=document;gt.div.contains(vt)&&(gt._focusEventsAllowed=!1,setTimeout(()=>{gt.div.contains(document.activeElement)?gt._focusEventsAllowed=!0:(gt.div.addEventListener("focusin",()=>{gt._focusEventsAllowed=!0},{once:!0}),vt.focus())},0)),gt._structTreeParentId=(At=mt(this,b))==null?void 0:At.moveElementInDOM(this.div,gt.div,gt.contentDiv,!0)}addOrRebuild(gt){gt.needsToBeRebuilt()?gt.rebuild():this.add(gt)}addUndoableEditor(gt){const vt=()=>gt._uiManager.rebuild(gt),At=()=>{gt.remove()};this.addCommands({cmd:vt,undo:At,mustExec:!1})}getNextId(){return mt(this,st).getId()}pasteEditor(gt,vt){mt(this,st).updateToolbar(gt),mt(this,st).updateMode(gt);const{offsetX:At,offsetY:Gt}=Qt(this,dt,Zn).call(this),Nt=this.getNextId(),Ht=Qt(this,dt,Qn).call(this,{parent:this,id:Nt,x:At,y:Gt,uiManager:mt(this,st),isCentered:!0,...vt});Ht&&this.add(Ht)}deserialize(gt){switch(gt.annotationType??gt.annotationEditorType){case s.AnnotationEditorType.FREETEXT:return c.FreeTextEditor.deserialize(gt,this,mt(this,st));case s.AnnotationEditorType.INK:return h.InkEditor.deserialize(gt,this,mt(this,st));case s.AnnotationEditorType.STAMP:return g.StampEditor.deserialize(gt,this,mt(this,st))}return null}addNewEditor(){Qt(this,dt,Tn).call(this,Qt(this,dt,Zn).call(this),!0)}setSelected(gt){mt(this,st).setSelected(gt)}toggleSelected(gt){mt(this,st).toggleSelected(gt)}isSelected(gt){return mt(this,st).isSelected(gt)}unselect(gt){mt(this,st).unselect(gt)}pointerup(gt){const{isMac:vt}=s.FeatureTest.platform;if(!(gt.button!==0||gt.ctrlKey&&vt)&&gt.target===this.div&&mt(this,it)){if(ir(this,it,!1),!mt(this,j)){ir(this,j,!0);return}if(mt(this,st).getMode()===s.AnnotationEditorType.STAMP){mt(this,st).unselectAll();return}Qt(this,dt,Tn).call(this,gt,!1)}}pointerdown(gt){if(mt(this,it)){ir(this,it,!1);return}const{isMac:vt}=s.FeatureTest.platform;if(gt.button!==0||gt.ctrlKey&&vt||gt.target!==this.div)return;ir(this,it,!0);const At=mt(this,st).getActive();ir(this,j,!At||At.isEmpty())}findNewParent(gt,vt,At){const Gt=mt(this,st).findParent(vt,At);return Gt===null||Gt===this?!1:(Gt.changeParent(gt),!0)}destroy(){var gt,vt;((gt=mt(this,st).getActive())==null?void 0:gt.parent)===this&&(mt(this,st).commitOrRemove(),mt(this,st).setActiveEditor(null));for(const At of mt(this,tt).values())(vt=mt(this,b))==null||vt.removePointerInTextLayer(At.contentDiv),At.setParent(null),At.isAttachedToDOM=!1,At.div.remove();this.div=null,mt(this,tt).clear(),mt(this,st).removeLayer(this)}render({viewport:gt}){this.viewport=gt,(0,d.setLayerDimensions)(this.div,gt);for(const vt of mt(this,st).getEditors(this.pageIndex))this.add(vt);this.updateMode()}update({viewport:gt}){mt(this,st).commitOrRemove(),this.viewport=gt,(0,d.setLayerDimensions)(this.div,{rotation:gt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:gt,pageHeight:vt}=this.viewport.rawDims;return[gt,vt]}};b=new WeakMap,j=new WeakMap,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,tt=new WeakMap,it=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakMap,dt=new WeakSet,Qn=function(gt){switch(mt(this,st).getMode()){case s.AnnotationEditorType.FREETEXT:return new c.FreeTextEditor(gt);case s.AnnotationEditorType.INK:return new h.InkEditor(gt);case s.AnnotationEditorType.STAMP:return new g.StampEditor(gt)}return null},Tn=function(gt,vt){const At=this.getNextId(),Gt=Qt(this,dt,Qn).call(this,{parent:this,id:At,x:gt.offsetX,y:gt.offsetY,uiManager:mt(this,st),isCentered:vt});return Gt&&this.add(Gt),Gt},Zn=function(){const{x:gt,y:vt,width:At,height:Gt}=this.div.getBoundingClientRect(),Nt=Math.max(0,gt),Ht=Math.max(0,vt),It=Math.min(window.innerWidth,gt+At),Wt=Math.min(window.innerHeight,vt+Gt),yt=(Nt+It)/2-gt,Dt=(Ht+Wt)/2-vt,[$t,_t]=this.viewport.rotation%180===0?[yt,Dt]:[Dt,yt];return{offsetX:$t,offsetY:_t}},Jn=function(){ir(this,nt,!0);for(const gt of mt(this,tt).values())gt.isEmpty()&&gt.remove();ir(this,nt,!1)},$r(pt,"_initialized",!1);let _=pt;i.AnnotationEditorLayer=_},(e,i,a)=>{var g,_,b,j,_e,et,rt,tt,it,nt,vs,ys,ws,mn,_i,Ss,na;Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var s=a(1),o=a(5),c=a(4),h=a(29);const pt=class pt extends c.AnnotationEditor{constructor(vt){super({...vt,name:"freeTextEditor"});nr(this,nt);nr(this,g,this.editorDivBlur.bind(this));nr(this,_,this.editorDivFocus.bind(this));nr(this,b,this.editorDivInput.bind(this));nr(this,j,this.editorDivKeydown.bind(this));nr(this,_e);nr(this,et,"");nr(this,rt,`${this.id}-editor`);nr(this,tt);nr(this,it,null);ir(this,_e,vt.color||pt._defaultColor||c.AnnotationEditor._defaultLineColor),ir(this,tt,vt.fontSize||pt._defaultFontSize)}static get _keyboardManager(){const vt=pt.prototype,At=Ht=>Ht.isEmpty(),Gt=o.AnnotationEditorUIManager.TRANSLATE_SMALL,Nt=o.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,s.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],vt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],vt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],vt._translateEmpty,{args:[-Gt,0],checker:At}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],vt._translateEmpty,{args:[-Nt,0],checker:At}],[["ArrowRight","mac+ArrowRight"],vt._translateEmpty,{args:[Gt,0],checker:At}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],vt._translateEmpty,{args:[Nt,0],checker:At}],[["ArrowUp","mac+ArrowUp"],vt._translateEmpty,{args:[0,-Gt],checker:At}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],vt._translateEmpty,{args:[0,-Nt],checker:At}],[["ArrowDown","mac+ArrowDown"],vt._translateEmpty,{args:[0,Gt],checker:At}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],vt._translateEmpty,{args:[0,Nt],checker:At}]]))}static initialize(vt){c.AnnotationEditor.initialize(vt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const At=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(At.getPropertyValue("--freetext-padding"))}static updateDefaultParams(vt,At){switch(vt){case s.AnnotationEditorParamsType.FREETEXT_SIZE:pt._defaultFontSize=At;break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:pt._defaultColor=At;break}}updateParams(vt,At){switch(vt){case s.AnnotationEditorParamsType.FREETEXT_SIZE:Qt(this,nt,vs).call(this,At);break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:Qt(this,nt,ys).call(this,At);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,pt._defaultFontSize],[s.AnnotationEditorParamsType.FREETEXT_COLOR,pt._defaultColor||c.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,mt(this,tt)],[s.AnnotationEditorParamsType.FREETEXT_COLOR,mt(this,_e)]]}_translateEmpty(vt,At){this._uiManager.translateSelectedEditors(vt,At,!0)}getInitialTranslation(){const vt=this.parentScale;return[-pt._internalPadding*vt,-(pt._internalPadding+mt(this,tt))*vt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(s.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",mt(this,j)),this.editorDiv.addEventListener("focus",mt(this,_)),this.editorDiv.addEventListener("blur",mt(this,g)),this.editorDiv.addEventListener("input",mt(this,b)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",mt(this,rt)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",mt(this,j)),this.editorDiv.removeEventListener("focus",mt(this,_)),this.editorDiv.removeEventListener("blur",mt(this,g)),this.editorDiv.removeEventListener("input",mt(this,b)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(vt){this._focusEventsAllowed&&(super.focusin(vt),vt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var vt;if(this.width){Qt(this,nt,na).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(vt=this._initialOptions)!=null&&vt.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const vt=mt(this,et),At=ir(this,et,Qt(this,nt,ws).call(this).trimEnd());if(vt===At)return;const Gt=Nt=>{if(ir(this,et,Nt),!Nt){this.remove();return}Qt(this,nt,_i).call(this),this._uiManager.rebuild(this),Qt(this,nt,mn).call(this)};this.addCommands({cmd:()=>{Gt(At)},undo:()=>{Gt(vt)},mustExec:!1}),Qt(this,nt,mn).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(vt){this.enterInEditMode()}keydown(vt){vt.target===this.div&&vt.key==="Enter"&&(this.enterInEditMode(),vt.preventDefault())}editorDivKeydown(vt){pt._keyboardManager.exec(this,vt)}editorDivFocus(vt){this.isEditing=!0}editorDivBlur(vt){this.isEditing=!1}editorDivInput(vt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let vt,At;this.width&&(vt=this.x,At=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",mt(this,rt)),this.enableEditing(),c.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Nt=>{var Ht;return(Ht=this.editorDiv)==null?void 0:Ht.setAttribute("aria-label",Nt)}),c.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Nt=>{var Ht;return(Ht=this.editorDiv)==null?void 0:Ht.setAttribute("default-content",Nt)}),this.editorDiv.contentEditable=!0;const{style:Gt}=this.editorDiv;if(Gt.fontSize=`calc(${mt(this,tt)}px * var(--scale-factor))`,Gt.color=mt(this,_e),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,o.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Nt,Ht]=this.parentDimensions;if(this.annotationElementId){const{position:It}=mt(this,it);let[Wt,yt]=this.getInitialTranslation();[Wt,yt]=this.pageTranslationToScreen(Wt,yt);const[Dt,$t]=this.pageDimensions,[_t,ht]=this.pageTranslation;let ct,xt;switch(this.rotation){case 0:ct=vt+(It[0]-_t)/Dt,xt=At+this.height-(It[1]-ht)/$t;break;case 90:ct=vt+(It[0]-_t)/Dt,xt=At-(It[1]-ht)/$t,[Wt,yt]=[yt,-Wt];break;case 180:ct=vt-this.width+(It[0]-_t)/Dt,xt=At-(It[1]-ht)/$t,[Wt,yt]=[-Wt,-yt];break;case 270:ct=vt+(It[0]-_t-this.height*$t)/Dt,xt=At+(It[1]-ht-this.width*Dt)/$t,[Wt,yt]=[-yt,Wt];break}this.setAt(ct*Nt,xt*Ht,Wt,yt)}else this.setAt(vt*Nt,At*Ht,this.width*Nt,this.height*Ht);Qt(this,nt,_i).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(vt,At,Gt){let Nt=null;if(vt instanceof h.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:It,fontColor:Wt},rect:yt,rotation:Dt,id:$t},textContent:_t,textPosition:ht,parent:{page:{pageNumber:ct}}}=vt;if(!_t||_t.length===0)return null;Nt=vt={annotationType:s.AnnotationEditorType.FREETEXT,color:Array.from(Wt),fontSize:It,value:_t.join(`
`),position:ht,pageIndex:ct-1,rect:yt,rotation:Dt,id:$t,deleted:!1}}const Ht=super.deserialize(vt,At,Gt);return ir(Ht,tt,vt.fontSize),ir(Ht,_e,s.Util.makeHexColor(...vt.color)),ir(Ht,et,vt.value),Ht.annotationElementId=vt.id||null,ir(Ht,it,Nt),Ht}serialize(vt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const At=pt._internalPadding*this.parentScale,Gt=this.getRect(At,At),Nt=c.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:mt(this,_e)),Ht={annotationType:s.AnnotationEditorType.FREETEXT,color:Nt,fontSize:mt(this,tt),value:mt(this,et),pageIndex:this.pageIndex,rect:Gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return vt?Ht:this.annotationElementId&&!Qt(this,nt,Ss).call(this,Ht)?null:(Ht.id=this.annotationElementId,Ht)}};g=new WeakMap,_=new WeakMap,b=new WeakMap,j=new WeakMap,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,tt=new WeakMap,it=new WeakMap,nt=new WeakSet,vs=function(vt){const At=Nt=>{this.editorDiv.style.fontSize=`calc(${Nt}px * var(--scale-factor))`,this.translate(0,-(Nt-mt(this,tt))*this.parentScale),ir(this,tt,Nt),Qt(this,nt,mn).call(this)},Gt=mt(this,tt);this.addCommands({cmd:()=>{At(vt)},undo:()=>{At(Gt)},mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ys=function(vt){const At=mt(this,_e);this.addCommands({cmd:()=>{ir(this,_e,this.editorDiv.style.color=vt)},undo:()=>{ir(this,_e,this.editorDiv.style.color=At)},mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ws=function(){const vt=this.editorDiv.getElementsByTagName("div");if(vt.length===0)return this.editorDiv.innerText;const At=[];for(const Gt of vt)At.push(Gt.innerText.replace(/\r\n?|\n/,""));return At.join(`
`)},mn=function(){const[vt,At]=this.parentDimensions;let Gt;if(this.isAttachedToDOM)Gt=this.div.getBoundingClientRect();else{const{currentLayer:Nt,div:Ht}=this,It=Ht.style.display;Ht.style.display="hidden",Nt.div.append(this.div),Gt=Ht.getBoundingClientRect(),Ht.remove(),Ht.style.display=It}this.rotation%180===this.parentRotation%180?(this.width=Gt.width/vt,this.height=Gt.height/At):(this.width=Gt.height/vt,this.height=Gt.width/At),this.fixAndSetPosition()},_i=function(){if(this.editorDiv.replaceChildren(),!!mt(this,et))for(const vt of mt(this,et).split(`
`)){const At=document.createElement("div");At.append(vt?document.createTextNode(vt):document.createElement("br")),this.editorDiv.append(At)}},Ss=function(vt){const{value:At,fontSize:Gt,color:Nt,rect:Ht,pageIndex:It}=mt(this,it);return vt.value!==At||vt.fontSize!==Gt||vt.rect.some((Wt,yt)=>Math.abs(Wt-Ht[yt])>=1)||vt.color.some((Wt,yt)=>Wt!==Nt[yt])||vt.pageIndex!==It},na=function(vt=!1){if(!this.annotationElementId)return;if(Qt(this,nt,mn).call(this),!vt&&(this.width===0||this.height===0)){setTimeout(()=>Qt(this,nt,na).call(this,!0),0);return}const At=pt._internalPadding*this.parentScale;mt(this,it).rect=this.getRect(At,At)},$r(pt,"_freeTextDefaultContent",""),$r(pt,"_internalPadding",0),$r(pt,"_defaultColor",null),$r(pt,"_defaultFontSize",10),$r(pt,"_type","freetext");let d=pt;i.FreeTextEditor=d},(e,i,a)=>{var xt,bt,en,Es,jt,er,Tt,ur,cr,hr,Yt,Xt,Ft,Ut,qt,Jt,dr,vr,_r,Zt,Er,Sr,Ts,An,ga,_a,Dr,jr,Hr,yr,rr,ar,Rr,xa,Wr,zt,gr,Tr,As,ba;Object.defineProperty(i,"__esModule",{value:!0}),i.StampAnnotationElement=i.InkAnnotationElement=i.FreeTextAnnotationElement=i.AnnotationLayer=void 0;var s=a(1),o=a(6),c=a(3),h=a(30),d=a(31),g=a(32);const _=1e3,b=9,j=new WeakSet;function _e(Fr){return{width:Fr[2]-Fr[0],height:Fr[3]-Fr[1]}}class et{static create(Vt){switch(Vt.data.annotationType){case s.AnnotationType.LINK:return new tt(Vt);case s.AnnotationType.TEXT:return new it(Vt);case s.AnnotationType.WIDGET:switch(Vt.data.fieldType){case"Tx":return new at(Vt);case"Btn":return Vt.data.radioButton?new lt(Vt):Vt.data.checkBox?new dt(Vt):new ut(Vt);case"Ch":return new ot(Vt);case"Sig":return new st(Vt)}return new nt(Vt);case s.AnnotationType.POPUP:return new ft(Vt);case s.AnnotationType.FREETEXT:return new St(Vt);case s.AnnotationType.LINE:return new gt(Vt);case s.AnnotationType.SQUARE:return new vt(Vt);case s.AnnotationType.CIRCLE:return new At(Vt);case s.AnnotationType.POLYLINE:return new Gt(Vt);case s.AnnotationType.CARET:return new Ht(Vt);case s.AnnotationType.INK:return new It(Vt);case s.AnnotationType.POLYGON:return new Nt(Vt);case s.AnnotationType.HIGHLIGHT:return new Wt(Vt);case s.AnnotationType.UNDERLINE:return new yt(Vt);case s.AnnotationType.SQUIGGLY:return new Dt(Vt);case s.AnnotationType.STRIKEOUT:return new $t(Vt);case s.AnnotationType.STAMP:return new _t(Vt);case s.AnnotationType.FILEATTACHMENT:return new ht(Vt);default:return new rt(Vt)}}}const Et=class Et{constructor(Vt,{isRenderable:Mt=!1,ignoreBorder:Kt=!1,createQuadrilaterals:lr=!1}={}){nr(this,xt,!1);this.isRenderable=Mt,this.data=Vt.data,this.layer=Vt.layer,this.linkService=Vt.linkService,this.downloadManager=Vt.downloadManager,this.imageResourcesPath=Vt.imageResourcesPath,this.renderForms=Vt.renderForms,this.svgFactory=Vt.svgFactory,this.annotationStorage=Vt.annotationStorage,this.enableScripting=Vt.enableScripting,this.hasJSActions=Vt.hasJSActions,this._fieldObjects=Vt.fieldObjects,this.parent=Vt.parent,Mt&&(this.container=this._createContainer(Kt)),lr&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Vt,contentsObj:Mt,richText:Kt}){return!!(Vt!=null&&Vt.str||Mt!=null&&Mt.str||Kt!=null&&Kt.str)}get hasPopupData(){return Et._hasPopupData(this.data)}_createContainer(Vt){const{data:Mt,parent:{page:Kt,viewport:lr}}=this,fr=document.createElement("section");fr.setAttribute("data-annotation-id",Mt.id),this instanceof nt||(fr.tabIndex=_),fr.style.zIndex=this.parent.zIndex++,this.data.popupRef&&fr.setAttribute("aria-haspopup","dialog"),Mt.noRotate&&fr.classList.add("norotate");const{pageWidth:xr,pageHeight:wr,pageX:Ir,pageY:Mr}=lr.rawDims;if(!Mt.rect||this instanceof ft){const{rotation:Rt}=Mt;return!Mt.hasOwnCanvas&&Rt!==0&&this.setRotation(Rt,fr),fr}const{width:wt,height:Lt}=_e(Mt.rect),kt=s.Util.normalizeRect([Mt.rect[0],Kt.view[3]-Mt.rect[1]+Kt.view[1],Mt.rect[2],Kt.view[3]-Mt.rect[3]+Kt.view[1]]);if(!Vt&&Mt.borderStyle.width>0){fr.style.borderWidth=`${Mt.borderStyle.width}px`;const Rt=Mt.borderStyle.horizontalCornerRadius,Bt=Mt.borderStyle.verticalCornerRadius;if(Rt>0||Bt>0){const mr=`calc(${Rt}px * var(--scale-factor)) / calc(${Bt}px * var(--scale-factor))`;fr.style.borderRadius=mr}else if(this instanceof lt){const mr=`calc(${wt}px * var(--scale-factor)) / calc(${Lt}px * var(--scale-factor))`;fr.style.borderRadius=mr}switch(Mt.borderStyle.style){case s.AnnotationBorderStyleType.SOLID:fr.style.borderStyle="solid";break;case s.AnnotationBorderStyleType.DASHED:fr.style.borderStyle="dashed";break;case s.AnnotationBorderStyleType.BEVELED:(0,s.warn)("Unimplemented border style: beveled");break;case s.AnnotationBorderStyleType.INSET:(0,s.warn)("Unimplemented border style: inset");break;case s.AnnotationBorderStyleType.UNDERLINE:fr.style.borderBottomStyle="solid";break}const tr=Mt.borderColor||null;tr?(ir(this,xt,!0),fr.style.borderColor=s.Util.makeHexColor(tr[0]|0,tr[1]|0,tr[2]|0)):fr.style.borderWidth=0}fr.style.left=`${100*(kt[0]-Ir)/xr}%`,fr.style.top=`${100*(kt[1]-Mr)/wr}%`;const{rotation:Pt}=Mt;return Mt.hasOwnCanvas||Pt===0?(fr.style.width=`${100*wt/xr}%`,fr.style.height=`${100*Lt/wr}%`):this.setRotation(Pt,fr),fr}setRotation(Vt,Mt=this.container){if(!this.data.rect)return;const{pageWidth:Kt,pageHeight:lr}=this.parent.viewport.rawDims,{width:fr,height:xr}=_e(this.data.rect);let wr,Ir;Vt%180===0?(wr=100*fr/Kt,Ir=100*xr/lr):(wr=100*xr/Kt,Ir=100*fr/lr),Mt.style.width=`${wr}%`,Mt.style.height=`${Ir}%`,Mt.setAttribute("data-main-rotation",(360-Vt)%360)}get _commonActions(){const Vt=(Mt,Kt,lr)=>{const fr=lr.detail[Mt],xr=fr[0],wr=fr.slice(1);lr.target.style[Kt]=h.ColorConverters[`${xr}_HTML`](wr),this.annotationStorage.setValue(this.data.id,{[Kt]:h.ColorConverters[`${xr}_rgb`](wr)})};return(0,s.shadow)(this,"_commonActions",{display:Mt=>{const{display:Kt}=Mt.detail,lr=Kt%2===1;this.container.style.visibility=lr?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:lr,noPrint:Kt===1||Kt===2})},print:Mt=>{this.annotationStorage.setValue(this.data.id,{noPrint:!Mt.detail.print})},hidden:Mt=>{const{hidden:Kt}=Mt.detail;this.container.style.visibility=Kt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Kt,noView:Kt})},focus:Mt=>{setTimeout(()=>Mt.target.focus({preventScroll:!1}),0)},userName:Mt=>{Mt.target.title=Mt.detail.userName},readonly:Mt=>{Mt.target.disabled=Mt.detail.readonly},required:Mt=>{this._setRequired(Mt.target,Mt.detail.required)},bgColor:Mt=>{Vt("bgColor","backgroundColor",Mt)},fillColor:Mt=>{Vt("fillColor","backgroundColor",Mt)},fgColor:Mt=>{Vt("fgColor","color",Mt)},textColor:Mt=>{Vt("textColor","color",Mt)},borderColor:Mt=>{Vt("borderColor","borderColor",Mt)},strokeColor:Mt=>{Vt("strokeColor","borderColor",Mt)},rotation:Mt=>{const Kt=Mt.detail.rotation;this.setRotation(Kt),this.annotationStorage.setValue(this.data.id,{rotation:Kt})}})}_dispatchEventFromSandbox(Vt,Mt){const Kt=this._commonActions;for(const lr of Object.keys(Mt.detail)){const fr=Vt[lr]||Kt[lr];fr==null||fr(Mt)}}_setDefaultPropertiesFromJS(Vt){if(!this.enableScripting)return;const Mt=this.annotationStorage.getRawValue(this.data.id);if(!Mt)return;const Kt=this._commonActions;for(const[lr,fr]of Object.entries(Mt)){const xr=Kt[lr];if(xr){const wr={detail:{[lr]:fr},target:Vt};xr(wr),delete Mt[lr]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Vt}=this.data;if(!Vt)return;const[Mt,Kt,lr,fr]=this.data.rect;if(Vt.length===1){const[,{x:Bt,y:tr},{x:mr,y:or}]=Vt[0];if(lr===Bt&&fr===tr&&Mt===mr&&Kt===or)return}const{style:xr}=this.container;let wr;if(mt(this,xt)){const{borderColor:Bt,borderWidth:tr}=xr;xr.borderWidth=0,wr=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Bt}" stroke-width="${tr}">`],this.container.classList.add("hasBorder")}const Ir=lr-Mt,Mr=fr-Kt,{svgFactory:wt}=this,Lt=wt.createElement("svg");Lt.classList.add("quadrilateralsContainer"),Lt.setAttribute("width",0),Lt.setAttribute("height",0);const kt=wt.createElement("defs");Lt.append(kt);const Pt=wt.createElement("clipPath"),Rt=`clippath_${this.data.id}`;Pt.setAttribute("id",Rt),Pt.setAttribute("clipPathUnits","objectBoundingBox"),kt.append(Pt);for(const[,{x:Bt,y:tr},{x:mr,y:or}]of Vt){const sr=wt.createElement("rect"),pr=(mr-Mt)/Ir,Ar=(fr-tr)/Mr,br=(Bt-mr)/Ir,Ur=(tr-or)/Mr;sr.setAttribute("x",pr),sr.setAttribute("y",Ar),sr.setAttribute("width",br),sr.setAttribute("height",Ur),Pt.append(sr),wr==null||wr.push(`<rect vector-effect="non-scaling-stroke" x="${pr}" y="${Ar}" width="${br}" height="${Ur}"/>`)}mt(this,xt)&&(wr.push("</g></svg>')"),xr.backgroundImage=wr.join("")),this.container.append(Lt),this.container.style.clipPath=`url(#${Rt})`}_createPopup(){const{container:Vt,data:Mt}=this;Vt.setAttribute("aria-haspopup","dialog");const Kt=new ft({data:{color:Mt.color,titleObj:Mt.titleObj,modificationDate:Mt.modificationDate,contentsObj:Mt.contentsObj,richText:Mt.richText,parentRect:Mt.rect,borderStyle:0,id:`popup_${Mt.id}`,rotation:Mt.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Kt.render())}render(){(0,s.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Vt,Mt=null){const Kt=[];if(this._fieldObjects){const lr=this._fieldObjects[Vt];if(lr)for(const{page:fr,id:xr,exportValues:wr}of lr){if(fr===-1||xr===Mt)continue;const Ir=typeof wr=="string"?wr:null,Mr=document.querySelector(`[data-element-id="${xr}"]`);if(Mr&&!j.has(Mr)){(0,s.warn)(`_getElementsByName - element not allowed: ${xr}`);continue}Kt.push({id:xr,exportValue:Ir,domElement:Mr})}return Kt}for(const lr of document.getElementsByName(Vt)){const{exportValue:fr}=lr,xr=lr.getAttribute("data-element-id");xr!==Mt&&j.has(lr)&&Kt.push({id:xr,exportValue:fr,domElement:lr})}return Kt}show(){var Vt;this.container&&(this.container.hidden=!1),(Vt=this.popup)==null||Vt.maybeShow()}hide(){var Vt;this.container&&(this.container.hidden=!0),(Vt=this.popup)==null||Vt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Vt=this.getElementsToTriggerPopup();if(Array.isArray(Vt))for(const Mt of Vt)Mt.classList.add("highlightArea");else Vt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:Vt,data:{id:Mt}}=this;this.container.addEventListener("dblclick",()=>{var Kt;(Kt=this.linkService.eventBus)==null||Kt.dispatch("switchannotationeditormode",{source:this,mode:Vt,editId:Mt})})}};xt=new WeakMap;let rt=Et;class tt extends rt{constructor(Mt,Kt=null){super(Mt,{isRenderable:!0,ignoreBorder:!!(Kt!=null&&Kt.ignoreBorder),createQuadrilaterals:!0});nr(this,bt);this.isTooltipOnly=Mt.data.isTooltipOnly}render(){const{data:Mt,linkService:Kt}=this,lr=document.createElement("a");lr.setAttribute("data-element-id",Mt.id);let fr=!1;return Mt.url?(Kt.addLinkAttributes(lr,Mt.url,Mt.newWindow),fr=!0):Mt.action?(this._bindNamedAction(lr,Mt.action),fr=!0):Mt.attachment?(this._bindAttachment(lr,Mt.attachment),fr=!0):Mt.setOCGState?(Qt(this,bt,Es).call(this,lr,Mt.setOCGState),fr=!0):Mt.dest?(this._bindLink(lr,Mt.dest),fr=!0):(Mt.actions&&(Mt.actions.Action||Mt.actions["Mouse Up"]||Mt.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(lr,Mt),fr=!0),Mt.resetForm?(this._bindResetFormAction(lr,Mt.resetForm),fr=!0):this.isTooltipOnly&&!fr&&(this._bindLink(lr,""),fr=!0)),this.container.classList.add("linkAnnotation"),fr&&this.container.append(lr),this.container}_bindLink(Mt,Kt){Mt.href=this.linkService.getDestinationHash(Kt),Mt.onclick=()=>(Kt&&this.linkService.goToDestination(Kt),!1),(Kt||Kt==="")&&Qt(this,bt,en).call(this)}_bindNamedAction(Mt,Kt){Mt.href=this.linkService.getAnchorUrl(""),Mt.onclick=()=>(this.linkService.executeNamedAction(Kt),!1),Qt(this,bt,en).call(this)}_bindAttachment(Mt,Kt){Mt.href=this.linkService.getAnchorUrl(""),Mt.onclick=()=>{var lr;return(lr=this.downloadManager)==null||lr.openOrDownloadData(this.container,Kt.content,Kt.filename),!1},Qt(this,bt,en).call(this)}_bindJSAction(Mt,Kt){Mt.href=this.linkService.getAnchorUrl("");const lr=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const fr of Object.keys(Kt.actions)){const xr=lr.get(fr);xr&&(Mt[xr]=()=>{var wr;return(wr=this.linkService.eventBus)==null||wr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Kt.id,name:fr}}),!1})}Mt.onclick||(Mt.onclick=()=>!1),Qt(this,bt,en).call(this)}_bindResetFormAction(Mt,Kt){const lr=Mt.onclick;if(lr||(Mt.href=this.linkService.getAnchorUrl("")),Qt(this,bt,en).call(this),!this._fieldObjects){(0,s.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),lr||(Mt.onclick=()=>!1);return}Mt.onclick=()=>{var Lt;lr==null||lr();const{fields:fr,refs:xr,include:wr}=Kt,Ir=[];if(fr.length!==0||xr.length!==0){const kt=new Set(xr);for(const Pt of fr){const Rt=this._fieldObjects[Pt]||[];for(const{id:Bt}of Rt)kt.add(Bt)}for(const Pt of Object.values(this._fieldObjects))for(const Rt of Pt)kt.has(Rt.id)===wr&&Ir.push(Rt)}else for(const kt of Object.values(this._fieldObjects))Ir.push(...kt);const Mr=this.annotationStorage,wt=[];for(const kt of Ir){const{id:Pt}=kt;switch(wt.push(Pt),kt.type){case"text":{const Bt=kt.defaultValue||"";Mr.setValue(Pt,{value:Bt});break}case"checkbox":case"radiobutton":{const Bt=kt.defaultValue===kt.exportValues;Mr.setValue(Pt,{value:Bt});break}case"combobox":case"listbox":{const Bt=kt.defaultValue||"";Mr.setValue(Pt,{value:Bt});break}default:continue}const Rt=document.querySelector(`[data-element-id="${Pt}"]`);if(Rt){if(!j.has(Rt)){(0,s.warn)(`_bindResetFormAction - element not allowed: ${Pt}`);continue}}else continue;Rt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Lt=this.linkService.eventBus)==null||Lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:wt,name:"ResetForm"}})),!1}}}bt=new WeakSet,en=function(){this.container.setAttribute("data-internal-link","")},Es=function(Mt,Kt){Mt.href=this.linkService.getAnchorUrl(""),Mt.onclick=()=>(this.linkService.executeSetOCGState(Kt),!1),Qt(this,bt,en).call(this)};class it extends rt{constructor(Vt){super(Vt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Vt=document.createElement("img");return Vt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Vt.alt="[{{type}} Annotation]",Vt.dataset.l10nId="text_annotation_type",Vt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Vt),this.container}}class nt extends rt{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(Vt){var Mt;this.data.hasOwnCanvas&&(((Mt=Vt.previousSibling)==null?void 0:Mt.nodeName)==="CANVAS"&&(Vt.previousSibling.hidden=!0),Vt.hidden=!1)}_getKeyModifier(Vt){const{isWin:Mt,isMac:Kt}=s.FeatureTest.platform;return Mt&&Vt.ctrlKey||Kt&&Vt.metaKey}_setEventListener(Vt,Mt,Kt,lr,fr){Kt.includes("mouse")?Vt.addEventListener(Kt,xr=>{var wr;(wr=this.linkService.eventBus)==null||wr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:lr,value:fr(xr),shift:xr.shiftKey,modifier:this._getKeyModifier(xr)}})}):Vt.addEventListener(Kt,xr=>{var wr;if(Kt==="blur"){if(!Mt.focused||!xr.relatedTarget)return;Mt.focused=!1}else if(Kt==="focus"){if(Mt.focused)return;Mt.focused=!0}fr&&((wr=this.linkService.eventBus)==null||wr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:lr,value:fr(xr)}}))})}_setEventListeners(Vt,Mt,Kt,lr){var fr,xr,wr;for(const[Ir,Mr]of Kt)(Mr==="Action"||(fr=this.data.actions)!=null&&fr[Mr])&&((Mr==="Focus"||Mr==="Blur")&&(Mt||(Mt={focused:!1})),this._setEventListener(Vt,Mt,Ir,Mr,lr),Mr==="Focus"&&!((xr=this.data.actions)!=null&&xr.Blur)?this._setEventListener(Vt,Mt,"blur","Blur",null):Mr==="Blur"&&!((wr=this.data.actions)!=null&&wr.Focus)&&this._setEventListener(Vt,Mt,"focus","Focus",null))}_setBackgroundColor(Vt){const Mt=this.data.backgroundColor||null;Vt.style.backgroundColor=Mt===null?"transparent":s.Util.makeHexColor(Mt[0],Mt[1],Mt[2])}_setTextStyle(Vt){const Mt=["left","center","right"],{fontColor:Kt}=this.data.defaultAppearanceData,lr=this.data.defaultAppearanceData.fontSize||b,fr=Vt.style;let xr;const wr=2,Ir=Mr=>Math.round(10*Mr)/10;if(this.data.multiLine){const Mr=Math.abs(this.data.rect[3]-this.data.rect[1]-wr),wt=Math.round(Mr/(s.LINE_FACTOR*lr))||1,Lt=Mr/wt;xr=Math.min(lr,Ir(Lt/s.LINE_FACTOR))}else{const Mr=Math.abs(this.data.rect[3]-this.data.rect[1]-wr);xr=Math.min(lr,Ir(Mr/s.LINE_FACTOR))}fr.fontSize=`calc(${xr}px * var(--scale-factor))`,fr.color=s.Util.makeHexColor(Kt[0],Kt[1],Kt[2]),this.data.textAlignment!==null&&(fr.textAlign=Mt[this.data.textAlignment])}_setRequired(Vt,Mt){Mt?Vt.setAttribute("required",!0):Vt.removeAttribute("required"),Vt.setAttribute("aria-required",Mt)}}class at extends nt{constructor(Vt){const Mt=Vt.renderForms||!Vt.data.hasAppearance&&!!Vt.data.fieldValue;super(Vt,{isRenderable:Mt})}setPropertyOnSiblings(Vt,Mt,Kt,lr){const fr=this.annotationStorage;for(const xr of this._getElementsByName(Vt.name,Vt.id))xr.domElement&&(xr.domElement[Mt]=Kt),fr.setValue(xr.id,{[lr]:Kt})}render(){var lr,fr;const Vt=this.annotationStorage,Mt=this.data.id;this.container.classList.add("textWidgetAnnotation");let Kt=null;if(this.renderForms){const xr=Vt.getValue(Mt,{value:this.data.fieldValue});let wr=xr.value||"";const Ir=Vt.getValue(Mt,{charLimit:this.data.maxLen}).charLimit;Ir&&wr.length>Ir&&(wr=wr.slice(0,Ir));let Mr=xr.formattedValue||((lr=this.data.textContent)==null?void 0:lr.join(`
`))||null;Mr&&this.data.comb&&(Mr=Mr.replaceAll(/\s+/g,""));const wt={userValue:wr,formattedValue:Mr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Kt=document.createElement("textarea"),Kt.textContent=Mr??wr,this.data.doNotScroll&&(Kt.style.overflowY="hidden")):(Kt=document.createElement("input"),Kt.type="text",Kt.setAttribute("value",Mr??wr),this.data.doNotScroll&&(Kt.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Kt.hidden=!0),j.add(Kt),Kt.setAttribute("data-element-id",Mt),Kt.disabled=this.data.readOnly,Kt.name=this.data.fieldName,Kt.tabIndex=_,this._setRequired(Kt,this.data.required),Ir&&(Kt.maxLength=Ir),Kt.addEventListener("input",kt=>{Vt.setValue(Mt,{value:kt.target.value}),this.setPropertyOnSiblings(Kt,"value",kt.target.value,"value"),wt.formattedValue=null}),Kt.addEventListener("resetform",kt=>{const Pt=this.data.defaultFieldValue??"";Kt.value=wt.userValue=Pt,wt.formattedValue=null});let Lt=kt=>{const{formattedValue:Pt}=wt;Pt!=null&&(kt.target.value=Pt),kt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Kt.addEventListener("focus",Pt=>{if(wt.focused)return;const{target:Rt}=Pt;wt.userValue&&(Rt.value=wt.userValue),wt.lastCommittedValue=Rt.value,wt.commitKey=1,wt.focused=!0}),Kt.addEventListener("updatefromsandbox",Pt=>{this.showElementAndHideCanvas(Pt.target);const Rt={value(Bt){wt.userValue=Bt.detail.value??"",Vt.setValue(Mt,{value:wt.userValue.toString()}),Bt.target.value=wt.userValue},formattedValue(Bt){const{formattedValue:tr}=Bt.detail;wt.formattedValue=tr,tr!=null&&Bt.target!==document.activeElement&&(Bt.target.value=tr),Vt.setValue(Mt,{formattedValue:tr})},selRange(Bt){Bt.target.setSelectionRange(...Bt.detail.selRange)},charLimit:Bt=>{var sr;const{charLimit:tr}=Bt.detail,{target:mr}=Bt;if(tr===0){mr.removeAttribute("maxLength");return}mr.setAttribute("maxLength",tr);let or=wt.userValue;!or||or.length<=tr||(or=or.slice(0,tr),mr.value=wt.userValue=or,Vt.setValue(Mt,{value:or}),(sr=this.linkService.eventBus)==null||sr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Mt,name:"Keystroke",value:or,willCommit:!0,commitKey:1,selStart:mr.selectionStart,selEnd:mr.selectionEnd}}))}};this._dispatchEventFromSandbox(Rt,Pt)}),Kt.addEventListener("keydown",Pt=>{var tr;wt.commitKey=1;let Rt=-1;if(Pt.key==="Escape"?Rt=0:Pt.key==="Enter"&&!this.data.multiLine?Rt=2:Pt.key==="Tab"&&(wt.commitKey=3),Rt===-1)return;const{value:Bt}=Pt.target;wt.lastCommittedValue!==Bt&&(wt.lastCommittedValue=Bt,wt.userValue=Bt,(tr=this.linkService.eventBus)==null||tr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Mt,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Rt,selStart:Pt.target.selectionStart,selEnd:Pt.target.selectionEnd}}))});const kt=Lt;Lt=null,Kt.addEventListener("blur",Pt=>{var Bt;if(!wt.focused||!Pt.relatedTarget)return;wt.focused=!1;const{value:Rt}=Pt.target;wt.userValue=Rt,wt.lastCommittedValue!==Rt&&((Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Mt,name:"Keystroke",value:Rt,willCommit:!0,commitKey:wt.commitKey,selStart:Pt.target.selectionStart,selEnd:Pt.target.selectionEnd}})),kt(Pt)}),(fr=this.data.actions)!=null&&fr.Keystroke&&Kt.addEventListener("beforeinput",Pt=>{var Ar;wt.lastCommittedValue=null;const{data:Rt,target:Bt}=Pt,{value:tr,selectionStart:mr,selectionEnd:or}=Bt;let sr=mr,pr=or;switch(Pt.inputType){case"deleteWordBackward":{const br=tr.substring(0,mr).match(/\w*[^\w]*$/);br&&(sr-=br[0].length);break}case"deleteWordForward":{const br=tr.substring(mr).match(/^[^\w]*\w*/);br&&(pr+=br[0].length);break}case"deleteContentBackward":mr===or&&(sr-=1);break;case"deleteContentForward":mr===or&&(pr+=1);break}Pt.preventDefault(),(Ar=this.linkService.eventBus)==null||Ar.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Mt,name:"Keystroke",value:tr,change:Rt||"",willCommit:!1,selStart:sr,selEnd:pr}})}),this._setEventListeners(Kt,wt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Pt=>Pt.target.value)}if(Lt&&Kt.addEventListener("blur",Lt),this.data.comb){const Pt=(this.data.rect[2]-this.data.rect[0])/Ir;Kt.classList.add("comb"),Kt.style.letterSpacing=`calc(${Pt}px * var(--scale-factor) - 1ch)`}}else Kt=document.createElement("div"),Kt.textContent=this.data.fieldValue,Kt.style.verticalAlign="middle",Kt.style.display="table-cell";return this._setTextStyle(Kt),this._setBackgroundColor(Kt),this._setDefaultPropertiesFromJS(Kt),this.container.append(Kt),this.container}}class st extends nt{constructor(Vt){super(Vt,{isRenderable:!!Vt.data.hasOwnCanvas})}}class dt extends nt{constructor(Vt){super(Vt,{isRenderable:Vt.renderForms})}render(){const Vt=this.annotationStorage,Mt=this.data,Kt=Mt.id;let lr=Vt.getValue(Kt,{value:Mt.exportValue===Mt.fieldValue}).value;typeof lr=="string"&&(lr=lr!=="Off",Vt.setValue(Kt,{value:lr})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const fr=document.createElement("input");return j.add(fr),fr.setAttribute("data-element-id",Kt),fr.disabled=Mt.readOnly,this._setRequired(fr,this.data.required),fr.type="checkbox",fr.name=Mt.fieldName,lr&&fr.setAttribute("checked",!0),fr.setAttribute("exportValue",Mt.exportValue),fr.tabIndex=_,fr.addEventListener("change",xr=>{const{name:wr,checked:Ir}=xr.target;for(const Mr of this._getElementsByName(wr,Kt)){const wt=Ir&&Mr.exportValue===Mt.exportValue;Mr.domElement&&(Mr.domElement.checked=wt),Vt.setValue(Mr.id,{value:wt})}Vt.setValue(Kt,{value:Ir})}),fr.addEventListener("resetform",xr=>{const wr=Mt.defaultFieldValue||"Off";xr.target.checked=wr===Mt.exportValue}),this.enableScripting&&this.hasJSActions&&(fr.addEventListener("updatefromsandbox",xr=>{const wr={value(Ir){Ir.target.checked=Ir.detail.value!=="Off",Vt.setValue(Kt,{value:Ir.target.checked})}};this._dispatchEventFromSandbox(wr,xr)}),this._setEventListeners(fr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],xr=>xr.target.checked)),this._setBackgroundColor(fr),this._setDefaultPropertiesFromJS(fr),this.container.append(fr),this.container}}class lt extends nt{constructor(Vt){super(Vt,{isRenderable:Vt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Vt=this.annotationStorage,Mt=this.data,Kt=Mt.id;let lr=Vt.getValue(Kt,{value:Mt.fieldValue===Mt.buttonValue}).value;typeof lr=="string"&&(lr=lr!==Mt.buttonValue,Vt.setValue(Kt,{value:lr}));const fr=document.createElement("input");if(j.add(fr),fr.setAttribute("data-element-id",Kt),fr.disabled=Mt.readOnly,this._setRequired(fr,this.data.required),fr.type="radio",fr.name=Mt.fieldName,lr&&fr.setAttribute("checked",!0),fr.tabIndex=_,fr.addEventListener("change",xr=>{const{name:wr,checked:Ir}=xr.target;for(const Mr of this._getElementsByName(wr,Kt))Vt.setValue(Mr.id,{value:!1});Vt.setValue(Kt,{value:Ir})}),fr.addEventListener("resetform",xr=>{const wr=Mt.defaultFieldValue;xr.target.checked=wr!=null&&wr===Mt.buttonValue}),this.enableScripting&&this.hasJSActions){const xr=Mt.buttonValue;fr.addEventListener("updatefromsandbox",wr=>{const Ir={value:Mr=>{const wt=xr===Mr.detail.value;for(const Lt of this._getElementsByName(Mr.target.name)){const kt=wt&&Lt.id===Kt;Lt.domElement&&(Lt.domElement.checked=kt),Vt.setValue(Lt.id,{value:kt})}}};this._dispatchEventFromSandbox(Ir,wr)}),this._setEventListeners(fr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wr=>wr.target.checked)}return this._setBackgroundColor(fr),this._setDefaultPropertiesFromJS(fr),this.container.append(fr),this.container}}class ut extends tt{constructor(Vt){super(Vt,{ignoreBorder:Vt.data.hasAppearance})}render(){const Vt=super.render();Vt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(Vt.title=this.data.alternativeText);const Mt=Vt.lastChild;return this.enableScripting&&this.hasJSActions&&Mt&&(this._setDefaultPropertiesFromJS(Mt),Mt.addEventListener("updatefromsandbox",Kt=>{this._dispatchEventFromSandbox({},Kt)})),Vt}}class ot extends nt{constructor(Vt){super(Vt,{isRenderable:Vt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Vt=this.annotationStorage,Mt=this.data.id,Kt=Vt.getValue(Mt,{value:this.data.fieldValue}),lr=document.createElement("select");j.add(lr),lr.setAttribute("data-element-id",Mt),lr.disabled=this.data.readOnly,this._setRequired(lr,this.data.required),lr.name=this.data.fieldName,lr.tabIndex=_;let fr=this.data.combo&&this.data.options.length>0;this.data.combo||(lr.size=this.data.options.length,this.data.multiSelect&&(lr.multiple=!0)),lr.addEventListener("resetform",wt=>{const Lt=this.data.defaultFieldValue;for(const kt of lr.options)kt.selected=kt.value===Lt});for(const wt of this.data.options){const Lt=document.createElement("option");Lt.textContent=wt.displayValue,Lt.value=wt.exportValue,Kt.value.includes(wt.exportValue)&&(Lt.setAttribute("selected",!0),fr=!1),lr.append(Lt)}let xr=null;if(fr){const wt=document.createElement("option");wt.value=" ",wt.setAttribute("hidden",!0),wt.setAttribute("selected",!0),lr.prepend(wt),xr=()=>{wt.remove(),lr.removeEventListener("input",xr),xr=null},lr.addEventListener("input",xr)}const wr=wt=>{const Lt=wt?"value":"textContent",{options:kt,multiple:Pt}=lr;return Pt?Array.prototype.filter.call(kt,Rt=>Rt.selected).map(Rt=>Rt[Lt]):kt.selectedIndex===-1?null:kt[kt.selectedIndex][Lt]};let Ir=wr(!1);const Mr=wt=>{const Lt=wt.target.options;return Array.prototype.map.call(Lt,kt=>({displayValue:kt.textContent,exportValue:kt.value}))};return this.enableScripting&&this.hasJSActions?(lr.addEventListener("updatefromsandbox",wt=>{const Lt={value(kt){xr==null||xr();const Pt=kt.detail.value,Rt=new Set(Array.isArray(Pt)?Pt:[Pt]);for(const Bt of lr.options)Bt.selected=Rt.has(Bt.value);Vt.setValue(Mt,{value:wr(!0)}),Ir=wr(!1)},multipleSelection(kt){lr.multiple=!0},remove(kt){const Pt=lr.options,Rt=kt.detail.remove;Pt[Rt].selected=!1,lr.remove(Rt),Pt.length>0&&Array.prototype.findIndex.call(Pt,tr=>tr.selected)===-1&&(Pt[0].selected=!0),Vt.setValue(Mt,{value:wr(!0),items:Mr(kt)}),Ir=wr(!1)},clear(kt){for(;lr.length!==0;)lr.remove(0);Vt.setValue(Mt,{value:null,items:[]}),Ir=wr(!1)},insert(kt){const{index:Pt,displayValue:Rt,exportValue:Bt}=kt.detail.insert,tr=lr.children[Pt],mr=document.createElement("option");mr.textContent=Rt,mr.value=Bt,tr?tr.before(mr):lr.append(mr),Vt.setValue(Mt,{value:wr(!0),items:Mr(kt)}),Ir=wr(!1)},items(kt){const{items:Pt}=kt.detail;for(;lr.length!==0;)lr.remove(0);for(const Rt of Pt){const{displayValue:Bt,exportValue:tr}=Rt,mr=document.createElement("option");mr.textContent=Bt,mr.value=tr,lr.append(mr)}lr.options.length>0&&(lr.options[0].selected=!0),Vt.setValue(Mt,{value:wr(!0),items:Mr(kt)}),Ir=wr(!1)},indices(kt){const Pt=new Set(kt.detail.indices);for(const Rt of kt.target.options)Rt.selected=Pt.has(Rt.index);Vt.setValue(Mt,{value:wr(!0)}),Ir=wr(!1)},editable(kt){kt.target.disabled=!kt.detail.editable}};this._dispatchEventFromSandbox(Lt,wt)}),lr.addEventListener("input",wt=>{var kt;const Lt=wr(!0);Vt.setValue(Mt,{value:Lt}),wt.preventDefault(),(kt=this.linkService.eventBus)==null||kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Mt,name:"Keystroke",value:Ir,changeEx:Lt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(lr,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],wt=>wt.target.value)):lr.addEventListener("input",function(wt){Vt.setValue(Mt,{value:wr(!0)})}),this.data.combo&&this._setTextStyle(lr),this._setBackgroundColor(lr),this._setDefaultPropertiesFromJS(lr),this.container.append(lr),this.container}}class ft extends rt{constructor(Vt){const{data:Mt,elements:Kt}=Vt;super(Vt,{isRenderable:rt._hasPopupData(Mt)}),this.elements=Kt}render(){this.container.classList.add("popupAnnotation");const Vt=new pt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),Mt=[];for(const Kt of this.elements)Kt.popup=Vt,Mt.push(Kt.data.id),Kt.addHighlightArea();return this.container.setAttribute("aria-controls",Mt.map(Kt=>`${s.AnnotationPrefix}${Kt}`).join(",")),this.container}}class pt{constructor({container:Vt,color:Mt,elements:Kt,titleObj:lr,modificationDate:fr,contentsObj:xr,richText:wr,parent:Ir,rect:Mr,parentRect:wt,open:Lt}){nr(this,Sr);nr(this,jt,null);nr(this,er,Qt(this,Sr,Ts).bind(this));nr(this,Tt,Qt(this,Sr,_a).bind(this));nr(this,ur,Qt(this,Sr,ga).bind(this));nr(this,cr,Qt(this,Sr,An).bind(this));nr(this,hr,null);nr(this,Yt,null);nr(this,Xt,null);nr(this,Ft,null);nr(this,Ut,null);nr(this,qt,null);nr(this,Jt,!1);nr(this,dr,null);nr(this,vr,null);nr(this,_r,null);nr(this,Zt,null);nr(this,Er,!1);var Pt;ir(this,Yt,Vt),ir(this,Zt,lr),ir(this,Xt,xr),ir(this,_r,wr),ir(this,Ut,Ir),ir(this,hr,Mt),ir(this,vr,Mr),ir(this,qt,wt),ir(this,Ft,Kt);const kt=o.PDFDateString.toDateObject(fr);kt&&ir(this,jt,Ir.l10n.get("annotation_date_string",{date:kt.toLocaleDateString(),time:kt.toLocaleTimeString()})),this.trigger=Kt.flatMap(Rt=>Rt.getElementsToTriggerPopup());for(const Rt of this.trigger)Rt.addEventListener("click",mt(this,cr)),Rt.addEventListener("mouseenter",mt(this,ur)),Rt.addEventListener("mouseleave",mt(this,Tt)),Rt.classList.add("popupTriggerArea");for(const Rt of Kt)(Pt=Rt.container)==null||Pt.addEventListener("keydown",mt(this,er));mt(this,Yt).hidden=!0,Lt&&Qt(this,Sr,An).call(this)}render(){if(mt(this,dr))return;const{page:{view:Vt},viewport:{rawDims:{pageWidth:Mt,pageHeight:Kt,pageX:lr,pageY:fr}}}=mt(this,Ut),xr=ir(this,dr,document.createElement("div"));if(xr.className="popup",mt(this,hr)){const sr=xr.style.outlineColor=s.Util.makeHexColor(...mt(this,hr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?xr.style.backgroundColor=`color-mix(in srgb, ${sr} 30%, white)`:xr.style.backgroundColor=s.Util.makeHexColor(...mt(this,hr).map(Ar=>Math.floor(.7*(255-Ar)+Ar)))}const wr=document.createElement("span");wr.className="header";const Ir=document.createElement("h1");if(wr.append(Ir),{dir:Ir.dir,str:Ir.textContent}=mt(this,Zt),xr.append(wr),mt(this,jt)){const sr=document.createElement("span");sr.classList.add("popupDate"),mt(this,jt).then(pr=>{sr.textContent=pr}),wr.append(sr)}const Mr=mt(this,Xt),wt=mt(this,_r);if(wt!=null&&wt.str&&(!(Mr!=null&&Mr.str)||Mr.str===wt.str))g.XfaLayer.render({xfaHtml:wt.html,intent:"richText",div:xr}),xr.lastChild.classList.add("richText","popupContent");else{const sr=this._formatContents(Mr);xr.append(sr)}let Lt=!!mt(this,qt),kt=Lt?mt(this,qt):mt(this,vr);for(const sr of mt(this,Ft))if(!kt||s.Util.intersect(sr.data.rect,kt)!==null){kt=sr.data.rect,Lt=!0;break}const Pt=s.Util.normalizeRect([kt[0],Vt[3]-kt[1]+Vt[1],kt[2],Vt[3]-kt[3]+Vt[1]]),Bt=Lt?kt[2]-kt[0]+5:0,tr=Pt[0]+Bt,mr=Pt[1],{style:or}=mt(this,Yt);or.left=`${100*(tr-lr)/Mt}%`,or.top=`${100*(mr-fr)/Kt}%`,mt(this,Yt).append(xr)}_formatContents({str:Vt,dir:Mt}){const Kt=document.createElement("p");Kt.classList.add("popupContent"),Kt.dir=Mt;const lr=Vt.split(/(?:\r\n?|\n)/);for(let fr=0,xr=lr.length;fr<xr;++fr){const wr=lr[fr];Kt.append(document.createTextNode(wr)),fr<xr-1&&Kt.append(document.createElement("br"))}return Kt}forceHide(){ir(this,Er,this.isVisible),mt(this,Er)&&(mt(this,Yt).hidden=!0)}maybeShow(){mt(this,Er)&&(ir(this,Er,!1),mt(this,Yt).hidden=!1)}get isVisible(){return mt(this,Yt).hidden===!1}}jt=new WeakMap,er=new WeakMap,Tt=new WeakMap,ur=new WeakMap,cr=new WeakMap,hr=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,Ft=new WeakMap,Ut=new WeakMap,qt=new WeakMap,Jt=new WeakMap,dr=new WeakMap,vr=new WeakMap,_r=new WeakMap,Zt=new WeakMap,Er=new WeakMap,Sr=new WeakSet,Ts=function(Vt){Vt.altKey||Vt.shiftKey||Vt.ctrlKey||Vt.metaKey||(Vt.key==="Enter"||Vt.key==="Escape"&&mt(this,Jt))&&Qt(this,Sr,An).call(this)},An=function(){ir(this,Jt,!mt(this,Jt)),mt(this,Jt)?(Qt(this,Sr,ga).call(this),mt(this,Yt).addEventListener("click",mt(this,cr)),mt(this,Yt).addEventListener("keydown",mt(this,er))):(Qt(this,Sr,_a).call(this),mt(this,Yt).removeEventListener("click",mt(this,cr)),mt(this,Yt).removeEventListener("keydown",mt(this,er)))},ga=function(){mt(this,dr)||this.render(),this.isVisible?mt(this,Jt)&&mt(this,Yt).classList.add("focused"):(mt(this,Yt).hidden=!1,mt(this,Yt).style.zIndex=parseInt(mt(this,Yt).style.zIndex)+1e3)},_a=function(){mt(this,Yt).classList.remove("focused"),!(mt(this,Jt)||!this.isVisible)&&(mt(this,Yt).hidden=!0,mt(this,Yt).style.zIndex=parseInt(mt(this,Yt).style.zIndex)-1e3)};class St extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Vt.data.textContent,this.textPosition=Vt.data.textPosition,this.annotationEditorType=s.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Vt=document.createElement("div");Vt.classList.add("annotationTextContent"),Vt.setAttribute("role","comment");for(const Mt of this.textContent){const Kt=document.createElement("span");Kt.textContent=Mt,Vt.append(Kt)}this.container.append(Vt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}i.FreeTextAnnotationElement=St;class gt extends rt{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0});nr(this,Dr,null)}render(){this.container.classList.add("lineAnnotation");const Mt=this.data,{width:Kt,height:lr}=_e(Mt.rect),fr=this.svgFactory.create(Kt,lr,!0),xr=ir(this,Dr,this.svgFactory.createElement("svg:line"));return xr.setAttribute("x1",Mt.rect[2]-Mt.lineCoordinates[0]),xr.setAttribute("y1",Mt.rect[3]-Mt.lineCoordinates[1]),xr.setAttribute("x2",Mt.rect[2]-Mt.lineCoordinates[2]),xr.setAttribute("y2",Mt.rect[3]-Mt.lineCoordinates[3]),xr.setAttribute("stroke-width",Mt.borderStyle.width||1),xr.setAttribute("stroke","transparent"),xr.setAttribute("fill","transparent"),fr.append(xr),this.container.append(fr),!Mt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return mt(this,Dr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dr=new WeakMap;class vt extends rt{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0});nr(this,jr,null)}render(){this.container.classList.add("squareAnnotation");const Mt=this.data,{width:Kt,height:lr}=_e(Mt.rect),fr=this.svgFactory.create(Kt,lr,!0),xr=Mt.borderStyle.width,wr=ir(this,jr,this.svgFactory.createElement("svg:rect"));return wr.setAttribute("x",xr/2),wr.setAttribute("y",xr/2),wr.setAttribute("width",Kt-xr),wr.setAttribute("height",lr-xr),wr.setAttribute("stroke-width",xr||1),wr.setAttribute("stroke","transparent"),wr.setAttribute("fill","transparent"),fr.append(wr),this.container.append(fr),!Mt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return mt(this,jr)}addHighlightArea(){this.container.classList.add("highlightArea")}}jr=new WeakMap;class At extends rt{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0});nr(this,Hr,null)}render(){this.container.classList.add("circleAnnotation");const Mt=this.data,{width:Kt,height:lr}=_e(Mt.rect),fr=this.svgFactory.create(Kt,lr,!0),xr=Mt.borderStyle.width,wr=ir(this,Hr,this.svgFactory.createElement("svg:ellipse"));return wr.setAttribute("cx",Kt/2),wr.setAttribute("cy",lr/2),wr.setAttribute("rx",Kt/2-xr/2),wr.setAttribute("ry",lr/2-xr/2),wr.setAttribute("stroke-width",xr||1),wr.setAttribute("stroke","transparent"),wr.setAttribute("fill","transparent"),fr.append(wr),this.container.append(fr),!Mt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return mt(this,Hr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hr=new WeakMap;class Gt extends rt{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0});nr(this,yr,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const Mt=this.data,{width:Kt,height:lr}=_e(Mt.rect),fr=this.svgFactory.create(Kt,lr,!0);let xr=[];for(const Ir of Mt.vertices){const Mr=Ir.x-Mt.rect[0],wt=Mt.rect[3]-Ir.y;xr.push(Mr+","+wt)}xr=xr.join(" ");const wr=ir(this,yr,this.svgFactory.createElement(this.svgElementName));return wr.setAttribute("points",xr),wr.setAttribute("stroke-width",Mt.borderStyle.width||1),wr.setAttribute("stroke","transparent"),wr.setAttribute("fill","transparent"),fr.append(wr),this.container.append(fr),!Mt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return mt(this,yr)}addHighlightArea(){this.container.classList.add("highlightArea")}}yr=new WeakMap;class Nt extends Gt{constructor(Vt){super(Vt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ht extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class It extends rt{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0});nr(this,rr,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=s.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const Mt=this.data,{width:Kt,height:lr}=_e(Mt.rect),fr=this.svgFactory.create(Kt,lr,!0);for(const xr of Mt.inkLists){let wr=[];for(const Mr of xr){const wt=Mr.x-Mt.rect[0],Lt=Mt.rect[3]-Mr.y;wr.push(`${wt},${Lt}`)}wr=wr.join(" ");const Ir=this.svgFactory.createElement(this.svgElementName);mt(this,rr).push(Ir),Ir.setAttribute("points",wr),Ir.setAttribute("stroke-width",Mt.borderStyle.width||1),Ir.setAttribute("stroke","transparent"),Ir.setAttribute("fill","transparent"),!Mt.popupRef&&this.hasPopupData&&this._createPopup(),fr.append(Ir)}return this.container.append(fr),this.container}getElementsToTriggerPopup(){return mt(this,rr)}addHighlightArea(){this.container.classList.add("highlightArea")}}rr=new WeakMap,i.InkAnnotationElement=It;class Wt extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class yt extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Dt extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class $t extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class _t extends rt{constructor(Vt){super(Vt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}i.StampAnnotationElement=_t;class ht extends rt{constructor(Mt){var fr;super(Mt,{isRenderable:!0});nr(this,Rr);nr(this,ar,null);const{filename:Kt,content:lr}=this.data.file;this.filename=(0,o.getFilenameFromUrl)(Kt,!0),this.content=lr,(fr=this.linkService.eventBus)==null||fr.dispatch("fileattachmentannotation",{source:this,filename:Kt,content:lr})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:Mt,data:Kt}=this;let lr;Kt.hasAppearance||Kt.fillAlpha===0?lr=document.createElement("div"):(lr=document.createElement("img"),lr.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Kt.name)?"paperclip":"pushpin"}.svg`,Kt.fillAlpha&&Kt.fillAlpha<1&&(lr.style=`filter: opacity(${Math.round(Kt.fillAlpha*100)}%);`)),lr.addEventListener("dblclick",Qt(this,Rr,xa).bind(this)),ir(this,ar,lr);const{isMac:fr}=s.FeatureTest.platform;return Mt.addEventListener("keydown",xr=>{xr.key==="Enter"&&(fr?xr.metaKey:xr.ctrlKey)&&Qt(this,Rr,xa).call(this)}),!Kt.popupRef&&this.hasPopupData?this._createPopup():lr.classList.add("popupTriggerArea"),Mt.append(lr),Mt}getElementsToTriggerPopup(){return mt(this,ar)}addHighlightArea(){this.container.classList.add("highlightArea")}}ar=new WeakMap,Rr=new WeakSet,xa=function(){var Mt;(Mt=this.downloadManager)==null||Mt.openOrDownloadData(this.container,this.content,this.filename)};class ct{constructor({div:Vt,accessibilityManager:Mt,annotationCanvasMap:Kt,l10n:lr,page:fr,viewport:xr}){nr(this,Tr);nr(this,Wr,null);nr(this,zt,null);nr(this,gr,new Map);this.div=Vt,ir(this,Wr,Mt),ir(this,zt,Kt),this.l10n=lr,this.page=fr,this.viewport=xr,this.zIndex=0,this.l10n||(this.l10n=d.NullL10n)}async render(Vt){const{annotations:Mt}=Vt,Kt=this.div;(0,o.setLayerDimensions)(Kt,this.viewport);const lr=new Map,fr={data:null,layer:Kt,linkService:Vt.linkService,downloadManager:Vt.downloadManager,imageResourcesPath:Vt.imageResourcesPath||"",renderForms:Vt.renderForms!==!1,svgFactory:new o.DOMSVGFactory,annotationStorage:Vt.annotationStorage||new c.AnnotationStorage,enableScripting:Vt.enableScripting===!0,hasJSActions:Vt.hasJSActions,fieldObjects:Vt.fieldObjects,parent:this,elements:null};for(const xr of Mt){if(xr.noHTML)continue;const wr=xr.annotationType===s.AnnotationType.POPUP;if(wr){const wt=lr.get(xr.id);if(!wt)continue;fr.elements=wt}else{const{width:wt,height:Lt}=_e(xr.rect);if(wt<=0||Lt<=0)continue}fr.data=xr;const Ir=et.create(fr);if(!Ir.isRenderable)continue;if(!wr&&xr.popupRef){const wt=lr.get(xr.popupRef);wt?wt.push(Ir):lr.set(xr.popupRef,[Ir])}Ir.annotationEditorType>0&&mt(this,gr).set(Ir.data.id,Ir);const Mr=Ir.render();xr.hidden&&(Mr.style.visibility="hidden"),Qt(this,Tr,As).call(this,Mr,xr.id)}Qt(this,Tr,ba).call(this),await this.l10n.translate(Kt)}update({viewport:Vt}){const Mt=this.div;this.viewport=Vt,(0,o.setLayerDimensions)(Mt,{rotation:Vt.rotation}),Qt(this,Tr,ba).call(this),Mt.hidden=!1}getEditableAnnotations(){return Array.from(mt(this,gr).values())}getEditableAnnotation(Vt){return mt(this,gr).get(Vt)}}Wr=new WeakMap,zt=new WeakMap,gr=new WeakMap,Tr=new WeakSet,As=function(Vt,Mt){var lr;const Kt=Vt.firstChild||Vt;Kt.id=`${s.AnnotationPrefix}${Mt}`,this.div.append(Vt),(lr=mt(this,Wr))==null||lr.moveElementInDOM(this.div,Vt,Kt,!1)},ba=function(){if(!mt(this,zt))return;const Vt=this.div;for(const[Mt,Kt]of mt(this,zt)){const lr=Vt.querySelector(`[data-annotation-id="${Mt}"]`);if(!lr)continue;const{firstChild:fr}=lr;fr?fr.nodeName==="CANVAS"?fr.replaceWith(Kt):fr.before(Kt):lr.append(Kt)}mt(this,zt).clear()},i.AnnotationLayer=ct},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function a(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}function s(c){return Math.max(0,Math.min(255,255*c))}class o{static CMYK_G([h,d,g,_]){return["G",1-Math.min(1,.3*h+.59*g+.11*d+_)]}static G_CMYK([h]){return["CMYK",0,0,0,1-h]}static G_RGB([h]){return["RGB",h,h,h]}static G_rgb([h]){return h=s(h),[h,h,h]}static G_HTML([h]){const d=a(h);return`#${d}${d}${d}`}static RGB_G([h,d,g]){return["G",.3*h+.59*d+.11*g]}static RGB_rgb(h){return h.map(s)}static RGB_HTML(h){return`#${h.map(a).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([h,d,g,_]){return["RGB",1-Math.min(1,h+_),1-Math.min(1,g+_),1-Math.min(1,d+_)]}static CMYK_rgb([h,d,g,_]){return[s(1-Math.min(1,h+_)),s(1-Math.min(1,g+_)),s(1-Math.min(1,d+_))]}static CMYK_HTML(h){const d=this.CMYK_RGB(h).slice(1);return this.RGB_HTML(d)}static RGB_CMYK([h,d,g]){const _=1-h,b=1-d,j=1-g,_e=Math.min(_,b,j);return["CMYK",_,b,j,_e]}}i.ColorConverters=o},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NullL10n=void 0,i.getL10nFallback=s;const a={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};a.print_progress_percent="{{progress}}%";function s(h,d){switch(h){case"find_match_count":h=`find_match_count[${d.total===1?"one":"other"}]`;break;case"find_match_count_limit":h=`find_match_count_limit[${d.limit===1?"one":"other"}]`;break}return a[h]||""}function o(h,d){return d?h.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(g,_)=>_ in d?d[_]:"{{"+_+"}}"):h}const c={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(h,d=null,g=s(h,d)){return o(g,d)},async translate(h){}};i.NullL10n=c},(e,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var s=a(25);class o{static setupStorage(h,d,g,_,b){const j=_.getValue(d,{value:null});switch(g.name){case"textarea":if(j.value!==null&&(h.textContent=j.value),b==="print")break;h.addEventListener("input",_e=>{_.setValue(d,{value:_e.target.value})});break;case"input":if(g.attributes.type==="radio"||g.attributes.type==="checkbox"){if(j.value===g.attributes.xfaOn?h.setAttribute("checked",!0):j.value===g.attributes.xfaOff&&h.removeAttribute("checked"),b==="print")break;h.addEventListener("change",_e=>{_.setValue(d,{value:_e.target.checked?_e.target.getAttribute("xfaOn"):_e.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&h.setAttribute("value",j.value),b==="print")break;h.addEventListener("input",_e=>{_.setValue(d,{value:_e.target.value})})}break;case"select":if(j.value!==null){h.setAttribute("value",j.value);for(const _e of g.children)_e.attributes.value===j.value?_e.attributes.selected=!0:_e.attributes.hasOwnProperty("selected")&&delete _e.attributes.selected}h.addEventListener("input",_e=>{const et=_e.target.options,rt=et.selectedIndex===-1?"":et[et.selectedIndex].value;_.setValue(d,{value:rt})});break}}static setAttributes({html:h,element:d,storage:g=null,intent:_,linkService:b}){const{attributes:j}=d,_e=h instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${_}`);for(const[et,rt]of Object.entries(j))if(rt!=null)switch(et){case"class":rt.length&&h.setAttribute(et,rt.join(" "));break;case"dataId":break;case"id":h.setAttribute("data-element-id",rt);break;case"style":Object.assign(h.style,rt);break;case"textContent":h.textContent=rt;break;default:(!_e||et!=="href"&&et!=="newWindow")&&h.setAttribute(et,rt)}_e&&b.addLinkAttributes(h,j.href,j.newWindow),g&&j.dataId&&this.setupStorage(h,j.dataId,d,g)}static render(h){var tt;const d=h.annotationStorage,g=h.linkService,_=h.xfaHtml,b=h.intent||"display",j=document.createElement(_.name);_.attributes&&this.setAttributes({html:j,element:_,intent:b,linkService:g});const _e=[[_,-1,j]],et=h.div;if(et.append(j),h.viewport){const it=`matrix(${h.viewport.transform.join(",")})`;et.style.transform=it}b!=="richText"&&et.setAttribute("class","xfaLayer xfaFont");const rt=[];for(;_e.length>0;){const[it,nt,at]=_e.at(-1);if(nt+1===it.children.length){_e.pop();continue}const st=it.children[++_e.at(-1)[1]];if(st===null)continue;const{name:dt}=st;if(dt==="#text"){const ut=document.createTextNode(st.value);rt.push(ut),at.append(ut);continue}const lt=(tt=st==null?void 0:st.attributes)!=null&&tt.xmlns?document.createElementNS(st.attributes.xmlns,dt):document.createElement(dt);if(at.append(lt),st.attributes&&this.setAttributes({html:lt,element:st,storage:d,intent:b,linkService:g}),st.children&&st.children.length>0)_e.push([st,-1,lt]);else if(st.value){const ut=document.createTextNode(st.value);s.XfaText.shouldBuildText(dt)&&rt.push(ut),lt.append(ut)}}for(const it of et.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))it.setAttribute("readOnly",!0);return{textDivs:rt}}static update(h){const d=`matrix(${h.viewport.transform.join(",")})`;h.div.style.transform=d,h.div.hidden=!1}}i.XfaLayer=o},(e,i,a)=>{var _,b,j,_e,et,rt,tt,it,nt,at,st,dt,lt,ut,ot,ks,bs,Cs,Fs,$a,Ps,es,Rs,Ds,Ms,Ls,Is,Zr,ts,kn,bn,an,rs,Cn,bt,Os,ns,Ns,Bs,is,Fn,sn;Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0;var s=a(1),o=a(4),c=a(29),h=a(6),d=a(5);const hr=class hr extends o.AnnotationEditor{constructor(Ft){super({...Ft,name:"inkEditor"});nr(this,ot);nr(this,_,0);nr(this,b,0);nr(this,j,this.canvasPointermove.bind(this));nr(this,_e,this.canvasPointerleave.bind(this));nr(this,et,this.canvasPointerup.bind(this));nr(this,rt,this.canvasPointerdown.bind(this));nr(this,tt,new Path2D);nr(this,it,!1);nr(this,nt,!1);nr(this,at,!1);nr(this,st,null);nr(this,dt,0);nr(this,lt,0);nr(this,ut,null);this.color=Ft.color||null,this.thickness=Ft.thickness||null,this.opacity=Ft.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Ft){o.AnnotationEditor.initialize(Ft,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Ft,Ut){switch(Ft){case s.AnnotationEditorParamsType.INK_THICKNESS:hr._defaultThickness=Ut;break;case s.AnnotationEditorParamsType.INK_COLOR:hr._defaultColor=Ut;break;case s.AnnotationEditorParamsType.INK_OPACITY:hr._defaultOpacity=Ut/100;break}}updateParams(Ft,Ut){switch(Ft){case s.AnnotationEditorParamsType.INK_THICKNESS:Qt(this,ot,ks).call(this,Ut);break;case s.AnnotationEditorParamsType.INK_COLOR:Qt(this,ot,bs).call(this,Ut);break;case s.AnnotationEditorParamsType.INK_OPACITY:Qt(this,ot,Cs).call(this,Ut);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,hr._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,hr._defaultColor||o.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(hr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||hr._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,this.color||hr._defaultColor||o.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??hr._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Qt(this,ot,kn).call(this),Qt(this,ot,bn).call(this)),this.isAttachedToDOM||(this.parent.add(this),Qt(this,ot,an).call(this)),Qt(this,ot,sn).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,mt(this,st).disconnect(),ir(this,st,null),super.remove())}setParent(Ft){!this.parent&&Ft?this._uiManager.removeShouldRescale(this):this.parent&&Ft===null&&this._uiManager.addShouldRescale(this),super.setParent(Ft)}onScaleChanging(){const[Ft,Ut]=this.parentDimensions,qt=this.width*Ft,Jt=this.height*Ut;this.setDimensions(qt,Jt)}enableEditMode(){mt(this,it)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",mt(this,rt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",mt(this,rt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){mt(this,it)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ir(this,it,!0),this.div.classList.add("disabled"),Qt(this,ot,sn).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Ft){this._focusEventsAllowed&&(super.focusin(Ft),this.enableEditMode())}canvasPointerdown(Ft){Ft.button!==0||!this.isInEditMode()||mt(this,it)||(this.setInForeground(),Ft.preventDefault(),Ft.type!=="mouse"&&this.div.focus(),Qt(this,ot,Ps).call(this,Ft.offsetX,Ft.offsetY))}canvasPointermove(Ft){Ft.preventDefault(),Qt(this,ot,es).call(this,Ft.offsetX,Ft.offsetY)}canvasPointerup(Ft){Ft.preventDefault(),Qt(this,ot,ts).call(this,Ft)}canvasPointerleave(Ft){Qt(this,ot,ts).call(this,Ft)}get isResizable(){return!this.isEmpty()&&mt(this,it)}render(){if(this.div)return this.div;let Ft,Ut;this.width&&(Ft=this.x,Ut=this.y),super.render(),o.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(_r=>{var Zt;return(Zt=this.div)==null?void 0:Zt.setAttribute("aria-label",_r)});const[qt,Jt,dr,vr]=Qt(this,ot,Fs).call(this);if(this.setAt(qt,Jt,0,0),this.setDims(dr,vr),Qt(this,ot,kn).call(this),this.width){const[_r,Zt]=this.parentDimensions;this.setAspectRatio(this.width*_r,this.height*Zt),this.setAt(Ft*_r,Ut*Zt,this.width*_r,this.height*Zt),ir(this,at,!0),Qt(this,ot,an).call(this),this.setDims(this.width*_r,this.height*Zt),Qt(this,ot,Zr).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Qt(this,ot,bn).call(this),this.div}setDimensions(Ft,Ut){const qt=Math.round(Ft),Jt=Math.round(Ut);if(mt(this,dt)===qt&&mt(this,lt)===Jt)return;ir(this,dt,qt),ir(this,lt,Jt),this.canvas.style.visibility="hidden";const[dr,vr]=this.parentDimensions;this.width=Ft/dr,this.height=Ut/vr,this.fixAndSetPosition(),mt(this,it)&&Qt(this,ot,rs).call(this,Ft,Ut),Qt(this,ot,an).call(this),Qt(this,ot,Zr).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Ft,Ut,qt){var Dr,jr,Hr;if(Ft instanceof c.InkAnnotationElement)return null;const Jt=super.deserialize(Ft,Ut,qt);Jt.thickness=Ft.thickness,Jt.color=s.Util.makeHexColor(...Ft.color),Jt.opacity=Ft.opacity;const[dr,vr]=Jt.pageDimensions,_r=Jt.width*dr,Zt=Jt.height*vr,Er=Jt.parentScale,Sr=Ft.thickness/2;ir(Jt,it,!0),ir(Jt,dt,Math.round(_r)),ir(Jt,lt,Math.round(Zt));const{paths:Vr,rect:Nr,rotation:Pr}=Ft;for(let{bezier:yr}of Vr){yr=Qt(Dr=hr,bt,Ns).call(Dr,yr,Nr,Pr);const rr=[];Jt.paths.push(rr);let ar=Er*(yr[0]-Sr),Rr=Er*(yr[1]-Sr);for(let Wr=2,zt=yr.length;Wr<zt;Wr+=6){const gr=Er*(yr[Wr]-Sr),Tr=Er*(yr[Wr+1]-Sr),Lr=Er*(yr[Wr+2]-Sr),Or=Er*(yr[Wr+3]-Sr),Fr=Er*(yr[Wr+4]-Sr),Vt=Er*(yr[Wr+5]-Sr);rr.push([[ar,Rr],[gr,Tr],[Lr,Or],[Fr,Vt]]),ar=Fr,Rr=Vt}const zr=Qt(this,bt,Os).call(this,rr);Jt.bezierPath2D.push(zr)}const kr=Qt(jr=Jt,ot,is).call(jr);return ir(Jt,b,Math.max(o.AnnotationEditor.MIN_SIZE,kr[2]-kr[0])),ir(Jt,_,Math.max(o.AnnotationEditor.MIN_SIZE,kr[3]-kr[1])),Qt(Hr=Jt,ot,rs).call(Hr,_r,Zt),Jt}serialize(){if(this.isEmpty())return null;const Ft=this.getRect(0,0),Ut=o.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:s.AnnotationEditorType.INK,color:Ut,thickness:this.thickness,opacity:this.opacity,paths:Qt(this,ot,Bs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Ft),pageIndex:this.pageIndex,rect:Ft,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};_=new WeakMap,b=new WeakMap,j=new WeakMap,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,tt=new WeakMap,it=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakMap,dt=new WeakMap,lt=new WeakMap,ut=new WeakMap,ot=new WeakSet,ks=function(Ft){const Ut=this.thickness;this.addCommands({cmd:()=>{this.thickness=Ft,Qt(this,ot,sn).call(this)},undo:()=>{this.thickness=Ut,Qt(this,ot,sn).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},bs=function(Ft){const Ut=this.color;this.addCommands({cmd:()=>{this.color=Ft,Qt(this,ot,Zr).call(this)},undo:()=>{this.color=Ut,Qt(this,ot,Zr).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Cs=function(Ft){Ft/=100;const Ut=this.opacity;this.addCommands({cmd:()=>{this.opacity=Ft,Qt(this,ot,Zr).call(this)},undo:()=>{this.opacity=Ut,Qt(this,ot,Zr).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Fs=function(){const{parentRotation:Ft,parentDimensions:[Ut,qt]}=this;switch(Ft){case 90:return[0,qt,qt,Ut];case 180:return[Ut,qt,Ut,qt];case 270:return[Ut,0,qt,Ut];default:return[0,0,Ut,qt]}},$a=function(){const{ctx:Ft,color:Ut,opacity:qt,thickness:Jt,parentScale:dr,scaleFactor:vr}=this;Ft.lineWidth=Jt*dr/vr,Ft.lineCap="round",Ft.lineJoin="round",Ft.miterLimit=10,Ft.strokeStyle=`${Ut}${(0,d.opacityToHex)(qt)}`},Ps=function(Ft,Ut){this.canvas.addEventListener("contextmenu",h.noContextMenu),this.canvas.addEventListener("pointerleave",mt(this,_e)),this.canvas.addEventListener("pointermove",mt(this,j)),this.canvas.addEventListener("pointerup",mt(this,et)),this.canvas.removeEventListener("pointerdown",mt(this,rt)),this.isEditing=!0,mt(this,at)||(ir(this,at,!0),Qt(this,ot,an).call(this),this.thickness||(this.thickness=hr._defaultThickness),this.color||(this.color=hr._defaultColor||o.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=hr._defaultOpacity)),this.currentPath.push([Ft,Ut]),ir(this,nt,!1),Qt(this,ot,$a).call(this),ir(this,ut,()=>{Qt(this,ot,Ms).call(this),mt(this,ut)&&window.requestAnimationFrame(mt(this,ut))}),window.requestAnimationFrame(mt(this,ut))},es=function(Ft,Ut){const[qt,Jt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Ft===qt&&Ut===Jt)return;const dr=this.currentPath;let vr=mt(this,tt);if(dr.push([Ft,Ut]),ir(this,nt,!0),dr.length<=2){vr.moveTo(...dr[0]),vr.lineTo(Ft,Ut);return}dr.length===3&&(ir(this,tt,vr=new Path2D),vr.moveTo(...dr[0])),Qt(this,ot,Ls).call(this,vr,...dr.at(-3),...dr.at(-2),Ft,Ut)},Rs=function(){if(this.currentPath.length===0)return;const Ft=this.currentPath.at(-1);mt(this,tt).lineTo(...Ft)},Ds=function(Ft,Ut){ir(this,ut,null),Ft=Math.min(Math.max(Ft,0),this.canvas.width),Ut=Math.min(Math.max(Ut,0),this.canvas.height),Qt(this,ot,es).call(this,Ft,Ut),Qt(this,ot,Rs).call(this);let qt;if(this.currentPath.length!==1)qt=Qt(this,ot,Is).call(this);else{const Zt=[Ft,Ut];qt=[[Zt,Zt.slice(),Zt.slice(),Zt]]}const Jt=mt(this,tt),dr=this.currentPath;this.currentPath=[],ir(this,tt,new Path2D);const vr=()=>{this.allRawPaths.push(dr),this.paths.push(qt),this.bezierPath2D.push(Jt),this.rebuild()},_r=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Qt(this,ot,kn).call(this),Qt(this,ot,bn).call(this)),Qt(this,ot,sn).call(this))};this.addCommands({cmd:vr,undo:_r,mustExec:!0})},Ms=function(){if(!mt(this,nt))return;ir(this,nt,!1);const Ft=Math.ceil(this.thickness*this.parentScale),Ut=this.currentPath.slice(-3),qt=Ut.map(vr=>vr[0]),Jt=Ut.map(vr=>vr[1]);Math.min(...qt)-Ft,Math.max(...qt)+Ft,Math.min(...Jt)-Ft,Math.max(...Jt)+Ft;const{ctx:dr}=this;dr.save(),dr.clearRect(0,0,this.canvas.width,this.canvas.height);for(const vr of this.bezierPath2D)dr.stroke(vr);dr.stroke(mt(this,tt)),dr.restore()},Ls=function(Ft,Ut,qt,Jt,dr,vr,_r){const Zt=(Ut+Jt)/2,Er=(qt+dr)/2,Sr=(Jt+vr)/2,Vr=(dr+_r)/2;Ft.bezierCurveTo(Zt+2*(Jt-Zt)/3,Er+2*(dr-Er)/3,Sr+2*(Jt-Sr)/3,Vr+2*(dr-Vr)/3,Sr,Vr)},Is=function(){const Ft=this.currentPath;if(Ft.length<=2)return[[Ft[0],Ft[0],Ft.at(-1),Ft.at(-1)]];const Ut=[];let qt,[Jt,dr]=Ft[0];for(qt=1;qt<Ft.length-2;qt++){const[Nr,Pr]=Ft[qt],[kr,Dr]=Ft[qt+1],jr=(Nr+kr)/2,Hr=(Pr+Dr)/2,yr=[Jt+2*(Nr-Jt)/3,dr+2*(Pr-dr)/3],rr=[jr+2*(Nr-jr)/3,Hr+2*(Pr-Hr)/3];Ut.push([[Jt,dr],yr,rr,[jr,Hr]]),[Jt,dr]=[jr,Hr]}const[vr,_r]=Ft[qt],[Zt,Er]=Ft[qt+1],Sr=[Jt+2*(vr-Jt)/3,dr+2*(_r-dr)/3],Vr=[Zt+2*(vr-Zt)/3,Er+2*(_r-Er)/3];return Ut.push([[Jt,dr],Sr,Vr,[Zt,Er]]),Ut},Zr=function(){if(this.isEmpty()){Qt(this,ot,Cn).call(this);return}Qt(this,ot,$a).call(this);const{canvas:Ft,ctx:Ut}=this;Ut.setTransform(1,0,0,1,0,0),Ut.clearRect(0,0,Ft.width,Ft.height),Qt(this,ot,Cn).call(this);for(const qt of this.bezierPath2D)Ut.stroke(qt)},ts=function(Ft){this.canvas.removeEventListener("pointerleave",mt(this,_e)),this.canvas.removeEventListener("pointermove",mt(this,j)),this.canvas.removeEventListener("pointerup",mt(this,et)),this.canvas.addEventListener("pointerdown",mt(this,rt)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",h.noContextMenu)},10),Qt(this,ot,Ds).call(this,Ft.offsetX,Ft.offsetY),this.addToAnnotationStorage(),this.setInBackground()},kn=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",o.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Ft=>{var Ut;return(Ut=this.canvas)==null?void 0:Ut.setAttribute("aria-label",Ft)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},bn=function(){ir(this,st,new ResizeObserver(Ft=>{const Ut=Ft[0].contentRect;Ut.width&&Ut.height&&this.setDimensions(Ut.width,Ut.height)})),mt(this,st).observe(this.div)},an=function(){if(!mt(this,at))return;const[Ft,Ut]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Ft),this.canvas.height=Math.ceil(this.height*Ut),Qt(this,ot,Cn).call(this)},rs=function(Ft,Ut){const qt=Qt(this,ot,Fn).call(this),Jt=(Ft-qt)/mt(this,b),dr=(Ut-qt)/mt(this,_);this.scaleFactor=Math.min(Jt,dr)},Cn=function(){const Ft=Qt(this,ot,Fn).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Ft,this.translationY*this.scaleFactor+Ft)},bt=new WeakSet,Os=function(Ft){const Ut=new Path2D;for(let qt=0,Jt=Ft.length;qt<Jt;qt++){const[dr,vr,_r,Zt]=Ft[qt];qt===0&&Ut.moveTo(...dr),Ut.bezierCurveTo(vr[0],vr[1],_r[0],_r[1],Zt[0],Zt[1])}return Ut},ns=function(Ft,Ut,qt){const[Jt,dr,vr,_r]=Ut;switch(qt){case 0:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2)Ft[Zt]+=Jt,Ft[Zt+1]=_r-Ft[Zt+1];break;case 90:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2){const Sr=Ft[Zt];Ft[Zt]=Ft[Zt+1]+Jt,Ft[Zt+1]=Sr+dr}break;case 180:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2)Ft[Zt]=vr-Ft[Zt],Ft[Zt+1]+=dr;break;case 270:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2){const Sr=Ft[Zt];Ft[Zt]=vr-Ft[Zt+1],Ft[Zt+1]=_r-Sr}break;default:throw new Error("Invalid rotation")}return Ft},Ns=function(Ft,Ut,qt){const[Jt,dr,vr,_r]=Ut;switch(qt){case 0:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2)Ft[Zt]-=Jt,Ft[Zt+1]=_r-Ft[Zt+1];break;case 90:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2){const Sr=Ft[Zt];Ft[Zt]=Ft[Zt+1]-dr,Ft[Zt+1]=Sr-Jt}break;case 180:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2)Ft[Zt]=vr-Ft[Zt],Ft[Zt+1]-=dr;break;case 270:for(let Zt=0,Er=Ft.length;Zt<Er;Zt+=2){const Sr=Ft[Zt];Ft[Zt]=_r-Ft[Zt+1],Ft[Zt+1]=vr-Sr}break;default:throw new Error("Invalid rotation")}return Ft},Bs=function(Ft,Ut,qt,Jt){var Er,Sr;const dr=[],vr=this.thickness/2,_r=Ft*Ut+vr,Zt=Ft*qt+vr;for(const Vr of this.paths){const Nr=[],Pr=[];for(let kr=0,Dr=Vr.length;kr<Dr;kr++){const[jr,Hr,yr,rr]=Vr[kr],ar=Ft*jr[0]+_r,Rr=Ft*jr[1]+Zt,zr=Ft*Hr[0]+_r,Wr=Ft*Hr[1]+Zt,zt=Ft*yr[0]+_r,gr=Ft*yr[1]+Zt,Tr=Ft*rr[0]+_r,Lr=Ft*rr[1]+Zt;kr===0&&(Nr.push(ar,Rr),Pr.push(ar,Rr)),Nr.push(zr,Wr,zt,gr,Tr,Lr),Pr.push(zr,Wr),kr===Dr-1&&Pr.push(Tr,Lr)}dr.push({bezier:Qt(Er=hr,bt,ns).call(Er,Nr,Jt,this.rotation),points:Qt(Sr=hr,bt,ns).call(Sr,Pr,Jt,this.rotation)})}return dr},is=function(){let Ft=1/0,Ut=-1/0,qt=1/0,Jt=-1/0;for(const dr of this.paths)for(const[vr,_r,Zt,Er]of dr){const Sr=s.Util.bezierBoundingBox(...vr,..._r,...Zt,...Er);Ft=Math.min(Ft,Sr[0]),qt=Math.min(qt,Sr[1]),Ut=Math.max(Ut,Sr[2]),Jt=Math.max(Jt,Sr[3])}return[Ft,qt,Ut,Jt]},Fn=function(){return mt(this,it)?Math.ceil(this.thickness*this.parentScale):0},sn=function(Ft=!1){if(this.isEmpty())return;if(!mt(this,it)){Qt(this,ot,Zr).call(this);return}const Ut=Qt(this,ot,is).call(this),qt=Qt(this,ot,Fn).call(this);ir(this,b,Math.max(o.AnnotationEditor.MIN_SIZE,Ut[2]-Ut[0])),ir(this,_,Math.max(o.AnnotationEditor.MIN_SIZE,Ut[3]-Ut[1]));const Jt=Math.ceil(qt+mt(this,b)*this.scaleFactor),dr=Math.ceil(qt+mt(this,_)*this.scaleFactor),[vr,_r]=this.parentDimensions;this.width=Jt/vr,this.height=dr/_r,this.setAspectRatio(Jt,dr);const Zt=this.translationX,Er=this.translationY;this.translationX=-Ut[0],this.translationY=-Ut[1],Qt(this,ot,an).call(this),Qt(this,ot,Zr).call(this),ir(this,dt,Jt),ir(this,lt,dr),this.setDims(Jt,dr);const Sr=Ft?qt/this.scaleFactor/2:0;this.translate(Zt-this.translationX-Sr,Er-this.translationY-Sr)},nr(hr,bt),$r(hr,"_defaultColor",null),$r(hr,"_defaultOpacity",1),$r(hr,"_defaultThickness",1),$r(hr,"_type","ink");let g=hr;i.InkEditor=g},(e,i,a)=>{var g,_,b,j,_e,et,rt,tt,it,nt,at,gn,_n,Pn,as,Vs,Us,ss,Rn,js;Object.defineProperty(i,"__esModule",{value:!0}),i.StampEditor=void 0;var s=a(1),o=a(4),c=a(6),h=a(29);const vt=class vt extends o.AnnotationEditor{constructor(Nt){super({...Nt,name:"stampEditor"});nr(this,at);nr(this,g,null);nr(this,_,null);nr(this,b,null);nr(this,j,null);nr(this,_e,null);nr(this,et,null);nr(this,rt,null);nr(this,tt,null);nr(this,it,!1);nr(this,nt,!1);ir(this,j,Nt.bitmapUrl),ir(this,_e,Nt.bitmapFile)}static initialize(Nt){o.AnnotationEditor.initialize(Nt)}static get supportedTypes(){const Nt=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,s.shadow)(this,"supportedTypes",Nt.map(Ht=>`image/${Ht}`))}static get supportedTypesStr(){return(0,s.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Nt){return this.supportedTypes.includes(Nt)}static paste(Nt,Ht){Ht.pasteEditor(s.AnnotationEditorType.STAMP,{bitmapFile:Nt.getAsFile()})}remove(){var Nt,Ht;mt(this,_)&&(ir(this,g,null),this._uiManager.imageManager.deleteId(mt(this,_)),(Nt=mt(this,et))==null||Nt.remove(),ir(this,et,null),(Ht=mt(this,rt))==null||Ht.disconnect(),ir(this,rt,null)),super.remove()}rebuild(){if(!this.parent){mt(this,_)&&Qt(this,at,Pn).call(this);return}super.rebuild(),this.div!==null&&(mt(this,_)&&Qt(this,at,Pn).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(mt(this,b)||mt(this,g)||mt(this,j)||mt(this,_e))}get isResizable(){return!0}render(){if(this.div)return this.div;let Nt,Ht;if(this.width&&(Nt=this.x,Ht=this.y),super.render(),this.div.hidden=!0,mt(this,g)?Qt(this,at,as).call(this):Qt(this,at,Pn).call(this),this.width){const[It,Wt]=this.parentDimensions;this.setAt(Nt*It,Ht*Wt,this.width*It,this.height*Wt)}return this.div}static deserialize(Nt,Ht,It){if(Nt instanceof h.StampAnnotationElement)return null;const Wt=super.deserialize(Nt,Ht,It),{rect:yt,bitmapUrl:Dt,bitmapId:$t,isSvg:_t,accessibilityData:ht}=Nt;$t&&It.imageManager.isValidId($t)?ir(Wt,_,$t):ir(Wt,j,Dt),ir(Wt,it,_t);const[ct,xt]=Wt.pageDimensions;return Wt.width=(yt[2]-yt[0])/ct,Wt.height=(yt[3]-yt[1])/xt,ht&&(Wt.altTextData=ht),Wt}serialize(Nt=!1,Ht=null){if(this.isEmpty())return null;const It={annotationType:s.AnnotationEditorType.STAMP,bitmapId:mt(this,_),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:mt(this,it),structTreeParentId:this._structTreeParentId};if(Nt)return It.bitmapUrl=Qt(this,at,Rn).call(this,!0),It.accessibilityData=this.altTextData,It;const{decorative:Wt,altText:yt}=this.altTextData;if(!Wt&&yt&&(It.accessibilityData={type:"Figure",alt:yt}),Ht===null)return It;Ht.stamps||(Ht.stamps=new Map);const Dt=mt(this,it)?(It.rect[2]-It.rect[0])*(It.rect[3]-It.rect[1]):null;if(!Ht.stamps.has(mt(this,_)))Ht.stamps.set(mt(this,_),{area:Dt,serialized:It}),It.bitmap=Qt(this,at,Rn).call(this,!1);else if(mt(this,it)){const $t=Ht.stamps.get(mt(this,_));Dt>$t.area&&($t.area=Dt,$t.serialized.bitmap.close(),$t.serialized.bitmap=Qt(this,at,Rn).call(this,!1))}return It}};g=new WeakMap,_=new WeakMap,b=new WeakMap,j=new WeakMap,_e=new WeakMap,et=new WeakMap,rt=new WeakMap,tt=new WeakMap,it=new WeakMap,nt=new WeakMap,at=new WeakSet,gn=function(Nt,Ht=!1){if(!Nt){this.remove();return}ir(this,g,Nt.bitmap),Ht||(ir(this,_,Nt.id),ir(this,it,Nt.isSvg)),Qt(this,at,as).call(this)},_n=function(){ir(this,b,null),this._uiManager.enableWaiting(!1),mt(this,et)&&this.div.focus()},Pn=function(){if(mt(this,_)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(mt(this,_)).then(Ht=>Qt(this,at,gn).call(this,Ht,!0)).finally(()=>Qt(this,at,_n).call(this));return}if(mt(this,j)){const Ht=mt(this,j);ir(this,j,null),this._uiManager.enableWaiting(!0),ir(this,b,this._uiManager.imageManager.getFromUrl(Ht).then(It=>Qt(this,at,gn).call(this,It)).finally(()=>Qt(this,at,_n).call(this)));return}if(mt(this,_e)){const Ht=mt(this,_e);ir(this,_e,null),this._uiManager.enableWaiting(!0),ir(this,b,this._uiManager.imageManager.getFromFile(Ht).then(It=>Qt(this,at,gn).call(this,It)).finally(()=>Qt(this,at,_n).call(this)));return}const Nt=document.createElement("input");Nt.type="file",Nt.accept=vt.supportedTypesStr,ir(this,b,new Promise(Ht=>{Nt.addEventListener("change",async()=>{if(!Nt.files||Nt.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const It=await this._uiManager.imageManager.getFromFile(Nt.files[0]);Qt(this,at,gn).call(this,It)}Ht()}),Nt.addEventListener("cancel",()=>{this.remove(),Ht()})}).finally(()=>Qt(this,at,_n).call(this))),Nt.click()},as=function(){const{div:Nt}=this;let{width:Ht,height:It}=mt(this,g);const[Wt,yt]=this.pageDimensions,Dt=.75;if(this.width)Ht=this.width*Wt,It=this.height*yt;else if(Ht>Dt*Wt||It>Dt*yt){const ct=Math.min(Dt*Wt/Ht,Dt*yt/It);Ht*=ct,It*=ct}const[$t,_t]=this.parentDimensions;this.setDims(Ht*$t/Wt,It*_t/yt),this._uiManager.enableWaiting(!1);const ht=ir(this,et,document.createElement("canvas"));Nt.append(ht),Nt.hidden=!1,Qt(this,at,ss).call(this,Ht,It),Qt(this,at,js).call(this),mt(this,nt)||(this.parent.addUndoableEditor(this),ir(this,nt,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Vs=function(Nt,Ht){var Dt;const[It,Wt]=this.parentDimensions;this.width=Nt/It,this.height=Ht/Wt,this.setDims(Nt,Ht),(Dt=this._initialOptions)!=null&&Dt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,mt(this,tt)!==null&&clearTimeout(mt(this,tt)),ir(this,tt,setTimeout(()=>{ir(this,tt,null),Qt(this,at,ss).call(this,Nt,Ht)},200))},Us=function(Nt,Ht){const{width:It,height:Wt}=mt(this,g);let yt=It,Dt=Wt,$t=mt(this,g);for(;yt>2*Nt||Dt>2*Ht;){const _t=yt,ht=Dt;yt>2*Nt&&(yt=yt>=16384?Math.floor(yt/2)-1:Math.ceil(yt/2)),Dt>2*Ht&&(Dt=Dt>=16384?Math.floor(Dt/2)-1:Math.ceil(Dt/2));const ct=new OffscreenCanvas(yt,Dt);ct.getContext("2d").drawImage($t,0,0,_t,ht,0,0,yt,Dt),$t=ct.transferToImageBitmap()}return $t},ss=function(Nt,Ht){Nt=Math.ceil(Nt),Ht=Math.ceil(Ht);const It=mt(this,et);if(!It||It.width===Nt&&It.height===Ht)return;It.width=Nt,It.height=Ht;const Wt=mt(this,it)?mt(this,g):Qt(this,at,Us).call(this,Nt,Ht),yt=It.getContext("2d");yt.filter=this._uiManager.hcmFilter,yt.drawImage(Wt,0,0,Wt.width,Wt.height,0,0,Nt,Ht)},Rn=function(Nt){if(Nt){if(mt(this,it)){const Wt=this._uiManager.imageManager.getSvgUrl(mt(this,_));if(Wt)return Wt}const Ht=document.createElement("canvas");return{width:Ht.width,height:Ht.height}=mt(this,g),Ht.getContext("2d").drawImage(mt(this,g),0,0),Ht.toDataURL()}if(mt(this,it)){const[Ht,It]=this.pageDimensions,Wt=Math.round(this.width*Ht*c.PixelsPerInch.PDF_TO_CSS_UNITS),yt=Math.round(this.height*It*c.PixelsPerInch.PDF_TO_CSS_UNITS),Dt=new OffscreenCanvas(Wt,yt);return Dt.getContext("2d").drawImage(mt(this,g),0,0,mt(this,g).width,mt(this,g).height,0,0,Wt,yt),Dt.transferToImageBitmap()}return structuredClone(mt(this,g))},js=function(){ir(this,rt,new ResizeObserver(Nt=>{const Ht=Nt[0].contentRect;Ht.width&&Ht.height&&Qt(this,at,Vs).call(this,Ht.width,Ht.height)})),mt(this,rt).observe(this.div)},$r(vt,"_type","stamp");let d=vt;i.StampEditor=d}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var i=__webpack_module_cache__[e];if(i!==void 0)return i.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](a,a.exports,__w_pdfjs_require__),a.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return c.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return h.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return d.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return s.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return g.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return i.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return a.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return s.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return a.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return s.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return i.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return s.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return a.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return _.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return a.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return a.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return s.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return s.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return s.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return s.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return s.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return s.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return s.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return i.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return o.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return s.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return o.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return a.version}});var i=__w_pdfjs_require__(1),a=__w_pdfjs_require__(2),s=__w_pdfjs_require__(6),o=__w_pdfjs_require__(26),c=__w_pdfjs_require__(27),h=__w_pdfjs_require__(5),d=__w_pdfjs_require__(29),g=__w_pdfjs_require__(14),_=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;function extractDate(e){const i=/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,a=e.match(i);if(a){const s=parseInt(a[1],10),o=parseInt(a[2],10)-1;let c=parseInt(a[3],10);return c<100&&(c+=2e3),new Date(c,o,s)}return null}function extractEmployee(e){const i=/(?:|-)[\s]*([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/,a=e.match(i);if(a)return a[1].trim();const s=/([A-Z][a-z]+\s+[A-Z][a-z]+)/,o=e.match(s);return o?o[1].trim():"Unbekannt"}function extractAppointments(e){const i=[],a=/(\d+)\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)?(?:\s+aus\s+[A-Z][a-z]+)?)/g;let s;for(;(s=a.exec(e))!==null;)i.push({number:parseInt(s[1],10),customer:s[2].trim()});return i}function parseTextContent(e){const i=extractDate(e);if(!i)return null;const a=extractEmployee(e),s=extractAppointments(e);return s.length===0?null:{date:i,employee:a,appointments:s}}async function parseTxtFile(e){const i=await e.text(),a=parseTextContent(i);return a?[a]:[]}async function parsePdfFile(e){try{const i=await e.arrayBuffer(),a=await pdfExports.getDocument({data:i}).promise;let s="";for(let c=1;c<=a.numPages;c++){const g=(await(await a.getPage(c)).getTextContent()).items.map(_=>_.str).join(" ");s+=g+`
`}const o=parseTextContent(s);return o?[o]:[]}catch(i){throw console.error("Error parsing PDF:",i),new Error("Fehler beim Parsen der PDF-Datei")}}async function parseExcelFile(e){try{const i=await e.arrayBuffer(),a=readSync(i,{type:"array"}),s=[],o=a.SheetNames[0],c=a.Sheets[o],d=utils.sheet_to_json(c,{header:1}).map(_=>_.join(" ")).join(`
`),g=parseTextContent(d);return g&&s.push(g),s}catch(i){throw console.error("Error parsing Excel:",i),new Error("Fehler beim Parsen der Excel-Datei")}}async function parseFile(e){var a;switch((a=e.name.split(".").pop())==null?void 0:a.toLowerCase()){case"txt":return parseTxtFile(e);case"pdf":return parsePdfFile(e);case"xlsx":case"xls":return parseExcelFile(e);default:throw new Error("Nicht untersttztes Dateiformat")}}function getRandomPause(e,i){return Math.floor(Math.random()*(i-e+1))+e}function generateTimeWindow(e){const i=format(e,"HH:mm"),a=addMinutes(e,180),s=format(a,"HH:mm");return`${i} - ${s}`}function setTimeOnDate(e,i){const[a,s]=i.split(":").map(Number),o=new Date(e);return o.setHours(a,s,0,0),o}function scheduleTour(e,i){const a=[];let s=setTimeOnDate(e.date,i.tourStartTime);return e.appointments.forEach((o,c)=>{if(c>0){const _=getRandomPause(i.pauseMin,i.pauseMax);s=addMinutes(s,_)}const h=new Date(s),d=addMinutes(h,i.appointmentDuration),g=i.enableTimeWindow?generateTimeWindow(h):"-";a.push({date:e.date,employee:e.employee,appointmentNumber:o.number,customer:o.customer,startTime:h,endTime:d,timeWindow:g}),s=d}),a}function scheduleAllTours(e,i){const a=[];return e.forEach(s=>{const o=scheduleTour(s,i);a.push(...o)}),a.sort((s,o)=>{const c=s.date.getTime()-o.date.getTime();return c!==0?c:s.appointmentNumber-o.appointmentNumber}),a}const SETTINGS_KEY="tour-report-settings";function App(){const[e,i]=reactExports.useState([]),[a,s]=reactExports.useState(DEFAULT_SETTINGS);reactExports.useEffect(()=>{const h=localStorage.getItem(SETTINGS_KEY);if(h)try{const d=JSON.parse(h);s(d)}catch(d){console.error("Error loading settings:",d)}},[]);const o=h=>{s(h),localStorage.setItem(SETTINGS_KEY,JSON.stringify(h)),e.length>0},c=async h=>{try{const d=await parseFile(h);if(d.length===0){alert("Keine gltigen Tour-Daten in der Datei gefunden.");return}const g=scheduleAllTours(d,a);i(g)}catch(d){throw console.error("Error processing file:",d),d}};return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-background",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[jsxRuntimeExports.jsx("header",{className:"mb-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-primary text-primary-foreground",children:jsxRuntimeExports.jsx(Calendar,{size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold",children:"Tour Report Manager"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Termine planen und exportieren"})]})]}),jsxRuntimeExports.jsx(SettingsPanel,{settings:a,onSettingsChange:o})]})}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx(FileUpload,{onFileUpload:c}),jsxRuntimeExports.jsx(AppointmentTable,{entries:e})]}),jsxRuntimeExports.jsx("footer",{className:"mt-12 text-center text-sm text-muted-foreground",children:jsxRuntimeExports.jsx("p",{children:"Alle Daten werden lokal in Ihrem Browser verarbeitet."})})]})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
